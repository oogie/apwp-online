(self.webpackChunkAPWP_online_org=self.webpackChunkAPWP_online_org||[]).push([[826],{3268:(t,e,i)=>{"use strict";var n=i(865),r=i.n(n),s=new Intl.RelativeTimeFormat("en",{localeMatcher:"best fit",numeric:"auto",style:"long"}),a=new Intl.DateTimeFormat("en-GB",{dateStyle:"short",timeStyle:"short"}),o={serialize:function(t,e){return JSON.stringify(t,(function(t,e){if("number"==typeof e){if(isNaN(e))return"__SERIALIZED__NaN";if(e===1/0)return"__SERIALIZED__Infinity";if(e===-1/0)return"__SERIALIZED__-Infinity"}return void 0===e?"__SERIALIZED__undefined":e}),e)},deserialize:function(t){return JSON.parse(t,(function(t,e){return"__SERIALIZED__NaN"===e?NaN:"__SERIALIZED__Infinity"===e?1/0:"__SERIALIZED__-Infinity"===e?-1/0:"__SERIALIZED__undefined"!==e?e:void 0}))},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))},displayFileSize:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=e?1e3:1024;if(Math.abs(t)<n)return t+" B";var r=e?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],s=-1,a=Math.pow(10,i);do{t/=n,++s}while(Math.round(Math.abs(t)*a)/a>=n&&s<r.length-1);return t.toFixed(i)+" "+r[s]},displayElapsedTime:function(t){var e=t/1e3,i="second";return e>=90&&"second"===i&&(e/=60,i="minute"),e>=90&&"minute"===i&&(e/=60,i="hour"),e>=36&&"hour"===i&&(e/=24,i="day"),0===(e=Math.round(100*e)/100)?"N/A":s.format(e,i)},displayFullDate:function(t){var e=new Date(t);return a.format(e)},currentTimestamp:function(){return Math.floor(Date.now()/1e3).toString()},merge:function(){for(var t={},e=function(e){for(var i in e)e.hasOwnProperty(i)&&("[object Object]"===Object.prototype.toString.call(e[i])?t[i]=o.merge(t[i],e[i]):t[i]=e[i])},i=0;i<arguments.length;i++)e(arguments[i]);return t},debounce:function(t,e,i){var n;return function(){var r=this,s=arguments,a=i&&!n;clearTimeout(n),n=setTimeout((function(){n=null,i||t.apply(r,s)}),e),a&&t.apply(r,s)}},now:function(){return parseInt((new Date).getTime()/1e3).toString()},tsToLocaleString:function(t,e){e=e||{month:"short",day:"numeric",hour:"numeric",minute:"numeric"};var i=1e3*parseInt(t);return new Date(i).toLocaleString("en-GB",e)},downloadFile:function(t,e){var i=document.createElement("a");i.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),i.setAttribute("download",t),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)},downloadXlsx:function(t,e,i,n){window.setTimeout((function(){try{var r=i.substring(0,30),s="".concat(i," APWP-online.org, ").concat(o.tsToLocaleString(o.now()),".").concat(null!=n?n:"xlsx");s=s.replaceAll(":","-");var a={};t.forEach((function(t){a[t.value]=t.label}));var l=[a];e.forEach((function(e){var i={};t.forEach((function(t){if("function"==typeof t.value)i[t.value]=t.value(e);else if(Array.isArray(t.value)){var n=e;t.value.forEach((function(t){var e;n=(null!==(e=n)&&void 0!==e?e:{})[t]})),i[t.value]=n}else i[t.value]=e[t.value]})),l.push(i)}));var h=Bu.book_new();h.Props={Title:r,Author:"APWP-onliner.org software",CreatedDate:new Date};var c=Bu.json_to_sheet(l,{skipHeader:!0});Bu.book_append_sheet(h,c,r),function(t,e,i){var n=i||{};n.type="file",n.file=e,Cu(n),ku(t,n)}(h,s,{})}catch(t){console.error(t),alert("Error, Something went wrong with the export of "+i+".")}}),30)}},l={getOption:function(t){var e;return null!==(e=g.general.deserialize(window.sessionStorage.getItem("option_"+t.toString())))&&void 0!==e?e:m.findDefault(t).value},setOption:function(t,e){return void 0===e&&(e=m.findDefault(t).value),window.sessionStorage.setItem("option_"+t.toString(),g.general.serialize(e))}},h=i(9483),c=i.n(h);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}var d={dataset:{id:void 0,created:0,name:"",status:"created",error:null,raw:{name:"",size:0,file:null},data:{poles:[],length:0},calculations:{_docstore_link:!0,link:"calculation",multiple:!0}},calculation:{id:void 0,created:0,type:"",status:"created",error:null,options:{},results:[],calculationtime:0}};!1===c().supports(c().INDEXEDDB)&&alert("IndexedDB is not supported by your browser. This is currently needed to use this website,\n           the website will not function correctly. Use (a newer version of) Chrome, Firefox or Safari.\n           If this is not possible, please send me a message at info@apwp-online.org, then we will make\n           an update of the website with a fallback for this feature");var f=Object.fromEntries(Object.keys(d).map((function(t){return[t,c().createInstance({name:t,driver:[c().INDEXEDDB]})]}))),p={get:function(t,e){return void 0===f[t]?Promise.reject("Docstore: tried to get document of type ".concat(t,", this is not a defined type")):void 0===e?Promise.resolve():f[t].getItem(e)},getAll:function(t){return void 0===t?Promise.all(Object.keys(f).map((function(t){return p.getAll(t)}))).then((function(t){return Object.fromEntries(Object.keys(f).map((function(e,i){return[e,t[i]]})))})):void 0===f[t]?Promise.reject("Docstore: tried to get all documents of type ".concat(t,", this is not a defined type")):f[t].keys().then((function(e){var i=e.map((function(e){return p.get(t,e)}));return Promise.all(i)}))},getFull:function t(e,i){return void 0===f[e]?Promise.reject("Docstore: tried to get a full document of type ".concat(e,", this is not a defined type")):void 0===i?Promise.resolve():new Promise((function(n,r){p.get(e,i).then((function(i){var r=[],s=d[e];Object.keys(s).forEach((function(e){var n;if(null===(n=s[e])||void 0===n?void 0:n._docstore_link)if(s[e].multiple)i[e].forEach((function(n,a){var o="object"===u(i[e][a])?i[e][a].id:i[e][a];r.push(t(s[e].link,o).then((function(t){i[e][a]=t})))}));else{var a="object"===u(i[e])?i[e].id:i[e];r.push(t(s[e].link,a).then((function(t){i[e]=t})))}})),Promise.all(r).then((function(){n(i)}))}))}))},set:function(t,e){var i;return void 0===f[t]?Promise.reject("Docstore: tried to set document of type ".concat(t,", this is not a defined type")):(e=Object.assign({},d[t],null!==(i=e)&&void 0!==i?i:{}),Object.keys(e).forEach((function(t){var i;!0===(null===(i=e[t])||void 0===i?void 0:i._docstore_link)&&(e[t].multiple?e[t]=[]:e[t]=null)})),void 0===e.id&&(e.id=g.general.uuid(),e.created=parseInt(Date.now()/1e3)),f[t].setItem(e.id,e))},remove:function(t,e){return void 0===f[t]?Promise.reject("Docstore: tried to remove document of type ".concat(t,", this is not a defined type")):void 0===e?Promise.resolve():f[t].removeItem(e)},clear:function(t){return void 0===t?Promise.all(Object.keys(f).map((function(t){return f[t].clear()}))):f[t].clear()}},g={general:o,sessionStorage:l,docstore:p},m={find:function(t,e){return m[t].find((function(t){return t.value==e}))},findLabel:function(t,e){return(m.find(t,e)||{}).label},findDefault:function(t){return void 0===m[t]?{value:void 0,label:void 0}:m[t].find((function(t){return t.default}))||m[t][0]},bool:[{value:"true",label:"True",default:!0},{value:"false",label:"False"}],RPD_datasource:[{value:"raw",label:"Use dataset",default:!0},{value:"apwp",label:"Use APWP of dataset"}],RPD_Nb:[{value:20,label:"RPD_Nb",default:!0}],RPD_ref_loc_type:[{value:"mean_loc",label:"Calculate mean location of input",default:!0},{value:"one_ref_loc",label:"Set a custom single location"},{value:"samp_loc",label:"Use sampling location of each individual study"}],RPD_ref_loc_lat:[{value:90,label:"RPD_ref_loc_lat",default:!0}],RPD_ref_loc_lon:[{value:0,label:"RPD_ref_loc_lon",default:!0}],RPD_ref_window:[{value:10,label:"RPD_ref_window",default:!0}],RPD_ref_type:[{value:"gapwap",label:"Global APWP",default:!0},{value:"geopole",label:"North pole (0,90)"},{value:"custom",label:"Custom dataset"}],RPD_Euler_poles:[{value:"Euler_poles_101.csv",label:"North America (101)"},{value:"Euler_poles_102.csv",label:"Greenland (102)"},{value:"Euler_poles_201.csv",label:"South America (201)"},{value:"Euler_poles_301.csv",label:"Eurasia (301)",default:!0},{value:"Euler_poles_304.csv",label:"Iberia (304)",default:!0},{value:"Euler_poles_501.csv",label:"India (501)"},{value:"Euler_poles_503.csv",label:"Arabia (503)"},{value:"Euler_poles_701.csv",label:"South Africa (701)"},{value:"Euler_poles_801.csv",label:"Australia (801)"},{value:"Euler_poles_802.csv",label:"East Antarctica (802)"},{value:"Euler_poles_901.csv",label:"Pacific (901)"}],APWP_window_length:[{value:5,label:"APWP_window_length",default:!0}],APWP_time_step:[{value:1,label:"APWP_time_step",default:!0}],APWP_t_min:[{value:5,label:"APWP_t_min",default:!0}],APWP_t_max:[{value:25,label:"APWP_t_max",default:!0}],APWP_Nb:[{value:30,label:"APWP_Nb",default:!0}],mapProjection:[{value:"ESRI:54009",label:"World Mollweide",name:"ESRI:54009",params:"+proj=moll +lon_0=0 +x_0=0 +y_0=0 +datum=WGS84 units=m +no_defs",extent:[-18019909.21177587,-9009954.605703328,18019909.21177587,9009954.605703328],worldextent:[-180,-90,180,90],basemapsrc:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attributions:['&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>']},{value:"EPSG:3857",label:"WGS 84 / Pseudo-Mercator",default:!0,name:"EPSG:3857",params:"+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs",extent:[-20037508.34,-20048966.1,20037508.34,20048966.1],worldextent:[-180,-85.06,180,85.06],basemapsrc:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attributions:['&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>']},{value:"EPSG:3571",label:"WGS 84 / North Pole LAEA Bering Sea",name:"EPSG:3571",params:"+proj=laea +lat_0=90 +lon_0=180 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs +type=crs",extent:[-4839568.42,-4889334.8,4839568.42,4889334.8].map((function(t){return 2*t})),worldextent:[-180,45,180,90],basemapsrc:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attributions:['&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>']},{value:"EPSG:3572",label:"WGS 84 / North Pole LAEA Alaska",name:"EPSG:3572",params:"+proj=laea +lat_0=90 +lon_0=-150 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs +type=crs",extent:[-4867195.52,-4883796.85,4867195.52,4883796.85].map((function(t){return 2*t})),worldextent:[-180,45,180,90],basemapsrc:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attributions:['&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>']},{value:"EPSG:3573",label:"WGS 84 / North Pole LAEA Canada",name:"EPSG:3573",params:"+proj=laea +lat_0=90 +lon_0=-100 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs +type=crs",extent:[-4859208.99,-4886873.23,4859208.99,4886873.23].map((function(t){return 2*t})),worldextent:[-180,45,180,90],basemapsrc:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attributions:['&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>']},{value:"EPSG:3574",label:"WGS 84 / North Pole LAEA Atlantic",name:"EPSG:3574",params:"+proj=laea +lat_0=90 +lon_0=-40 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs +type=crs",extent:[-4888719.37,-4849999.19,4888719.37,4849999.19].map((function(t){return 2*t})),worldextent:[-180,45,180,90],basemapsrc:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attributions:['&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>']},{value:"EPSG:3575",label:"WGS 84 / North Pole LAEA Europe",name:"EPSG:3575",params:"+proj=laea +lat_0=90 +lon_0=10 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs +type=crs",extent:[-4886873.23,-4859208.99,4886873.23,4859208.99].map((function(t){return 2*t})),worldextent:[-180,45,180,90],attributions:['&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>']},{value:"EPSG:3576",label:"WGS 84 / North Pole LAEA Russia",name:"EPSG:3576",params:"+proj=laea +lat_0=90 +lon_0=90 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs +type=crs",extent:[-4889334.8,-4839568.42,4889334.8,4839568.42].map((function(t){return 2*t})),worldextent:[-180,45,180,90],basemapsrc:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attributions:['&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>']},{value:"EPSG:3413",label:"WGS 84 / NSIDC Sea Ice Polar Stereographic North",name:"EPSG:3413",params:"+ proj=stere + lat_0=90 + lat_ts=70 + lon_0=-45 + x_0=0 + y_0=0 + datum=WGS84 + units=m + no_defs + type=crs",extent:[-3314693.24,-3314693.24,3314693.24,3314693.24],worldextent:[-180,60,180,90],basemapsrc:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attributions:['&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>']}]};var v={version:{apwp:"1.2"},demodata:[{name:"DEMO - North east Japan",isdemo:!0,status:"created",error:null,raw:{name:"NEJ.csv",size:3163,file:"/dist/assets/resources/NEJ.csv"},data:{poles:[{name:"NEJ-Baba-RY",age:16.52,min_age:15.7,max_age:17.34,slat:38,slon:140.7,N:99,K:34.1,A95:2.5,plat:68.5,plon:56.4,mdec:332.8,minc:56.4,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Baba-TA",age:14.44,min_age:13.56,max_age:15.32,slat:38,slon:140.7,N:93,K:16.6,A95:3.7,plat:73.5,plon:331.9,mdec:356.6,minc:38.6,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Hir-Fuk1",age:22.3,min_age:21.6,max_age:23,slat:37.3,slon:140.6,N:4,K:90.3,A95:9.7,plat:77.7,plon:36.2,mdec:345.7,minc:52.8,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Hir-Nii1",age:12.9,min_age:12.2,max_age:13.6,slat:37.8,slon:138.8,N:6,K:132.2,A95:5.8,plat:82.3,plon:272.6,mdec:6.6,minc:51.6,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Hir-NMS",age:15,min_age:14.5,max_age:15.5,slat:37.5,slon:139.1,N:28,K:221.3,A95:1.8,plat:66.9,plon:31.2,mdec:335.1,minc:46.4,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Hoshi98-KE",age:17.1,min_age:16.8,max_age:17.4,slat:40.18,slon:141.31,N:8,K:105.9,A95:5.4,plat:88.9,plon:217.2,mdec:1.4,minc:59.6,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Hoshi98-NIS",age:21,min_age:20.7,max_age:21.3,slat:40.28,slon:141.33,N:40,K:41.6,A95:3.5,plat:34,plon:54.2,mdec:295.8,minc:40.6,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Hoshi97-Mot",age:18,min_age:17.6,max_age:18.4,slat:36.6,slon:140.2,N:25,K:72.8,A95:3.4,plat:82.7,plon:318.1,mdec:.3,minc:48.3,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Hoshi97-Yam",age:17.2,min_age:16.8,max_age:17.6,slat:36.6,slon:140.2,N:33,K:21.6,A95:5.5,plat:81,plon:235.1,mdec:11,minc:54.8,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Hoshi13",age:15.9,min_age:15.7,max_age:16.1,slat:36.57,slon:140.19,N:106,K:32.9,A95:2.4,plat:82.7,plon:200.8,mdec:8.3,minc:59.1,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Hoshi07",age:13.5,min_age:13.3,max_age:13.7,slat:38.75,slon:141.2,N:82,K:42.8,A95:2.4,plat:77.5,plon:178.4,mdec:11.3,minc:65.9,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Hos-Im",age:16.1,min_age:15,max_age:17.2,slat:39.28,slon:140.84,N:51,K:58.9,A95:2.6,plat:65,plon:83.1,mdec:327.4,minc:66.1,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Hos-Kr",age:14.5,min_age:14,max_age:15,slat:39.29,slon:140.78,N:19,K:128.7,A95:3,plat:82.1,plon:236.9,mdec:10,minc:57.4,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Oto85-Dai",age:20.1,min_age:19,max_age:21.2,slat:39.96,slon:139.76,N:17,K:90.3,A95:3.8,plat:59.8,plon:34,mdec:327.2,minc:45.3,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Oto85-Mas",age:21.9,min_age:null,max_age:null,slat:39.18,slon:140.33,N:25,K:137.2,A95:2.5,plat:56.7,plon:106.5,mdec:319.6,minc:75,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Oto85-Oku",age:14.1,min_age:null,max_age:null,slat:39.72,slon:140.39,N:18,K:40.8,A95:5.5,plat:78.7,plon:11.6,mdec:349.6,minc:51.5,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Oto85-Yun",age:33,min_age:null,max_age:null,slat:39.12,slon:140.37,N:28,K:29.3,A95:5.1,plat:57.7,plon:76.5,mdec:316.6,minc:64,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Oto-Oka",age:25,min_age:null,max_age:null,slat:39.03,slon:140.36,N:4,K:133.9,A95:8,plat:52.1,plon:49.9,mdec:315.1,minc:48.6,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Oto94-Its",age:6.3,min_age:5.6,max_age:7,slat:40.02,slon:141.11,N:24,K:156.6,A95:2.4,plat:80.5,plon:353,mdec:354.1,minc:51.1,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Oto94-Kir",age:11.6,min_age:10.4,max_age:12.8,slat:40,slon:140.94,N:24,K:57.4,A95:3.9,plat:74.5,plon:300.9,mdec:5.8,minc:43.4,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Oto94-Nis",age:21.8,min_age:null,max_age:null,slat:40.3,slon:141.34,N:22,K:35,A95:5.3,plat:22.5,plon:66.2,mdec:278.8,minc:43.5,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Oto94-Yas",age:17.2,min_age:16.3,max_age:18.1,slat:39.23,slon:140.21,N:34,K:46.5,A95:3.6,plat:50.6,plon:67.9,mdec:308.3,minc:58.9,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Oto-Azu",age:7.15,min_age:7,max_age:7.3,slat:40.13,slon:140.86,N:4,K:21.4,A95:20.3,plat:82.6,plon:192.6,mdec:8.2,minc:63,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Oto97-mean1",age:13.75,min_age:12,max_age:15.5,slat:36.8,slon:139.3,N:8,K:29.9,A95:10.3,plat:81,plon:310.2,mdec:1.6,minc:46.7,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Oto97-mean2",age:7.95,min_age:5,max_age:10.9,slat:36.8,slon:139.3,N:21,K:13.1,A95:9.1,plat:79,plon:267,mdec:10,minc:48.7,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Tak-RY",age:16,min_age:15.5,max_age:16.5,slat:37.75,slon:140.75,N:63,K:31.1,A95:3.3,plat:86,plon:351.5,mdec:357.5,minc:53.7,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Tak-TM",age:20,min_age:19.5,max_age:20.5,slat:37.75,slon:140.82,N:31,K:16,A95:6.7,plat:51.5,plon:33.2,mdec:321.1,minc:35,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Tam-Og/Ts",age:16,min_age:15.5,max_age:16.5,slat:38.9,slon:139.6,N:19,K:24,A95:7,plat:84.2,plon:305.4,mdec:1.7,minc:52.7,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Yam-Kan",age:17.8,min_age:16.2,max_age:19.4,slat:37.72,slon:139.47,N:11,K:26.1,A95:9.1,plat:79.1,plon:54.7,mdec:346.2,minc:57.3,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"NEJ-Yam-Kit",age:22.7,min_age:22.4,max_age:23,slat:38.25,slon:139.67,N:9,K:8.8,A95:18.4,plat:68.2,plon:70.3,mdec:331.8,minc:61.5,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"WHO-Fuj-As",age:9.25,min_age:7.3,max_age:11.2,slat:42,slon:140.5,N:19,K:18.9,A95:7.9,plat:76.7,plon:319.7,mdec:.2,minc:47.6,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"WHO-Fuj-Fu",age:23,min_age:21.7,max_age:24.3,slat:42,slon:140.5,N:13,K:26.1,A95:8.3,plat:38,plon:59.4,mdec:295.8,minc:49.3,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"WHO-Fuj-Kik",age:12.85,min_age:11.2,max_age:14.5,slat:42,slon:140.5,N:10,K:15.9,A95:12.5,plat:84.9,plon:329.5,mdec:359,minc:56.4,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"WHO-Fuj-Ku",age:15.8,min_age:14.5,max_age:17.1,slat:42,slon:140.5,N:29,K:8.9,A95:9.5,plat:78.7,plon:24.8,mdec:347.3,minc:55.8,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"WHO-Oto-Kun",age:24.7,min_age:23.5,max_age:25.9,slat:43,slon:140.9,N:19,K:22.9,A95:7.2,plat:44.7,plon:83.2,mdec:293,minc:66.7,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"WHO-Tan-Fur",age:13.81,min_age:11.63,max_age:15.99,slat:43.2,slon:140.5,N:19,K:37,A95:5.6,plat:84.1,plon:212.9,mdec:7.9,minc:63.2,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"WHO-Tan-Yob",age:3.96,min_age:2.58,max_age:5.33,slat:43.2,slon:140.5,N:6,K:32.5,A95:11.9,plat:73.3,plon:296.1,mdec:7.7,minc:46.4,plateID:null,lithology:"undefined",f:null,p_std:null}],length:37},calculations:[]},{name:"DEMO - South west Japan",isdemo:!0,status:"created",error:null,raw:{name:"SWJ.csv",size:3215,file:"/dist/assets/resources/SWJ.csv"},data:{poles:[{name:"SWJ-Hay86-Ake",age:17.8,min_age:17.5,max_age:18.1,slat:35.4,slon:137.2,N:20,K:13.8,A95:9.1,plat:42.9,plon:221,mdec:55,minc:45.9,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Hay86-Oid",age:15.75,min_age:15.7,max_age:15.8,slat:35.4,slon:137.2,N:12,K:17.5,A95:10.7,plat:66.8,plon:244.2,mdec:24.8,minc:44.3,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Hay86-Toy",age:17.5,min_age:16,max_age:19,slat:34.7,slon:136.9,N:29,K:19.8,A95:6.2,plat:43.4,plon:210.8,mdec:57.2,minc:53.3,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Hay86-Uts",age:15.5,min_age:15,max_age:16,slat:34.7,slon:136.9,N:45,K:15.1,A95:5.7,plat:63.8,plon:215.7,mdec:32.2,minc:55,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Hay84-Ich",age:16.4,min_age:15.2,max_age:17.6,slat:34.7,slon:136.4,N:39,K:10.1,A95:7.6,plat:50.4,plon:230.8,mdec:43.9,minc:41,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Hir99-Ake",age:17.8,min_age:17.5,max_age:18.1,slat:35.4,slon:137.2,N:78,K:19.7,A95:3.7,plat:46.4,plon:224.4,mdec:50.3,minc:45,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Hir99-Mat",age:16.6,min_age:15.7,max_age:17.5,slat:34.82,slon:138,N:98,K:11.3,A95:4.5,plat:53.1,plon:186.9,mdec:46.4,minc:68.2,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Hir-INS",age:16.3,min_age:15.6,max_age:17,slat:36.25,slon:136.3,N:62,K:120.7,A95:1.6,plat:55.8,plon:225.6,mdec:40.3,minc:48.7,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Hoshi13-Tsu",age:15,min_age:14.7,max_age:15.3,slat:35.2,slon:137.62,N:9,K:15.9,A95:13.3,plat:79.6,plon:263.6,mdec:9.6,minc:47.6,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Hoshi01-Shi",age:15,min_age:14.3,max_age:15.7,slat:35.15,slon:137.61,N:21,K:29.8,A95:5.9,plat:84,plon:254.8,mdec:6.3,minc:51.6,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Hoshi00-Nijo",age:14.9,min_age:14.6,max_age:15.2,slat:34.5,slon:135.6,N:20,K:26.2,A95:6.5,plat:85,plon:50,mdec:353.9,minc:54.2,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Hoshi15-Oid",age:15.75,min_age:15.7,max_age:15.8,slat:35.4,slon:137.25,N:19,K:18.6,A95:8,plat:77.2,plon:262.3,mdec:11.8,minc:46.1,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Ishi-KK",age:30,min_age:27,max_age:33,slat:33.9,slon:130.7,N:45,K:34.6,A95:3.7,plat:56.4,plon:224.1,mdec:37.9,minc:44.2,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Itoh-EMio",age:15.7,min_age:15,max_age:16.4,slat:36,slon:137.2,N:5,K:30.3,A95:14.1,plat:79,plon:240.3,mdec:12.8,minc:52.2,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Itoh-Hig",age:15,min_age:14.9,max_age:15.1,slat:36.6,slon:137.08,N:61,K:17.7,A95:4.4,plat:83,plon:317.1,mdec:360,minc:48.6,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Itoh-Ton",age:14.8,min_age:14.7,max_age:14.9,slat:36.6,slon:137.08,N:7,K:145,A95:5,plat:89,plon:223.8,mdec:1.3,minc:56.1,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Itoh-Dai",age:15.9,min_age:15.2,max_age:16.6,slat:36.25,slon:136.33,N:56,K:61.8,A95:2.4,plat:60.1,plon:217.1,mdec:37.1,minc:54.7,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Itoh-Kan",age:15.9,min_age:15.2,max_age:16.6,slat:36.5,slon:136.67,N:5,K:25.7,A95:15.4,plat:68.8,plon:226.8,mdec:25.7,minc:53.1,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Itoh03-Ioz",age:15.6,min_age:15.2,max_age:16,slat:36.55,slon:136.83,N:7,K:11.9,A95:18.2,plat:65.2,plon:225.2,mdec:30.1,minc:52.8,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Itoh01-Was",age:21,min_age:20,max_age:22,slat:36.28,slon:136.61,N:5,K:31.2,A95:13.9,plat:50.5,plon:209.9,mdec:49.9,minc:56.6,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Koj-Kori",age:19,min_age:17,max_age:21,slat:36.25,slon:133.2,N:4,K:13.9,A95:25.6,plat:41.7,plon:221.1,mdec:55.1,minc:42.4,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Koj-Oki",age:6.8,min_age:6.6,max_age:7,slat:36.3,slon:133.23,N:4,K:13.8,A95:25.6,plat:78.3,plon:332.7,mdec:355.7,minc:43.2,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Nak-Kun",age:12.6,min_age:11.1,max_age:14.1,slat:36.1,slon:136.1,N:6,K:33.4,A95:11.8,plat:74.5,plon:337.4,mdec:354,minc:38.2,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Nak-Nun",age:16,min_age:14.2,max_age:17.8,slat:36.1,slon:136.1,N:3,K:15.7,A95:32.3,plat:60.5,plon:257,mdec:26.4,minc:32.9,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Nak-Sas",age:19,min_age:18.6,max_age:19.4,slat:36.1,slon:136.1,N:7,K:6.8,A95:25,plat:54.8,plon:220,mdec:42.5,minc:51.4,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Nak-Uch",age:15.1,min_age:14.8,max_age:15.4,slat:35.5,slon:135.5,N:4,K:12,A95:27.7,plat:79.5,plon:20.2,mdec:349,minc:49.7,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Nak-Ume",age:15.4,min_age:13.4,max_age:17.4,slat:35.9,slon:136,N:23,K:35.1,A95:5.2,plat:71.7,plon:337.6,mdec:353,minc:34.1,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Oto83-Kaw",age:28.5,min_age:28,max_age:29,slat:35,slon:132.5,N:6,K:16.4,A95:17,plat:35.7,plon:225.4,mdec:58.3,minc:32.2,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Oto83-KG",age:33,min_age:32,max_age:34,slat:35,slon:132.5,N:5,K:111.5,A95:7.3,plat:41.2,plon:206.5,mdec:59.8,minc:52.6,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Oto84-31/35",age:33,min_age:31,max_age:35,slat:34.85,slon:132,N:15,K:13.1,A95:11,plat:33.4,plon:211.8,mdec:65.9,minc:44.1,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Oto84-Hata",age:21,min_age:20,max_age:22,slat:35.08,slon:132.52,N:4,K:19.3,A95:21.4,plat:30.7,plon:213.4,mdec:68.2,minc:41.6,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Oto91-Kaw",age:16.1,min_age:14.7,max_age:17.5,slat:35.23,slon:132.75,N:5,K:43.1,A95:11.8,plat:56.6,plon:228.2,mdec:37.6,minc:44.3,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Oto91-Omo",age:14.2,min_age:13.6,max_age:14.8,slat:35.28,slon:132.92,N:10,K:13.1,A95:13.9,plat:87.3,plon:62.6,mdec:356.9,minc:55.6,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Saw-Hata",age:15.9,min_age:14.9,max_age:16.9,slat:35.18,slon:132.73,N:6,K:51.2,A95:9.5,plat:78.6,plon:278.4,mdec:7.1,minc:43.7,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Saw-Sada",age:20,min_age:18,max_age:22,slat:35.18,slon:132.73,N:6,K:28.2,A95:12.8,plat:44,plon:220.3,mdec:52.5,minc:43.2,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Tam06-Ioz",age:17,min_age:16.7,max_age:17.3,slat:36.56,slon:137.07,N:4,K:18.5,A95:22,plat:51.3,plon:229.8,mdec:44.1,minc:44.5,plateID:null,lithology:"undefined",f:null,p_std:null},{name:"SWJ-Tam06-Iwa",age:17.2,min_age:16.8,max_age:17.6,slat:36.54,slon:137.06,N:5,K:11.4,A95:23.7,plat:55.9,plon:231.8,mdec:38.9,minc:45.7,plateID:null,lithology:"undefined",f:null,p_std:null}],length:37},calculations:[]}],datasetImportAliases:[{orig:"K",alias:"mean_K"},{orig:"A95",alias:"P95"}],datasetImportDefaults:[{field:"plateID",value:""},{field:"lithology",value:"undefined"},{field:"f",value:null},{field:"p_std",value:null}],datasetImportValidation:[{field:"age",cond:function(t){return t>=0},condMsg:"positive"},{field:"slat",cond:function(t){return t>=-90&&t<=90},condMsg:"between -90 and 90"},{field:"slon",cond:function(t){return t>=-180&&t<=360},condMsg:"between -180 and 360"},{field:"N",cond:function(t){return t>1},condMsg:"bigger then 1"},{field:"K",cond:function(t){return t>=0},condMsg:"positive"},{field:"A95",cond:function(t){return t>=0},condMsg:"positive"},{field:"min_age",cond:function(t,e){return t<e.age},condMsg:"less then the age",optional:!0},{field:"max_age",cond:function(t,e){return t>e.age},condMsg:"bigger then the age",optional:!0},{field:"f",cond:function(t){return t>=0&&t<=1},condMsg:"between 0 and 1",optional:!0},{field:"p_std",cond:function(t){return t>=0},condMsg:"positive",optional:!0},{field:"plat",cond:function(t){return t>=-90&&t<=90},condMsg:"between -90 and 90",optional:!0},{field:"plon",cond:function(t){return t>=-180&&t<=360},condMsg:"between -180 and 360",optional:!0},{field:"minc",cond:function(t){return t>=-90&&t<=90},condMsg:"between -90 and 90",optional:!0},{field:"mdec",cond:function(t){return t>=-180&&t<=360},condMsg:"between -180 and 360",optional:!0},{field:"plat",cond:function(t,e){return null!==e.plon&&void 0!==e.plon},condMsg:"paired with a plon value, plon is missing",optional:!0},{field:"plon",cond:function(t,e){return null!==e.plat&&void 0!==e.plat},condMsg:"paired with a plat value, plat is missing",optional:!0},{field:"minc",cond:function(t,e){return null!==e.mdec&&void 0!==e.mdec},condMsg:"paired with a mdec value, mdec is missing",optional:!0},{field:"mdec",cond:function(t,e){return null!==e.minc&&void 0!==e.minc},condMsg:"paired with a minc value, minc is missing",optional:!0},{field:"min_age",cond:function(t,e){return null!==e.max_age&&void 0!==e.max_age},condMsg:"paired with a max_age value, max_age is missing",optional:!0},{field:"max_age",cond:function(t,e){return null!==e.min_age&&void 0!==e.min_age},condMsg:"paired with a min_age value, min_age is missing",optional:!0}]},y={version:"0.18.5"},b=1200,_=1252,x=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],w={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},S=function(t){-1!=x.indexOf(t)&&(_=w[0]=t)};var T=function(t){b=t,S(t)};function E(){T(1200),S(1252)}function k(t){for(var e=[],i=0,n=t.length;i<n;++i)e[i]=t.charCodeAt(i);return e}function C(t){for(var e=[],i=0;i<t.length>>1;++i)e[i]=String.fromCharCode(t.charCodeAt(2*i+1)+(t.charCodeAt(2*i)<<8));return e.join("")}var M,A=function(t){var e=t.charCodeAt(0),i=t.charCodeAt(1);return 255==e&&254==i?function(t){for(var e=[],i=0;i<t.length>>1;++i)e[i]=String.fromCharCode(t.charCodeAt(2*i)+(t.charCodeAt(2*i+1)<<8));return e.join("")}(t.slice(2)):254==e&&255==i?C(t.slice(2)):65279==e?t.slice(1):t},O=function(t){return String.fromCharCode(t)},P=function(t){return String.fromCharCode(t)};var R=null,I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function L(t){for(var e="",i=0,n=0,r=0,s=0,a=0,o=0,l=0,h=0;h<t.length;)s=(i=t.charCodeAt(h++))>>2,a=(3&i)<<4|(n=t.charCodeAt(h++))>>4,o=(15&n)<<2|(r=t.charCodeAt(h++))>>6,l=63&r,isNaN(n)?o=l=64:isNaN(r)&&(l=64),e+=I.charAt(s)+I.charAt(a)+I.charAt(o)+I.charAt(l);return e}function D(t){var e="",i=0,n=0,r=0,s=0,a=0,o=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<t.length;)i=I.indexOf(t.charAt(l++))<<2|(s=I.indexOf(t.charAt(l++)))>>4,e+=String.fromCharCode(i),n=(15&s)<<4|(a=I.indexOf(t.charAt(l++)))>>2,64!==a&&(e+=String.fromCharCode(n)),r=(3&a)<<6|(o=I.indexOf(t.charAt(l++))),64!==o&&(e+=String.fromCharCode(r));return e}var N=function(){return"undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node}(),F=function(){if("undefined"!=typeof Buffer){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch(e){t=!0}return t?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function j(t){return N?Buffer.alloc?Buffer.alloc(t):new Buffer(t):"undefined"!=typeof Uint8Array?new Uint8Array(t):new Array(t)}function B(t){return N?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):"undefined"!=typeof Uint8Array?new Uint8Array(t):new Array(t)}var z=function(t){return N?F(t,"binary"):t.split("").map((function(t){return 255&t.charCodeAt(0)}))};function W(t){if("undefined"==typeof ArrayBuffer)return z(t);for(var e=new ArrayBuffer(t.length),i=new Uint8Array(e),n=0;n!=t.length;++n)i[n]=255&t.charCodeAt(n);return e}function G(t){if(Array.isArray(t))return t.map((function(t){return String.fromCharCode(t)})).join("");for(var e=[],i=0;i<t.length;++i)e[i]=String.fromCharCode(t[i]);return e.join("")}function U(t){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(t instanceof ArrayBuffer)return U(new Uint8Array(t));for(var e=new Array(t.length),i=0;i<t.length;++i)e[i]=t[i];return e}var H=N?function(t){return Buffer.concat(t.map((function(t){return Buffer.isBuffer(t)?t:F(t)})))}:function(t){if("undefined"!=typeof Uint8Array){var e=0,i=0;for(e=0;e<t.length;++e)i+=t[e].length;var n=new Uint8Array(i),r=0;for(e=0,i=0;e<t.length;i+=r,++e)if(r=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],i);else{if("string"==typeof t[e])throw"wtf";n.set(new Uint8Array(t[e]),i)}return n}return[].concat.apply([],t.map((function(t){return Array.isArray(t)?t:[].slice.call(t)})))};var X=/\u0000/g,V=/[\u0001-\u0006]/g;function Y(t){for(var e="",i=t.length-1;i>=0;)e+=t.charAt(i--);return e}function K(t,e){var i=""+t;return i.length>=e?i:he("0",e-i.length)+i}function q(t,e){var i=""+t;return i.length>=e?i:he(" ",e-i.length)+i}function Z(t,e){var i=""+t;return i.length>=e?i:i+he(" ",e-i.length)}var J=Math.pow(2,32);function Q(t,e){return t>J||t<-J?function(t,e){var i=""+Math.round(t);return i.length>=e?i:he("0",e-i.length)+i}(t,e):function(t,e){var i=""+t;return i.length>=e?i:he("0",e-i.length)+i}(Math.round(t),e)}function tt(t,e){return e=e||0,t.length>=7+e&&103==(32|t.charCodeAt(e))&&101==(32|t.charCodeAt(e+1))&&110==(32|t.charCodeAt(e+2))&&101==(32|t.charCodeAt(e+3))&&114==(32|t.charCodeAt(e+4))&&97==(32|t.charCodeAt(e+5))&&108==(32|t.charCodeAt(e+6))}var et=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],it=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},rt={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},st={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function at(t,e,i){for(var n=t<0?-1:1,r=t*n,s=0,a=1,o=0,l=1,h=0,c=0,u=Math.floor(r);h<e&&(o=(u=Math.floor(r))*a+s,c=u*h+l,!(r-u<5e-8));)r=1/(r-u),s=a,a=o,l=h,h=c;if(c>e&&(h>e?(c=l,o=s):(c=h,o=a)),!i)return[0,n*o,c];var d=Math.floor(n*o/c);return[d,n*o-d*c,c]}function ot(t,e,i){if(t>2958465||t<0)return null;var n=0|t,r=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:r,u:86400*(t-n)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,86400==++r&&(o.T=r=0,++n,++o.D)),60===n)a=i?[1317,10,29]:[1900,2,29],s=3;else if(0===n)a=i?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),i&&(s=function(t,e){e[0]-=581;var i=t.getDay();t<60&&(i=(i+6)%7);return i}(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=r%60,r=Math.floor(r/60),o.M=r%60,r=Math.floor(r/60),o.H=r,o.q=s,o}var lt=new Date(1899,11,31,0,0,0),ht=lt.getTime(),ct=new Date(1900,2,1,0,0,0);function ut(t,e){var i=t.getTime();return e?i-=1262304e5:t>=ct&&(i+=864e5),(i-(ht+6e4*(t.getTimezoneOffset()-lt.getTimezoneOffset())))/864e5}function dt(t){return-1==t.indexOf(".")?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ft(t){var e,i=Math.floor(Math.log(Math.abs(t))*Math.LOG10E);return e=i>=-4&&i<=-1?t.toPrecision(10+i):Math.abs(i)<=9?function(t){var e=t<0?12:11,i=dt(t.toFixed(12));return i.length<=e||(i=t.toPrecision(10)).length<=e?i:t.toExponential(5)}(t):10===i?t.toFixed(10).substr(0,12):function(t){var e=dt(t.toFixed(11));return e.length>(t<0?12:11)||"0"===e||"-0"===e?t.toPrecision(6):e}(t),dt(function(t){return-1==t.indexOf("E")?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(e.toUpperCase()))}function pt(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(0|t)===t?t.toString(10):ft(t);case"undefined":return"";case"object":if(null==t)return"";if(t instanceof Date)return Dt(14,ut(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function gt(t,e,i,n){var r,s="",a=0,o=0,l=i.y,h=0;switch(t){case 98:l=i.y+543;case 121:switch(e.length){case 1:case 2:r=l%100,h=2;break;default:r=l%1e4,h=4}break;case 109:switch(e.length){case 1:case 2:r=i.m,h=e.length;break;case 3:return it[i.m-1][1];case 5:return it[i.m-1][0];default:return it[i.m-1][2]}break;case 100:switch(e.length){case 1:case 2:r=i.d,h=e.length;break;case 3:return et[i.q][0];default:return et[i.q][1]}break;case 104:switch(e.length){case 1:case 2:r=1+(i.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:r=i.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:r=i.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if("s"!=e&&"ss"!=e&&".0"!=e&&".00"!=e&&".000"!=e)throw"bad second format: "+e;return 0!==i.u||"s"!=e&&"ss"!=e?(o=n>=2?3===n?1e3:100:1===n?10:1,(a=Math.round(o*(i.S+i.u)))>=60*o&&(a=0),"s"===e?0===a?"0":""+a/o:(s=K(a,2+n),"ss"===e?s.substr(0,2):"."+s.substr(2,e.length-1))):K(i.S,e.length);case 90:switch(e){case"[h]":case"[hh]":r=24*i.D+i.H;break;case"[m]":case"[mm]":r=60*(24*i.D+i.H)+i.M;break;case"[s]":case"[ss]":r=60*(60*(24*i.D+i.H)+i.M)+Math.round(i.S+i.u);break;default:throw"bad abstime format: "+e}h=3===e.length?1:2;break;case 101:r=l,h=1}return h>0?K(r,h):""}function mt(t){if(t.length<=3)return t;for(var e=t.length%3,i=t.substr(0,e);e!=t.length;e+=3)i+=(i.length>0?",":"")+t.substr(e,3);return i}var vt=/%/g;function yt(t,e){var i,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==e)return"0.0E+0";if(e<0)return"-"+yt(t,-e);var r=t.indexOf(".");-1===r&&(r=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%r;if(s<0&&(s+=r),-1===(i=(e/Math.pow(10,s)).toPrecision(n+1+(r+s)%r)).indexOf("e")){var a=Math.floor(Math.log(e)*Math.LOG10E);for(-1===i.indexOf(".")?i=i.charAt(0)+"."+i.substr(1)+"E+"+(a-i.length+s):i+="E+"+(a-s);"0."===i.substr(0,2);)i=(i=i.charAt(0)+i.substr(2,r)+"."+i.substr(2+r)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");i=i.replace(/\+-/,"-")}i=i.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(t,e,i,n){return e+i+n.substr(0,(r+s)%r)+"."+n.substr(s)+"E"}))}else i=e.toExponential(n);return t.match(/E\+00$/)&&i.match(/e[+-]\d$/)&&(i=i.substr(0,i.length-1)+"0"+i.charAt(i.length-1)),t.match(/E\-/)&&i.match(/e\+/)&&(i=i.replace(/e\+/,"e")),i.replace("e","E")}var bt=/# (\?+)( ?)\/( ?)(\d+)/;var _t=/^#*0*\.([0#]+)/,xt=/\).*[0#]/,wt=/\(###\) ###\\?-####/;function St(t){for(var e,i="",n=0;n!=t.length;++n)switch(e=t.charCodeAt(n)){case 35:break;case 63:i+=" ";break;case 48:i+="0";break;default:i+=String.fromCharCode(e)}return i}function Tt(t,e){var i=Math.pow(10,e);return""+Math.round(t*i)/i}function Et(t,e){var i=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(i*n)).length?0:Math.round(i*n)}function kt(t,e,i){if(40===t.charCodeAt(0)&&!e.match(xt)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return i>=0?kt("n",n,i):"("+kt("n",n,-i)+")"}if(44===e.charCodeAt(e.length-1))return function(t,e,i){for(var n=e.length-1;44===e.charCodeAt(n-1);)--n;return At(t,e.substr(0,n),i/Math.pow(10,3*(e.length-n)))}(t,e,i);if(-1!==e.indexOf("%"))return function(t,e,i){var n=e.replace(vt,""),r=e.length-n.length;return At(t,n,i*Math.pow(10,2*r))+he("%",r)}(t,e,i);if(-1!==e.indexOf("E"))return yt(e,i);if(36===e.charCodeAt(0))return"$"+kt(t,e.substr(" "==e.charAt(1)?2:1),i);var r,s,a,o,l=Math.abs(i),h=i<0?"-":"";if(e.match(/^00+$/))return h+Q(l,e.length);if(e.match(/^[#?]+$/))return"0"===(r=Q(i,0))&&(r=""),r.length>e.length?r:St(e.substr(0,e.length-r.length))+r;if(s=e.match(bt))return function(t,e,i){var n=parseInt(t[4],10),r=Math.round(e*n),s=Math.floor(r/n),a=r-s*n,o=n;return i+(0===s?"":""+s)+" "+(0===a?he(" ",t[1].length+1+t[4].length):q(a,t[1].length)+t[2]+"/"+t[3]+K(o,t[4].length))}(s,l,h);if(e.match(/^#+0+$/))return h+Q(l,e.length-e.indexOf("0"));if(s=e.match(_t))return r=Tt(i,s[1].length).replace(/^([^\.]+)$/,"$1."+St(s[1])).replace(/\.$/,"."+St(s[1])).replace(/\.(\d*)$/,(function(t,e){return"."+e+he("0",St(s[1]).length-e.length)})),-1!==e.indexOf("0.")?r:r.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return h+Tt(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return h+mt(Q(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return i<0?"-"+kt(t,e,-i):mt(""+(Math.floor(i)+function(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}(i,s[1].length)))+"."+K(Et(i,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return kt(t,e.replace(/^#,#*,/,""),i);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Y(kt(t,e.replace(/[\\-]/g,""),i)),a=0,Y(Y(e.replace(/\\/g,"")).replace(/[0#]/g,(function(t){return a<r.length?r.charAt(a++):"0"===t?"0":""})));if(e.match(wt))return"("+(r=kt(t,"##########",i)).substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var c="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=at(l,Math.pow(10,a)-1,!1),r=""+h," "==(c=At("n",s[1],o[1])).charAt(c.length-1)&&(c=c.substr(0,c.length-1)+"0"),r+=c+s[2]+"/"+s[3],(c=Z(o[2],a)).length<s[4].length&&(c=St(s[4].substr(s[4].length-c.length))+c),r+=c;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),h+((o=at(l,Math.pow(10,a)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?q(o[1],a)+s[2]+"/"+s[3]+Z(o[2],a):he(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return r=Q(i,0),e.length<=r.length?r:St(e.substr(0,e.length-r.length))+r;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){r=""+i.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=r.indexOf(".");var u=e.indexOf(".")-a,d=e.length-r.length-u;return St(e.substr(0,u)+r+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Et(i,s[1].length),i<0?"-"+kt(t,e,-i):mt(function(t){return t<2147483647&&t>-2147483648?""+(t>=0?0|t:t-1|0):""+Math.floor(t)}(i)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(t){return"00,"+(t.length<3?K(0,3-t.length):"")+t}))+"."+K(a,s[1].length);switch(e){case"###,##0.00":return kt(t,"#,##0.00",i);case"###,###":case"##,###":case"#,###":var f=mt(Q(l,0));return"0"!==f?h+f:"";case"###,###.00":return kt(t,"###,##0.00",i).replace(/^0\./,".");case"#,###.00":return kt(t,"#,##0.00",i).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Ct(t,e){var i,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==e)return"0.0E+0";if(e<0)return"-"+Ct(t,-e);var r=t.indexOf(".");-1===r&&(r=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%r;if(s<0&&(s+=r),!(i=(e/Math.pow(10,s)).toPrecision(n+1+(r+s)%r)).match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);-1===i.indexOf(".")?i=i.charAt(0)+"."+i.substr(1)+"E+"+(a-i.length+s):i+="E+"+(a-s),i=i.replace(/\+-/,"-")}i=i.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(t,e,i,n){return e+i+n.substr(0,(r+s)%r)+"."+n.substr(s)+"E"}))}else i=e.toExponential(n);return t.match(/E\+00$/)&&i.match(/e[+-]\d$/)&&(i=i.substr(0,i.length-1)+"0"+i.charAt(i.length-1)),t.match(/E\-/)&&i.match(/e\+/)&&(i=i.replace(/e\+/,"e")),i.replace("e","E")}function Mt(t,e,i){if(40===t.charCodeAt(0)&&!e.match(xt)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return i>=0?Mt("n",n,i):"("+Mt("n",n,-i)+")"}if(44===e.charCodeAt(e.length-1))return function(t,e,i){for(var n=e.length-1;44===e.charCodeAt(n-1);)--n;return At(t,e.substr(0,n),i/Math.pow(10,3*(e.length-n)))}(t,e,i);if(-1!==e.indexOf("%"))return function(t,e,i){var n=e.replace(vt,""),r=e.length-n.length;return At(t,n,i*Math.pow(10,2*r))+he("%",r)}(t,e,i);if(-1!==e.indexOf("E"))return Ct(e,i);if(36===e.charCodeAt(0))return"$"+Mt(t,e.substr(" "==e.charAt(1)?2:1),i);var r,s,a,o,l=Math.abs(i),h=i<0?"-":"";if(e.match(/^00+$/))return h+K(l,e.length);if(e.match(/^[#?]+$/))return r=""+i,0===i&&(r=""),r.length>e.length?r:St(e.substr(0,e.length-r.length))+r;if(s=e.match(bt))return function(t,e,i){return i+(0===e?"":""+e)+he(" ",t[1].length+2+t[4].length)}(s,l,h);if(e.match(/^#+0+$/))return h+K(l,e.length-e.indexOf("0"));if(s=e.match(_t))return r=(r=(""+i).replace(/^([^\.]+)$/,"$1."+St(s[1])).replace(/\.$/,"."+St(s[1]))).replace(/\.(\d*)$/,(function(t,e){return"."+e+he("0",St(s[1]).length-e.length)})),-1!==e.indexOf("0.")?r:r.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return h+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return h+mt(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return i<0?"-"+Mt(t,e,-i):mt(""+i)+"."+he("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Mt(t,e.replace(/^#,#*,/,""),i);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Y(Mt(t,e.replace(/[\\-]/g,""),i)),a=0,Y(Y(e.replace(/\\/g,"")).replace(/[0#]/g,(function(t){return a<r.length?r.charAt(a++):"0"===t?"0":""})));if(e.match(wt))return"("+(r=Mt(t,"##########",i)).substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var c="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=at(l,Math.pow(10,a)-1,!1),r=""+h," "==(c=At("n",s[1],o[1])).charAt(c.length-1)&&(c=c.substr(0,c.length-1)+"0"),r+=c+s[2]+"/"+s[3],(c=Z(o[2],a)).length<s[4].length&&(c=St(s[4].substr(s[4].length-c.length))+c),r+=c;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),h+((o=at(l,Math.pow(10,a)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?q(o[1],a)+s[2]+"/"+s[3]+Z(o[2],a):he(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return r=""+i,e.length<=r.length?r:St(e.substr(0,e.length-r.length))+r;if(s=e.match(/^([#0]+)\.([#0]+)$/)){r=""+i.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=r.indexOf(".");var u=e.indexOf(".")-a,d=e.length-r.length-u;return St(e.substr(0,u)+r+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return i<0?"-"+Mt(t,e,-i):mt(""+i).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(t){return"00,"+(t.length<3?K(0,3-t.length):"")+t}))+"."+K(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var f=mt(""+l);return"0"!==f?h+f:"";default:if(e.match(/\.[0#?]*$/))return Mt(t,e.slice(0,e.lastIndexOf(".")),i)+St(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function At(t,e,i){return(0|i)===i?Mt(t,e,i):kt(t,e,i)}var Ot=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Pt(t){for(var e=0,i="",n="";e<t.length;)switch(i=t.charAt(e)){case"G":tt(t,e)&&(e+=6),e++;break;case'"':for(;34!==t.charCodeAt(++e)&&e<t.length;);++e;break;case"\\":case"_":e+=2;break;case"@":++e;break;case"B":case"b":if("1"===t.charAt(e+1)||"2"===t.charAt(e+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if("A/P"===t.substr(e,3).toUpperCase())return!0;if("AM/PM"===t.substr(e,5).toUpperCase())return!0;if("上午/下午"===t.substr(e,5).toUpperCase())return!0;++e;break;case"[":for(n=i;"]"!==t.charAt(e++)&&e<t.length;)n+=t.charAt(e);if(n.match(Ot))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(i=t.charAt(++e))>-1||"\\"==i&&"-"==t.charAt(e+1)&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===i;);break;case"*":++e," "!=t.charAt(e)&&"*"!=t.charAt(e)||++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;default:++e}return!1}var Rt=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function It(t,e){if(null==e)return!1;var i=parseFloat(e[2]);switch(e[1]){case"=":if(t==i)return!0;break;case">":if(t>i)return!0;break;case"<":if(t<i)return!0;break;case"<>":if(t!=i)return!0;break;case">=":if(t>=i)return!0;break;case"<=":if(t<=i)return!0}return!1}function Lt(t,e){var i=function(t){for(var e=[],i=!1,n=0,r=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:i=!i;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(r,n-r),r=n+1}if(e[e.length]=t.substr(r),!0===i)throw new Error("Format |"+t+"| unterminated string ");return e}(t),n=i.length,r=i[n-1].indexOf("@");if(n<4&&r>-1&&--n,i.length>4)throw new Error("cannot find right format for |"+i.join("|")+"|");if("number"!=typeof e)return[4,4===i.length||r>-1?i[i.length-1]:"@"];switch(i.length){case 1:i=r>-1?["General","General","General",i[0]]:[i[0],i[0],i[0],"@"];break;case 2:i=r>-1?[i[0],i[0],i[0],i[1]]:[i[0],i[1],i[0],"@"];break;case 3:i=r>-1?[i[0],i[1],i[0],i[2]]:[i[0],i[1],i[2],"@"]}var s=e>0?i[0]:e<0?i[1]:i[2];if(-1===i[0].indexOf("[")&&-1===i[1].indexOf("["))return[n,s];if(null!=i[0].match(/\[[=<>]/)||null!=i[1].match(/\[[=<>]/)){var a=i[0].match(Rt),o=i[1].match(Rt);return It(e,a)?[n,i[0]]:It(e,o)?[n,i[1]]:[n,i[null!=a&&null!=o?2:1]]}return[n,s]}function Dt(t,e,i){null==i&&(i={});var n="";switch(typeof t){case"string":n="m/d/yy"==t&&i.dateNF?i.dateNF:t;break;case"number":null==(n=14==t&&i.dateNF?i.dateNF:(null!=i.table?i.table:nt)[t])&&(n=i.table&&i.table[rt[t]]||nt[rt[t]]),null==n&&(n=st[t]||"General")}if(tt(n,0))return pt(e,i);e instanceof Date&&(e=ut(e,i.date1904));var r=Lt(n,e);if(tt(r[1]))return pt(e,i);if(!0===e)e="TRUE";else if(!1===e)e="FALSE";else if(""===e||null==e)return"";return function(t,e,i,n){for(var r,s,a,o=[],l="",h=0,c="",u="t",d="H";h<t.length;)switch(c=t.charAt(h)){case"G":if(!tt(t,h))throw new Error("unrecognized character "+c+" in "+t);o[o.length]={t:"G",v:"General"},h+=7;break;case'"':for(l="";34!==(a=t.charCodeAt(++h))&&h<t.length;)l+=String.fromCharCode(a);o[o.length]={t:"t",v:l},++h;break;case"\\":var f=t.charAt(++h),p="("===f||")"===f?f:"t";o[o.length]={t:p,v:f},++h;break;case"_":o[o.length]={t:"t",v:" "},h+=2;break;case"@":o[o.length]={t:"T",v:e},++h;break;case"B":case"b":if("1"===t.charAt(h+1)||"2"===t.charAt(h+1)){if(null==r&&null==(r=ot(e,i,"2"===t.charAt(h+1))))return"";o[o.length]={t:"X",v:t.substr(h,2)},u=c,h+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0)return"";if(null==r&&null==(r=ot(e,i)))return"";for(l=c;++h<t.length&&t.charAt(h).toLowerCase()===c;)l+=c;"m"===c&&"h"===u.toLowerCase()&&(c="M"),"h"===c&&(c=d),o[o.length]={t:c,v:l},u=c;break;case"A":case"a":case"上":var g={t:c,v:c};if(null==r&&(r=ot(e,i)),"A/P"===t.substr(h,3).toUpperCase()?(null!=r&&(g.v=r.H>=12?"P":"A"),g.t="T",d="h",h+=3):"AM/PM"===t.substr(h,5).toUpperCase()?(null!=r&&(g.v=r.H>=12?"PM":"AM"),g.t="T",h+=5,d="h"):"上午/下午"===t.substr(h,5).toUpperCase()?(null!=r&&(g.v=r.H>=12?"下午":"上午"),g.t="T",h+=5,d="h"):(g.t="t",++h),null==r&&"T"===g.t)return"";o[o.length]=g,u=c;break;case"[":for(l=c;"]"!==t.charAt(h++)&&h<t.length;)l+=t.charAt(h);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(Ot)){if(null==r&&null==(r=ot(e,i)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},u=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Pt(t)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=r){for(l=c;++h<t.length&&"0"===(c=t.charAt(h));)l+=c;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=c;++h<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(h))>-1;)l+=c;o[o.length]={t:"n",v:l};break;case"?":for(l=c;t.charAt(++h)===c;)l+=c;o[o.length]={t:c,v:l},u=c;break;case"*":++h," "!=t.charAt(h)&&"*"!=t.charAt(h)||++h;break;case"(":case")":o[o.length]={t:1===n?"t":c,v:c},++h;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=c;h<t.length&&"0123456789".indexOf(t.charAt(++h))>-1;)l+=t.charAt(h);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:c,v:c},++h;break;case"$":o[o.length]={t:"t",v:"$"},++h;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c))throw new Error("unrecognized character "+c+" in "+t);o[o.length]={t:"t",v:c},++h}var m,v=0,y=0;for(h=o.length-1,u="t";h>=0;--h)switch(o[h].t){case"h":case"H":o[h].t=d,u="h",v<1&&(v=1);break;case"s":(m=o[h].v.match(/\.0+$/))&&(y=Math.max(y,m[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":u=o[h].t;break;case"m":"s"===u&&(o[h].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&o[h].v.match(/[Hh]/)&&(v=1),v<2&&o[h].v.match(/[Mm]/)&&(v=2),v<3&&o[h].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:r.u>=.5&&(r.u=0,++r.S),r.S>=60&&(r.S=0,++r.M),r.M>=60&&(r.M=0,++r.H);break;case 2:r.u>=.5&&(r.u=0,++r.S),r.S>=60&&(r.S=0,++r.M)}var b,_="";for(h=0;h<o.length;++h)switch(o[h].t){case"t":case"T":case" ":case"D":break;case"X":o[h].v="",o[h].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[h].v=gt(o[h].t.charCodeAt(0),o[h].v,r,y),o[h].t="t";break;case"n":case"?":for(b=h+1;null!=o[b]&&("?"===(c=o[b].t)||"D"===c||(" "===c||"t"===c)&&null!=o[b+1]&&("?"===o[b+1].t||"t"===o[b+1].t&&"/"===o[b+1].v)||"("===o[h].t&&(" "===c||"n"===c||")"===c)||"t"===c&&("/"===o[b].v||" "===o[b].v&&null!=o[b+1]&&"?"==o[b+1].t));)o[h].v+=o[b].v,o[b]={v:"",t:";"},++b;_+=o[h].v,h=b-1;break;case"G":o[h].t="t",o[h].v=pt(e,i)}var x,w,S="";if(_.length>0){40==_.charCodeAt(0)?(x=e<0&&45===_.charCodeAt(0)?-e:e,w=At("n",_,x)):(w=At("n",_,x=e<0&&n>1?-e:e),x<0&&o[0]&&"t"==o[0].t&&(w=w.substr(1),o[0].v="-"+o[0].v)),b=w.length-1;var T=o.length;for(h=0;h<o.length;++h)if(null!=o[h]&&"t"!=o[h].t&&o[h].v.indexOf(".")>-1){T=h;break}var E=o.length;if(T===o.length&&-1===w.indexOf("E")){for(h=o.length-1;h>=0;--h)null!=o[h]&&-1!=="n?".indexOf(o[h].t)&&(b>=o[h].v.length-1?(b-=o[h].v.length,o[h].v=w.substr(b+1,o[h].v.length)):b<0?o[h].v="":(o[h].v=w.substr(0,b+1),b=-1),o[h].t="t",E=h);b>=0&&E<o.length&&(o[E].v=w.substr(0,b+1)+o[E].v)}else if(T!==o.length&&-1===w.indexOf("E")){for(b=w.indexOf(".")-1,h=T;h>=0;--h)if(null!=o[h]&&-1!=="n?".indexOf(o[h].t)){for(s=o[h].v.indexOf(".")>-1&&h===T?o[h].v.indexOf(".")-1:o[h].v.length-1,S=o[h].v.substr(s+1);s>=0;--s)b>=0&&("0"===o[h].v.charAt(s)||"#"===o[h].v.charAt(s))&&(S=w.charAt(b--)+S);o[h].v=S,o[h].t="t",E=h}for(b>=0&&E<o.length&&(o[E].v=w.substr(0,b+1)+o[E].v),b=w.indexOf(".")+1,h=T;h<o.length;++h)if(null!=o[h]&&(-1!=="n?(".indexOf(o[h].t)||h===T)){for(s=o[h].v.indexOf(".")>-1&&h===T?o[h].v.indexOf(".")+1:0,S=o[h].v.substr(0,s);s<o[h].v.length;++s)b<w.length&&(S+=w.charAt(b++));o[h].v=S,o[h].t="t",E=h}}}for(h=0;h<o.length;++h)null!=o[h]&&"n?".indexOf(o[h].t)>-1&&(x=n>1&&e<0&&h>0&&"-"===o[h-1].v?-e:e,o[h].v=At(o[h].t,o[h].v,x),o[h].t="t");var k="";for(h=0;h!==o.length;++h)null!=o[h]&&(k+=o[h].v);return k}(r[1],e,i,r[0])}function Nt(t,e){if("number"!=typeof e){e=+e||-1;for(var i=0;i<392;++i)if(null!=nt[i]){if(nt[i]==t){e=i;break}}else e<0&&(e=i);e<0&&(e=391)}return nt[e]=t,e}function Ft(t){for(var e=0;392!=e;++e)void 0!==t[e]&&Nt(t[e],e)}function jt(){var t;t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',nt=t}var Bt={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},zt=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var Wt=function(){var t={};t.version="1.2.0";var e=function(){for(var t=0,e=new Array(256),i=0;256!=i;++i)t=1&(t=1&(t=1&(t=1&(t=1&(t=1&(t=1&(t=1&(t=i)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1,e[i]=t;return"undefined"!=typeof Int32Array?new Int32Array(e):e}();var i=function(t){var e=0,i=0,n=0,r="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(n=0;256!=n;++n)r[n]=t[n];for(n=0;256!=n;++n)for(i=t[n],e=256+n;e<4096;e+=256)i=r[e]=i>>>8^t[255&i];var s=[];for(n=1;16!=n;++n)s[n-1]="undefined"!=typeof Int32Array?r.subarray(256*n,256*n+256):r.slice(256*n,256*n+256);return s}(e),n=i[0],r=i[1],s=i[2],a=i[3],o=i[4],l=i[5],h=i[6],c=i[7],u=i[8],d=i[9],f=i[10],p=i[11],g=i[12],m=i[13],v=i[14];return t.table=e,t.bstr=function(t,i){for(var n=-1^i,r=0,s=t.length;r<s;)n=n>>>8^e[255&(n^t.charCodeAt(r++))];return~n},t.buf=function(t,i){for(var y=-1^i,b=t.length-15,_=0;_<b;)y=v[t[_++]^255&y]^m[t[_++]^y>>8&255]^g[t[_++]^y>>16&255]^p[t[_++]^y>>>24]^f[t[_++]]^d[t[_++]]^u[t[_++]]^c[t[_++]]^h[t[_++]]^l[t[_++]]^o[t[_++]]^a[t[_++]]^s[t[_++]]^r[t[_++]]^n[t[_++]]^e[t[_++]];for(b+=15;_<b;)y=y>>>8^e[255&(y^t[_++])];return~y},t.str=function(t,i){for(var n=-1^i,r=0,s=t.length,a=0,o=0;r<s;)(a=t.charCodeAt(r++))<128?n=n>>>8^e[255&(n^a)]:a<2048?n=(n=n>>>8^e[255&(n^(192|a>>6&31))])>>>8^e[255&(n^(128|63&a))]:a>=55296&&a<57344?(a=64+(1023&a),o=1023&t.charCodeAt(r++),n=(n=(n=(n=n>>>8^e[255&(n^(240|a>>8&7))])>>>8^e[255&(n^(128|a>>2&63))])>>>8^e[255&(n^(128|o>>6&15|(3&a)<<4))])>>>8^e[255&(n^(128|63&o))]):n=(n=(n=n>>>8^e[255&(n^(224|a>>12&15))])>>>8^e[255&(n^(128|a>>6&63))])>>>8^e[255&(n^(128|63&a))];return~n},t}(),Gt=function(){var t,e={};function i(t){if("/"==t.charAt(t.length-1))return-1===t.slice(0,-1).indexOf("/")?t:i(t.slice(0,-1));var e=t.lastIndexOf("/");return-1===e?t:t.slice(0,e+1)}function n(t){if("/"==t.charAt(t.length-1))return n(t.slice(0,-1));var e=t.lastIndexOf("/");return-1===e?t:t.slice(e+1)}function r(t,e){"string"==typeof e&&(e=new Date(e));var i=e.getHours();i=(i=i<<6|e.getMinutes())<<5|e.getSeconds()>>>1,t.write_shift(2,i);var n=e.getFullYear()-1980;n=(n=n<<4|e.getMonth()+1)<<5|e.getDate(),t.write_shift(2,n)}function s(t){Yi(t,0);for(var e={},i=0;t.l<=t.length-4;){var n=t.read_shift(2),r=t.read_shift(2),s=t.l+r,a={};if(21589===n)1&(i=t.read_shift(1))&&(a.mtime=t.read_shift(4)),r>5&&(2&i&&(a.atime=t.read_shift(4)),4&i&&(a.ctime=t.read_shift(4))),a.mtime&&(a.mt=new Date(1e3*a.mtime));t.l=s,e[n]=a}return e}function a(){return t||(t={})}function o(t,e){if(80==t[0]&&75==t[1])return pt(t,e);if(109==(32|t[0])&&105==(32|t[1]))return function(t,e){if("mime-version:"!=w(t.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var i=e&&e.root||"",n=(N&&Buffer.isBuffer(t)?t.toString("binary"):w(t)).split("\r\n"),r=0,s="";for(r=0;r<n.length;++r)if(s=n[r],/^Content-Location:/i.test(s)&&(s=s.slice(s.indexOf("file")),i||(i=s.slice(0,s.lastIndexOf("/")+1)),s.slice(0,i.length)!=i))for(;i.length>0&&(i=(i=i.slice(0,i.length-1)).slice(0,i.lastIndexOf("/")+1),s.slice(0,i.length)!=i););var a=(n[1]||"").match(/boundary="(.*?)"/);if(!a)throw new Error("MAD cannot find boundary");var o="--"+(a[1]||""),l=[],h=[],c={FileIndex:l,FullPaths:h};d(c);var u,f=0;for(r=0;r<n.length;++r){var p=n[r];p!==o&&p!==o+"--"||(f++&&_t(c,n.slice(u,r),i),u=r)}return c}(t,e);if(t.length<512)throw new Error("CFB file size "+t.length+" < 512");var i,n,r,s,a,o,f=512,p=[],g=t.slice(0,512);Yi(g,0);var m=function(t){if(80==t[t.l]&&75==t[t.l+1])return[0,0];t.chk(y,"Header Signature: "),t.l+=16;var e=t.read_shift(2,"u");return[t.read_shift(2,"u"),e]}(g);switch(i=m[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==m[1])return pt(t,e);default:throw new Error("Major Version: Expected 3 or 4 saw "+i)}512!==f&&Yi(g=t.slice(0,f),28);var b=t.slice(0,f);!function(t,e){var i=9;switch(t.l+=2,i=t.read_shift(2)){case 9:if(3!=e)throw new Error("Sector Shift: Expected 9 saw "+i);break;case 12:if(4!=e)throw new Error("Sector Shift: Expected 12 saw "+i);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+i)}t.chk("0600","Mini Sector Shift: "),t.chk("000000000000","Reserved: ")}(g,i);var _=g.read_shift(4,"i");if(3===i&&0!==_)throw new Error("# Directory Sectors: Expected 0 saw "+_);g.l+=4,s=g.read_shift(4,"i"),g.l+=4,g.chk("00100000","Mini Stream Cutoff Size: "),a=g.read_shift(4,"i"),n=g.read_shift(4,"i"),o=g.read_shift(4,"i"),r=g.read_shift(4,"i");for(var x=-1,S=0;S<109&&!((x=g.read_shift(4,"i"))<0);++S)p[S]=x;var T=function(t,e){for(var i=Math.ceil(t.length/e)-1,n=[],r=1;r<i;++r)n[r-1]=t.slice(r*e,(r+1)*e);return n[i-1]=t.slice(i*e),n}(t,f);h(o,r,T,f,p);var E=function(t,e,i,n){var r=t.length,s=[],a=[],o=[],l=[],h=n-1,c=0,u=0,d=0,f=0;for(c=0;c<r;++c)if(o=[],(d=c+e)>=r&&(d-=r),!a[d]){l=[];var p=[];for(u=d;u>=0;){p[u]=!0,a[u]=!0,o[o.length]=u,l.push(t[u]);var g=i[Math.floor(4*u/n)];if(n<4+(f=4*u&h))throw new Error("FAT boundary crossed: "+u+" 4 "+n);if(!t[g])break;if(p[u=Bi(t[g],f)])break}s[d]={nodes:o,data:pi([l])}}return s}(T,s,p,f);E[s].name="!Directory",n>0&&a!==v&&(E[a].name="!MiniFAT"),E[p[0]].name="!FAT",E.fat_addrs=p,E.ssz=f;var k=[],C=[],M=[];!function(t,e,i,n,r,s,a,o){for(var h,d=0,f=n.length?2:0,p=e[t].data,g=0,m=0;g<p.length;g+=128){var y=p.slice(g,g+128);Yi(y,64),m=y.read_shift(2),h=mi(y,0,m-f),n.push(h);var b={name:h,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.ct=u(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.mt=u(y,y.l-8)),b.start=y.read_shift(4,"i"),b.size=y.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=v,b.name=""),5===b.type?(d=b.start,r>0&&d!==v&&(e[d].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===e[b.start]&&(e[b.start]=c(i,b.start,e.fat_addrs,e.ssz)),e[b.start].name=b.name,b.content=e[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:d!==v&&b.start!==v&&e[d]&&(b.content=l(b,e[d].data,(e[o]||{}).data))),b.content&&Yi(b.content,0),s[h]=b,a.push(b)}}(s,E,T,k,n,{},C,a),function(t,e,i){for(var n=0,r=0,s=0,a=0,o=0,l=i.length,h=[],c=[];n<l;++n)h[n]=c[n]=n,e[n]=i[n];for(;o<c.length;++o)r=t[n=c[o]].L,s=t[n].R,a=t[n].C,h[n]===n&&(-1!==r&&h[r]!==r&&(h[n]=h[r]),-1!==s&&h[s]!==s&&(h[n]=h[s])),-1!==a&&(h[a]=n),-1!==r&&n!=h[n]&&(h[r]=h[n],c.lastIndexOf(r)<o&&c.push(r)),-1!==s&&n!=h[n]&&(h[s]=h[n],c.lastIndexOf(s)<o&&c.push(s));for(n=1;n<l;++n)h[n]===n&&(-1!==s&&h[s]!==s?h[n]=h[s]:-1!==r&&h[r]!==r&&(h[n]=h[r]));for(n=1;n<l;++n)if(0!==t[n].type){if((o=n)!=h[o])do{o=h[o],e[n]=e[o]+"/"+e[n]}while(0!==o&&-1!==h[o]&&o!=h[o]);h[n]=-1}for(e[0]+="/",n=1;n<l;++n)2!==t[n].type&&(e[n]+="/")}(C,M,k),k.shift();var A={FileIndex:C,FullPaths:M};return e&&e.raw&&(A.raw={header:b,sectors:T}),A}function l(t,e,i){for(var n=t.start,r=t.size,s=[],a=n;i&&r>0&&a>=0;)s.push(e.slice(a*m,a*m+m)),r-=m,a=Bi(i,4*a);return 0===s.length?qi(0):H(s).slice(0,t.size)}function h(t,e,i,n,r){var s=v;if(t===v){if(0!==e)throw new Error("DIFAT chain shorter than expected")}else if(-1!==t){var a=i[t],o=(n>>>2)-1;if(!a)return;for(var l=0;l<o&&(s=Bi(a,4*l))!==v;++l)r.push(s);h(Bi(a,n-4),e-1,i,n,r)}}function c(t,e,i,n,r){var s=[],a=[];r||(r=[]);var o=n-1,l=0,h=0;for(l=e;l>=0;){r[l]=!0,s[s.length]=l,a.push(t[l]);var c=i[Math.floor(4*l/n)];if(n<4+(h=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+n);if(!t[c])break;l=Bi(t[c],h)}return{nodes:s,data:pi([a])}}function u(t,e){return new Date(1e3*(ji(t,e+4)/1e7*Math.pow(2,32)+ji(t,e)/1e7-11644473600))}function d(t,e){var i=e||{},n=i.root||"Root Entry";if(t.FullPaths||(t.FullPaths=[]),t.FileIndex||(t.FileIndex=[]),t.FullPaths.length!==t.FileIndex.length)throw new Error("inconsistent CFB structure");0===t.FullPaths.length&&(t.FullPaths[0]=n+"/",t.FileIndex[0]={name:n,type:5}),i.CLSID&&(t.FileIndex[0].clsid=i.CLSID),function(t){var e="Sh33tJ5";if(Gt.find(t,"/"+e))return;var i=qi(4);i[0]=55,i[1]=i[3]=50,i[2]=54,t.FileIndex.push({name:e,type:2,content:i,size:4,L:69,R:69,C:69}),t.FullPaths.push(t.FullPaths[0]+e),f(t)}(t)}function f(t,e){d(t);for(var r=!1,s=!1,a=t.FullPaths.length-1;a>=0;--a){var o=t.FileIndex[a];switch(o.type){case 0:s?r=!0:(t.FileIndex.pop(),t.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(o.R*o.L*o.C)&&(r=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(r=!0);break;default:r=!0}}if(r||e){var l=new Date(1987,1,19),h=0,c=Object.create?Object.create(null):{},u=[];for(a=0;a<t.FullPaths.length;++a)c[t.FullPaths[a]]=!0,0!==t.FileIndex[a].type&&u.push([t.FullPaths[a],t.FileIndex[a]]);for(a=0;a<u.length;++a){var f=i(u[a][0]);(s=c[f])||(u.push([f,{name:n(f).replace("/",""),type:1,clsid:_,ct:l,mt:l,content:null}]),c[f]=!0)}for(u.sort((function(t,e){return function(t,e){for(var i=t.split("/"),n=e.split("/"),r=0,s=0,a=Math.min(i.length,n.length);r<a;++r){if(s=i[r].length-n[r].length)return s;if(i[r]!=n[r])return i[r]<n[r]?-1:1}return i.length-n.length}(t[0],e[0])})),t.FullPaths=[],t.FileIndex=[],a=0;a<u.length;++a)t.FullPaths[a]=u[a][0],t.FileIndex[a]=u[a][1];for(a=0;a<u.length;++a){var p=t.FileIndex[a],g=t.FullPaths[a];if(p.name=n(g).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||_,0===a)p.C=u.length>1?1:-1,p.size=0,p.type=5;else if("/"==g.slice(-1)){for(h=a+1;h<u.length&&i(t.FullPaths[h])!=g;++h);for(p.C=h>=u.length?-1:h,h=a+1;h<u.length&&i(t.FullPaths[h])!=i(g);++h);p.R=h>=u.length?-1:h,p.type=1}else i(t.FullPaths[a+1]||"")==i(g)&&(p.R=a+1),p.type=2}}}function p(t,e){var i=e||{};if("mad"==i.fileType)return function(t,e){for(var i=e||{},n=i.boundary||"SheetJS",r=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(n="------="+n).slice(2)+'"',"","",""],s=t.FullPaths[0],a=s,o=t.FileIndex[0],l=1;l<t.FullPaths.length;++l)if(a=t.FullPaths[l].slice(s.length),(o=t.FileIndex[l]).size&&o.content&&"Sh33tJ5"!=a){a=a.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(t){return"_x"+t.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(t){return"_u"+t.charCodeAt(0).toString(16)+"_"}));for(var h=o.content,c=N&&Buffer.isBuffer(h)?h.toString("binary"):w(h),u=0,d=Math.min(1024,c.length),f=0,p=0;p<=d;++p)(f=c.charCodeAt(p))>=32&&f<128&&++u;var g=u>=4*d/5;r.push(n),r.push("Content-Location: "+(i.root||"file:///C:/SheetJS/")+a),r.push("Content-Transfer-Encoding: "+(g?"quoted-printable":"base64")),r.push("Content-Type: "+vt(o,a)),r.push(""),r.push(g?bt(c):yt(c))}return r.push(n+"--\r\n"),r.join("\r\n")}(t,i);if(f(t),"zip"===i.fileType)return function(t,e){var i=e||{},n=[],s=[],a=qi(1),o=i.compression?8:0,l=0;0;var h=0,c=0,u=0,d=0,f=t.FullPaths[0],p=f,g=t.FileIndex[0],m=[],v=0;for(h=1;h<t.FullPaths.length;++h)if(p=t.FullPaths[h].slice(f.length),(g=t.FileIndex[h]).size&&g.content&&"Sh33tJ5"!=p){var y=u,b=qi(p.length);for(c=0;c<p.length;++c)b.write_shift(1,127&p.charCodeAt(c));b=b.slice(0,b.l),m[d]=Wt.buf(g.content,0);var _=g.content;8==o&&(_=S(_)),(a=qi(30)).write_shift(4,67324752),a.write_shift(2,20),a.write_shift(2,l),a.write_shift(2,o),g.mt?r(a,g.mt):a.write_shift(4,0),a.write_shift(-4,8&l?0:m[d]),a.write_shift(4,8&l?0:_.length),a.write_shift(4,8&l?0:g.content.length),a.write_shift(2,b.length),a.write_shift(2,0),u+=a.length,n.push(a),u+=b.length,n.push(b),u+=_.length,n.push(_),8&l&&((a=qi(12)).write_shift(-4,m[d]),a.write_shift(4,_.length),a.write_shift(4,g.content.length),u+=a.l,n.push(a)),(a=qi(46)).write_shift(4,33639248),a.write_shift(2,0),a.write_shift(2,20),a.write_shift(2,l),a.write_shift(2,o),a.write_shift(4,0),a.write_shift(-4,m[d]),a.write_shift(4,_.length),a.write_shift(4,g.content.length),a.write_shift(2,b.length),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a.write_shift(4,y),v+=a.l,s.push(a),v+=b.length,s.push(b),++d}return a=qi(22),a.write_shift(4,101010256),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,d),a.write_shift(2,d),a.write_shift(4,v),a.write_shift(4,u),a.write_shift(2,0),H([H(n),H(s),a])}(t,i);var n=function(t){for(var e=0,i=0,n=0;n<t.FileIndex.length;++n){var r=t.FileIndex[n];if(r.content){var s=r.content.length;s>0&&(s<4096?e+=s+63>>6:i+=s+511>>9)}}for(var a=t.FullPaths.length+3>>2,o=e+127>>7,l=(e+7>>3)+i+a+o,h=l+127>>7,c=h<=109?0:Math.ceil((h-109)/127);l+h+c+127>>7>h;)c=++h<=109?0:Math.ceil((h-109)/127);var u=[1,c,h,o,a,i,e,0];return t.FileIndex[0].size=e<<6,u[7]=(t.FileIndex[0].start=u[0]+u[1]+u[2]+u[3]+u[4]+u[5])+(u[6]+7>>3),u}(t),s=qi(n[7]<<9),a=0,o=0;for(a=0;a<8;++a)s.write_shift(1,b[a]);for(a=0;a<8;++a)s.write_shift(2,0);for(s.write_shift(2,62),s.write_shift(2,3),s.write_shift(2,65534),s.write_shift(2,9),s.write_shift(2,6),a=0;a<3;++a)s.write_shift(2,0);for(s.write_shift(4,0),s.write_shift(4,n[2]),s.write_shift(4,n[0]+n[1]+n[2]+n[3]-1),s.write_shift(4,0),s.write_shift(4,4096),s.write_shift(4,n[3]?n[0]+n[1]+n[2]-1:v),s.write_shift(4,n[3]),s.write_shift(-4,n[1]?n[0]-1:v),s.write_shift(4,n[1]),a=0;a<109;++a)s.write_shift(-4,a<n[2]?n[1]+a:-1);if(n[1])for(o=0;o<n[1];++o){for(;a<236+127*o;++a)s.write_shift(-4,a<n[2]?n[1]+a:-1);s.write_shift(-4,o===n[1]-1?v:o+1)}var l=function(t){for(o+=t;a<o-1;++a)s.write_shift(-4,a+1);t&&(++a,s.write_shift(-4,v))};for(o=a=0,o+=n[1];a<o;++a)s.write_shift(-4,x.DIFSECT);for(o+=n[2];a<o;++a)s.write_shift(-4,x.FATSECT);l(n[3]),l(n[4]);for(var h=0,c=0,u=t.FileIndex[0];h<t.FileIndex.length;++h)(u=t.FileIndex[h]).content&&((c=u.content.length)<4096||(u.start=o,l(c+511>>9)));for(l(n[6]+7>>3);511&s.l;)s.write_shift(-4,x.ENDOFCHAIN);for(o=a=0,h=0;h<t.FileIndex.length;++h)(u=t.FileIndex[h]).content&&(!(c=u.content.length)||c>=4096||(u.start=o,l(c+63>>6)));for(;511&s.l;)s.write_shift(-4,x.ENDOFCHAIN);for(a=0;a<n[4]<<2;++a){var d=t.FullPaths[a];if(d&&0!==d.length){u=t.FileIndex[a],0===a&&(u.start=u.size?u.start-1:v);var p=0===a&&i.root||u.name;if(c=2*(p.length+1),s.write_shift(64,p,"utf16le"),s.write_shift(2,c),s.write_shift(1,u.type),s.write_shift(1,u.color),s.write_shift(-4,u.L),s.write_shift(-4,u.R),s.write_shift(-4,u.C),u.clsid)s.write_shift(16,u.clsid,"hex");else for(h=0;h<4;++h)s.write_shift(4,0);s.write_shift(4,u.state||0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,u.start),s.write_shift(4,u.size),s.write_shift(4,0)}else{for(h=0;h<17;++h)s.write_shift(4,0);for(h=0;h<3;++h)s.write_shift(4,-1);for(h=0;h<12;++h)s.write_shift(4,0)}}for(a=1;a<t.FileIndex.length;++a)if((u=t.FileIndex[a]).size>=4096)if(s.l=u.start+1<<9,N&&Buffer.isBuffer(u.content))u.content.copy(s,s.l,0,u.size),s.l+=u.size+511&-512;else{for(h=0;h<u.size;++h)s.write_shift(1,u.content[h]);for(;511&h;++h)s.write_shift(1,0)}for(a=1;a<t.FileIndex.length;++a)if((u=t.FileIndex[a]).size>0&&u.size<4096)if(N&&Buffer.isBuffer(u.content))u.content.copy(s,s.l,0,u.size),s.l+=u.size+63&-64;else{for(h=0;h<u.size;++h)s.write_shift(1,u.content[h]);for(;63&h;++h)s.write_shift(1,0)}if(N)s.l=s.length;else for(;s.l<s.length;)s.write_shift(1,0);return s}e.version="1.2.1";var g,m=64,v=-2,y="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],_="00000000000000000000000000000000",x={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:_,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function w(t){for(var e=new Array(t.length),i=0;i<t.length;++i)e[i]=String.fromCharCode(t[i]);return e.join("")}function S(t){return g?g.deflateRawSync(t):st(t)}var T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],E=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],k=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];for(var C,M,A="undefined"!=typeof Uint8Array,O=A?new Uint8Array(256):[],P=0;P<256;++P)O[P]=(M=void 0,255&((M=139536&((C=P)<<1|C<<11)|558144&(C<<5|C<<15))>>16|M>>8|M));function R(t,e){var i=O[255&t];return e<=8?i>>>8-e:(i=i<<8|O[t>>8&255],e<=16?i>>>16-e:(i=i<<8|O[t>>16&255])>>>24-e)}function I(t,e){var i=7&e,n=e>>>3;return(t[n]|(i<=6?0:t[n+1]<<8))>>>i&3}function W(t,e){var i=7&e,n=e>>>3;return(t[n]|(i<=5?0:t[n+1]<<8))>>>i&7}function G(t,e){var i=7&e,n=e>>>3;return(t[n]|(i<=3?0:t[n+1]<<8))>>>i&31}function U(t,e){var i=7&e,n=e>>>3;return(t[n]|(i<=1?0:t[n+1]<<8))>>>i&127}function Y(t,e,i){var n=7&e,r=e>>>3,s=(1<<i)-1,a=t[r]>>>n;return i<8-n?a&s:(a|=t[r+1]<<8-n,i<16-n?a&s:(a|=t[r+2]<<16-n,i<24-n?a&s:(a|=t[r+3]<<24-n)&s))}function K(t,e,i){var n=7&e,r=e>>>3;return n<=5?t[r]|=(7&i)<<n:(t[r]|=i<<n&255,t[r+1]=(7&i)>>8-n),e+3}function q(t,e,i){return i=(1&i)<<(7&e),t[e>>>3]|=i,e+1}function Z(t,e,i){var n=e>>>3;return i<<=7&e,t[n]|=255&i,i>>>=8,t[n+1]=i,e+8}function J(t,e,i){var n=e>>>3;return i<<=7&e,t[n]|=255&i,i>>>=8,t[n+1]=255&i,t[n+2]=i>>>8,e+16}function $(t,e){var i=t.length,n=2*i>e?2*i:e+5,r=0;if(i>=e)return t;if(N){var s=B(n);if(t.copy)t.copy(s);else for(;r<t.length;++r)s[r]=t[r];return s}if(A){var a=new Uint8Array(n);if(a.set)a.set(t);else for(;r<i;++r)a[r]=t[r];return a}return t.length=n,t}function Q(t){for(var e=new Array(t),i=0;i<t;++i)e[i]=0;return e}function tt(t,e,i){var n=1,r=0,s=0,a=0,o=0,l=t.length,h=A?new Uint16Array(32):Q(32);for(s=0;s<32;++s)h[s]=0;for(s=l;s<i;++s)t[s]=0;l=t.length;var c=A?new Uint16Array(l):Q(l);for(s=0;s<l;++s)h[r=t[s]]++,n<r&&(n=r),c[s]=0;for(h[0]=0,s=1;s<=n;++s)h[s+16]=o=o+h[s-1]<<1;for(s=0;s<l;++s)0!=(o=t[s])&&(c[s]=h[o+16]++);var u=0;for(s=0;s<l;++s)if(0!=(u=t[s]))for(o=R(c[s],n)>>n-u,a=(1<<n+4-u)-1;a>=0;--a)e[o|a<<u]=15&u|s<<4;return n}var et=A?new Uint16Array(512):Q(512),it=A?new Uint16Array(32):Q(32);if(!A){for(var nt=0;nt<512;++nt)et[nt]=0;for(nt=0;nt<32;++nt)it[nt]=0}!function(){for(var t=[],e=0;e<32;e++)t.push(5);tt(t,it,32);var i=[];for(e=0;e<=143;e++)i.push(8);for(;e<=255;e++)i.push(9);for(;e<=279;e++)i.push(7);for(;e<=287;e++)i.push(8);tt(i,et,288)}();var rt=function(){for(var t=A?new Uint8Array(32768):[],e=0,i=0;e<k.length-1;++e)for(;i<k[e+1];++i)t[i]=e;for(;i<32768;++i)t[i]=29;var n=A?new Uint8Array(259):[];for(e=0,i=0;e<E.length-1;++e)for(;i<E[e+1];++i)n[i]=e;return function(e,i){return e.length<8?function(t,e){for(var i=0;i<t.length;){var n=Math.min(65535,t.length-i),r=i+n==t.length;for(e.write_shift(1,+r),e.write_shift(2,n),e.write_shift(2,65535&~n);n-- >0;)e[e.l++]=t[i++]}return e.l}(e,i):function(e,i){for(var r=0,s=0,a=A?new Uint16Array(32768):[];s<e.length;){var o=Math.min(65535,e.length-s);if(o<10){for(7&(r=K(i,r,+!(s+o!=e.length)))&&(r+=8-(7&r)),i.l=r/8|0,i.write_shift(2,o),i.write_shift(2,65535&~o);o-- >0;)i[i.l++]=e[s++];r=8*i.l}else{r=K(i,r,+!(s+o!=e.length)+2);for(var l=0;o-- >0;){var h=e[s],c=-1,u=0;if((c=a[l=32767&(l<<5^h)])&&((c|=-32768&s)>s&&(c-=32768),c<s))for(;e[c+u]==e[s+u]&&u<250;)++u;if(u>2){(h=n[u])<=22?r=Z(i,r,O[h+1]>>1)-1:(Z(i,r,3),Z(i,r+=5,O[h-23]>>5),r+=3);var d=h<8?0:h-4>>2;d>0&&(J(i,r,u-E[h]),r+=d),h=t[s-c],r=Z(i,r,O[h]>>3),r-=3;var f=h<4?0:h-2>>1;f>0&&(J(i,r,s-c-k[h]),r+=f);for(var p=0;p<u;++p)a[l]=32767&s,l=32767&(l<<5^e[s]),++s;o-=u-1}else h<=143?h+=48:r=q(i,r,1),r=Z(i,r,O[h]),a[l]=32767&s,++s}r=Z(i,r,0)-1}}return i.l=(r+7)/8|0,i.l}(e,i)}}();function st(t){var e=qi(50+Math.floor(1.1*t.length)),i=rt(t,e);return e.slice(0,i)}var at=A?new Uint16Array(32768):Q(32768),ot=A?new Uint16Array(32768):Q(32768),lt=A?new Uint16Array(128):Q(128),ht=1,ct=1;function ut(t,e){var i=G(t,e)+257,n=G(t,e+=5)+1,r=function(t,e){var i=7&e,n=e>>>3;return(t[n]|(i<=4?0:t[n+1]<<8))>>>i&15}(t,e+=5)+4;e+=4;for(var s=0,a=A?new Uint8Array(19):Q(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,h=A?new Uint8Array(8):Q(8),c=A?new Uint8Array(8):Q(8),u=a.length,d=0;d<r;++d)a[T[d]]=s=W(t,e),l<s&&(l=s),h[s]++,e+=3;var f=0;for(h[0]=0,d=1;d<=l;++d)c[d]=f=f+h[d-1]<<1;for(d=0;d<u;++d)0!=(f=a[d])&&(o[d]=c[f]++);var p=0;for(d=0;d<u;++d)if(0!=(p=a[d])){f=O[o[d]]>>8-p;for(var g=(1<<7-p)-1;g>=0;--g)lt[f|g<<p]=7&p|d<<3}var m=[];for(l=1;m.length<i+n;)switch(e+=7&(f=lt[U(t,e)]),f>>>=3){case 16:for(s=3+I(t,e),e+=2,f=m[m.length-1];s-- >0;)m.push(f);break;case 17:for(s=3+W(t,e),e+=3;s-- >0;)m.push(0);break;case 18:for(s=11+U(t,e),e+=7;s-- >0;)m.push(0);break;default:m.push(f),l<f&&(l=f)}var v=m.slice(0,i),y=m.slice(i);for(d=i;d<286;++d)v[d]=0;for(d=n;d<30;++d)y[d]=0;return ht=tt(v,at,286),ct=tt(y,ot,30),e}function dt(t,e){var i=function(t,e){if(3==t[0]&&!(3&t[1]))return[j(e),2];for(var i=0,n=0,r=B(e||1<<18),s=0,a=r.length>>>0,o=0,l=0;0==(1&n);)if(n=W(t,i),i+=3,n>>>1!=0)for(n>>1==1?(o=9,l=5):(i=ut(t,i),o=ht,l=ct);;){!e&&a<s+32767&&(a=(r=$(r,s+32767)).length);var h=Y(t,i,o),c=n>>>1==1?et[h]:at[h];if(i+=15&c,0==((c>>>=4)>>>8&255))r[s++]=c;else{if(256==c)break;var u=(c-=257)<8?0:c-4>>2;u>5&&(u=0);var d=s+E[c];u>0&&(d+=Y(t,i,u),i+=u),h=Y(t,i,l),i+=15&(c=n>>>1==1?it[h]:ot[h]);var f=(c>>>=4)<4?0:c-2>>1,p=k[c];for(f>0&&(p+=Y(t,i,f),i+=f),!e&&a<d&&(a=(r=$(r,d+100)).length);s<d;)r[s]=r[s-p],++s}}else{7&i&&(i+=8-(7&i));var g=t[i>>>3]|t[1+(i>>>3)]<<8;if(i+=32,g>0)for(!e&&a<s+g&&(a=(r=$(r,s+g)).length);g-- >0;)r[s++]=t[i>>>3],i+=8}return e?[r,i+7>>>3]:[r.slice(0,s),i+7>>>3]}(t.slice(t.l||0),e);return t.l+=i[1],i[0]}function ft(t,e){if(!t)throw new Error(e);"undefined"!=typeof console&&console.error(e)}function pt(t,e){var i=t;Yi(i,0);var n={FileIndex:[],FullPaths:[]};d(n,{root:e.root});for(var r=i.length-4;(80!=i[r]||75!=i[r+1]||5!=i[r+2]||6!=i[r+3])&&r>=0;)--r;i.l=r+4,i.l+=4;var a=i.read_shift(2);i.l+=6;var o=i.read_shift(4);for(i.l=o,r=0;r<a;++r){i.l+=20;var l=i.read_shift(4),h=i.read_shift(4),c=i.read_shift(2),u=i.read_shift(2),f=i.read_shift(2);i.l+=8;var p=i.read_shift(4),g=s(i.slice(i.l+c,i.l+c+u));i.l+=c+u+f;var m=i.l;i.l=p+4,gt(i,l,h,n,g),i.l=m}return n}function gt(t,e,i,n,r){t.l+=2;var a=t.read_shift(2),o=t.read_shift(2),l=function(t){var e=65535&t.read_shift(2),i=65535&t.read_shift(2),n=new Date,r=31&i,s=15&(i>>>=5);i>>>=4,n.setMilliseconds(0),n.setFullYear(i+1980),n.setMonth(s-1),n.setDate(r);var a=31&e,o=63&(e>>>=5);return e>>>=6,n.setHours(e),n.setMinutes(o),n.setSeconds(a<<1),n}(t);if(8257&a)throw new Error("Unsupported ZIP encryption");t.read_shift(4);for(var h=t.read_shift(4),c=t.read_shift(4),u=t.read_shift(2),d=t.read_shift(2),f="",p=0;p<u;++p)f+=String.fromCharCode(t[t.l++]);if(d){var m=s(t.slice(t.l,t.l+d));(m[21589]||{}).mt&&(l=m[21589].mt),((r||{})[21589]||{}).mt&&(l=r[21589].mt)}t.l+=d;var v=t.slice(t.l,t.l+h);switch(o){case 8:v=function(t,e){if(!g)return dt(t,e);var i=new(0,g.InflateRaw),n=i._processChunk(t.slice(t.l),i._finishFlushFlag);return t.l+=i.bytesRead,n}(t,c);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var y=!1;8&a&&(134695760==t.read_shift(4)&&(t.read_shift(4),y=!0),h=t.read_shift(4),c=t.read_shift(4)),h!=e&&ft(y,"Bad compressed size: "+e+" != "+h),c!=i&&ft(y,"Bad uncompressed size: "+i+" != "+c),xt(n,f,v,{unsafe:!0,mt:l})}var mt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vt(t,e){if(t.ctype)return t.ctype;var i=t.name||"",n=i.match(/\.([^\.]+)$/);return n&&mt[n[1]]||e&&(n=(i=e).match(/[\.\\]([^\.\\])+$/))&&mt[n[1]]?mt[n[1]]:"application/octet-stream"}function yt(t){for(var e=L(t),i=[],n=0;n<e.length;n+=76)i.push(e.slice(n,n+76));return i.join("\r\n")+"\r\n"}function bt(t){var e=t.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(t){var e=t.charCodeAt(0).toString(16).toUpperCase();return"="+(1==e.length?"0"+e:e)}));"\n"==(e=e.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(e="=0D"+e.slice(1));for(var i=[],n=(e=e.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),r=0;r<n.length;++r){var s=n[r];if(0!=s.length)for(var a=0;a<s.length;){var o=76,l=s.slice(a,a+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=s.slice(a,a+o),(a+=o)<s.length&&(l+="="),i.push(l)}else i.push("")}return i.join("\r\n")}function _t(t,e,i){for(var n,r="",s="",a="",o=0;o<10;++o){var l=e[o];if(!l||l.match(/^\s*$/))break;var h=l.match(/^(.*?):\s*([^\s].*)$/);if(h)switch(h[1].toLowerCase()){case"content-location":r=h[2].trim();break;case"content-type":a=h[2].trim();break;case"content-transfer-encoding":s=h[2].trim()}}switch(++o,s.toLowerCase()){case"base64":n=z(D(e.slice(o).join("")));break;case"quoted-printable":n=function(t){for(var e=[],i=0;i<t.length;++i){for(var n=t[i];i<=t.length&&"="==n.charAt(n.length-1);)n=n.slice(0,n.length-1)+t[++i];e.push(n)}for(var r=0;r<e.length;++r)e[r]=e[r].replace(/[=][0-9A-Fa-f]{2}/g,(function(t){return String.fromCharCode(parseInt(t.slice(1),16))}));return z(e.join("\r\n"))}(e.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+s)}var c=xt(t,r.slice(i.length),n,{unsafe:!0});a&&(c.ctype=a)}function xt(t,e,i,r){var s=r&&r.unsafe;s||d(t);var a=!s&&Gt.find(t,e);if(!a){var o=t.FullPaths[0];e.slice(0,o.length)==o?o=e:("/"!=o.slice(-1)&&(o+="/"),o=(o+e).replace("//","/")),a={name:n(e),type:2},t.FileIndex.push(a),t.FullPaths.push(o),s||Gt.utils.cfb_gc(t)}return a.content=i,a.size=i?i.length:0,r&&(r.CLSID&&(a.clsid=r.CLSID),r.mt&&(a.mt=r.mt),r.ct&&(a.ct=r.ct)),a}return e.find=function(t,e){var i=t.FullPaths.map((function(t){return t.toUpperCase()})),n=i.map((function(t){var e=t.split("/");return e[e.length-("/"==t.slice(-1)?2:1)]})),r=!1;47===e.charCodeAt(0)?(r=!0,e=i[0].slice(0,-1)+e):r=-1!==e.indexOf("/");var s=e.toUpperCase(),a=!0===r?i.indexOf(s):n.indexOf(s);if(-1!==a)return t.FileIndex[a];var o=!s.match(V);for(s=s.replace(X,""),o&&(s=s.replace(V,"!")),a=0;a<i.length;++a){if((o?i[a].replace(V,"!"):i[a]).replace(X,"")==s)return t.FileIndex[a];if((o?n[a].replace(V,"!"):n[a]).replace(X,"")==s)return t.FileIndex[a]}return null},e.read=function(e,i){var n=i&&i.type;switch(n||N&&Buffer.isBuffer(e)&&(n="buffer"),n||"base64"){case"file":return function(e,i){return a(),o(t.readFileSync(e),i)}(e,i);case"base64":return o(z(D(e)),i);case"binary":return o(z(e),i)}return o(e,i)},e.parse=o,e.write=function(e,i){var n=p(e,i);switch(i&&i.type||"buffer"){case"file":return a(),t.writeFileSync(i.filename,n),n;case"binary":return"string"==typeof n?n:w(n);case"base64":return L("string"==typeof n?n:w(n));case"buffer":if(N)return Buffer.isBuffer(n)?n:F(n);case"array":return"string"==typeof n?z(n):n}return n},e.writeFile=function(e,i,n){a();var r=p(e,n);t.writeFileSync(i,r)},e.utils={cfb_new:function(t){var e={};return d(e,t),e},cfb_add:xt,cfb_del:function(t,e){d(t);var i=Gt.find(t,e);if(i)for(var n=0;n<t.FileIndex.length;++n)if(t.FileIndex[n]==i)return t.FileIndex.splice(n,1),t.FullPaths.splice(n,1),!0;return!1},cfb_mov:function(t,e,i){d(t);var r=Gt.find(t,e);if(r)for(var s=0;s<t.FileIndex.length;++s)if(t.FileIndex[s]==r)return t.FileIndex[s].name=n(i),t.FullPaths[s]=i,!0;return!1},cfb_gc:function(t){f(t,!0)},ReadShift:Wi,CheckField:Vi,prep_blob:Yi,bconcat:H,use_zlib:function(t){try{var e=new(0,t.InflateRaw);if(e._processChunk(new Uint8Array([3,0]),e._finishFlushFlag),!e.bytesRead)throw new Error("zlib does not expose bytesRead");g=t}catch(t){console.error("cannot use native zlib: "+(t.message||t))}},_deflateRaw:st,_inflateRaw:dt,consts:x},e}();let Ut;function Ht(t){return"string"==typeof t?W(t):Array.isArray(t)?function(t){if("undefined"==typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(t)}(t):t}function Xt(t,e,i){if(void 0!==Ut&&Ut.writeFileSync)return i?Ut.writeFileSync(t,e,i):Ut.writeFileSync(t,e);if("undefined"!=typeof Deno){if(i&&"string"==typeof e)switch(i){case"utf8":e=new TextEncoder(i).encode(e);break;case"binary":e=W(e);break;default:throw new Error("Unsupported encoding "+i)}return Deno.writeFileSync(t,e)}var n="utf8"==i?Ze(e):e;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(n,t);if("undefined"!=typeof Blob){var r=new Blob([Ht(n)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(r,t);if("undefined"!=typeof saveAs)return saveAs(r,t);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(r);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(s)}),6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(null!=a.download)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(s)}),6e4),s}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=G(e)),o.write(e),o.close(),e}catch(t){if(!t.message||!t.message.match(/onstruct/))throw t}throw new Error("cannot save file "+t)}function Vt(t){for(var e=Object.keys(t),i=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&i.push(e[n]);return i}function Yt(t,e){for(var i=[],n=Vt(t),r=0;r!==n.length;++r)null==i[t[n[r]][e]]&&(i[t[n[r]][e]]=n[r]);return i}function Kt(t){for(var e=[],i=Vt(t),n=0;n!==i.length;++n)e[t[i[n]]]=i[n];return e}function qt(t){for(var e=[],i=Vt(t),n=0;n!==i.length;++n)e[t[i[n]]]=parseInt(i[n],10);return e}var Zt=new Date(1899,11,30,0,0,0);function Jt(t,e){var i=t.getTime();return e&&(i-=1263168e5),(i-(Zt.getTime()+6e4*(t.getTimezoneOffset()-Zt.getTimezoneOffset())))/864e5}var $t=new Date,Qt=Zt.getTime()+6e4*($t.getTimezoneOffset()-Zt.getTimezoneOffset()),te=$t.getTimezoneOffset();function ee(t){var e=new Date;return e.setTime(24*t*60*60*1e3+Qt),e.getTimezoneOffset()!==te&&e.setTime(e.getTime()+6e4*(e.getTimezoneOffset()-te)),e}function ie(t){var e=0,i=0,n=!1,r=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!r)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=r.length;++s)if(r[s]){switch(i=1,s>3&&(n=!0),r[s].slice(r[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+r[s].slice(r[s].length-1));case"D":i*=24;case"H":i*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");i*=60}e+=i*parseInt(r[s],10)}return e}var ne=new Date("2017-02-19T19:06:09.000Z"),re=isNaN(ne.getFullYear())?new Date("2/19/17"):ne,se=2017==re.getFullYear();function ae(t,e){var i=new Date(t);if(se)return e>0?i.setTime(i.getTime()+60*i.getTimezoneOffset()*1e3):e<0&&i.setTime(i.getTime()-60*i.getTimezoneOffset()*1e3),i;if(t instanceof Date)return t;if(1917==re.getFullYear()&&!isNaN(i.getFullYear())){var n=i.getFullYear();return t.indexOf(""+n)>-1||i.setFullYear(i.getFullYear()+100),i}var r=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}function oe(t,e){if(N&&Buffer.isBuffer(t)){if(e){if(255==t[0]&&254==t[1])return Ze(t.slice(2).toString("utf16le"));if(254==t[1]&&255==t[2])return Ze(C(t.slice(2).toString("binary")))}return t.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(e){if(255==t[0]&&254==t[1])return Ze(new TextDecoder("utf-16le").decode(t.slice(2)));if(254==t[0]&&255==t[1])return Ze(new TextDecoder("utf-16be").decode(t.slice(2)))}var i={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"",ˆ:"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,(function(t){return i[t]||t}))}catch(t){}for(var n=[],r=0;r!=t.length;++r)n.push(String.fromCharCode(t[r]));return n.join("")}function le(t){if("undefined"!=typeof JSON&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if("object"!=typeof t||null==t)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=le(t[i]));return e}function he(t,e){for(var i="";i.length<e;)i+=t;return i}function ce(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var i=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return i*=100,""}));return isNaN(e=Number(n))?(n=n.replace(/[(](.*)[)]/,(function(t,e){return i=-i,e})),isNaN(e=Number(n))?e:e/i):e/i}var ue=["january","february","march","april","may","june","july","august","september","october","november","december"];function de(t){var e=new Date(t),i=new Date(NaN),n=e.getYear(),r=e.getMonth(),s=e.getDate();if(isNaN(s))return i;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==ue.indexOf(a))return i}else if(a.match(/[a-z]/))return i;return n<0||n>8099?i:(r>0||s>1)&&101!=n?e:t.match(/[^-0-9:,\/\\]/)?i:e}var fe=function(){var t=5=="abacaba".split(/(:?b)/i).length;return function(e,i,n){if(t||"string"==typeof i)return e.split(i);for(var r=e.split(i),s=[r[0]],a=1;a<r.length;++a)s.push(n),s.push(r[a]);return s}}();function pe(t){return t?t.content&&t.type?oe(t.content,!0):t.data?A(t.data):t.asNodeBuffer&&N?A(t.asNodeBuffer().toString("binary")):t.asBinary?A(t.asBinary()):t._data&&t._data.getContent?A(oe(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function ge(t){if(!t)return null;if(t.data)return k(t.data);if(t.asNodeBuffer&&N)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return"string"==typeof e?k(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function me(t,e){for(var i=t.FullPaths||Vt(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),r=n.replace(/\\/g,"/"),s=0;s<i.length;++s){var a=i[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||r==a)return t.files?t.files[i[s]]:t.FileIndex[s]}return null}function ve(t,e){var i=me(t,e);if(null==i)throw new Error("Cannot find file "+e+" in zip");return i}function ye(t,e,i){if(!i)return(n=ve(t,e))&&".bin"===n.name.slice(-4)?ge(n):pe(n);var n;if(!e)return null;try{return ye(t,e)}catch(t){return null}}function be(t,e,i){if(!i)return pe(ve(t,e));if(!e)return null;try{return be(t,e)}catch(t){return null}}function _e(t,e,i){if(!i)return ge(ve(t,e));if(!e)return null;try{return _e(t,e)}catch(t){return null}}function xe(t){for(var e=t.FullPaths||Vt(t.files),i=[],n=0;n<e.length;++n)"/"!=e[n].slice(-1)&&i.push(e[n].replace(/^Root Entry[\/]/,""));return i.sort()}function we(t,e,i){if(t.FullPaths){var n;if("string"==typeof i)return n=N?F(i):function(t){for(var e=[],i=0,n=t.length+250,r=j(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)r[i++]=a;else if(a<2048)r[i++]=192|a>>6&31,r[i++]=128|63&a;else if(a>=55296&&a<57344){a=64+(1023&a);var o=1023&t.charCodeAt(++s);r[i++]=240|a>>8&7,r[i++]=128|a>>2&63,r[i++]=128|o>>6&15|(3&a)<<4,r[i++]=128|63&o}else r[i++]=224|a>>12&15,r[i++]=128|a>>6&63,r[i++]=128|63&a;i>n&&(e.push(r.slice(0,i)),i=0,r=j(65535),n=65530)}return e.push(r.slice(0,i)),H(e)}(i),Gt.utils.cfb_add(t,e,n);Gt.utils.cfb_add(t,e,i)}else t.file(e,i)}function Se(){return Gt.utils.cfb_new()}function Te(t,e){switch(e.type){case"base64":return Gt.read(t,{type:"base64"});case"binary":return Gt.read(t,{type:"binary"});case"buffer":case"array":return Gt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Ee(t,e){if("/"==t.charAt(0))return t.slice(1);var i=e.split("/");"/"!=e.slice(-1)&&i.pop();for(var n=t.split("/");0!==n.length;){var r=n.shift();".."===r?i.pop():"."!==r&&i.push(r)}return i.join("/")}var ke='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Ce=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Me=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Ae=ke.match(Me)?Me:/<[^>]*>/g,Oe=/<\w*:/,Pe=/<(\/?)\w+:/;function Re(t,e,i){for(var n={},r=0,s=0;r!==t.length&&(32!==(s=t.charCodeAt(r))&&10!==s&&13!==s);++r);if(e||(n[0]=t.slice(0,r)),r===t.length)return n;var a=t.match(Ce),o=0,l="",h=0,c="",u="",d=1;if(a)for(h=0;h!=a.length;++h){for(u=a[h],s=0;s!=u.length&&61!==u.charCodeAt(s);++s);for(c=u.slice(0,s).trim();32==u.charCodeAt(s+1);)++s;for(d=34==(r=u.charCodeAt(s+1))||39==r?1:0,l=u.slice(s+1+d,u.length-d),o=0;o!=c.length&&58!==c.charCodeAt(o);++o);if(o===c.length)c.indexOf("_")>0&&(c=c.slice(0,c.indexOf("_"))),n[c]=l,i||(n[c.toLowerCase()]=l);else{var f=(5===o&&"xmlns"===c.slice(0,5)?"xmlns":"")+c.slice(o+1);if(n[f]&&"ext"==c.slice(o-3,o))continue;n[f]=l,i||(n[f.toLowerCase()]=l)}}return n}function Ie(t){return t.replace(Pe,"<$1")}var Le={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},De=Kt(Le),Ne=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,e=/_x([\da-fA-F]{4})_/gi;return function i(n){var r=n+"",s=r.indexOf("<![CDATA[");if(-1==s)return r.replace(t,(function(t,e){return Le[t]||String.fromCharCode(parseInt(e,t.indexOf("x")>-1?16:10))||t})).replace(e,(function(t,e){return String.fromCharCode(parseInt(e,16))}));var a=r.indexOf("]]>");return i(r.slice(0,s))+r.slice(s+9,a)+i(r.slice(a+3))}}(),Fe=/[&<>'"]/g,je=/[\u0000-\u0008\u000b-\u001f]/g;function Be(t){return(t+"").replace(Fe,(function(t){return De[t]})).replace(je,(function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"}))}function ze(t){return Be(t).replace(/ /g,"_x0020_")}var We=/[\u0000-\u001f]/g;function Ge(t){return(t+"").replace(Fe,(function(t){return De[t]})).replace(/\n/g,"<br/>").replace(We,(function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"}))}var Ue=function(){var t=/&#(\d+);/g;function e(t,e){return String.fromCharCode(parseInt(e,10))}return function(i){return i.replace(t,e)}}();function He(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Xe(t){for(var e="",i=0,n=0,r=0,s=0,a=0,o=0;i<t.length;)(n=t.charCodeAt(i++))<128?e+=String.fromCharCode(n):(r=t.charCodeAt(i++),n>191&&n<224?(a=(31&n)<<6,a|=63&r,e+=String.fromCharCode(a)):(s=t.charCodeAt(i++),n<240?e+=String.fromCharCode((15&n)<<12|(63&r)<<6|63&s):(o=((7&n)<<18|(63&r)<<12|(63&s)<<6|63&(a=t.charCodeAt(i++)))-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(1023&o)))));return e}function Ve(t){var e,i,n,r=j(2*t.length),s=1,a=0,o=0;for(i=0;i<t.length;i+=s)s=1,(n=t.charCodeAt(i))<128?e=n:n<224?(e=64*(31&n)+(63&t.charCodeAt(i+1)),s=2):n<240?(e=4096*(15&n)+64*(63&t.charCodeAt(i+1))+(63&t.charCodeAt(i+2)),s=3):(s=4,e=262144*(7&n)+4096*(63&t.charCodeAt(i+1))+64*(63&t.charCodeAt(i+2))+(63&t.charCodeAt(i+3)),o=55296+((e-=65536)>>>10&1023),e=56320+(1023&e)),0!==o&&(r[a++]=255&o,r[a++]=o>>>8,o=0),r[a++]=e%256,r[a++]=e>>>8;return r.slice(0,a).toString("ucs2")}function Ye(t){return F(t,"binary").toString("utf8")}var Ke="foo bar bazâð£",qe=N&&(Ye(Ke)==Xe(Ke)&&Ye||Ve(Ke)==Xe(Ke)&&Ve)||Xe,Ze=N?function(t){return F(t,"utf8").toString("binary")}:function(t){for(var e=[],i=0,n=0,r=0;i<t.length;)switch(n=t.charCodeAt(i++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,r=t.charCodeAt(i++)-56320+(n<<10),e.push(String.fromCharCode(240+(r>>18&7))),e.push(String.fromCharCode(144+(r>>12&63))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(63&r)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(63&n)))}return e.join("")},Je=function(){var t={};return function(e,i){var n=e+"|"+(i||"");return t[n]?t[n]:t[n]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",i||"")}}(),$e=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]}));return function(e){for(var i=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<t.length;++n)i=i.replace(t[n][0],t[n][1]);return i}}(),Qe=function(){var t={};return function(e){return void 0!==t[e]?t[e]:t[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}}(),ti=/<\/?(?:vt:)?variant>/g,ei=/<(?:vt:)([^>]*)>([\s\S]*)</;function ii(t,e){var i=Re(t),n=t.match(Qe(i.baseType))||[],r=[];if(n.length!=i.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+i.size);return r}return n.forEach((function(t){var e=t.replace(ti,"").match(ei);e&&r.push({v:qe(e[2]),t:e[1]})})),r}var ni=/(^\s|\s$|\n)/;function ri(t,e){return"<"+t+(e.match(ni)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function si(t){return Vt(t).map((function(e){return" "+e+'="'+t[e]+'"'})).join("")}function ai(t,e,i){return"<"+t+(null!=i?si(i):"")+(null!=e?(e.match(ni)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function oi(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function li(t){if(N&&Buffer.isBuffer(t))return t.toString("utf8");if("string"==typeof t)return t;if("undefined"!=typeof Uint8Array&&t instanceof Uint8Array)return qe(G(U(t)));throw new Error("Bad input format: expected Buffer or string")}var hi=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,ci={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ui=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],di={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};var fi=function(t){for(var e=[],i=0;i<t[0].length;++i)if(t[0][i])for(var n=0,r=t[0][i].length;n<r;n+=10240)e.push.apply(e,t[0][i].slice(n,n+10240));return e},pi=N?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map((function(t){return Buffer.isBuffer(t)?t:F(t)}))):fi(t)}:fi,gi=function(t,e,i){for(var n=[],r=e;r<i;r+=2)n.push(String.fromCharCode(Ni(t,r)));return n.join("").replace(X,"")},mi=N?function(t,e,i){return Buffer.isBuffer(t)?t.toString("utf16le",e,i).replace(X,""):gi(t,e,i)}:gi,vi=function(t,e,i){for(var n=[],r=e;r<e+i;++r)n.push(("0"+t[r].toString(16)).slice(-2));return n.join("")},yi=N?function(t,e,i){return Buffer.isBuffer(t)?t.toString("hex",e,e+i):vi(t,e,i)}:vi,bi=function(t,e,i){for(var n=[],r=e;r<i;r++)n.push(String.fromCharCode(Di(t,r)));return n.join("")},_i=N?function(t,e,i){return Buffer.isBuffer(t)?t.toString("utf8",e,i):bi(t,e,i)}:bi,xi=function(t,e){var i=ji(t,e);return i>0?_i(t,e+4,e+4+i-1):""},wi=xi,Si=function(t,e){var i=ji(t,e);return i>0?_i(t,e+4,e+4+i-1):""},Ti=Si,Ei=function(t,e){var i=2*ji(t,e);return i>0?_i(t,e+4,e+4+i-1):""},ki=Ei,Ci=function(t,e){var i=ji(t,e);return i>0?mi(t,e+4,e+4+i):""},Mi=Ci,Ai=function(t,e){var i=ji(t,e);return i>0?_i(t,e+4,e+4+i):""},Oi=Ai,Pi=function(t,e){return function(t,e){for(var i=1-2*(t[e+7]>>>7),n=((127&t[e+7])<<4)+(t[e+6]>>>4&15),r=15&t[e+6],s=5;s>=0;--s)r=256*r+t[e+s];return 2047==n?0==r?i*(1/0):NaN:(0==n?n=-1022:(n-=1023,r+=Math.pow(2,52)),i*Math.pow(2,n-52)*r)}(t,e)},Ri=Pi,Ii=function(t){return Array.isArray(t)||"undefined"!=typeof Uint8Array&&t instanceof Uint8Array};function Li(){mi=function(t,e,i){return M.utils.decode(1200,t.slice(e,i)).replace(X,"")},_i=function(t,e,i){return M.utils.decode(65001,t.slice(e,i))},wi=function(t,e){var i=ji(t,e);return i>0?M.utils.decode(_,t.slice(e+4,e+4+i-1)):""},Ti=function(t,e){var i=ji(t,e);return i>0?M.utils.decode(b,t.slice(e+4,e+4+i-1)):""},ki=function(t,e){var i=2*ji(t,e);return i>0?M.utils.decode(1200,t.slice(e+4,e+4+i-1)):""},Mi=function(t,e){var i=ji(t,e);return i>0?M.utils.decode(1200,t.slice(e+4,e+4+i)):""},Oi=function(t,e){var i=ji(t,e);return i>0?M.utils.decode(65001,t.slice(e+4,e+4+i)):""}}N&&(wi=function(t,e){if(!Buffer.isBuffer(t))return xi(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},Ti=function(t,e){if(!Buffer.isBuffer(t))return Si(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},ki=function(t,e){if(!Buffer.isBuffer(t))return Ei(t,e);var i=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i-1)},Mi=function(t,e){if(!Buffer.isBuffer(t))return Ci(t,e);var i=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i)},Oi=function(t,e){if(!Buffer.isBuffer(t))return Ai(t,e);var i=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+i)},Ri=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):Pi(t,e)},Ii=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||"undefined"!=typeof Uint8Array&&t instanceof Uint8Array}),void 0!==M&&Li();var Di=function(t,e){return t[e]},Ni=function(t,e){return 256*t[e+1]+t[e]},Fi=function(t,e){var i=256*t[e+1]+t[e];return i<32768?i:-1*(65535-i+1)},ji=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Bi=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},zi=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Wi(t,e){var i,n,r,s,a,o,l="",h=[];switch(e){case"dbcs":if(o=this.l,N&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*t).toString("utf16le");else for(a=0;a<t;++a)l+=String.fromCharCode(Ni(this,o)),o+=2;t*=2;break;case"utf8":l=_i(this,this.l,this.l+t);break;case"utf16le":t*=2,l=mi(this,this.l,this.l+t);break;case"wstr":if(void 0===M)return Wi.call(this,t,"dbcs");l=M.utils.decode(b,this.slice(this.l,this.l+2*t)),t*=2;break;case"lpstr-ansi":l=wi(this,this.l),t=4+ji(this,this.l);break;case"lpstr-cp":l=Ti(this,this.l),t=4+ji(this,this.l);break;case"lpwstr":l=ki(this,this.l),t=4+2*ji(this,this.l);break;case"lpp4":t=4+ji(this,this.l),l=Mi(this,this.l),2&t&&(t+=2);break;case"8lpp4":t=4+ji(this,this.l),l=Oi(this,this.l),3&t&&(t+=4-(3&t));break;case"cstr":for(t=0,l="";0!==(r=Di(this,this.l+t++));)h.push(O(r));l=h.join("");break;case"_wstr":for(t=0,l="";0!==(r=Ni(this,this.l+t));)h.push(O(r)),t+=2;t+=2,l=h.join("");break;case"dbcs-cont":for(l="",o=this.l,a=0;a<t;++a){if(this.lens&&-1!==this.lens.indexOf(o))return r=Di(this,o),this.l=o+1,s=Wi.call(this,t-a,r?"dbcs-cont":"sbcs-cont"),h.join("")+s;h.push(O(Ni(this,o))),o+=2}l=h.join(""),t*=2;break;case"cpstr":if(void 0!==M){l=M.utils.decode(b,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(l="",o=this.l,a=0;a!=t;++a){if(this.lens&&-1!==this.lens.indexOf(o))return r=Di(this,o),this.l=o+1,s=Wi.call(this,t-a,r?"dbcs-cont":"sbcs-cont"),h.join("")+s;h.push(O(Di(this,o))),o+=1}l=h.join("");break;default:switch(t){case 1:return i=Di(this,this.l),this.l++,i;case 2:return i=("i"===e?Fi:Ni)(this,this.l),this.l+=2,i;case 4:case-4:return"i"===e||0==(128&this[this.l+3])?(i=(t>0?Bi:zi)(this,this.l),this.l+=4,i):(n=ji(this,this.l),this.l+=4,n);case 8:case-8:if("f"===e)return n=8==t?Ri(this,this.l):Ri([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;t=8;case 16:l=yi(this,this.l,t)}}return this.l+=t,l}var Gi=function(t,e,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24&255},Ui=function(t,e,i){t[i]=255&e,t[i+1]=e>>8&255,t[i+2]=e>>16&255,t[i+3]=e>>24&255},Hi=function(t,e,i){t[i]=255&e,t[i+1]=e>>>8&255};function Xi(t,e,i){var n=0,r=0;if("dbcs"===i){for(r=0;r!=e.length;++r)Hi(this,e.charCodeAt(r),this.l+2*r);n=2*e.length}else if("sbcs"===i){if(void 0!==M&&874==_)for(r=0;r!=e.length;++r){var s=M.utils.encode(_,e.charAt(r));this[this.l+r]=s[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=e.length;++r)this[this.l+r]=255&e.charCodeAt(r);n=e.length}else{if("hex"===i){for(;r<t;++r)this[this.l++]=parseInt(e.slice(2*r,2*r+2),16)||0;return this}if("utf16le"===i){var a=Math.min(this.l+t,this.length);for(r=0;r<Math.min(e.length,t);++r){var o=e.charCodeAt(r);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}switch(t){case 1:n=1,this[this.l]=255&e;break;case 2:n=2,this[this.l]=255&e,e>>>=8,this[this.l+1]=255&e;break;case 3:n=3,this[this.l]=255&e,e>>>=8,this[this.l+1]=255&e,e>>>=8,this[this.l+2]=255&e;break;case 4:n=4,Gi(this,e,this.l);break;case 8:if(n=8,"f"===i){!function(t,e,i){var n=(e<0||1/e==-1/0?1:0)<<7,r=0,s=0,a=n?-e:e;isFinite(a)?0==a?r=s=0:(r=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-r),r<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?r=-1022:(s-=Math.pow(2,52),r+=1023)):(r=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[i+o]=255&s;t[i+6]=(15&r)<<4|15&s,t[i+7]=r>>4|n}(this,e,this.l);break}case 16:break;case-4:n=4,Ui(this,e,this.l)}}return this.l+=n,this}function Vi(t,e){var i=yi(this,this.l,t.length>>1);if(i!==t)throw new Error(e+"Expected "+t+" saw "+i);this.l+=t.length>>1}function Yi(t,e){t.l=e,t.read_shift=Wi,t.chk=Vi,t.write_shift=Xi}function Ki(t,e){t.l+=e}function qi(t){var e=j(t);return Yi(e,0),e}function Zi(t,e,i){if(t){var n,r,s;Yi(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){128&(o=t.read_shift(1))&&(o=(127&o)+((127&t.read_shift(1))<<7));var h=lc[o]||lc[65535];for(s=127&(n=t.read_shift(1)),r=1;r<4&&128&n;++r)s+=(127&(n=t.read_shift(1)))<<7*r;l=t.l+s;var c=h.f&&h.f(t,s,i);if(t.l=l,e(c,h,o))return}}}function Ji(){var t=[],e=N?256:2048,i=function(t){var e=qi(t);return Yi(e,0),e},n=i(e),r=function(){n&&(n.length>n.l&&((n=n.slice(0,n.l)).l=n.length),n.length>0&&t.push(n),n=null)},s=function(t){return n&&t<n.length-n.l?n:(r(),n=i(Math.max(t+1,e)))};return{next:s,push:function(t){r(),null==(n=t).l&&(n.l=n.length),s(e)},end:function(){return r(),H(t)},_bufs:t}}function $i(t,e,i,n){var r,s=+e;if(!isNaN(s)){n||(n=lc[s].p||(i||[]).length||0),r=1+(s>=128?1:0)+1,n>=128&&++r,n>=16384&&++r,n>=2097152&&++r;var a=t.next(r);s<=127?a.write_shift(1,s):(a.write_shift(1,128+(127&s)),a.write_shift(1,s>>7));for(var o=0;4!=o;++o){if(!(n>=128)){a.write_shift(1,n);break}a.write_shift(1,128+(127&n)),n>>=7}n>0&&Ii(i)&&t.push(i)}}function Qi(t,e,i){var n=le(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!i||i.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function tn(t,e,i){var n=le(t);return n.s=Qi(n.s,e.s,i),n.e=Qi(n.e,e.s,i),n}function en(t,e){if(t.cRel&&t.c<0)for(t=le(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=le(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var i=hn(t);return t.cRel||null==t.cRel||(i=i.replace(/^([A-Z])/,"$$$1")),t.rRel||null==t.rRel||(i=function(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(i)),i}function nn(t,e){return 0!=t.s.r||t.s.rRel||t.e.r!=(e.biff>=12?1048575:e.biff>=8?65536:16384)||t.e.rRel?0!=t.s.c||t.s.cRel||t.e.c!=(e.biff>=12?16383:255)||t.e.cRel?en(t.s,e.biff)+":"+en(t.e,e.biff):(t.s.rRel?"":"$")+sn(t.s.r)+":"+(t.e.rRel?"":"$")+sn(t.e.r):(t.s.cRel?"":"$")+on(t.s.c)+":"+(t.e.cRel?"":"$")+on(t.e.c)}function rn(t){return parseInt(t.replace(/\$(\d+)$/,"$1"),10)-1}function sn(t){return""+(t+1)}function an(t){for(var e=t.replace(/^\$([A-Z])/,"$1"),i=0,n=0;n!==e.length;++n)i=26*i+e.charCodeAt(n)-64;return i-1}function on(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function ln(t){for(var e=0,i=0,n=0;n<t.length;++n){var r=t.charCodeAt(n);r>=48&&r<=57?e=10*e+(r-48):r>=65&&r<=90&&(i=26*i+(r-64))}return{c:i-1,r:e-1}}function hn(t){for(var e=t.c+1,i="";e;e=(e-1)/26|0)i=String.fromCharCode((e-1)%26+65)+i;return i+(t.r+1)}function cn(t){var e=t.indexOf(":");return-1==e?{s:ln(t),e:ln(t)}:{s:ln(t.slice(0,e)),e:ln(t.slice(e+1))}}function un(t,e){return void 0===e||"number"==typeof e?un(t.s,t.e):("string"!=typeof t&&(t=hn(t)),"string"!=typeof e&&(e=hn(e)),t==e?t:t+":"+e)}function dn(t){var e={s:{c:0,r:0},e:{c:0,r:0}},i=0,n=0,r=0,s=t.length;for(i=0;n<s&&!((r=t.charCodeAt(n)-64)<1||r>26);++n)i=26*i+r;for(e.s.c=--i,i=0;n<s&&!((r=t.charCodeAt(n)-48)<0||r>9);++n)i=10*i+r;if(e.s.r=--i,n===s||10!=r)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,i=0;n!=s&&!((r=t.charCodeAt(n)-64)<1||r>26);++n)i=26*i+r;for(e.e.c=--i,i=0;n!=s&&!((r=t.charCodeAt(n)-48)<0||r>9);++n)i=10*i+r;return e.e.r=--i,e}function fn(t,e){var i="d"==t.t&&e instanceof Date;if(null!=t.z)try{return t.w=Dt(t.z,i?Jt(e):e)}catch(t){}try{return t.w=Dt((t.XF||{}).numFmtId||(i?14:0),i?Jt(e):e)}catch(t){return""+e}}function pn(t,e,i){return null==t||null==t.t||"z"==t.t?"":void 0!==t.w?t.w:("d"==t.t&&!t.z&&i&&i.dateNF&&(t.z=i.dateNF),"e"==t.t?nr[t.v]||t.v:fn(t,null==e?t.v:e))}function gn(t,e){var i=e&&e.sheet?e.sheet:"Sheet1",n={};return n[i]=t,{SheetNames:[i],Sheets:n}}function mn(t,e,i){var n=i||{},r=t?Array.isArray(t):n.dense;null!=R&&null==r&&(r=R);var s=t||(r?[]:{}),a=0,o=0;if(s&&null!=n.origin){if("number"==typeof n.origin)a=n.origin;else{var l="string"==typeof n.origin?ln(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var c=dn(s["!ref"]);h.s.c=c.s.c,h.s.r=c.s.r,h.e.c=Math.max(h.e.c,c.e.c),h.e.r=Math.max(h.e.r,c.e.r),-1==a&&(h.e.r=a=c.e.r+1)}for(var u=0;u!=e.length;++u)if(e[u]){if(!Array.isArray(e[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[u].length;++d)if(void 0!==e[u][d]){var f={v:e[u][d]},p=a+u,g=o+d;if(h.s.r>p&&(h.s.r=p),h.s.c>g&&(h.s.c=g),h.e.r<p&&(h.e.r=p),h.e.c<g&&(h.e.c=g),!e[u][d]||"object"!=typeof e[u][d]||Array.isArray(e[u][d])||e[u][d]instanceof Date)if(Array.isArray(f.v)&&(f.f=e[u][d][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else{if(!n.sheetStubs)continue;f.t="z"}else"number"==typeof f.v?f.t="n":"boolean"==typeof f.v?f.t="b":f.v instanceof Date?(f.z=n.dateNF||nt[14],n.cellDates?(f.t="d",f.w=Dt(f.z,Jt(f.v))):(f.t="n",f.v=Jt(f.v),f.w=Dt(f.z,f.v))):f.t="s";else f=e[u][d];if(r)s[p]||(s[p]=[]),s[p][g]&&s[p][g].z&&(f.z=s[p][g].z),s[p][g]=f;else{var m=hn({c:g,r:p});s[m]&&s[m].z&&(f.z=s[m].z),s[m]=f}}}return h.s.c<1e7&&(s["!ref"]=un(h)),s}function vn(t,e){return mn(null,t,e)}function yn(t,e){return e||(e=qi(4)),e.write_shift(4,t),e}function bn(t){var e=t.read_shift(4);return 0===e?"":t.read_shift(e,"dbcs")}function _n(t,e){var i=!1;return null==e&&(i=!0,e=qi(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),i?e.slice(0,e.l):e}function xn(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function wn(t,e){var i=t.l,n=t.read_shift(1),r=bn(t),s=[],a={t:r,h:r};if(0!=(1&n)){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(xn(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=i+e,a}var Sn=wn;function Tn(t,e){var i=!1;return null==e&&(i=!0,e=qi(23+4*t.t.length)),e.write_shift(1,1),_n(t.t,e),e.write_shift(4,1),function(t,e){e||(e=qi(4)),e.write_shift(2,t.ich||0),e.write_shift(2,t.ifnt||0)}({ich:0,ifnt:0},e),i?e.slice(0,e.l):e}function En(t){var e=t.read_shift(4),i=t.read_shift(2);return i+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:i}}function kn(t,e){return null==e&&(e=qi(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Cn(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Mn(t,e){return null==e&&(e=qi(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var An=bn,On=_n;function Pn(t){var e=t.read_shift(4);return 0===e||4294967295===e?"":t.read_shift(e,"dbcs")}function Rn(t,e){var i=!1;return null==e&&(i=!0,e=qi(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),i?e.slice(0,e.l):e}var In=bn,Ln=Pn,Dn=Rn;function Nn(t){var e=t.slice(t.l,t.l+4),i=1&e[0],n=2&e[0];t.l+=4;var r=0===n?Ri([0,0,0,0,252&e[0],e[1],e[2],e[3]],0):Bi(e,0)>>2;return i?r/100:r}function Fn(t,e){null==e&&(e=qi(4));var i=0,n=0,r=100*t;if(t==(0|t)&&t>=-(1<<29)&&t<1<<29?n=1:r==(0|r)&&r>=-(1<<29)&&r<1<<29&&(n=1,i=1),!n)throw new Error("unsupported RkNumber "+t);e.write_shift(-4,((i?r:t)<<2)+(i+2))}function jn(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Bn=jn,zn=function(t,e){return e||(e=qi(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e};function Wn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Gn(t,e){return(e||qi(8)).write_shift(8,t,"f")}function Un(t,e){if(e||(e=qi(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;null!=t.index?(e.write_shift(1,2),e.write_shift(1,t.index)):null!=t.theme?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var i=t.tint||0;if(i>0?i*=32767:i<0&&(i*=32768),e.write_shift(2,i),t.rgb&&null==t.theme){var n=t.rgb||"FFFFFF";"number"==typeof n&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}else e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);return e}function Hn(t,e){var i=t.read_shift(4);switch(i){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[t.read_shift(4)]||""}if(i>400)throw new Error("Unsupported Clipboard: "+i.toString(16));return t.l-=4,t.read_shift(0,1==e?"lpstr":"lpwstr")}var Xn=2,Vn=3,Yn=12,Kn=80,qn=81,Zn=[Kn,qn],Jn={1:{n:"CodePage",t:Xn},2:{n:"Category",t:Kn},3:{n:"PresentationFormat",t:Kn},4:{n:"ByteCount",t:Vn},5:{n:"LineCount",t:Vn},6:{n:"ParagraphCount",t:Vn},7:{n:"SlideCount",t:Vn},8:{n:"NoteCount",t:Vn},9:{n:"HiddenCount",t:Vn},10:{n:"MultimediaClipCount",t:Vn},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:Kn},15:{n:"Company",t:Kn},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:Vn},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:Vn,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:Kn},27:{n:"ContentStatus",t:Kn},28:{n:"Language",t:Kn},29:{n:"Version",t:Kn},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},$n={1:{n:"CodePage",t:Xn},2:{n:"Title",t:Kn},3:{n:"Subject",t:Kn},4:{n:"Author",t:Kn},5:{n:"Keywords",t:Kn},6:{n:"Comments",t:Kn},7:{n:"Template",t:Kn},8:{n:"LastAuthor",t:Kn},9:{n:"RevNumber",t:Kn},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:Vn},15:{n:"WordCount",t:Vn},16:{n:"CharCount",t:Vn},17:{n:"Thumbnail",t:71},18:{n:"Application",t:Kn},19:{n:"DocSecurity",t:Vn},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Qn={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},tr=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function er(t){return t.map((function(t){return[t>>16&255,t>>8&255,255&t]}))}var ir=le(er([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),nr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},rr={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},sr={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ar={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function or(t,e){var i,n=function(t){for(var e=[],i=Vt(t),n=0;n!==i.length;++n)null==e[t[i[n]]]&&(e[t[i[n]]]=[]),e[t[i[n]]].push(i[n]);return e}(sr),r=[];r[r.length]=ke,r[r.length]=ai("Types",null,{xmlns:ci.CT,"xmlns:xsd":ci.xsd,"xmlns:xsi":ci.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map((function(t){return ai("Default",null,{Extension:t[0],ContentType:t[1]})})));var s=function(n){t[n]&&t[n].length>0&&(i=t[n][0],r[r.length]=ai("Override",null,{PartName:("/"==i[0]?"":"/")+i,ContentType:ar[n][e.bookType]||ar[n].xlsx}))},a=function(i){(t[i]||[]).forEach((function(t){r[r.length]=ai("Override",null,{PartName:("/"==t[0]?"":"/")+t,ContentType:ar[i][e.bookType]||ar[i].xlsx})}))},o=function(e){(t[e]||[]).forEach((function(t){r[r.length]=ai("Override",null,{PartName:("/"==t[0]?"":"/")+t,ContentType:n[e][0]})}))};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var lr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function hr(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function cr(t,e){var i={"!id":{}};if(!t)return i;"/"!==e.charAt(0)&&(e="/"+e);var n={};return(t.match(Ae)||[]).forEach((function(t){var r=Re(t);if("<Relationship"===r[0]){var s={};s.Type=r.Type,s.Target=r.Target,s.Id=r.Id,r.TargetMode&&(s.TargetMode=r.TargetMode);var a="External"===r.TargetMode?r.Target:Ee(r.Target,e);i[a]=s,n[r.Id]=s}})),i["!id"]=n,i}function ur(t){var e=[ke,ai("Relationships",null,{xmlns:ci.RELS})];return Vt(t["!id"]).forEach((function(i){e[e.length]=ai("Relationship",null,t["!id"][i])})),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function dr(t,e,i,n,r,s){if(r||(r={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,r.Id="rId"+e,r.Type=n,r.Target=i,s?r.TargetMode=s:[lr.HLINK,lr.XPATH,lr.XMISS].indexOf(r.Type)>-1&&(r.TargetMode="External"),t["!id"][r.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][r.Id]=r,t[("/"+r.Target).replace("//","/")]=r,e}var fr="application/vnd.oasis.opendocument.spreadsheet";function pr(t,e,i){return['  <rdf:Description rdf:about="'+t+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(i||"odf")+"#"+e+'"/>\n',"  </rdf:Description>\n"].join("")}function gr(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+y.version+"</meta:generator></office:meta></office:document-meta>"}var mr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],vr=function(){for(var t=new Array(mr.length),e=0;e<mr.length;++e){var i=mr[e],n="(?:"+i[0].slice(0,i[0].indexOf(":"))+":)"+i[0].slice(i[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function yr(t){var e={};t=qe(t);for(var i=0;i<mr.length;++i){var n=mr[i],r=t.match(vr[i]);null!=r&&r.length>0&&(e[n[1]]=Ne(r[1])),"date"===n[2]&&e[n[1]]&&(e[n[1]]=ae(e[n[1]]))}return e}function br(t,e,i,n,r){null==r[t]&&null!=e&&""!==e&&(r[t]=e,e=Be(e),n[n.length]=i?ai(t,e,i):ri(t,e))}function _r(t,e){var i=e||{},n=[ke,ai("cp:coreProperties",null,{"xmlns:cp":ci.CORE_PROPS,"xmlns:dc":ci.dc,"xmlns:dcterms":ci.dcterms,"xmlns:dcmitype":ci.dcmitype,"xmlns:xsi":ci.xsi})],r={};if(!t&&!i.Props)return n.join("");t&&(null!=t.CreatedDate&&br("dcterms:created","string"==typeof t.CreatedDate?t.CreatedDate:oi(t.CreatedDate,i.WTF),{"xsi:type":"dcterms:W3CDTF"},n,r),null!=t.ModifiedDate&&br("dcterms:modified","string"==typeof t.ModifiedDate?t.ModifiedDate:oi(t.ModifiedDate,i.WTF),{"xsi:type":"dcterms:W3CDTF"},n,r));for(var s=0;s!=mr.length;++s){var a=mr[s],o=i.Props&&null!=i.Props[a[1]]?i.Props[a[1]]:t?t[a[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&br(a[0],o,null,n,r)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var xr=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],wr=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Sr(t,e,i,n){var r=[];if("string"==typeof t)r=ii(t,n);else for(var s=0;s<t.length;++s)r=r.concat(t[s].map((function(t){return{v:t}})));var a="string"==typeof e?ii(e,n).map((function(t){return t.v})):e,o=0,l=0;if(a.length>0)for(var h=0;h!==r.length;h+=2){switch(l=+r[h+1].v,r[h].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":i.Worksheets=l,i.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":i.NamedRanges=l,i.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":i.Chartsheets=l,i.ChartNames=a.slice(o,o+l)}o+=l}}function Tr(t){var e=[],i=ai;return t||(t={}),t.Application="SheetJS",e[e.length]=ke,e[e.length]=ai("Properties",null,{xmlns:ci.EXT_PROPS,"xmlns:vt":ci.vt}),xr.forEach((function(n){if(void 0!==t[n[1]]){var r;switch(n[2]){case"string":r=Be(String(t[n[1]]));break;case"bool":r=t[n[1]]?"true":"false"}void 0!==r&&(e[e.length]=i(n[0],r))}})),e[e.length]=i("HeadingPairs",i("vt:vector",i("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+i("vt:variant",i("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=i("TitlesOfParts",i("vt:vector",t.SheetNames.map((function(t){return"<vt:lpstr>"+Be(t)+"</vt:lpstr>"})).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Er=/<[^>]+>[^<]*/g;function kr(t){var e=[ke,ai("Properties",null,{xmlns:ci.CUST_PROPS,"xmlns:vt":ci.vt})];if(!t)return e.join("");var i=1;return Vt(t).forEach((function(n){++i,e[e.length]=ai("property",function(t,e){switch(typeof t){case"string":var i=ai("vt:lpwstr",Be(t));return e&&(i=i.replace(/&quot;/g,"_x0022_")),i;case"number":return ai((0|t)==t?"vt:i4":"vt:r8",Be(String(t)));case"boolean":return ai("vt:bool",t?"true":"false")}if(t instanceof Date)return ai("vt:filetime",oi(t));throw new Error("Unable to serialize "+t)}(t[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:i,name:Be(n)})})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Cr,Mr={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Ar(t,e,i){Cr||(Cr=Kt(Mr)),t[e=Cr[e]||e]=i}function Or(t){var e=t.read_shift(4),i=t.read_shift(4);return new Date(1e3*(i/1e7*Math.pow(2,32)+e/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Pr(t,e,i){var n=t.l,r=t.read_shift(0,"lpstr-cp");if(i)for(;t.l-n&3;)++t.l;return r}function Rr(t,e,i){var n=t.read_shift(0,"lpwstr");return i&&(t.l+=4-(n.length+1&3)&3),n}function Ir(t,e,i){return 31===e?Rr(t):Pr(t,0,i)}function Lr(t,e,i){return Ir(t,e,!1===i?0:4)}function Dr(t){var e=t.l,i=jr(t,qn);return 0==t[t.l]&&0==t[t.l+1]&&t.l-e&2&&(t.l+=2),[i,jr(t,Vn)]}function Nr(t,e){for(var i=t.read_shift(4),n={},r=0;r!=i;++r){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,1200===e?"utf16le":"utf8").replace(X,"").replace(V,"!"),1200===e&&a%2&&(t.l+=2)}return 3&t.l&&(t.l=t.l>>3<<2),n}function Fr(t){var e=t.read_shift(4),i=t.slice(t.l,t.l+e);return t.l+=e,(3&e)>0&&(t.l+=4-(3&e)&3),i}function jr(t,e,i){var n,r=t.read_shift(2),s=i||{};if(t.l+=2,e!==Yn&&r!==e&&-1===Zn.indexOf(e)&&(4126!=(65534&e)||4126!=(65534&r)))throw new Error("Expected type "+e+" saw "+r);switch(e===Yn?r:e){case 2:return n=t.read_shift(2,"i"),s.raw||(t.l+=2),n;case 3:return n=t.read_shift(4,"i");case 11:return 0!==t.read_shift(4);case 19:return n=t.read_shift(4);case 30:return Pr(t,0,4).replace(X,"");case 31:return Rr(t);case 64:return Or(t);case 65:return Fr(t);case 71:return function(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}(t);case 80:return Lr(t,r,!s.raw).replace(X,"");case 81:return function(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return Ir(t,e,0)}(t,r).replace(X,"");case 4108:return function(t){for(var e=t.read_shift(4),i=[],n=0;n<e/2;++n)i.push(Dr(t));return i}(t);case 4126:case 4127:return 4127==r?function(t){for(var e=t.read_shift(4),i=[],n=0;n!=e;++n){var r=t.l;i[n]=t.read_shift(0,"lpwstr").replace(X,""),t.l-r&2&&(t.l+=2)}return i}(t):function(t){for(var e=t.read_shift(4),i=[],n=0;n!=e;++n)i[n]=t.read_shift(0,"lpstr-cp").replace(X,"");return i}(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}}function Br(t,e){var i=qi(4),n=qi(4);switch(i.write_shift(4,80==t?31:t),t){case 3:n.write_shift(-4,e);break;case 5:(n=qi(8)).write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=function(t){var e=("string"==typeof t?new Date(Date.parse(t)):t).getTime()/1e3+11644473600,i=e%Math.pow(2,32),n=(e-i)/Math.pow(2,32);n*=1e7;var r=(i*=1e7)/Math.pow(2,32)|0;r>0&&(i%=Math.pow(2,32),n+=r);var s=qi(8);return s.write_shift(4,i),s.write_shift(4,n),s}(e);break;case 31:case 80:for((n=qi(4+2*(e.length+1)+(e.length%2?0:2))).write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return H([i,n])}function zr(t,e){var i=t.l,n=t.read_shift(4),r=t.read_shift(4),s=[],a=0,o=0,l=-1,h={};for(a=0;a!=r;++a){var c=t.read_shift(4),u=t.read_shift(4);s[a]=[c,u+i]}s.sort((function(t,e){return t[1]-e[1]}));var d={};for(a=0;a!=r;++a){if(t.l!==s[a][1]){var f=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,f=!1);break;case 80:case 4108:t.l<=s[a][1]&&(t.l=s[a][1],f=!1)}if((!e||0==a)&&t.l<=s[a][1]&&(f=!1,t.l=s[a][1]),f)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var p=e[s[a][0]];if(d[p.n]=jr(t,p.t,{raw:!0}),"version"===p.p&&(d[p.n]=String(d[p.n]>>16)+"."+("0000"+String(65535&d[p.n])).slice(-4)),"CodePage"==p.n)switch(d[p.n]){case 0:d[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:T(o=d[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[p.n])}}else if(1===s[a][0]){if(o=d.CodePage=jr(t,Xn),T(o),-1!==l){var g=t.l;t.l=s[l][1],h=Nr(t,o),t.l=g}}else if(0===s[a][0]){if(0===o){l=a,t.l=s[a+1][1];continue}h=Nr(t,o)}else{var m,v=h[s[a][0]];switch(t[t.l]){case 65:t.l+=4,m=Fr(t);break;case 30:case 31:t.l+=4,m=Lr(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,m=t.read_shift(4,"i");break;case 19:t.l+=4,m=t.read_shift(4);break;case 5:t.l+=4,m=t.read_shift(8,"f");break;case 11:t.l+=4,m=Yr(t,4);break;case 64:t.l+=4,m=ae(Or(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[v]=m}}return t.l=i+n,d}var Wr=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Gr(t){switch(typeof t){case"boolean":return 11;case"number":return(0|t)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64}return-1}function Ur(t,e,i){var n=qi(8),r=[],s=[],a=8,o=0,l=qi(8),h=qi(8);if(l.write_shift(4,2),l.write_shift(4,1200),h.write_shift(4,1),s.push(l),r.push(h),a+=8+l.length,!e){(h=qi(8)).write_shift(4,0),r.unshift(h);var c=[qi(4)];for(c[0].write_shift(4,t.length),o=0;o<t.length;++o){var u=t[o][0];for((l=qi(8+2*(u.length+1)+(u.length%2?0:2))).write_shift(4,o+2),l.write_shift(4,u.length+1),l.write_shift(0,u,"dbcs");l.l!=l.length;)l.write_shift(1,0);c.push(l)}l=H(c),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if((!e||e[t[o][0]])&&!(Wr.indexOf(t[o][0])>-1||wr.indexOf(t[o][0])>-1)&&null!=t[o][1]){var d=t[o][1],f=0;if(e){var p=i[f=+e[t[o][0]]];if("version"==p.p&&"string"==typeof d){var g=d.split(".");d=(+g[0]<<16)+(+g[1]||0)}l=Br(p.t,d)}else{var m=Gr(d);-1==m&&(m=31,d=String(d)),l=Br(m,d)}s.push(l),(h=qi(8)).write_shift(4,e?f:2+o),r.push(h),a+=8+l.length}var v=8*(s.length+1);for(o=0;o<s.length;++o)r[o].write_shift(4,v),v+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),H([n].concat(r).concat(s))}function Hr(t,e,i){var n=t.content;if(!n)return{};Yi(n,0);var r,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var h=n.read_shift(4),c=n.read_shift(16);if(c!==Gt.utils.consts.HEADER_CLSID&&c!==i)throw new Error("Bad PropertySet CLSID "+c);if(1!==(r=n.read_shift(4))&&2!==r)throw new Error("Unrecognized #Sets: "+r);if(s=n.read_shift(16),o=n.read_shift(4),1===r&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);2===r&&(a=n.read_shift(16),l=n.read_shift(4));var u,d=zr(n,e),f={SystemIdentifier:h};for(var p in d)f[p]=d[p];if(f.FMTID=s,1===r)return f;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);try{u=zr(n,null)}catch(t){}for(p in u)f[p]=u[p];return f.FMTID=[s,a],f}function Xr(t,e,i,n,r,s){var a=qi(r?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Gt.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,r?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,r?68:48);var l=Ur(t,i,n);if(o.push(l),r){var h=Ur(r,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(h)}return H(o)}function Vr(t,e){return t.read_shift(e),null}function Yr(t,e){return 1===t.read_shift(e)}function Kr(t,e){return e||(e=qi(2)),e.write_shift(2,+!!t),e}function qr(t){return t.read_shift(2,"u")}function Zr(t,e){return e||(e=qi(2)),e.write_shift(2,t),e}function Jr(t,e){return function(t,e,i){for(var n=[],r=t.l+e;t.l<r;)n.push(i(t,r-t.l));if(r!==t.l)throw new Error("Slurp error");return n}(t,e,qr)}function $r(t,e,i){return i||(i=qi(2)),i.write_shift(1,"e"==e?+t:+!!t),i.write_shift(1,"e"==e?1:0),i}function Qr(t,e,i){var n=t.read_shift(i&&i.biff>=12?2:1),r="sbcs-cont",s=b;(i&&i.biff>=8&&(b=1200),i&&8!=i.biff)?12==i.biff&&(r="wstr"):t.read_shift(1)&&(r="dbcs-cont");i.biff>=2&&i.biff<=5&&(r="cpstr");var a=n?t.read_shift(n,r):"";return b=s,a}function ts(t){var e=b;b=1200;var i,n=t.read_shift(2),r=t.read_shift(1),s=4&r,a=8&r,o=1+(1&r),l=0,h={};a&&(l=t.read_shift(2)),s&&(i=t.read_shift(4));var c=2==o?"dbcs-cont":"sbcs-cont",u=0===n?"":t.read_shift(n,c);return a&&(t.l+=4*l),s&&(t.l+=i),h.t=u,a||(h.raw="<t>"+h.t+"</t>",h.r=h.t),b=e,h}function es(t){var e=t.t||"",i=qi(3);i.write_shift(2,e.length),i.write_shift(1,1);var n=qi(2*e.length);return n.write_shift(2*e.length,e,"utf16le"),H([i,n])}function is(t,e,i){if(i){if(i.biff>=2&&i.biff<=5)return t.read_shift(e,"cpstr");if(i.biff>=12)return t.read_shift(e,"dbcs-cont")}return 0===t.read_shift(1)?t.read_shift(e,"sbcs-cont"):t.read_shift(e,"dbcs-cont")}function ns(t,e,i){var n=t.read_shift(i&&2==i.biff?1:2);return 0===n?(t.l++,""):is(t,n,i)}function rs(t,e,i){if(i.biff>5)return ns(t,0,i);var n=t.read_shift(1);return 0===n?(t.l++,""):t.read_shift(n,i.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function ss(t,e,i){return i||(i=qi(3+2*t.length)),i.write_shift(2,t.length),i.write_shift(1,1),i.write_shift(31,t,"utf16le"),i}function as(t,e){var i=t.read_shift(16);switch(16,i){case"e0c9ea79f9bace118c8200aa004ba90b":return function(t){var e=t.read_shift(4),i=t.l,n=!1;e>24&&(t.l+=e-24,"795881f43b1d7f48af2c825dc4852763"===t.read_shift(16)&&(n=!0),t.l=i);var r=t.read_shift((n?e-24:e)>>1,"utf16le").replace(X,"");return n&&(t.l+=24),r}(t);case"0303000000000000c000000000000046":return function(t){for(var e=t.read_shift(2),i="";e-- >0;)i+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,57005!=t.read_shift(2))throw new Error("Bad FileMoniker");if(0===t.read_shift(4))return i+n.replace(/\\/g,"/");var r=t.read_shift(4);if(3!=t.read_shift(2))throw new Error("Bad FileMoniker");return i+t.read_shift(r>>1,"utf16le").replace(X,"")}(t);default:throw new Error("Unsupported Moniker "+i)}}function os(t){var e=t.read_shift(4);return e>0?t.read_shift(e,"utf16le").replace(X,""):""}function ls(t,e){e||(e=qi(6+2*t.length)),e.write_shift(4,1+t.length);for(var i=0;i<t.length;++i)e.write_shift(2,t.charCodeAt(i));return e.write_shift(2,0),e}function hs(t){var e=qi(512),i=0,n=t.Target;"file://"==n.slice(0,7)&&(n=n.slice(7));var r=n.indexOf("#"),s=r>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(i=0;i<a.length;++i)e.write_shift(4,a[i]);if(28==s)ls(n=n.slice(1),e);else if(2&s){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<a.length;++i)e.write_shift(1,parseInt(a[i],16));var o=r>-1?n.slice(0,r):n;for(e.write_shift(4,2*(o.length+1)),i=0;i<o.length;++i)e.write_shift(2,o.charCodeAt(i));e.write_shift(2,0),8&s&&ls(r>-1?n.slice(r+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),i=0;i<a.length;++i)e.write_shift(1,parseInt(a[i],16));for(var l=0;"../"==n.slice(3*l,3*l+3)||"..\\"==n.slice(3*l,3*l+3);)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),i=0;i<n.length-3*l;++i)e.write_shift(1,255&n.charCodeAt(i+3*l));for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),i=0;i<6;++i)e.write_shift(4,0)}return e.slice(0,e.l)}function cs(t){return[t.read_shift(1),t.read_shift(1),t.read_shift(1),t.read_shift(1)]}function us(t,e){var i=cs(t);return i[3]=0,i}function ds(t){return{r:t.read_shift(2),c:t.read_shift(2),ixfe:t.read_shift(2)}}function fs(t,e,i,n){return n||(n=qi(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,i||0),n}function ps(t,e,i){var n=i.biff>8?4:2;return[t.read_shift(n),t.read_shift(n,"i"),t.read_shift(n,"i")]}function gs(t){return[t.read_shift(2),Nn(t)]}function ms(t){var e=t.read_shift(2),i=t.read_shift(2);return{s:{c:t.read_shift(2),r:e},e:{c:t.read_shift(2),r:i}}}function vs(t,e){return e||(e=qi(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function ys(t){var e=t.read_shift(2),i=t.read_shift(2);return{s:{c:t.read_shift(1),r:e},e:{c:t.read_shift(1),r:i}}}var bs=ys;function _s(t){t.l+=4;var e=t.read_shift(2),i=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[i,e,n]}function xs(t){t.l+=2,t.l+=t.read_shift(2)}var ws={0:xs,4:xs,5:xs,6:xs,7:function(t){return t.l+=4,t.cf=t.read_shift(2),{}},8:xs,9:xs,10:xs,11:xs,12:xs,13:function(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e},14:xs,15:xs,16:xs,17:xs,18:xs,19:xs,20:xs,21:_s};function Ss(t,e){var i={BIFFVer:0,dt:0};switch(i.BIFFVer=t.read_shift(2),(e-=2)>=2&&(i.dt=t.read_shift(2),t.l-=2),i.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+i.BIFFVer)}return t.read_shift(e),i}function Ts(t,e,i){var n=1536,r=16;switch(i.bookType){case"biff8":case"xla":break;case"biff5":n=1280,r=8;break;case"biff4":n=4,r=6;break;case"biff3":n=3,r=6;break;case"biff2":n=2,r=4;break;default:throw new Error("unsupported BIFF version")}var s=qi(r);return s.write_shift(2,n),s.write_shift(2,e),r>4&&s.write_shift(2,29282),r>6&&s.write_shift(2,1997),r>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Es(t,e){var i=!e||e.biff>=8?2:1,n=qi(8+i*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(i*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var r=n.slice(0,n.l);return r.l=n.l,r}function ks(t,e,i){var n=0;i&&2==i.biff||(n=t.read_shift(2));var r=t.read_shift(2);return i&&2==i.biff&&(n=1-(r>>15),r&=32767),[{Unsynced:1&n,DyZero:(2&n)>>1,ExAsc:(4&n)>>2,ExDsc:(8&n)>>3},r]}function Cs(t,e,i,n){var r=i&&5==i.biff;n||(n=qi(r?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(r?1:2,e.length),r||n.write_shift(1,1),n.write_shift((r?1:2)*e.length,e,r?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return null==s.l&&(s.l=s.length),s}var Ms=rs;function As(t,e,i){var n=t.l+e,r=8!=i.biff&&i.biff?2:4,s=t.read_shift(r),a=t.read_shift(r),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function Os(t,e,i,n){var r=i&&5==i.biff;n||(n=qi(r?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&r&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),r||n.write_shift(4,0),n.write_shift(2,0),n}function Ps(t,e,i){var n=ds(t);2!=i.biff&&9!=e||++t.l;var r=function(t){var e=t.read_shift(1);return 1===t.read_shift(1)?e:1===e}(t);return n.val=r,n.t=!0===r||!1===r?"b":"e",n}var Rs=function(t,e,i){return 0===e?"":rs(t,0,i)};function Is(t,e,i){var n,r=t.read_shift(2),s={fBuiltIn:1&r,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return 14849===i.sbcch&&(n=function(t,e,i){t.l+=4,e-=4;var n=t.l+e,r=Qr(t,0,i),s=t.read_shift(2);if(s!==(n-=t.l))throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,r}(t,e-2,i)),s.body=n||t.read_shift(e-2),"string"==typeof n&&(s.Name=n),s}var Ls=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Ds(t,e,i){var n=t.l+e,r=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(i&&2==i.biff?1:2),l=0;(!i||i.biff>=5)&&(5!=i.biff&&(t.l+=2),l=t.read_shift(2),5==i.biff&&(t.l+=2),t.l+=4);var h=is(t,a,i);32&r&&(h=Ls[h.charCodeAt(0)]);var c=n-t.l;i&&2==i.biff&&--c;var u=n!=t.l&&0!==o&&c>0?function(t,e,i,n){var r,s=t.l+e,a=tl(t,n,i);s!==t.l&&(r=Qo(t,s-t.l,a,i));return[a,r]}(t,c,i,o):[];return{chKey:s,Name:h,itab:l,rgce:u}}function Ns(t,e,i){if(i.biff<8)return function(t,e,i){3==t[t.l+1]&&t[t.l]++;var n=Qr(t,0,i);return 3==n.charCodeAt(0)?n.slice(1):n}(t,0,i);for(var n=[],r=t.l+e,s=t.read_shift(i.biff>8?4:2);0!=s--;)n.push(ps(t,i.biff,i));if(t.l!=r)throw new Error("Bad ExternSheet: "+t.l+" != "+r);return n}function Fs(t,e,i){var n=bs(t,6);switch(i.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,al(t,e,i)]}var js={8:function(t,e){var i=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var r=t.read_shift(1);return t.l+=r,t.l=i,{fmt:n}}};function Bs(t){var e=qi(24),i=ln(t[0]);e.write_shift(2,i.r),e.write_shift(2,i.r),e.write_shift(2,i.c),e.write_shift(2,i.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)e.write_shift(1,parseInt(n[r],16));return H([e,hs(t[1])])}function zs(t){var e=t[1].Tooltip,i=qi(10+2*(e.length+1));i.write_shift(2,2048);var n=ln(t[0]);i.write_shift(2,n.r),i.write_shift(2,n.r),i.write_shift(2,n.c),i.write_shift(2,n.c);for(var r=0;r<e.length;++r)i.write_shift(2,e.charCodeAt(r));return i.write_shift(2,0),i}function Ws(t,e,i){if(!i.cellStyles)return Ki(t,e);var n=i&&i.biff>=12?4:2,r=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);2==n&&(t.l+=2);var h={s:r,e:s,w:a,ixfe:o,flags:l};return(i.biff>=5||!i.biff)&&(h.level=l>>8&7),h}var Gs=ds,Us=Jr,Hs=ns;var Xs=[2,3,48,49,131,139,140,245],Vs=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Kt({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function i(e,i){var n=i||{};n.dateNF||(n.dateNF="yyyymmdd");var r=vn(function(e,i){var n=[],r=j(1);switch(i.type){case"base64":r=z(D(e));break;case"binary":r=z(e);break;case"buffer":case"array":r=e}Yi(r,0);var s=r.read_shift(1),a=!!(136&s),o=!1,l=!1;switch(s){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,a=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+s.toString(16))}var h=0,c=521;2==s&&(h=r.read_shift(2)),r.l+=3,2!=s&&(h=r.read_shift(4)),h>1048576&&(h=1e6),2!=s&&(c=r.read_shift(2));var u=r.read_shift(2),d=i.codepage||1252;2!=s&&(r.l+=16,r.read_shift(1),0!==r[r.l]&&(d=t[r[r.l]]),r.l+=1,r.l+=2),l&&(r.l+=36);for(var f=[],p={},g=Math.min(r.length,2==s?521:c-10-(o?264:0)),m=l?32:11;r.l<g&&13!=r[r.l];)switch((p={}).name=M.utils.decode(d,r.slice(r.l,r.l+m)).replace(/[\u0000\r\n].*$/g,""),r.l+=m,p.type=String.fromCharCode(r.read_shift(1)),2==s||l||(p.offset=r.read_shift(4)),p.len=r.read_shift(1),2==s&&(p.offset=r.read_shift(2)),p.dec=r.read_shift(1),p.name.length&&f.push(p),2!=s&&(r.l+=l?13:14),p.type){case"B":o&&8==p.len||!i.WTF||console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":i.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==r[r.l]&&(r.l=c-1),13!==r.read_shift(1))throw new Error("DBF Terminator not found "+r.l+" "+r[r.l]);r.l=c;var v=0,y=0;for(n[0]=[],y=0;y!=f.length;++y)n[0][y]=f[y].name;for(;h-- >0;)if(42!==r[r.l])for(++r.l,n[++v]=[],y=0,y=0;y!=f.length;++y){var b=r.slice(r.l,r.l+f[y].len);r.l+=f[y].len,Yi(b,0);var _=M.utils.decode(d,b);switch(f[y].type){case"C":_.trim().length&&(n[v][y]=_.replace(/\s+$/,""));break;case"D":8===_.length?n[v][y]=new Date(+_.slice(0,4),+_.slice(4,6)-1,+_.slice(6,8)):n[v][y]=_;break;case"F":n[v][y]=parseFloat(_.trim());break;case"+":case"I":n[v][y]=l?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(_.trim().toUpperCase()){case"Y":case"T":n[v][y]=!0;break;case"N":case"F":n[v][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+_+"|")}break;case"M":if(!a)throw new Error("DBF Unexpected MEMO for type "+s.toString(16));n[v][y]="##MEMO##"+(l?parseInt(_.trim(),10):b.read_shift(4));break;case"N":(_=_.replace(/\u0000/g,"").trim())&&"."!=_&&(n[v][y]=+_||0);break;case"@":n[v][y]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":n[v][y]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":n[v][y]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":n[v][y]=-b.read_shift(-8,"f");break;case"B":if(o&&8==f[y].len){n[v][y]=b.read_shift(8,"f");break}case"G":case"P":b.l+=f[y].len;break;case"0":if("_NullFlags"===f[y].name)break;default:throw new Error("DBF Unsupported data type "+f[y].type)}}else r.l+=u;if(2!=s&&r.l<r.length&&26!=r[r.l++])throw new Error("DBF EOF Marker missing "+(r.l-1)+" of "+r.length+" "+r[r.l-1].toString(16));return i&&i.sheetRows&&(n=n.slice(0,i.sheetRows)),i.DBF=f,n}(e,n),n);return r["!cols"]=n.DBF.map((function(t){return{wch:t.len,DBF:t}})),delete n.DBF,r}var n={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(t,e){try{return gn(i(t,e),e)}catch(t){if(e&&e.WTF)throw t}return{SheetNames:[],Sheets:{}}},to_sheet:i,from_sheet:function(t,i){var r=i||{};if(+r.codepage>=0&&T(+r.codepage),"string"==r.type)throw new Error("Cannot write DBF to JS string");var s=Ji(),a=Au(t,{header:1,raw:!0,cellDates:!0}),o=a[0],l=a.slice(1),h=t["!cols"]||[],c=0,u=0,d=0,f=1;for(c=0;c<o.length;++c)if(((h[c]||{}).DBF||{}).name)o[c]=h[c].DBF.name,++d;else if(null!=o[c]){if(++d,"number"==typeof o[c]&&(o[c]=o[c].toString(10)),"string"!=typeof o[c])throw new Error("DBF Invalid column name "+o[c]+" |"+typeof o[c]+"|");if(o.indexOf(o[c])!==c)for(u=0;u<1024;++u)if(-1==o.indexOf(o[c]+"_"+u)){o[c]+="_"+u;break}}var p=dn(t["!ref"]),g=[],m=[],v=[];for(c=0;c<=p.e.c-p.s.c;++c){var y="",b="",x=0,w=[];for(u=0;u<l.length;++u)null!=l[u][c]&&w.push(l[u][c]);if(0!=w.length&&null!=o[c]){for(u=0;u<w.length;++u){switch(typeof w[u]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=w[u]instanceof Date?"D":"C"}x=Math.max(x,String(w[u]).length),y=y&&y!=b?"C":b}x>250&&(x=250),"C"==(b=((h[c]||{}).DBF||{}).type)&&h[c].DBF.len>x&&(x=h[c].DBF.len),"B"==y&&"N"==b&&(y="N",v[c]=h[c].DBF.dec,x=h[c].DBF.len),m[c]="C"==y||"N"==b?x:n[y]||0,f+=m[c],g[c]=y}else g[c]="?"}var S=s.next(32);for(S.write_shift(4,318902576),S.write_shift(4,l.length),S.write_shift(2,296+32*d),S.write_shift(2,f),c=0;c<4;++c)S.write_shift(4,0);for(S.write_shift(4,0|(+e[_]||3)<<8),c=0,u=0;c<o.length;++c)if(null!=o[c]){var E=s.next(32),k=(o[c].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);E.write_shift(1,k,"sbcs"),E.write_shift(1,"?"==g[c]?"C":g[c],"sbcs"),E.write_shift(4,u),E.write_shift(1,m[c]||n[g[c]]||0),E.write_shift(1,v[c]||0),E.write_shift(1,2),E.write_shift(4,0),E.write_shift(1,0),E.write_shift(4,0),E.write_shift(4,0),u+=m[c]||n[g[c]]||0}var C=s.next(264);for(C.write_shift(4,13),c=0;c<65;++c)C.write_shift(4,0);for(c=0;c<l.length;++c){var M=s.next(f);for(M.write_shift(1,0),u=0;u<o.length;++u)if(null!=o[u])switch(g[u]){case"L":M.write_shift(1,null==l[c][u]?63:l[c][u]?84:70);break;case"B":M.write_shift(8,l[c][u]||0,"f");break;case"N":var A="0";for("number"==typeof l[c][u]&&(A=l[c][u].toFixed(v[u]||0)),d=0;d<m[u]-A.length;++d)M.write_shift(1,32);M.write_shift(1,A,"sbcs");break;case"D":l[c][u]?(M.write_shift(4,("0000"+l[c][u].getFullYear()).slice(-4),"sbcs"),M.write_shift(2,("00"+(l[c][u].getMonth()+1)).slice(-2),"sbcs"),M.write_shift(2,("00"+l[c][u].getDate()).slice(-2),"sbcs")):M.write_shift(8,"00000000","sbcs");break;case"C":var O=String(null!=l[c][u]?l[c][u]:"").slice(0,m[u]);for(M.write_shift(1,O,"sbcs"),d=0;d<m[u]-O.length;++d)M.write_shift(1,32)}}return s.next(1).write_shift(1,26),s.end()}}}(),Ys=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("N("+Vt(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),i=function(e,i){var n=t[i];return"number"==typeof n?P(n):n},n=function(t,e,i){var n=e.charCodeAt(0)-32<<4|i.charCodeAt(0)-48;return 59==n?t:P(n)};function r(t,r){var s,a=t.split(/[\n\r]+/),o=-1,l=-1,h=0,c=0,u=[],d=[],f=null,p={},g=[],m=[],v=[],y=0;for(+r.codepage>=0&&T(+r.codepage);h!==a.length;++h){y=0;var b,_=a[h].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,i),x=_.replace(/;;/g,"\0").split(";").map((function(t){return t.replace(/\u0000/g,";")})),w=x[0];if(_.length>0)switch(w){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==x[1].charAt(0)&&d.push(_.slice(3).replace(/;;/g,";"));break;case"C":var S=!1,E=!1,k=!1,C=!1,A=-1,O=-1;for(c=1;c<x.length;++c)switch(x[c].charAt(0)){case"A":case"G":break;case"X":l=parseInt(x[c].slice(1))-1,E=!0;break;case"Y":for(o=parseInt(x[c].slice(1))-1,E||(l=0),s=u.length;s<=o;++s)u[s]=[];break;case"K":'"'===(b=x[c].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN(ce(b))?isNaN(de(b).getDate())||(b=ae(b)):(b=ce(b),null!==f&&Pt(f)&&(b=ee(b))),void 0!==M&&"string"==typeof b&&"string"!=(r||{}).type&&(r||{}).codepage&&(b=M.utils.decode(r.codepage,b)),S=!0;break;case"E":C=!0;var P=Mo(x[c].slice(1),{r:o,c:l});u[o][l]=[u[o][l],P];break;case"S":k=!0,u[o][l]=[u[o][l],"S5S"];break;case"R":A=parseInt(x[c].slice(1))-1;break;case"C":O=parseInt(x[c].slice(1))-1;break;default:if(r&&r.WTF)throw new Error("SYLK bad record "+_)}if(S&&(u[o][l]&&2==u[o][l].length?u[o][l][0]=b:u[o][l]=b,f=null),k){if(C)throw new Error("SYLK shared formula cannot have own formula");var R=A>-1&&u[A][O];if(!R||!R[1])throw new Error("SYLK shared formula cannot find base");u[o][l][1]=Po(R[1],{r:o-A,c:l-O})}break;case"F":var I=0;for(c=1;c<x.length;++c)switch(x[c].charAt(0)){case"X":l=parseInt(x[c].slice(1))-1,++I;break;case"Y":for(o=parseInt(x[c].slice(1))-1,s=u.length;s<=o;++s)u[s]=[];break;case"M":y=parseInt(x[c].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=d[parseInt(x[c].slice(1))];break;case"W":for(v=x[c].slice(1).split(" "),s=parseInt(v[0],10);s<=parseInt(v[1],10);++s)y=parseInt(v[2],10),m[s-1]=0===y?{hidden:!0}:{wch:y},Na(m[s-1]);break;case"C":m[l=parseInt(x[c].slice(1))-1]||(m[l]={});break;case"R":g[o=parseInt(x[c].slice(1))-1]||(g[o]={}),y>0?(g[o].hpt=y,g[o].hpx=Ba(y)):0===y&&(g[o].hidden=!0);break;default:if(r&&r.WTF)throw new Error("SYLK bad record "+_)}I<1&&(f=null);break;default:if(r&&r.WTF)throw new Error("SYLK bad record "+_)}}return g.length>0&&(p["!rows"]=g),m.length>0&&(p["!cols"]=m),r&&r.sheetRows&&(u=u.slice(0,r.sheetRows)),[u,p]}function s(t,e){var i=function(t,e){switch(e.type){case"base64":return r(D(t),e);case"binary":return r(t,e);case"buffer":return r(N&&Buffer.isBuffer(t)?t.toString("binary"):G(t),e);case"array":return r(oe(t),e)}throw new Error("Unrecognized type "+e.type)}(t,e),n=i[0],s=i[1],a=vn(n,e);return Vt(s).forEach((function(t){a[t]=s[t]})),a}function a(t,e,i,n){var r="C;Y"+(i+1)+";X"+(n+1)+";K";switch(t.t){case"n":r+=t.v||0,t.f&&!t.F&&(r+=";E"+Oo(t.f,{r:i,c:n}));break;case"b":r+=t.v?"TRUE":"FALSE";break;case"e":r+=t.w||t.v;break;case"d":r+='"'+(t.w||t.v)+'"';break;case"s":r+='"'+t.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return r}return t["|"]=254,{to_workbook:function(t,e){return gn(s(t,e),e)},to_sheet:s,from_sheet:function(t,e){var i,n,r=["ID;PWXL;N;E"],s=[],o=dn(t["!ref"]),l=Array.isArray(t),h="\r\n";r.push("P;PGeneral"),r.push("F;P0;DG0G8;M255"),t["!cols"]&&(n=r,t["!cols"].forEach((function(t,e){var i="F;W"+(e+1)+" "+(e+1)+" ";t.hidden?i+="0":("number"!=typeof t.width||t.wpx||(t.wpx=Pa(t.width)),"number"!=typeof t.wpx||t.wch||(t.wch=Ra(t.wpx)),"number"==typeof t.wch&&(i+=Math.round(t.wch)))," "!=i.charAt(i.length-1)&&n.push(i)}))),t["!rows"]&&function(t,e){e.forEach((function(e,i){var n="F;";e.hidden?n+="M0;":e.hpt?n+="M"+20*e.hpt+";":e.hpx&&(n+="M"+20*ja(e.hpx)+";"),n.length>2&&t.push(n+"R"+(i+1))}))}(r,t["!rows"]),r.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=hn({r:c,c:u});(i=l?(t[c]||[])[u]:t[d])&&(null!=i.v||i.f&&!i.F)&&s.push(a(i,0,c,u))}return r.join(h)+h+s.join(h)+h+"E"+h}}}(),Ks=function(){function t(t,e){for(var i=t.split("\n"),n=-1,r=-1,s=0,a=[];s!==i.length;++s)if("BOT"!==i[s].trim()){if(!(n<0)){for(var o=i[s].trim().split(","),l=o[0],h=o[1],c=i[++s]||"";1&(c.match(/["]/g)||[]).length&&s<i.length-1;)c+="\n"+i[++s];switch(c=c.trim(),+l){case-1:if("BOT"===c){a[++n]=[],r=0;continue}if("EOD"!==c)throw new Error("Unrecognized DIF special command "+c);break;case 0:"TRUE"===c?a[n][r]=!0:"FALSE"===c?a[n][r]=!1:isNaN(ce(h))?isNaN(de(h).getDate())?a[n][r]=h:a[n][r]=ae(h):a[n][r]=ce(h),++r;break;case 1:(c=(c=c.slice(1,c.length-1)).replace(/""/g,'"'))&&c.match(/^=".*"$/)&&(c=c.slice(2,-1)),a[n][r++]=""!==c?c:null}if("EOD"===c)break}}else a[++n]=[],r=0;return e&&e.sheetRows&&(a=a.slice(0,e.sheetRows)),a}function e(e,i){return vn(function(e,i){switch(i.type){case"base64":return t(D(e),i);case"binary":return t(e,i);case"buffer":return t(N&&Buffer.isBuffer(e)?e.toString("binary"):G(e),i);case"array":return t(oe(e),i)}throw new Error("Unrecognized type "+i.type)}(e,i),i)}return{to_workbook:function(t,i){return gn(e(t,i),i)},to_sheet:e,from_sheet:function(){var t=function(t,e,i,n,r){t.push(e),t.push(i+","+n),t.push('"'+r.replace(/"/g,'""')+'"')},e=function(t,e,i,n){t.push(e+","+i),t.push(1==e?'"'+n.replace(/"/g,'""')+'"':n)};return function(i){var n,r=[],s=dn(i["!ref"]),a=Array.isArray(i);t(r,"TABLE",0,1,"sheetjs"),t(r,"VECTORS",0,s.e.r-s.s.r+1,""),t(r,"TUPLES",0,s.e.c-s.s.c+1,""),t(r,"DATA",0,0,"");for(var o=s.s.r;o<=s.e.r;++o){e(r,-1,0,"BOT");for(var l=s.s.c;l<=s.e.c;++l){var h=hn({r:o,c:l});if(n=a?(i[o]||[])[l]:i[h])switch(n.t){case"n":var c=n.w;c||null==n.v||(c=n.v),null==c?n.f&&!n.F?e(r,1,0,"="+n.f):e(r,1,0,""):e(r,0,c,"V");break;case"b":e(r,0,n.v?1:0,n.v?"TRUE":"FALSE");break;case"s":e(r,1,0,isNaN(n.v)?n.v:'="'+n.v+'"');break;case"d":n.w||(n.w=Dt(n.z||nt[14],Jt(ae(n.v)))),e(r,0,n.w,"V");break;default:e(r,1,0,"")}else e(r,1,0,"")}}e(r,-1,0,"EOD");return r.join("\r\n")}}()}}(),qs=function(){function t(t){return t.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(t,e){return vn(function(t,e){for(var i=t.split("\n"),n=-1,r=-1,s=0,a=[];s!==i.length;++s){var o=i[s].trim().split(":");if("cell"===o[0]){var l=ln(o[1]);if(a.length<=l.r)for(n=a.length;n<=l.r;++n)a[n]||(a[n]=[]);switch(n=l.r,r=l.c,o[2]){case"t":a[n][r]=o[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":a[n][r]=+o[3];break;case"vtf":var h=o[o.length-1];case"vtc":"nl"===o[3]?a[n][r]=!!+o[4]:a[n][r]=+o[4],"vtf"==o[2]&&(a[n][r]=[a[n][r],h])}}}return e&&e.sheetRows&&(a=a.slice(0,e.sheetRows)),a}(t,e),e)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),n=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",r=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),s="--SocialCalcSpreadsheetControlSave--";function a(e){if(!e||!e["!ref"])return"";for(var i,n=[],r=[],s="",a=cn(e["!ref"]),o=Array.isArray(e),l=a.s.r;l<=a.e.r;++l)for(var h=a.s.c;h<=a.e.c;++h)if(s=hn({r:l,c:h}),(i=o?(e[l]||[])[h]:e[s])&&null!=i.v&&"z"!==i.t){switch(r=["cell",s,"t"],i.t){case"s":case"str":r.push(t(i.v));break;case"n":i.f?(r[2]="vtf",r[3]="n",r[4]=i.v,r[5]=t(i.f)):(r[2]="v",r[3]=i.v);break;case"b":r[2]="vt"+(i.f?"f":"c"),r[3]="nl",r[4]=i.v?"1":"0",r[5]=t(i.f||(i.v?"TRUE":"FALSE"));break;case"d":var c=Jt(ae(i.v));r[2]="vtc",r[3]="nd",r[4]=""+c,r[5]=i.w||Dt(i.z||nt[14],c);break;case"e":continue}n.push(r.join(":"))}return n.push("sheet:c:"+(a.e.c-a.s.c+1)+":r:"+(a.e.r-a.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}return{to_workbook:function(t,i){return gn(e(t,i),i)},to_sheet:e,from_sheet:function(t){return[i,n,r,n,a(t),s].join("\n")}}}(),Zs=function(){function t(t,e,i,n,r){r.raw?e[i][n]=t:""===t||("TRUE"===t?e[i][n]=!0:"FALSE"===t?e[i][n]=!1:isNaN(ce(t))?isNaN(de(t).getDate())?e[i][n]=t:e[i][n]=ae(t):e[i][n]=ce(t))}var e={44:",",9:"\t",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function n(t){for(var n={},r=!1,s=0,a=0;s<t.length;++s)34==(a=t.charCodeAt(s))?r=!r:!r&&a in e&&(n[a]=(n[a]||0)+1);for(s in a=[],n)Object.prototype.hasOwnProperty.call(n,s)&&a.push([n[s],s]);if(!a.length)for(s in n=i)Object.prototype.hasOwnProperty.call(n,s)&&a.push([n[s],s]);return a.sort((function(t,e){return t[0]-e[0]||i[t[1]]-i[e[1]]})),e[a.pop()[1]]||44}function r(t,e){var i=e||{},r="";null!=R&&null==i.dense&&(i.dense=R);var s=i.dense?[]:{},a={s:{c:0,r:0},e:{c:0,r:0}};"sep="==t.slice(0,4)?13==t.charCodeAt(5)&&10==t.charCodeAt(6)?(r=t.charAt(4),t=t.slice(7)):13==t.charCodeAt(5)||10==t.charCodeAt(5)?(r=t.charAt(4),t=t.slice(6)):r=n(t.slice(0,1024)):r=i&&i.FS?i.FS:n(t.slice(0,1024));var o=0,l=0,h=0,c=0,u=0,d=r.charCodeAt(0),f=!1,p=0,g=t.charCodeAt(0);t=t.replace(/\r\n/gm,"\n");var m,v,y=null!=i.dateNF?(m=i.dateNF,v=(v="number"==typeof m?nt[m]:m).replace(zt,"(\\d+)"),new RegExp("^"+v+"$")):null;function b(){var e=t.slice(c,u),n={};if('"'==e.charAt(0)&&'"'==e.charAt(e.length-1)&&(e=e.slice(1,-1).replace(/""/g,'"')),0===e.length)n.t="z";else if(i.raw)n.t="s",n.v=e;else if(0===e.trim().length)n.t="s",n.v=e;else if(61==e.charCodeAt(0))34==e.charCodeAt(1)&&34==e.charCodeAt(e.length-1)?(n.t="s",n.v=e.slice(2,-1).replace(/""/g,'"')):1!=e.length?(n.t="n",n.f=e.slice(1)):(n.t="s",n.v=e);else if("TRUE"==e)n.t="b",n.v=!0;else if("FALSE"==e)n.t="b",n.v=!1;else if(isNaN(h=ce(e)))if(!isNaN(de(e).getDate())||y&&e.match(y)){n.z=i.dateNF||nt[14];var r=0;y&&e.match(y)&&(e=function(t,e,i){var n=-1,r=-1,s=-1,a=-1,o=-1,l=-1;(e.match(zt)||[]).forEach((function(t,e){var h=parseInt(i[e+1],10);switch(t.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":a=h;break;case"s":l=h;break;case"m":a>=0?o=h:r=h}})),l>=0&&-1==o&&r>=0&&(o=r,r=-1);var h=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);7==h.length&&(h="0"+h),8==h.length&&(h="20"+h);var c=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==a&&-1==o&&-1==l?h:-1==n&&-1==r&&-1==s?c:h+"T"+c}(0,i.dateNF,e.match(y)||[]),r=1),i.cellDates?(n.t="d",n.v=ae(e,r)):(n.t="n",n.v=Jt(ae(e,r))),!1!==i.cellText&&(n.w=Dt(n.z,n.v instanceof Date?Jt(n.v):n.v)),i.cellNF||delete n.z}else n.t="s",n.v=e;else n.t="n",!1!==i.cellText&&(n.w=e),n.v=h;if("z"==n.t||(i.dense?(s[o]||(s[o]=[]),s[o][l]=n):s[hn({c:l,r:o})]=n),c=u+1,g=t.charCodeAt(c),a.e.c<l&&(a.e.c=l),a.e.r<o&&(a.e.r=o),p==d)++l;else if(l=0,++o,i.sheetRows&&i.sheetRows<=o)return!0}t:for(;u<t.length;++u)switch(p=t.charCodeAt(u)){case 34:34===g&&(f=!f);break;case d:case 10:case 13:if(!f&&b())break t}return u-c>0&&b(),s["!ref"]=un(a),s}function s(e,i){return i&&i.PRN?i.FS||"sep="==e.slice(0,4)||e.indexOf("\t")>=0||e.indexOf(",")>=0||e.indexOf(";")>=0?r(e,i):vn(function(e,i){var n=i||{},r=[];if(!e||0===e.length)return r;for(var s=e.split(/[\r\n]/),a=s.length-1;a>=0&&0===s[a].length;)--a;for(var o=10,l=0,h=0;h<=a;++h)-1==(l=s[h].indexOf(" "))?l=s[h].length:l++,o=Math.max(o,l);for(h=0;h<=a;++h){r[h]=[];var c=0;for(t(s[h].slice(0,o).trim(),r,h,c,n),c=1;c<=(s[h].length-o)/10+1;++c)t(s[h].slice(o+10*(c-1),o+10*c).trim(),r,h,c,n)}return n.sheetRows&&(r=r.slice(0,n.sheetRows)),r}(e,i),i):r(e,i)}function a(t,e){var i="",n="string"==e.type?[0,0,0,0]:yu(t,e);switch(e.type){case"base64":i=D(t);break;case"binary":case"string":i=t;break;case"buffer":i=65001==e.codepage?t.toString("utf8"):e.codepage&&void 0!==M?M.utils.decode(e.codepage,t):N&&Buffer.isBuffer(t)?t.toString("binary"):G(t);break;case"array":i=oe(t);break;default:throw new Error("Unrecognized type "+e.type)}return 239==n[0]&&187==n[1]&&191==n[2]?i=qe(i.slice(3)):"string"!=e.type&&"buffer"!=e.type&&65001==e.codepage?i=qe(i):"binary"==e.type&&void 0!==M&&e.codepage&&(i=M.utils.decode(e.codepage,M.utils.encode(28591,i))),"socialcalc:version:"==i.slice(0,19)?qs.to_sheet("string"==e.type?i:qe(i),e):s(i,e)}return{to_workbook:function(t,e){return gn(a(t,e),e)},to_sheet:a,from_sheet:function(t){for(var e,i=[],n=dn(t["!ref"]),r=Array.isArray(t),s=n.s.r;s<=n.e.r;++s){for(var a=[],o=n.s.c;o<=n.e.c;++o){var l=hn({r:s,c:o});if((e=r?(t[s]||[])[o]:t[l])&&null!=e.v){for(var h=(e.w||(pn(e),e.w)||"").slice(0,10);h.length<10;)h+=" ";a.push(h+(0===o?" ":""))}else a.push("          ")}i.push(a.join(""))}return i.join("\n")}}}();var Js=function(){function t(t,e,i){if(t){Yi(t,t.l||0);for(var n=i.Enum||v;t.l<t.length;){var r=t.read_shift(2),s=n[r]||n[65535],a=t.read_shift(2),o=t.l+a,l=s.f&&s.f(t,a,i);if(t.l=o,e(l,s,r))return}}}function e(e,i){if(!e)return e;var n=i||{};null!=R&&null==n.dense&&(n.dense=R);var r=n.dense?[]:{},s="Sheet1",a="",o=0,l={},h=[],c=[],u={s:{r:0,c:0},e:{r:0,c:0}},d=n.sheetRows||0;if(0==e[2]&&(8==e[3]||9==e[3])&&e.length>=16&&5==e[14]&&108===e[15])throw new Error("Unsupported Works 3 for Mac file");if(2==e[2])n.Enum=v,t(e,(function(t,e,i){switch(i){case 0:n.vers=t,t>=4096&&(n.qpro=!0);break;case 6:u=t;break;case 204:t&&(a=t);break;case 222:a=t;break;case 15:case 51:n.qpro||(t[1].v=t[1].v.slice(1));case 13:case 14:case 16:14==i&&112==(112&t[2])&&(15&t[2])>1&&(15&t[2])<15&&(t[1].z=n.dateNF||nt[14],n.cellDates&&(t[1].t="d",t[1].v=ee(t[1].v))),n.qpro&&t[3]>o&&(r["!ref"]=un(u),l[s]=r,h.push(s),r=n.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},o=t[3],s=a||"Sheet"+(o+1),a="");var c=n.dense?(r[t[0].r]||[])[t[0].c]:r[hn(t[0])];if(c){c.t=t[1].t,c.v=t[1].v,null!=t[1].z&&(c.z=t[1].z),null!=t[1].f&&(c.f=t[1].f);break}n.dense?(r[t[0].r]||(r[t[0].r]=[]),r[t[0].r][t[0].c]=t[1]):r[hn(t[0])]=t[1]}}),n);else{if(26!=e[2]&&14!=e[2])throw new Error("Unrecognized LOTUS BOF "+e[2]);n.Enum=y,14==e[2]&&(n.qpro=!0,e.l=0),t(e,(function(t,e,i){switch(i){case 204:s=t;break;case 22:t[1].v=t[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(t[3]>o&&(r["!ref"]=un(u),l[s]=r,h.push(s),r=n.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},o=t[3],s="Sheet"+(o+1)),d>0&&t[0].r>=d)break;n.dense?(r[t[0].r]||(r[t[0].r]=[]),r[t[0].r][t[0].c]=t[1]):r[hn(t[0])]=t[1],u.e.c<t[0].c&&(u.e.c=t[0].c),u.e.r<t[0].r&&(u.e.r=t[0].r);break;case 27:t[14e3]&&(c[t[14e3][0]]=t[14e3][1]);break;case 1537:c[t[0]]=t[1],t[0]==o&&(s=t[1])}}),n)}if(r["!ref"]=un(u),l[a||s]=r,h.push(a||s),!c.length)return{SheetNames:h,Sheets:l};for(var f={},p=[],g=0;g<c.length;++g)l[h[g]]?(p.push(c[g]||h[g]),f[c[g]]=l[c[g]]||l[h[g]]):(p.push(c[g]),f[c[g]]={"!ref":"A1"});return{SheetNames:p,Sheets:f}}function i(t,e,i){var n=[{c:0,r:0},{t:"n",v:0},0,0];return i.qpro&&20768!=i.vers?(n[0].c=t.read_shift(1),n[3]=t.read_shift(1),n[0].r=t.read_shift(2),t.l+=2):(n[2]=t.read_shift(1),n[0].c=t.read_shift(2),n[0].r=t.read_shift(2)),n}function n(t,e,n){var r=t.l+e,s=i(t,0,n);if(s[1].t="s",20768==n.vers){t.l++;var a=t.read_shift(1);return s[1].v=t.read_shift(a,"utf8"),s}return n.qpro&&t.l++,s[1].v=t.read_shift(r-t.l,"cstr"),s}function r(t,e,i){var n=qi(7+i.length);n.write_shift(1,255),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(1,39);for(var r=0;r<n.length;++r){var s=i.charCodeAt(r);n.write_shift(1,s>=128?95:s)}return n.write_shift(1,0),n}function s(t,e,i){var n=qi(7);return n.write_shift(1,255),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,i,"i"),n}function a(t,e,i){var n=qi(13);return n.write_shift(1,255),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(8,i,"f"),n}function o(t,e,i){var n=32768&e;return e=(n?t:0)+((e&=-32769)>=8192?e-16384:e),(n?"":"$")+(i?on(e):sn(e))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},h=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function c(t){var e=[{c:0,r:0},{t:"n",v:0},0];return e[0].r=t.read_shift(2),e[3]=t[t.l++],e[0].c=t[t.l++],e}function u(t,e,i,n){var r=qi(6+n.length);r.write_shift(2,t),r.write_shift(1,i),r.write_shift(1,e),r.write_shift(1,39);for(var s=0;s<n.length;++s){var a=n.charCodeAt(s);r.write_shift(1,a>=128?95:a)}return r.write_shift(1,0),r}function d(t,e){var i=c(t),n=t.read_shift(4),r=t.read_shift(4),s=t.read_shift(2);if(65535==s)return 0===n&&3221225472===r?(i[1].t="e",i[1].v=15):0===n&&3489660928===r?(i[1].t="e",i[1].v=42):i[1].v=0,i;var a=32768&s;return s=(32767&s)-16446,i[1].v=(1-2*a)*(r*Math.pow(2,s+32)+n*Math.pow(2,s)),i}function f(t,e,i,n){var r=qi(14);if(r.write_shift(2,t),r.write_shift(1,i),r.write_shift(1,e),0==n)return r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,65535),r;var s,a=0,o=0,l=0;return n<0&&(a=1,n=-n),o=0|Math.log2(n),0==(2147483648&(l=(n/=Math.pow(2,o-31))>>>0))&&(++o,l=(n/=2)>>>0),n-=l,l|=2147483648,l>>>=0,s=(n*=Math.pow(2,32))>>>0,r.write_shift(4,s),r.write_shift(4,l),o+=16383+(a?32768:0),r.write_shift(2,o),r}function p(t,e){var i=c(t),n=t.read_shift(8,"f");return i[1].v=n,i}function g(t,e){return 0==t[t.l+e-1]?t.read_shift(e,"cstr"):""}function m(t,e){var i=qi(5+t.length);i.write_shift(2,14e3),i.write_shift(2,e);for(var n=0;n<t.length;++n){var r=t.charCodeAt(n);i[i.l++]=r>127?95:r}return i[i.l++]=0,i}var v={0:{n:"BOF",f:qr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(t,e,i){var n={s:{c:0,r:0},e:{c:0,r:0}};return 8==e&&i.qpro?(n.s.c=t.read_shift(1),t.l++,n.s.r=t.read_shift(2),n.e.c=t.read_shift(1),t.l++,n.e.r=t.read_shift(2),n):(n.s.c=t.read_shift(2),n.s.r=t.read_shift(2),12==e&&i.qpro&&(t.l+=2),n.e.c=t.read_shift(2),n.e.r=t.read_shift(2),12==e&&i.qpro&&(t.l+=2),65535==n.s.c&&(n.s.c=n.e.c=n.s.r=n.e.r=0),n)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(t,e,n){var r=i(t,0,n);return r[1].v=t.read_shift(2,"i"),r}},14:{n:"NUMBER",f:function(t,e,n){var r=i(t,0,n);return r[1].v=t.read_shift(8,"f"),r}},15:{n:"LABEL",f:n},16:{n:"FORMULA",f:function(t,e,n){var r=t.l+e,s=i(t,0,n);if(s[1].v=t.read_shift(8,"f"),n.qpro)t.l=r;else{var a=t.read_shift(2);!function(t,e){Yi(t,0);var i=[],n=0,r="",s="",a="",c="";for(;t.l<t.length;){var u=t[t.l++];switch(u){case 0:i.push(t.read_shift(8,"f"));break;case 1:s=o(e[0].c,t.read_shift(2),!0),r=o(e[0].r,t.read_shift(2),!1),i.push(s+r);break;case 2:var d=o(e[0].c,t.read_shift(2),!0),f=o(e[0].r,t.read_shift(2),!1);s=o(e[0].c,t.read_shift(2),!0),r=o(e[0].r,t.read_shift(2),!1),i.push(d+f+":"+s+r);break;case 3:if(t.l<t.length)return void console.error("WK1 premature formula end");break;case 4:i.push("("+i.pop()+")");break;case 5:i.push(t.read_shift(2));break;case 6:for(var p="";u=t[t.l++];)p+=String.fromCharCode(u);i.push('"'+p.replace(/"/g,'""')+'"');break;case 8:i.push("-"+i.pop());break;case 23:i.push("+"+i.pop());break;case 22:i.push("NOT("+i.pop()+")");break;case 20:case 21:c=i.pop(),a=i.pop(),i.push(["AND","OR"][u-20]+"("+a+","+c+")");break;default:if(u<32&&h[u])c=i.pop(),a=i.pop(),i.push(a+h[u]+c);else{if(!l[u])return u<=7?console.error("WK1 invalid opcode "+u.toString(16)):u<=24?console.error("WK1 unsupported op "+u.toString(16)):u<=30?console.error("WK1 invalid opcode "+u.toString(16)):u<=115?console.error("WK1 unsupported function opcode "+u.toString(16)):console.error("WK1 unrecognized opcode "+u.toString(16));if(69==(n=l[u][1])&&(n=t[t.l++]),n>i.length)return void console.error("WK1 bad formula parse 0x"+u.toString(16)+":|"+i.join("|")+"|");var g=i.slice(-n);i.length-=n,i.push(l[u][0]+"("+g.join(",")+")")}}}1==i.length?e[1].f=""+i[0]:console.error("WK1 bad formula parse |"+i.join("|")+"|")}(t.slice(t.l,t.l+a),s),t.l+=a}return s}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:n},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:g},222:{n:"SHEETNAMELP",f:function(t,e){var i=t[t.l++];i>e-1&&(i=e-1);for(var n="";n.length<i;)n+=String.fromCharCode(t[t.l++]);return n}},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(t,e){var i=c(t);return i[1].t="s",i[1].v=t.read_shift(e-4,"cstr"),i}},23:{n:"NUMBER17",f:d},24:{n:"NUMBER18",f:function(t,e){var i=c(t);i[1].v=t.read_shift(2);var n=i[1].v>>1;if(1&i[1].v)switch(7&n){case 0:n=5e3*(n>>3);break;case 1:n=500*(n>>3);break;case 2:n=(n>>3)/20;break;case 3:n=(n>>3)/200;break;case 4:n=(n>>3)/2e3;break;case 5:n=(n>>3)/2e4;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64}return i[1].v=n,i}},25:{n:"FORMULA19",f:function(t,e){var i=d(t);return t.l+=e-14,i}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(t,e){for(var i={},n=t.l+e;t.l<n;){var r=t.read_shift(2);if(14e3==r){for(i[r]=[0,""],i[r][0]=t.read_shift(2);t[t.l];)i[r][1]+=String.fromCharCode(t[t.l]),t.l++;t.l++}}return i}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(t,e){var i=c(t),n=t.read_shift(4);return i[1].v=n>>6,i}},38:{n:"??"},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:function(t,e){var i=p(t);return t.l+=e-10,i}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:g},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(t,e,i){if(i.qpro&&!(e<21)){var n=t.read_shift(1);return t.l+=17,t.l+=1,t.l+=2,[n,t.read_shift(e-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(t,e){var i=e||{};if(+i.codepage>=0&&T(+i.codepage),"string"==i.type)throw new Error("Cannot write WK1 to JS string");var n,o,l=Ji(),h=dn(t["!ref"]),c=Array.isArray(t),u=[];cc(l,0,(n=1030,(o=qi(2)).write_shift(2,n),o)),cc(l,6,function(t){var e=qi(8);return e.write_shift(2,t.s.c),e.write_shift(2,t.s.r),e.write_shift(2,t.e.c),e.write_shift(2,t.e.r),e}(h));for(var d=Math.min(h.e.r,8191),f=h.s.r;f<=d;++f)for(var p=sn(f),g=h.s.c;g<=h.e.c;++g){f===h.s.r&&(u[g]=on(g));var m=u[g]+p,v=c?(t[f]||[])[g]:t[m];if(v&&"z"!=v.t)if("n"==v.t)(0|v.v)==v.v&&v.v>=-32768&&v.v<=32767?cc(l,13,s(f,g,v.v)):cc(l,14,a(f,g,v.v));else cc(l,15,r(f,g,pn(v).slice(0,239)))}return cc(l,1),l.end()},book_to_wk3:function(t,e){var i=e||{};if(+i.codepage>=0&&T(+i.codepage),"string"==i.type)throw new Error("Cannot write WK3 to JS string");var n=Ji();cc(n,0,function(t){var e=qi(26);e.write_shift(2,4096),e.write_shift(2,4),e.write_shift(4,0);for(var i=0,n=0,r=0,s=0;s<t.SheetNames.length;++s){var a=t.SheetNames[s],o=t.Sheets[a];if(o&&o["!ref"]){++r;var l=cn(o["!ref"]);i<l.e.r&&(i=l.e.r),n<l.e.c&&(n=l.e.c)}}i>8191&&(i=8191);return e.write_shift(2,i),e.write_shift(1,r),e.write_shift(1,n),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,1),e.write_shift(1,2),e.write_shift(4,0),e.write_shift(4,0),e}(t));for(var r=0,s=0;r<t.SheetNames.length;++r)(t.Sheets[t.SheetNames[r]]||{})["!ref"]&&cc(n,27,m(t.SheetNames[r],s++));var a=0;for(r=0;r<t.SheetNames.length;++r){var o=t.Sheets[t.SheetNames[r]];if(o&&o["!ref"]){for(var l=dn(o["!ref"]),h=Array.isArray(o),c=[],d=Math.min(l.e.r,8191),p=l.s.r;p<=d;++p)for(var g=sn(p),v=l.s.c;v<=l.e.c;++v){p===l.s.r&&(c[v]=on(v));var y=c[v]+g,b=h?(o[p]||[])[v]:o[y];if(b&&"z"!=b.t)if("n"==b.t)cc(n,23,f(p,v,a,b.v));else cc(n,22,u(p,v,a,pn(b).slice(0,239)))}++a}}return cc(n,1),n.end()},to_workbook:function(t,i){switch(i.type){case"base64":return e(z(D(t)),i);case"binary":return e(z(t),i);case"buffer":case"array":return e(t,i)}throw"Unsupported type "+i.type}}}();var $s=function(){var t=Je("t"),e=Je("rPr");function i(i){var n=i.match(t);if(!n)return{t:"s",v:""};var r={t:"s",v:Ne(n[1])},s=i.match(e);return s&&(r.s=function(t){var e={},i=t.match(Ae),n=0,r=!1;if(i)for(;n!=i.length;++n){var s=Re(i[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;e.cp=w[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting"}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(47!==s[0].charCodeAt(1)&&!r)throw new Error("Unrecognized rich format "+s[0])}}return e}(s[1])),r}var n=/<(?:\w+:)?r>/g,r=/<\/(?:\w+:)?r>/;return function(t){return t.replace(n,"").split(r).map(i).filter((function(t){return t.v}))}}(),Qs=function(){var t=/(\r\n|\n)/g;function e(e){var i=[[],e.v,[]];return e.v?(e.s&&function(t,e,i){var n=[];t.u&&n.push("text-decoration: underline;"),t.uval&&n.push("text-underline-style:"+t.uval+";"),t.sz&&n.push("font-size:"+t.sz+"pt;"),t.outline&&n.push("text-effect: outline;"),t.shadow&&n.push("text-shadow: auto;"),e.push('<span style="'+n.join("")+'">'),t.b&&(e.push("<b>"),i.push("</b>")),t.i&&(e.push("<i>"),i.push("</i>")),t.strike&&(e.push("<s>"),i.push("</s>"));var r=t.valign||"";"superscript"==r||"super"==r?r="sup":"subscript"==r&&(r="sub"),""!=r&&(e.push("<"+r+">"),i.push("</"+r+">")),i.push("</span>")}(e.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(t){return t.map(e).join("")}}(),ta=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,ea=/<(?:\w+:)?r>/,ia=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function na(t,e){var i=!e||e.cellHTML,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ne(qe(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=qe(t),i&&(n.h=Ge(n.t))):t.match(ea)&&(n.r=qe(t),n.t=Ne(qe((t.replace(ia,"").match(ta)||[]).join("").replace(Ae,""))),i&&(n.h=Qs($s(n.r)))),n):{t:""}}var ra=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sa=/<(?:\w+:)?(?:si|sstItem)>/g,aa=/<\/(?:\w+:)?(?:si|sstItem)>/;var oa=/^\s|\s$|[\t\n\r]/;function la(t,e){if(!e.bookSST)return"";var i=[ke];i[i.length]=ai("sst",null,{xmlns:ui[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(null!=t[n]){var r=t[n],s="<si>";r.r?s+=r.r:(s+="<t",r.t||(r.t=""),r.t.match(oa)&&(s+=' xml:space="preserve"'),s+=">"+Be(r.t)+"</t>"),s+="</si>",i[i.length]=s}return i.length>2&&(i[i.length]="</sst>",i[1]=i[1].replace("/>",">")),i.join("")}var ha=function(t,e){var i=!1;return null==e&&(i=!0,e=qi(15+4*t.t.length)),e.write_shift(1,0),_n(t.t,e),i?e.slice(0,e.l):e};function ca(t){var e=Ji();$i(e,159,function(t,e){return e||(e=qi(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}(t));for(var i=0;i<t.length;++i)$i(e,19,ha(t[i]));return $i(e,160),e.end()}function ua(t){if(void 0!==M)return M.utils.encode(_,t);for(var e=[],i=t.split(""),n=0;n<i.length;++n)e[n]=i[n].charCodeAt(0);return e}function da(t,e){var i={};return i.Major=t.read_shift(2),i.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),i}function fa(t){for(var e=t.read_shift(4),i=t.l+e-4,n={},r=t.read_shift(4),s=[];r-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=i)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+i);return n}function pa(t){var e=function(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=da(t,4),e.U=da(t,4),e.W=da(t,4),e}(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),4!=t.read_shift(4))throw new Error("Bad !Primary record");return e}function ga(t,e){var i=t.l+e,n={};n.Flags=63&t.read_shift(4),t.l+=4,n.AlgID=t.read_shift(4);var r=!1;switch(n.AlgID){case 26126:case 26127:case 26128:r=36==n.Flags;break;case 26625:r=4==n.Flags;break;case 0:r=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!r)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(i-t.l>>1,"utf16le"),t.l=i,n}function ma(t,e){var i={},n=t.l+e;return t.l+=4,i.Salt=t.slice(t.l,t.l+16),t.l+=16,i.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),i.VerifierHash=t.slice(t.l,n),t.l=n,i}function va(t){if(36!=(63&t.read_shift(4)))throw new Error("EncryptionInfo mismatch");var e=t.read_shift(4);return{t:"Std",h:ga(t,e),v:ma(t,t.length-t.l)}}function ya(){throw new Error("File is password-protected: ECMA-376 Extensible")}function ba(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var i=t.read_shift(t.length-t.l,"utf8"),n={};return i.replace(Ae,(function(t){var i=Re(t);switch(Ie(i[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":e.forEach((function(t){n[t]=i[t]}));break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"<keyEncryptor":n.uri=i.uri;break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}})),n}function _a(t){var e,i,n=0,r=ua(t),s=r.length+1;for((e=j(s))[0]=r.length,i=1;i!=s;++i)e[i]=r[i-1];for(i=s-1;i>=0;--i)n=((0==(16384&n)?0:1)|n<<1&32767)^e[i];return 52811^n}var xa=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],i=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(t,e){return 255&((i=t^e)/2|128*i);var i};return function(r){for(var s,a,o,l=ua(r),h=function(t){for(var n=e[t.length-1],r=104,s=t.length-1;s>=0;--s)for(var a=t[s],o=0;7!=o;++o)64&a&&(n^=i[r]),a*=2,--r;return n}(l),c=l.length,u=j(16),d=0;16!=d;++d)u[d]=0;for(1==(1&c)&&(s=h>>8,u[c]=n(t[0],s),--c,s=255&h,a=l[l.length-1],u[c]=n(a,s));c>0;)s=h>>8,u[--c]=n(l[c],s),s=255&h,u[--c]=n(l[c],s);for(c=15,o=15-l.length;o>0;)s=h>>8,u[c]=n(t[o],s),--o,s=255&h,u[--c]=n(l[c],s),--c,--o;return u}}(),wa=function(t){var e=0,i=xa(t);return function(t){var n=function(t,e,i,n,r){var s,a;for(r||(r=e),n||(n=xa(t)),s=0;s!=e.length;++s)a=e[s],a=255&((a^=n[i])>>5|a<<3),r[s]=a,++i;return[r,i,n]}("",t,e,i);return e=n[1],n[0]}};function Sa(t,e,i){var n=i||{};return n.Info=t.read_shift(2),t.l-=2,1===n.Info?n.Data=function(t){var e={},i=e.EncryptionVersionInfo=da(t,4);if(1!=i.Major||1!=i.Minor)throw"unrecognized version code "+i.Major+" : "+i.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}(t):n.Data=function(t,e){var i={},n=i.EncryptionVersionInfo=da(t,4);if(e-=4,2!=n.Minor)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);i.Flags=t.read_shift(4),e-=4;var r=t.read_shift(4);return e-=4,i.EncryptionHeader=ga(t,r),e-=r,i.EncryptionVerifier=ma(t,e),i}(t,e),n}var Ta=function(){function t(t,i){switch(i.type){case"base64":return e(D(t),i);case"binary":return e(t,i);case"buffer":return e(N&&Buffer.isBuffer(t)?t.toString("binary"):G(t),i);case"array":return e(oe(t),i)}throw new Error("Unrecognized type "+i.type)}function e(t,e){var i=(e||{}).dense?[]:{},n=t.match(/\\trowd.*?\\row\b/g);if(!n.length)throw new Error("RTF missing table");var r={s:{c:0,r:0},e:{c:0,r:n.length-1}};return n.forEach((function(t,e){Array.isArray(i)&&(i[e]=[]);for(var n,s=/\\\w+\b/g,a=0,o=-1;n=s.exec(t);){if("\\cell"===n[0]){var l=t.slice(a,s.lastIndex-n[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var h={v:l,t:"s"};Array.isArray(i)?i[e][o]=h:i[hn({r:e,c:o})]=h}}a=s.lastIndex}o>r.e.c&&(r.e.c=o)})),i["!ref"]=un(r),i}return{to_workbook:function(e,i){return gn(t(e,i),i)},to_sheet:t,from_sheet:function(t){for(var e,i=["{\\rtf1\\ansi"],n=dn(t["!ref"]),r=Array.isArray(t),s=n.s.r;s<=n.e.r;++s){i.push("\\trowd\\trautofit1");for(var a=n.s.c;a<=n.e.c;++a)i.push("\\cellx"+(a+1));for(i.push("\\pard\\intbl"),a=n.s.c;a<=n.e.c;++a){var o=hn({r:s,c:a});(e=r?(t[s]||[])[a]:t[o])&&(null!=e.v||e.f&&!e.F)&&(i.push(" "+(e.w||(pn(e),e.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}}}();function Ea(t){for(var e=0,i=1;3!=e;++e)i=256*i+(t[e]>255?255:t[e]<0?0:t[e]);return i.toString(16).toUpperCase().slice(1)}function ka(t,e){if(0===e)return t;var i,n,r=function(t){var e=t[0]/255,i=t[1]/255,n=t[2]/255,r=Math.max(e,i,n),s=Math.min(e,i,n),a=r-s;if(0===a)return[0,0,e];var o,l=0,h=r+s;switch(o=a/(h>1?2-h:h),r){case e:l=((i-n)/a+6)%6;break;case i:l=(n-e)/a+2;break;case n:l=(e-i)/a+4}return[l/6,o,h/2]}((n=(i=t).slice("#"===i[0]?1:0).slice(0,6),[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]));return r[2]=e<0?r[2]*(1+e):1-(1-r[2])*(1-e),Ea(function(t){var e,i=t[0],n=t[1],r=t[2],s=2*n*(r<.5?r:1-r),a=r-s/2,o=[a,a,a],l=6*i;if(0!==n)switch(0|l){case 0:case 6:e=s*l,o[0]+=s,o[1]+=e;break;case 1:e=s*(2-l),o[0]+=e,o[1]+=s;break;case 2:e=s*(l-2),o[1]+=s,o[2]+=e;break;case 3:e=s*(4-l),o[1]+=e,o[2]+=s;break;case 4:e=s*(l-4),o[2]+=s,o[0]+=e;break;case 5:e=s*(6-l),o[2]+=e,o[0]+=s}for(var h=0;3!=h;++h)o[h]=Math.round(255*o[h]);return o}(r))}var Ca=6,Ma=15,Aa=1,Oa=Ca;function Pa(t){return Math.floor((t+Math.round(128/Oa)/256)*Oa)}function Ra(t){return Math.floor((t-5)/Oa*100+.5)/100}function Ia(t){return Math.round((t*Oa+5)/Oa*256)/256}function La(t){return Ia(Ra(Pa(t)))}function Da(t){var e=Math.abs(t-La(t)),i=Oa;if(e>.005)for(Oa=Aa;Oa<Ma;++Oa)Math.abs(t-La(t))<=e&&(e=Math.abs(t-La(t)),i=Oa);Oa=i}function Na(t){t.width?(t.wpx=Pa(t.width),t.wch=Ra(t.wpx),t.MDW=Oa):t.wpx?(t.wch=Ra(t.wpx),t.width=Ia(t.wch),t.MDW=Oa):"number"==typeof t.wch&&(t.width=Ia(t.wch),t.wpx=Pa(t.width),t.MDW=Oa),t.customWidth&&delete t.customWidth}var Fa=96;function ja(t){return 96*t/Fa}function Ba(t){return t*Fa/96}var za={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var Wa=["numFmtId","fillId","fontId","borderId","xfId"],Ga=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var Ua=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,i=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,r=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,a,o){var l,h={};return s?((l=(s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(t))&&function(t,e,i){e.NumberFmt=[];for(var n=Vt(nt),r=0;r<n.length;++r)e.NumberFmt[n[r]]=nt[n[r]];var s=t[0].match(Ae);if(s)for(r=0;r<s.length;++r){var a=Re(s[r]);switch(Ie(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=Ne(qe(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&null!=e.NumberFmt[l];--l);e.NumberFmt[l]=o}Nt(o,l)}break;default:if(i.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}(l,h,o),(l=s.match(n))&&function(t,e,i,n){e.Fonts=[];var r={},s=!1;(t[0].match(Ae)||[]).forEach((function(t){var a=Re(t);switch(Ie(a[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":e.Fonts.push(r),r={};break;case"<name":a.val&&(r.name=qe(a.val));break;case"<b":r.bold=a.val?He(a.val):1;break;case"<b/>":r.bold=1;break;case"<i":r.italic=a.val?He(a.val):1;break;case"<i/>":r.italic=1;break;case"<u":switch(a.val){case"none":r.underline=0;break;case"single":r.underline=1;break;case"double":r.underline=2;break;case"singleAccounting":r.underline=33;break;case"doubleAccounting":r.underline=34}break;case"<u/>":r.underline=1;break;case"<strike":r.strike=a.val?He(a.val):1;break;case"<strike/>":r.strike=1;break;case"<outline":r.outline=a.val?He(a.val):1;break;case"<outline/>":r.outline=1;break;case"<shadow":r.shadow=a.val?He(a.val):1;break;case"<shadow/>":r.shadow=1;break;case"<condense":r.condense=a.val?He(a.val):1;break;case"<condense/>":r.condense=1;break;case"<extend":r.extend=a.val?He(a.val):1;break;case"<extend/>":r.extend=1;break;case"<sz":a.val&&(r.sz=+a.val);break;case"<vertAlign":a.val&&(r.vertAlign=a.val);break;case"<family":a.val&&(r.family=parseInt(a.val,10));break;case"<scheme":a.val&&(r.scheme=a.val);break;case"<charset":if("1"==a.val)break;a.codepage=w[parseInt(a.val,10)];break;case"<color":if(r.color||(r.color={}),a.auto&&(r.color.auto=He(a.auto)),a.rgb)r.color.rgb=a.rgb.slice(-6);else if(a.indexed){r.color.index=parseInt(a.indexed,10);var o=ir[r.color.index];81==r.color.index&&(o=ir[1]),o||(o=ir[1]),r.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else a.theme&&(r.color.theme=parseInt(a.theme,10),a.tint&&(r.color.tint=parseFloat(a.tint)),a.theme&&i.themeElements&&i.themeElements.clrScheme&&(r.color.rgb=ka(i.themeElements.clrScheme[r.color.theme].rgb,r.color.tint||0)));break;case"<AlternateContent":case"<ext":s=!0;break;case"</AlternateContent>":case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fonts")}}))}(l,h,a,o),(l=s.match(i))&&function(t,e,i,n){e.Fills=[];var r={},s=!1;(t[0].match(Ae)||[]).forEach((function(t){var i=Re(t);switch(Ie(i[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":r={},e.Fills.push(r);break;case"<gradientFill":case"</gradientFill>":e.Fills.push(r),r={};break;case"<patternFill":case"<patternFill>":i.patternType&&(r.patternType=i.patternType);break;case"<bgColor":r.bgColor||(r.bgColor={}),i.indexed&&(r.bgColor.indexed=parseInt(i.indexed,10)),i.theme&&(r.bgColor.theme=parseInt(i.theme,10)),i.tint&&(r.bgColor.tint=parseFloat(i.tint)),i.rgb&&(r.bgColor.rgb=i.rgb.slice(-6));break;case"<fgColor":r.fgColor||(r.fgColor={}),i.theme&&(r.fgColor.theme=parseInt(i.theme,10)),i.tint&&(r.fgColor.tint=parseFloat(i.tint)),null!=i.rgb&&(r.fgColor.rgb=i.rgb.slice(-6));break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+i[0]+" in fills")}}))}(l,h,0,o),(l=s.match(r))&&function(t,e,i,n){e.Borders=[];var r={},s=!1;(t[0].match(Ae)||[]).forEach((function(t){var i=Re(t);switch(Ie(i[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":r={},i.diagonalUp&&(r.diagonalUp=He(i.diagonalUp)),i.diagonalDown&&(r.diagonalDown=He(i.diagonalDown)),e.Borders.push(r);break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+i[0]+" in borders")}}))}(l,h,0,o),(l=s.match(e))&&function(t,e,i){var n;e.CellXf=[];var r=!1;(t[0].match(Ae)||[]).forEach((function(t){var s=Re(t),a=0;switch(Ie(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(n=s)[0],a=0;a<Wa.length;++a)n[Wa[a]]&&(n[Wa[a]]=parseInt(n[Wa[a]],10));for(a=0;a<Ga.length;++a)n[Ga[a]]&&(n[Ga[a]]=He(n[Ga[a]]));if(e.NumberFmt&&n.numFmtId>392)for(a=392;a>60;--a)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[a]){n.numFmtId=a;break}e.CellXf.push(n);break;case"<alignment":case"<alignment/>":var o={};s.vertical&&(o.vertical=s.vertical),s.horizontal&&(o.horizontal=s.horizontal),null!=s.textRotation&&(o.textRotation=s.textRotation),s.indent&&(o.indent=s.indent),s.wrapText&&(o.wrapText=He(s.wrapText)),n.alignment=o;break;case"<AlternateContent":case"<ext":r=!0;break;case"</AlternateContent>":case"</ext>":r=!1;break;default:if(i&&i.WTF&&!r)throw new Error("unrecognized "+s[0]+" in cellXfs")}}))}(l,h,o),h):h}}();function Ha(t,e){var i,n=[ke,ai("styleSheet",null,{xmlns:ui[0],"xmlns:vt":ci.vt})];return t.SSF&&null!=(i=function(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach((function(i){for(var n=i[0];n<=i[1];++n)null!=t[n]&&(e[e.length]=ai("numFmt",null,{numFmtId:n,formatCode:Be(t[n])}))})),1===e.length?"":(e[e.length]="</numFmts>",e[0]=ai("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}(t.SSF))&&(n[n.length]=i),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=function(t){var e=[];return e[e.length]=ai("cellXfs",null),t.forEach((function(t){e[e.length]=ai("xf",null,t)})),e[e.length]="</cellXfs>",2===e.length?"":(e[0]=ai("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}(e.cellXfs))&&(n[n.length]=i),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Xa(t,e,i){i||(i=qi(6+4*e.length)),i.write_shift(2,t),_n(e,i);var n=i.length>i.l?i.slice(0,i.l):i;return null==i.l&&(i.l=i.length),n}function Va(t,e){e||(e=qi(153)),e.write_shift(2,20*t.sz),function(t,e){e||(e=qi(2));var i=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);e.write_shift(1,i),e.write_shift(1,0)}(t,e),e.write_shift(2,t.bold?700:400);var i=0;"superscript"==t.vertAlign?i=1:"subscript"==t.vertAlign&&(i=2),e.write_shift(2,i),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Un(t.color,e);var n=0;return"major"==t.scheme&&(n=1),"minor"==t.scheme&&(n=2),e.write_shift(1,n),_n(t.name,e),e.length>e.l?e.slice(0,e.l):e}var Ya,Ka=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],qa=Ki;function Za(t,e){e||(e=qi(84)),Ya||(Ya=Kt(Ka));var i=Ya[t.patternType];null==i&&(i=40),e.write_shift(4,i);var n=0;if(40!=i)for(Un({auto:1},e),Un({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Ja(t,e,i){i||(i=qi(16)),i.write_shift(2,e||0),i.write_shift(2,t.numFmtId||0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(1,0),i.write_shift(1,0);return i.write_shift(1,0),i.write_shift(1,0),i.write_shift(1,0),i.write_shift(1,0),i}function $a(t,e){return e||(e=qi(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Qa=Ki;function to(t){var e;$i(t,613,yn(1)),$i(t,46,(e||(e=qi(51)),e.write_shift(1,0),$a(0,e),$a(0,e),$a(0,e),$a(0,e),$a(0,e),e.length>e.l?e.slice(0,e.l):e)),$i(t,614)}function eo(t){var e,i;$i(t,619,yn(1)),$i(t,48,(e={xfId:0,builtinId:0,name:"Normal"},i||(i=qi(52)),i.write_shift(4,e.xfId),i.write_shift(2,1),i.write_shift(1,+e.builtinId),i.write_shift(1,0),Rn(e.name||"",i),i.length>i.l?i.slice(0,i.l):i)),$i(t,620)}function io(t){$i(t,508,function(t,e,i){var n=qi(2052);return n.write_shift(4,t),Rn(e,n),Rn(i,n),n.length>n.l?n.slice(0,n.l):n}(0,"TableStyleMedium9","PivotStyleMedium4")),$i(t,509)}function no(t,e){var i=Ji();return $i(i,278),function(t,e){if(e){var i=0;[[5,8],[23,26],[41,44],[50,392]].forEach((function(t){for(var n=t[0];n<=t[1];++n)null!=e[n]&&++i})),0!=i&&($i(t,615,yn(i)),[[5,8],[23,26],[41,44],[50,392]].forEach((function(i){for(var n=i[0];n<=i[1];++n)null!=e[n]&&$i(t,44,Xa(n,e[n]))})),$i(t,616))}}(i,t.SSF),function(t){$i(t,611,yn(1)),$i(t,43,Va({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),$i(t,612)}(i),function(t){$i(t,603,yn(2)),$i(t,45,Za({patternType:"none"})),$i(t,45,Za({patternType:"gray125"})),$i(t,604)}(i),to(i),function(t){$i(t,626,yn(1)),$i(t,47,Ja({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),$i(t,627)}(i),function(t,e){$i(t,617,yn(e.length)),e.forEach((function(e){$i(t,47,Ja(e,0))})),$i(t,618)}(i,e.cellXfs),eo(i),function(t){$i(t,505,yn(0)),$i(t,506)}(i),io(i),$i(i,279),i.end()}var ro=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function so(t,e,i){e.themeElements.clrScheme=[];var n={};(t[0].match(Ae)||[]).forEach((function(t){var r=Re(t);switch(r[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=r.val;break;case"<a:sysClr":n.rgb=r.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===r[0].charAt(1)?(e.themeElements.clrScheme[ro.indexOf(r[0])]=n,n={}):n.name=r[0].slice(3,r[0].length-1);break;default:if(i&&i.WTF)throw new Error("Unrecognized "+r[0]+" in clrScheme")}}))}function ao(){}function oo(){}var lo=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,ho=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,co=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var uo=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function fo(t,e){var i;t&&0!==t.length||(t=po());var n={};if(!(i=t.match(uo)))throw new Error("themeElements not found in theme");return function(t,e,i){var n;e.themeElements={},[["clrScheme",lo,so],["fontScheme",ho,ao],["fmtScheme",co,oo]].forEach((function(r){if(!(n=t.match(r[1])))throw new Error(r[0]+" not found in themeElements");r[2](n,e,i)}))}(i[0],n,e),n.raw=t,n}function po(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&"string"==typeof t.raw)return t.raw;var i=[ke];return i[i.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',i[i.length]="<a:themeElements>",i[i.length]='<a:clrScheme name="Office">',i[i.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',i[i.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',i[i.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',i[i.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',i[i.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',i[i.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',i[i.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',i[i.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',i[i.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',i[i.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',i[i.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',i[i.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',i[i.length]="</a:clrScheme>",i[i.length]='<a:fontScheme name="Office">',i[i.length]="<a:majorFont>",i[i.length]='<a:latin typeface="Cambria"/>',i[i.length]='<a:ea typeface=""/>',i[i.length]='<a:cs typeface=""/>',i[i.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',i[i.length]='<a:font script="Hang" typeface="맑은 고딕"/>',i[i.length]='<a:font script="Hans" typeface="宋体"/>',i[i.length]='<a:font script="Hant" typeface="新細明體"/>',i[i.length]='<a:font script="Arab" typeface="Times New Roman"/>',i[i.length]='<a:font script="Hebr" typeface="Times New Roman"/>',i[i.length]='<a:font script="Thai" typeface="Tahoma"/>',i[i.length]='<a:font script="Ethi" typeface="Nyala"/>',i[i.length]='<a:font script="Beng" typeface="Vrinda"/>',i[i.length]='<a:font script="Gujr" typeface="Shruti"/>',i[i.length]='<a:font script="Khmr" typeface="MoolBoran"/>',i[i.length]='<a:font script="Knda" typeface="Tunga"/>',i[i.length]='<a:font script="Guru" typeface="Raavi"/>',i[i.length]='<a:font script="Cans" typeface="Euphemia"/>',i[i.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',i[i.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',i[i.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',i[i.length]='<a:font script="Thaa" typeface="MV Boli"/>',i[i.length]='<a:font script="Deva" typeface="Mangal"/>',i[i.length]='<a:font script="Telu" typeface="Gautami"/>',i[i.length]='<a:font script="Taml" typeface="Latha"/>',i[i.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',i[i.length]='<a:font script="Orya" typeface="Kalinga"/>',i[i.length]='<a:font script="Mlym" typeface="Kartika"/>',i[i.length]='<a:font script="Laoo" typeface="DokChampa"/>',i[i.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',i[i.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',i[i.length]='<a:font script="Viet" typeface="Times New Roman"/>',i[i.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',i[i.length]='<a:font script="Geor" typeface="Sylfaen"/>',i[i.length]="</a:majorFont>",i[i.length]="<a:minorFont>",i[i.length]='<a:latin typeface="Calibri"/>',i[i.length]='<a:ea typeface=""/>',i[i.length]='<a:cs typeface=""/>',i[i.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',i[i.length]='<a:font script="Hang" typeface="맑은 고딕"/>',i[i.length]='<a:font script="Hans" typeface="宋体"/>',i[i.length]='<a:font script="Hant" typeface="新細明體"/>',i[i.length]='<a:font script="Arab" typeface="Arial"/>',i[i.length]='<a:font script="Hebr" typeface="Arial"/>',i[i.length]='<a:font script="Thai" typeface="Tahoma"/>',i[i.length]='<a:font script="Ethi" typeface="Nyala"/>',i[i.length]='<a:font script="Beng" typeface="Vrinda"/>',i[i.length]='<a:font script="Gujr" typeface="Shruti"/>',i[i.length]='<a:font script="Khmr" typeface="DaunPenh"/>',i[i.length]='<a:font script="Knda" typeface="Tunga"/>',i[i.length]='<a:font script="Guru" typeface="Raavi"/>',i[i.length]='<a:font script="Cans" typeface="Euphemia"/>',i[i.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',i[i.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',i[i.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',i[i.length]='<a:font script="Thaa" typeface="MV Boli"/>',i[i.length]='<a:font script="Deva" typeface="Mangal"/>',i[i.length]='<a:font script="Telu" typeface="Gautami"/>',i[i.length]='<a:font script="Taml" typeface="Latha"/>',i[i.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',i[i.length]='<a:font script="Orya" typeface="Kalinga"/>',i[i.length]='<a:font script="Mlym" typeface="Kartika"/>',i[i.length]='<a:font script="Laoo" typeface="DokChampa"/>',i[i.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',i[i.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',i[i.length]='<a:font script="Viet" typeface="Arial"/>',i[i.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',i[i.length]='<a:font script="Geor" typeface="Sylfaen"/>',i[i.length]="</a:minorFont>",i[i.length]="</a:fontScheme>",i[i.length]='<a:fmtScheme name="Office">',i[i.length]="<a:fillStyleLst>",i[i.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',i[i.length]='<a:gradFill rotWithShape="1">',i[i.length]="<a:gsLst>",i[i.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',i[i.length]="</a:gsLst>",i[i.length]='<a:lin ang="16200000" scaled="1"/>',i[i.length]="</a:gradFill>",i[i.length]='<a:gradFill rotWithShape="1">',i[i.length]="<a:gsLst>",i[i.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',i[i.length]="</a:gsLst>",i[i.length]='<a:lin ang="16200000" scaled="0"/>',i[i.length]="</a:gradFill>",i[i.length]="</a:fillStyleLst>",i[i.length]="<a:lnStyleLst>",i[i.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',i[i.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',i[i.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',i[i.length]="</a:lnStyleLst>",i[i.length]="<a:effectStyleLst>",i[i.length]="<a:effectStyle>",i[i.length]="<a:effectLst>",i[i.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',i[i.length]="</a:effectLst>",i[i.length]="</a:effectStyle>",i[i.length]="<a:effectStyle>",i[i.length]="<a:effectLst>",i[i.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',i[i.length]="</a:effectLst>",i[i.length]="</a:effectStyle>",i[i.length]="<a:effectStyle>",i[i.length]="<a:effectLst>",i[i.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',i[i.length]="</a:effectLst>",i[i.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',i[i.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',i[i.length]="</a:effectStyle>",i[i.length]="</a:effectStyleLst>",i[i.length]="<a:bgFillStyleLst>",i[i.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',i[i.length]='<a:gradFill rotWithShape="1">',i[i.length]="<a:gsLst>",i[i.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',i[i.length]="</a:gsLst>",i[i.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',i[i.length]="</a:gradFill>",i[i.length]='<a:gradFill rotWithShape="1">',i[i.length]="<a:gsLst>",i[i.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',i[i.length]="</a:gsLst>",i[i.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',i[i.length]="</a:gradFill>",i[i.length]="</a:bgFillStyleLst>",i[i.length]="</a:fmtScheme>",i[i.length]="</a:themeElements>",i[i.length]="<a:objectDefaults>",i[i.length]="<a:spDef>",i[i.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',i[i.length]="</a:spDef>",i[i.length]="<a:lnDef>",i[i.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',i[i.length]="</a:lnDef>",i[i.length]="</a:objectDefaults>",i[i.length]="<a:extraClrSchemeLst/>",i[i.length]="</a:theme>",i.join("")}function go(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:case 4:t.l+=4;break;case 1:e.xclrValue=function(t,e){return Ki(t,e)}(t,4);break;case 2:e.xclrValue=cs(t);break;case 3:e.xclrValue=function(t){return t.read_shift(4)}(t)}return t.l+=8,e}function mo(t){var e=t.read_shift(2),i=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=go(t);break;case 6:n[1]=function(t,e){return Ki(t,e)}(t,i);break;case 14:case 15:n[1]=t.read_shift(1===i?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+i)}return n}function vo(){var t,e,i=Ji();return $i(i,332),$i(i,334,yn(1)),$i(i,335,((e=qi(12+2*(t={name:"XLDAPR",version:12e4,flags:3496657072}).name.length)).write_shift(4,t.flags),e.write_shift(4,t.version),_n(t.name,e),e.slice(0,e.l))),$i(i,336),$i(i,339,function(t,e){var i=qi(8+2*e.length);return i.write_shift(4,t),_n(e,i),i.slice(0,i.l)}(1,"XLDAPR")),$i(i,52),$i(i,35,yn(514)),$i(i,4096,yn(0)),$i(i,4097,Zr(1)),$i(i,36),$i(i,53),$i(i,340),$i(i,337,function(t,e){var i=qi(8);return i.write_shift(4,t),i.write_shift(4,e?1:0),i}(1,!0)),$i(i,51,function(t){var e=qi(4+8*t.length);e.write_shift(4,t.length);for(var i=0;i<t.length;++i)e.write_shift(4,t[i][0]),e.write_shift(4,t[i][1]);return e}([[1,0]])),$i(i,338),$i(i,333),i.end()}function yo(){var t=[ke];return t.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),t.join("")}var bo=1024;function _o(t,e){for(var i=[21600,21600],n=["m0,0l0",i[1],i[0],i[1],i[0],"0xe"].join(","),r=[ai("xml",null,{"xmlns:v":di.v,"xmlns:o":di.o,"xmlns:x":di.x,"xmlns:mv":di.mv}).replace(/\/>/,">"),ai("o:shapelayout",ai("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),ai("v:shapetype",[ai("v:stroke",null,{joinstyle:"miter"}),ai("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:i.join(","),path:n})];bo<1e3*t;)bo+=1e3;return e.forEach((function(t){var e=ln(t[0]),i={color2:"#BEFF82",type:"gradient"};"gradient"==i.type&&(i.angle="-180");var n="gradient"==i.type?ai("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,s=ai("v:fill",n,i);++bo,r=r.concat(["<v:shape"+si({id:"_x0000_s"+bo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(t[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",s,ai("v:shadow",null,{on:"t",obscured:"t"}),ai("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ri("x:Anchor",[e.c+1,0,e.r+1,0,e.c+3,20,e.r+5,20].join(",")),ri("x:AutoFill","False"),ri("x:Row",String(e.r)),ri("x:Column",String(e.c)),t[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])})),r.push("</xml>"),r.join("")}function xo(t,e,i,n){var r,s=Array.isArray(t);e.forEach((function(e){var a=ln(e.ref);if(s?(t[a.r]||(t[a.r]=[]),r=t[a.r][a.c]):r=t[e.ref],!r){r={t:"z"},s?t[a.r][a.c]=r:t[e.ref]=r;var o=dn(t["!ref"]||"BDWGO1000001:A1");o.s.r>a.r&&(o.s.r=a.r),o.e.r<a.r&&(o.e.r=a.r),o.s.c>a.c&&(o.s.c=a.c),o.e.c<a.c&&(o.e.c=a.c);var l=un(o);l!==t["!ref"]&&(t["!ref"]=l)}r.c||(r.c=[]);var h={a:e.author,t:e.t,r:e.r,T:i};e.h&&(h.h=e.h);for(var c=r.c.length-1;c>=0;--c){if(!i&&r.c[c].T)return;i&&!r.c[c].T&&r.c.splice(c,1)}if(i&&n)for(c=0;c<n.length;++c)if(h.a==n[c].id){h.a=n[c].name||h.a;break}r.c.push(h)}))}function wo(t){var e=[ke,ai("comments",null,{xmlns:ui[0]})],i=[];return e.push("<authors>"),t.forEach((function(t){t[1].forEach((function(t){var n=Be(t.a);-1==i.indexOf(n)&&(i.push(n),e.push("<author>"+n+"</author>")),t.T&&t.ID&&-1==i.indexOf("tc="+t.ID)&&(i.push("tc="+t.ID),e.push("<author>tc="+t.ID+"</author>"))}))})),0==i.length&&(i.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach((function(t){var n=0,r=[];if(t[1][0]&&t[1][0].T&&t[1][0].ID?n=i.indexOf("tc="+t[1][0].ID):t[1].forEach((function(t){t.a&&(n=i.indexOf(Be(t.a))),r.push(t.t||"")})),e.push('<comment ref="'+t[0]+'" authorId="'+n+'"><text>'),r.length<=1)e.push(ri("t",Be(r[0]||"")));else{for(var s="Comment:\n    "+r[0]+"\n",a=1;a<r.length;++a)s+="Reply:\n    "+r[a]+"\n";e.push(ri("t",Be(s)))}e.push("</text></comment>")})),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function So(t,e,i){var n=[ke,ai("ThreadedComments",null,{xmlns:ci.TCMNT}).replace(/[\/]>/,">")];return t.forEach((function(t){var r="";(t[1]||[]).forEach((function(s,a){if(s.T){s.a&&-1==e.indexOf(s.a)&&e.push(s.a);var o={ref:t[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+i.tcid++).slice(-12)+"}"};0==a?r=o.id:o.parentId=r,s.ID=o.id,s.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(s.a)).slice(-12)+"}"),n.push(ai("threadedComment",ri("text",s.t||""),o))}else delete s.ID}))})),n.push("</ThreadedComments>"),n.join("")}var To=bn;function Eo(t){var e=Ji(),i=[];return $i(e,628),$i(e,630),t.forEach((function(t){t[1].forEach((function(t){i.indexOf(t.a)>-1||(i.push(t.a.slice(0,54)),$i(e,632,function(t){return _n(t.slice(0,54))}(t.a)))}))})),$i(e,631),$i(e,633),t.forEach((function(t){t[1].forEach((function(n){n.iauthor=i.indexOf(n.a);var r={s:ln(t[0]),e:ln(t[0])};$i(e,635,function(t,e){return null==e&&(e=qi(36)),e.write_shift(4,t[1].iauthor),zn(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}([r,n])),n.t&&n.t.length>0&&$i(e,637,Tn(n)),$i(e,636),delete n.iauthor}))})),$i(e,634),$i(e,629),e.end()}var ko="application/vnd.ms-office.vbaProject";var Co=["xlsb","xlsm","xlam","biff8","xla"];var Mo=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function i(t,i,n,r){var s=!1,a=!1;0==n.length?a=!0:"["==n.charAt(0)&&(a=!0,n=n.slice(1,-1)),0==r.length?s=!0:"["==r.charAt(0)&&(s=!0,r=r.slice(1,-1));var o=n.length>0?0|parseInt(n,10):0,l=r.length>0?0|parseInt(r,10):0;return s?l+=e.c:--l,a?o+=e.r:--o,i+(s?"":"$")+on(l)+(a?"":"$")+sn(o)}return function(n,r){return e=r,n.replace(t,i)}}(),Ao=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Oo=function(){return function(t,e){return t.replace(Ao,(function(t,i,n,r,s,a){var o=an(r)-(n?0:e.c),l=rn(a)-(s?0:e.r);return i+"R"+(0==l?"":s?l+1:"["+l+"]")+"C"+(0==o?"":n?o+1:"["+o+"]")}))}}();function Po(t,e){return t.replace(Ao,(function(t,i,n,r,s,a){return i+("$"==n?n+r:on(an(r)+e.c))+("$"==s?s+a:sn(rn(a)+e.r))}))}function Ro(t,e,i){var n=cn(e).s,r=ln(i);return Po(t,{r:r.r-n.r,c:r.c-n.c})}function Io(t){return t.replace(/_xlfn\./g,"")}function Lo(t){t.l+=1}function Do(t,e){var i=t.read_shift(1==e?1:2);return[16383&i,i>>14&1,i>>15&1]}function No(t,e,i){var n=2;if(i){if(i.biff>=2&&i.biff<=5)return Fo(t);12==i.biff&&(n=4)}var r=t.read_shift(n),s=t.read_shift(n),a=Do(t,2),o=Do(t,2);return{s:{r,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Fo(t){var e=Do(t,2),i=Do(t,2),n=t.read_shift(1),r=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:i[0],c:r,cRel:i[1],rRel:i[2]}}}function jo(t,e,i){if(i&&i.biff>=2&&i.biff<=5)return function(t){var e=Do(t,2),i=t.read_shift(1);return{r:e[0],c:i,cRel:e[1],rRel:e[2]}}(t);var n=t.read_shift(i&&12==i.biff?4:2),r=Do(t,2);return{r:n,c:r[0],cRel:r[1],rRel:r[2]}}function Bo(t){var e=t.read_shift(2),i=t.read_shift(2);return{r:e,c:255&i,fQuoted:!!(16384&i),cRel:i>>15,rRel:i>>15}}function zo(t){var e=1&t[t.l+1];return t.l+=4,[e,1]}function Wo(t){return[t.read_shift(1),t.read_shift(1)]}function Go(t,e){var i=[t.read_shift(1)];if(12==e)switch(i[0]){case 2:i[0]=4;break;case 4:i[0]=16;break;case 0:i[0]=1;break;case 1:i[0]=2}switch(i[0]){case 4:i[1]=Yr(t,1)?"TRUE":"FALSE",12!=e&&(t.l+=7);break;case 37:case 16:i[1]=nr[t[t.l]],t.l+=12==e?4:8;break;case 0:t.l+=8;break;case 1:i[1]=Wn(t);break;case 2:i[1]=rs(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+i[0])}return i}function Uo(t,e,i){for(var n=t.read_shift(12==i.biff?4:2),r=[],s=0;s!=n;++s)r.push((12==i.biff?Bn:ms)(t,8));return r}function Ho(t,e,i){var n=0,r=0;12==i.biff?(n=t.read_shift(4),r=t.read_shift(4)):(r=1+t.read_shift(1),n=1+t.read_shift(2)),i.biff>=2&&i.biff<8&&(--n,0==--r&&(r=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=r;++o)a[s][o]=Go(t,i.biff);return a}function Xo(t,e,i){return t.l+=2,[Bo(t)]}function Vo(t){return t.l+=6,[]}function Yo(t){return t.l+=2,[qr(t),1&t.read_shift(2)]}var Ko=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var qo={1:{n:"PtgExp",f:function(t,e,i){return t.l++,i&&12==i.biff?[t.read_shift(4,"i"),0]:[t.read_shift(2),t.read_shift(i&&2==i.biff?1:2)]}},2:{n:"PtgTbl",f:Ki},3:{n:"PtgAdd",f:Lo},4:{n:"PtgSub",f:Lo},5:{n:"PtgMul",f:Lo},6:{n:"PtgDiv",f:Lo},7:{n:"PtgPower",f:Lo},8:{n:"PtgConcat",f:Lo},9:{n:"PtgLt",f:Lo},10:{n:"PtgLe",f:Lo},11:{n:"PtgEq",f:Lo},12:{n:"PtgGe",f:Lo},13:{n:"PtgGt",f:Lo},14:{n:"PtgNe",f:Lo},15:{n:"PtgIsect",f:Lo},16:{n:"PtgUnion",f:Lo},17:{n:"PtgRange",f:Lo},18:{n:"PtgUplus",f:Lo},19:{n:"PtgUminus",f:Lo},20:{n:"PtgPercent",f:Lo},21:{n:"PtgParen",f:Lo},22:{n:"PtgMissArg",f:Lo},23:{n:"PtgStr",f:function(t,e,i){return t.l++,Qr(t,0,i)}},26:{n:"PtgSheet",f:function(t,e,i){return t.l+=5,t.l+=2,t.l+=2==i.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(t,e,i){return t.l+=2==i.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(t){return t.l++,nr[t.read_shift(1)]}},29:{n:"PtgBool",f:function(t){return t.l++,0!==t.read_shift(1)}},30:{n:"PtgInt",f:function(t){return t.l++,t.read_shift(2)}},31:{n:"PtgNum",f:function(t){return t.l++,Wn(t)}},32:{n:"PtgArray",f:function(t,e,i){var n=(96&t[t.l++])>>5;return t.l+=2==i.biff?6:12==i.biff?14:7,[n]}},33:{n:"PtgFunc",f:function(t,e,i){var n=(96&t[t.l])>>5;t.l+=1;var r=t.read_shift(i&&i.biff<=3?1:2);return[vl[r],ml[r],n]}},34:{n:"PtgFuncVar",f:function(t,e,i){var n=t[t.l++],r=t.read_shift(1),s=i&&i.biff<=3?[88==n?-1:0,t.read_shift(1)]:function(t){return[t[t.l+1]>>7,32767&t.read_shift(2)]}(t);return[r,(0===s[0]?ml:gl)[s[1]]]}},35:{n:"PtgName",f:function(t,e,i){var n=t.read_shift(1)>>>5&3,r=!i||i.biff>=8?4:2,s=t.read_shift(r);switch(i.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12}return[n,0,s]}},36:{n:"PtgRef",f:function(t,e,i){var n=(96&t[t.l])>>5;return t.l+=1,[n,jo(t,0,i)]}},37:{n:"PtgArea",f:function(t,e,i){return[(96&t[t.l++])>>5,No(t,i.biff>=2&&i.biff,i)]}},38:{n:"PtgMemArea",f:function(t,e,i){var n=t.read_shift(1)>>>5&3;return t.l+=i&&2==i.biff?3:4,[n,t.read_shift(i&&2==i.biff?1:2)]}},39:{n:"PtgMemErr",f:Ki},40:{n:"PtgMemNoMem",f:Ki},41:{n:"PtgMemFunc",f:function(t,e,i){return[t.read_shift(1)>>>5&3,t.read_shift(i&&2==i.biff?1:2)]}},42:{n:"PtgRefErr",f:function(t,e,i){var n=t.read_shift(1)>>>5&3;return t.l+=4,i.biff<8&&t.l--,12==i.biff&&(t.l+=2),[n]}},43:{n:"PtgAreaErr",f:function(t,e,i){var n=(96&t[t.l++])>>5;return t.l+=i&&i.biff>8?12:i.biff<8?6:8,[n]}},44:{n:"PtgRefN",f:function(t,e,i){var n=(96&t[t.l])>>5;t.l+=1;var r=function(t,e,i){var n=i&&i.biff?i.biff:8;if(n>=2&&n<=5)return function(t){var e=t.read_shift(2),i=t.read_shift(1),n=(32768&e)>>15,r=(16384&e)>>14;return e&=16383,1==n&&e>=8192&&(e-=16384),1==r&&i>=128&&(i-=256),{r:e,c:i,cRel:r,rRel:n}}(t);var r=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(16384&s)>>14,o=(32768&s)>>15;if(s&=16383,1==o)for(;r>524287;)r-=1048576;if(1==a)for(;s>8191;)s-=16384;return{r,c:s,cRel:a,rRel:o}}(t,0,i);return[n,r]}},45:{n:"PtgAreaN",f:function(t,e,i){var n=(96&t[t.l++])>>5,r=function(t,e,i){if(i.biff<8)return Fo(t);var n=t.read_shift(12==i.biff?4:2),r=t.read_shift(12==i.biff?4:2),s=Do(t,2),a=Do(t,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r,c:a[0],cRel:a[1],rRel:a[2]}}}(t,0,i);return[n,r]}},46:{n:"PtgMemAreaN",f:function(t){return[t.read_shift(1)>>>5&3,t.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(t){return[t.read_shift(1)>>>5&3,t.read_shift(2)]}},57:{n:"PtgNameX",f:function(t,e,i){return 5==i.biff?function(t){var e=t.read_shift(1)>>>5&3,i=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,i,n]}(t):[t.read_shift(1)>>>5&3,t.read_shift(2),t.read_shift(4)]}},58:{n:"PtgRef3d",f:function(t,e,i){var n=(96&t[t.l])>>5;t.l+=1;var r=t.read_shift(2);return i&&5==i.biff&&(t.l+=12),[n,r,jo(t,0,i)]}},59:{n:"PtgArea3d",f:function(t,e,i){var n=(96&t[t.l++])>>5,r=t.read_shift(2,"i");if(i)switch(i.biff){case 5:t.l+=12,6;break;case 12:12}return[n,r,No(t,0,i)]}},60:{n:"PtgRefErr3d",f:function(t,e,i){var n=(96&t[t.l++])>>5,r=t.read_shift(2),s=4;if(i)switch(i.biff){case 5:s=15;break;case 12:s=6}return t.l+=s,[n,r]}},61:{n:"PtgAreaErr3d",f:function(t,e,i){var n=(96&t[t.l++])>>5,r=t.read_shift(2),s=8;if(i)switch(i.biff){case 5:t.l+=12,s=6;break;case 12:s=12}return t.l+=s,[n,r]}},255:{}},Zo={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Jo={1:{n:"PtgElfLel",f:Yo},2:{n:"PtgElfRw",f:Xo},3:{n:"PtgElfCol",f:Xo},6:{n:"PtgElfRwV",f:Xo},7:{n:"PtgElfColV",f:Xo},10:{n:"PtgElfRadical",f:Xo},11:{n:"PtgElfRadicalS",f:Vo},13:{n:"PtgElfColS",f:Vo},15:{n:"PtgElfColSV",f:Vo},16:{n:"PtgElfRadicalLel",f:Yo},25:{n:"PtgList",f:function(t){t.l+=2;var e=t.read_shift(2),i=t.read_shift(2),n=t.read_shift(4),r=t.read_shift(2),s=t.read_shift(2);return{ixti:e,coltype:3&i,rt:Ko[i>>2&31],idx:n,c:r,C:s}}},29:{n:"PtgSxName",f:function(t){return t.l+=2,[t.read_shift(4)]}},255:{}},$o={0:{n:"PtgAttrNoop",f:function(t){return t.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(t,e,i){var n=255&t[t.l+1]?1:0;return t.l+=i&&2==i.biff?3:4,[n]}},2:{n:"PtgAttrIf",f:function(t,e,i){var n=255&t[t.l+1]?1:0;return t.l+=2,[n,t.read_shift(i&&2==i.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(t,e,i){t.l+=2;for(var n=t.read_shift(i&&2==i.biff?1:2),r=[],s=0;s<=n;++s)r.push(t.read_shift(i&&2==i.biff?1:2));return r}},8:{n:"PtgAttrGoto",f:function(t,e,i){var n=255&t[t.l+1]?1:0;return t.l+=2,[n,t.read_shift(i&&2==i.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(t,e,i){t.l+=i&&2==i.biff?3:4}},32:{n:"PtgAttrBaxcel",f:zo},33:{n:"PtgAttrBaxcel",f:zo},64:{n:"PtgAttrSpace",f:function(t){return t.read_shift(2),Wo(t)}},65:{n:"PtgAttrSpaceSemi",f:function(t){return t.read_shift(2),Wo(t)}},128:{n:"PtgAttrIfError",f:function(t){var e=255&t[t.l+1]?1:0;return t.l+=2,[e,t.read_shift(2)]}},255:{}};function Qo(t,e,i,n){if(n.biff<8)return Ki(t,e);for(var r=t.l+e,s=[],a=0;a!==i.length;++a)switch(i[a][0]){case"PtgArray":i[a][1]=Ho(t,0,n),s.push(i[a][1]);break;case"PtgMemArea":i[a][2]=Uo(t,i[a][1],n),s.push(i[a][2]);break;case"PtgExp":n&&12==n.biff&&(i[a][1][1]=t.read_shift(4),s.push(i[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+i[a][0]}return 0!==(e=r-t.l)&&s.push(Ki(t,e)),s}function tl(t,e,i){for(var n,r,s=t.l+e,a=[];s!=t.l;)e=s-t.l,r=t[t.l],n=qo[r]||qo[Zo[r]],24!==r&&25!==r||(n=(24===r?Jo:$o)[t[t.l+1]]),n&&n.f?a.push([n.n,n.f(t,e,i)]):Ki(t,e);return a}function el(t){for(var e=[],i=0;i<t.length;++i){for(var n=t[i],r=[],s=0;s<n.length;++s){var a=n[s];if(a)if(2===a[0])r.push('"'+a[1].replace(/"/g,'""')+'"');else r.push(a[1]);else r.push("")}e.push(r.join(","))}return e.join(";")}var il={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nl(t,e,i){if(!t)return"SH33TJSERR0";if(i.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(i.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),0==e?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var r="";if(i.biff>8)switch(t[n[0]][0]){case 357:return r=-1==n[1]?"#REF":t.SheetNames[n[1]],n[1]==n[2]?r:r+":"+t.SheetNames[n[2]];case 358:return null!=i.SID?t.SheetNames[i.SID]:"SH33TJSSAME"+t[n[0]][0];default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return r=-1==n[1]?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?r:r+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map((function(t){return t.Name})).join(";;");default:return t[n[0]][0][3]?(r=-1==n[1]?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?r:r+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function rl(t,e,i){var n=nl(t,e,i);return"#REF"==n?n:function(t,e){if(!(t||e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}(n,i)}function sl(t,e,i,n,r){var s,a,o,l,h=r&&r.biff||8,c={s:{c:0,r:0},e:{c:0,r:0}},u=[],d=0,f=0,p="";if(!t[0]||!t[0][0])return"";for(var g=-1,m="",v=0,y=t[0].length;v<y;++v){var b=t[0][v];switch(b[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=u.pop(),a=u.pop(),g>=0){switch(t[0][g][1][0]){case 0:m=he(" ",t[0][g][1][1]);break;case 1:m=he("\r",t[0][g][1][1]);break;default:if(m="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}a+=m,g=-1}u.push(a+il[b[0]]+s);break;case"PtgIsect":s=u.pop(),a=u.pop(),u.push(a+" "+s);break;case"PtgUnion":s=u.pop(),a=u.pop(),u.push(a+","+s);break;case"PtgRange":s=u.pop(),a=u.pop(),u.push(a+":"+s);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=Qi(b[1][1],c,r),u.push(en(o,h));break;case"PtgRefN":o=i?Qi(b[1][1],i,r):b[1][1],u.push(en(o,h));break;case"PtgRef3d":d=b[1][1],o=Qi(b[1][2],c,r);p=rl(n,d,r);u.push(p+"!"+en(o,h));break;case"PtgFunc":case"PtgFuncVar":var _=b[1][0],x=b[1][1];_||(_=0);var w=0==(_&=127)?[]:u.slice(-_);u.length-=_,"User"===x&&(x=w.shift()),u.push(x+"("+w.join(",")+")");break;case"PtgBool":u.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":u.push(b[1]);break;case"PtgNum":u.push(String(b[1]));break;case"PtgStr":u.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=tn(b[1][1],i?{s:i}:c,r),u.push(nn(l,r));break;case"PtgArea":l=tn(b[1][1],c,r),u.push(nn(l,r));break;case"PtgArea3d":d=b[1][1],l=b[1][2],p=rl(n,d,r),u.push(p+"!"+nn(l,r));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgName":f=b[1][2];var S=(n.names||[])[f-1]||(n[0]||[])[f],T=S?S.Name:"SH33TJSNAME"+String(f);T&&"_xlfn."==T.slice(0,6)&&!r.xlfn&&(T=T.slice(6)),u.push(T);break;case"PtgNameX":var E,k=b[1][1];if(f=b[1][2],!(r.biff<=5)){var C="";if(14849==((n[k]||[])[0]||[])[0]||(1025==((n[k]||[])[0]||[])[0]?n[k][f]&&n[k][f].itab>0&&(C=n.SheetNames[n[k][f].itab-1]+"!"):C=n.SheetNames[f-1]+"!"),n[k]&&n[k][f])C+=n[k][f].Name;else if(n[0]&&n[0][f])C+=n[0][f].Name;else{var M=(nl(n,k,r)||"").split(";;");M[f-1]?C=M[f-1]:C+="SH33TJSERRX"}u.push(C);break}k<0&&(k=-k),n[k]&&(E=n[k][f]),E||(E={Name:"SH33TJSERRY"}),u.push(E.Name);break;case"PtgParen":var A="(",O=")";if(g>=0){switch(m="",t[0][g][1][0]){case 2:A=he(" ",t[0][g][1][1])+A;break;case 3:A=he("\r",t[0][g][1][1])+A;break;case 4:O=he(" ",t[0][g][1][1])+O;break;case 5:O=he("\r",t[0][g][1][1])+O;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}g=-1}u.push(A+u.pop()+O);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":u.push("#REF!");break;case"PtgExp":o={c:b[1][1],r:b[1][0]};var P={c:i.c,r:i.r};if(n.sharedf[hn(o)]){var R=n.sharedf[hn(o)];u.push(sl(R,c,P,n,r))}else{var I=!1;for(s=0;s!=n.arrayf.length;++s)if(a=n.arrayf[s],!(o.c<a[0].s.c||o.c>a[0].e.c||o.r<a[0].s.r||o.r>a[0].e.r)){u.push(sl(a[1],c,P,n,r)),I=!0;break}I||u.push(b[1])}break;case"PtgArray":u.push("{"+el(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgMissArg":u.push("");break;case"PtgList":u.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=r.biff&&g>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(t[0][v][0])){var L=!0;switch((b=t[0][g])[1][0]){case 4:L=!1;case 0:m=he(" ",b[1][1]);break;case 5:L=!1;case 1:m=he("\r",b[1][1]);break;default:if(m="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}u.push((L?m:"")+u.pop()+(L?"":m)),g=-1}}if(u.length>1&&r.WTF)throw new Error("bad formula stack");return u[0]}function al(t,e,i){var n,r=t.l+e,s=2==i.biff?1:2,a=t.read_shift(s);if(65535==a)return[[],Ki(t,e-2)];var o=tl(t,a,i);return e!==a+s&&(n=Qo(t,e-a-s,o,i)),t.l=r,[o,n]}function ol(t,e,i){var n,r=t.l+e,s=t.read_shift(2),a=tl(t,s,i);return 65535==s?[[],Ki(t,e-2)]:(e!==s+2&&(n=Qo(t,r-s-2,a,i)),[a,n])}function ll(t,e,i){var n=t.l+e,r=ds(t);2==i.biff&&++t.l;var s=function(t){var e;if(65535!==Ni(t,t.l+6))return[Wn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=1===t[t.l+2],t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}(t),a=t.read_shift(1);2!=i.biff&&(t.read_shift(1),i.biff>=5&&t.read_shift(4));var o=function(t,e,i){var n,r=t.l+e,s=2==i.biff?1:2,a=t.read_shift(s);if(65535==a)return[[],Ki(t,e-2)];var o=tl(t,a,i);return e!==a+s&&(n=Qo(t,e-a-s,o,i)),t.l=r,[o,n]}(t,n-t.l,i);return{cell:r,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function hl(t,e,i,n,r){var s=fs(e,i,r),a=function(t){if(null==t){var e=qi(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}return Gn("number"==typeof t?t:0)}(t.v),o=qi(6);o.write_shift(2,33),o.write_shift(4,0);for(var l=qi(t.bf.length),h=0;h<t.bf.length;++h)l[h]=t.bf[h];return H([s,a,o,l])}function cl(t,e,i){var n=t.read_shift(4),r=tl(t,n,i),s=t.read_shift(4);return[r,s>0?Qo(t,s,r,i):null]}var ul=cl,dl=cl,fl=cl,pl=cl,gl={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ml={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},vl={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function yl(t){return"of:"==t.slice(0,3)&&(t=t.slice(3)),61==t.charCodeAt(0)&&61==(t=t.slice(1)).charCodeAt(0)&&(t=t.slice(1)),(t=(t=(t=t.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(t,e){return e.replace(/\./g,"")}))).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function bl(t){var e=t.split(":");return[e[0].split(".")[0],e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var _l={},xl={},wl="undefined"!=typeof Map;function Sl(t,e,i){var n=0,r=t.length;if(i){if(wl?i.has(e):Object.prototype.hasOwnProperty.call(i,e))for(var s=wl?i.get(e):i[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}else for(;n<r;++n)if(t[n].t===e)return t.Count++,n;return t[r]={t:e},t.Count++,t.Unique++,i&&(wl?(i.has(e)||i.set(e,[]),i.get(e).push(r)):(Object.prototype.hasOwnProperty.call(i,e)||(i[e]=[]),i[e].push(r))),r}function Tl(t,e){var i={min:t+1,max:t+1},n=-1;return e.MDW&&(Oa=e.MDW),null!=e.width?i.customWidth=1:null!=e.wpx?n=Ra(e.wpx):null!=e.wch&&(n=e.wch),n>-1?(i.width=Ia(n),i.customWidth=1):null!=e.width&&(i.width=e.width),e.hidden&&(i.hidden=!0),null!=e.level&&(i.outlineLevel=i.level=e.level),i}function El(t,e){if(t){var i=[.7,.7,.75,.75,.3,.3];"xlml"==e&&(i=[1,1,1,1,.5,.5]),null==t.left&&(t.left=i[0]),null==t.right&&(t.right=i[1]),null==t.top&&(t.top=i[2]),null==t.bottom&&(t.bottom=i[3]),null==t.header&&(t.header=i[4]),null==t.footer&&(t.footer=i[5])}}function kl(t,e,i){var n=i.revssf[null!=e.z?e.z:"General"],r=60,s=t.length;if(null==n&&i.ssf)for(;r<392;++r)if(null==i.ssf[r]){Nt(e.z,r),i.ssf[r]=e.z,i.revssf[e.z]=n=r;break}for(r=0;r!=s;++r)if(t[r].numFmtId===n)return r;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Cl(t,e,i,n,r,s){try{n.cellNF&&(t.z=nt[e])}catch(t){if(n.WTF)throw t}if("z"!==t.t||n.cellStyles){if("d"===t.t&&"string"==typeof t.v&&(t.v=ae(t.v)),(!n||!1!==n.cellText)&&"z"!==t.t)try{if(null==nt[e]&&Nt(Bt[e]||"General",e),"e"===t.t)t.w=t.w||nr[t.v];else if(0===e)if("n"===t.t)(0|t.v)===t.v?t.w=t.v.toString(10):t.w=ft(t.v);else if("d"===t.t){var a=Jt(t.v);t.w=(0|a)===a?a.toString(10):ft(a)}else{if(void 0===t.v)return"";t.w=pt(t.v,xl)}else"d"===t.t?t.w=Dt(e,Jt(t.v),xl):t.w=Dt(e,t.v,xl)}catch(t){if(n.WTF)throw t}if(n.cellStyles&&null!=i)try{t.s=s.Fills[i],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=ka(r.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=r.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=ka(r.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=r.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(t){if(n.WTF&&s.Fills)throw t}}}function Ml(t,e,i){if(t&&t["!ref"]){var n=dn(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+i+"): "+t["!ref"])}}var Al=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Ol=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Pl=/<(?:\w:)?hyperlink [^>]*>/gm,Rl=/"(\w*:\w*)"/,Il=/<(?:\w:)?col\b[^>]*[\/]?>/g,Ll=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Dl=/<(?:\w:)?pageMargins[^>]*\/>/g,Nl=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Fl=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,jl=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Bl(t,e,i,n,r,s,a){if(!t)return t;n||(n={"!id":{}}),null!=R&&null==e.dense&&(e.dense=R);var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",c="",u=t.match(Ol);u?(h=t.slice(0,u.index),c=t.slice(u.index+u[0].length)):h=c=t;var d=h.match(Nl);d?zl(d[0],o,r,i):(d=h.match(Fl))&&function(t,e,i,n,r){zl(t.slice(0,t.indexOf(">")),i,n,r)}(d[0],d[1],o,r,i);var f=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var p=h.slice(f,f+50).match(Rl);p&&function(t,e){var i=dn(e);i.s.r<=i.e.r&&i.s.c<=i.e.c&&i.s.r>=0&&i.s.c>=0&&(t["!ref"]=un(i))}(o,p[1])}var g=h.match(jl);g&&g[1]&&function(t,e){e.Views||(e.Views=[{}]);(t.match(Ul)||[]).forEach((function(t,i){var n=Re(t);e.Views[i]||(e.Views[i]={}),+n.zoomScale&&(e.Views[i].zoom=+n.zoomScale),He(n.rightToLeft)&&(e.Views[i].RTL=!0)}))}(g[1],r);var m=[];if(e.cellStyles){var v=h.match(Il);v&&function(t,e){for(var i=!1,n=0;n!=e.length;++n){var r=Re(e[n],!0);r.hidden&&(r.hidden=He(r.hidden));var s=parseInt(r.min,10)-1,a=parseInt(r.max,10)-1;for(r.outlineLevel&&(r.level=+r.outlineLevel||0),delete r.min,delete r.max,r.width=+r.width,!i&&r.width&&(i=!0,Da(r.width)),Na(r);s<=a;)t[s++]=le(r)}}(m,v)}u&&Xl(u[1],o,e,l,s,a);var y=c.match(Ll);y&&(o["!autofilter"]=function(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}(y[0]));var b=[],_=c.match(Al);if(_)for(f=0;f!=_.length;++f)b[f]=dn(_[f].slice(_[f].indexOf('"')+1));var x=c.match(Pl);x&&function(t,e,i){for(var n=Array.isArray(t),r=0;r!=e.length;++r){var s=Re(qe(e[r]),!0);if(!s.ref)return;var a=((i||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Ne(s.location))):(s.Target="#"+Ne(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=dn(s.ref),l=o.s.r;l<=o.e.r;++l)for(var h=o.s.c;h<=o.e.c;++h){var c=hn({c:h,r:l});n?(t[l]||(t[l]=[]),t[l][h]||(t[l][h]={t:"z",v:void 0}),t[l][h].l=s):(t[c]||(t[c]={t:"z",v:void 0}),t[c].l=s)}}}(o,x,n);var w,S,T=c.match(Dl);if(T&&(o["!margins"]=(w=Re(T[0]),S={},["left","right","top","bottom","header","footer"].forEach((function(t){w[t]&&(S[t]=parseFloat(w[t]))})),S)),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=un(l)),e.sheetRows>0&&o["!ref"]){var E=dn(o["!ref"]);e.sheetRows<=+E.e.r&&(E.e.r=e.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=un(E))}return m.length>0&&(o["!cols"]=m),b.length>0&&(o["!merges"]=b),o}function zl(t,e,i,n){var r=Re(t);i.Sheets[n]||(i.Sheets[n]={}),r.codeName&&(i.Sheets[n].CodeName=Ne(qe(r.codeName)))}var Wl=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Gl=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];var Ul=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Hl(t,e,i,n){if(t.c&&i["!comments"].push([e,t.c]),void 0===t.v&&"string"!=typeof t.f||"z"===t.t&&!t.f)return"";var r="",s=t.t,a=t.v;if("z"!==t.t)switch(t.t){case"b":r=t.v?"1":"0";break;case"n":r=""+t.v;break;case"e":r=nr[t.v];break;case"d":n&&n.cellDates?r=ae(t.v,-1).toISOString():((t=le(t)).t="n",r=""+(t.v=Jt(ae(t.v)))),void 0===t.z&&(t.z=nt[14]);break;default:r=t.v}var o=ri("v",Be(r)),l={r:e},h=kl(n.cellXfs,t,n);switch(0!==h&&(l.s=h),t.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==t.v){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=ri("v",""+Sl(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str"}if(t.t!=s&&(t.t=s,t.v=a),"string"==typeof t.f&&t.f){var c=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=ai("f",Be(t.f),c)+(null!=t.v?o:"")}return t.l&&i["!links"].push([e,t.l]),t.D&&(l.cm=1),ai("c",o,l)}var Xl=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,i=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,r=/ref=["']([^"']*)["']/,s=Je("v"),a=Je("f");return function(o,l,h,c,u,d){for(var f,p,g,m,v,y=0,b="",_=[],x=[],w=0,S=0,T=0,E="",k=0,C=0,M=0,A=0,O=Array.isArray(d.CellXf),P=[],R=[],I=Array.isArray(l),L=[],D={},N=!1,F=!!h.sheetStubs,j=o.split(e),B=0,z=j.length;B!=z;++B){var W=(b=j[B].trim()).length;if(0!==W){var G=0;t:for(y=0;y<W;++y)switch(b[y]){case">":if("/"!=b[y-1]){++y;break t}if(h&&h.cellStyles){if(k=null!=(p=Re(b.slice(G,y),!0)).r?parseInt(p.r,10):k+1,C=-1,h.sheetRows&&h.sheetRows<k)continue;D={},N=!1,p.ht&&(N=!0,D.hpt=parseFloat(p.ht),D.hpx=Ba(D.hpt)),"1"==p.hidden&&(N=!0,D.hidden=!0),null!=p.outlineLevel&&(N=!0,D.level=+p.outlineLevel),N&&(L[k-1]=D)}break;case"<":G=y}if(G>=y)break;if(k=null!=(p=Re(b.slice(G,y),!0)).r?parseInt(p.r,10):k+1,C=-1,!(h.sheetRows&&h.sheetRows<k)){c.s.r>k-1&&(c.s.r=k-1),c.e.r<k-1&&(c.e.r=k-1),h&&h.cellStyles&&(D={},N=!1,p.ht&&(N=!0,D.hpt=parseFloat(p.ht),D.hpx=Ba(D.hpt)),"1"==p.hidden&&(N=!0,D.hidden=!0),null!=p.outlineLevel&&(N=!0,D.level=+p.outlineLevel),N&&(L[k-1]=D)),_=b.slice(y).split(t);for(var U=0;U!=_.length&&"<"==_[U].trim().charAt(0);++U);for(_=_.slice(U),y=0;y!=_.length;++y)if(0!==(b=_[y].trim()).length){if(x=b.match(i),w=y,S=0,T=0,b="<c "+("<"==b.slice(0,1)?">":"")+b,null!=x&&2===x.length){for(w=0,E=x[1],S=0;S!=E.length&&!((T=E.charCodeAt(S)-64)<1||T>26);++S)w=26*w+T;C=--w}else++C;for(S=0;S!=b.length&&62!==b.charCodeAt(S);++S);if(++S,(p=Re(b.slice(0,S),!0)).r||(p.r=hn({r:k-1,c:C})),f={t:""},null!=(x=(E=b.slice(S)).match(s))&&""!==x[1]&&(f.v=Ne(x[1])),h.cellFormula){if(null!=(x=E.match(a))&&""!==x[1]){if(f.f=Ne(qe(x[1])).replace(/\r\n/g,"\n"),h.xlfn||(f.f=Io(f.f)),x[0].indexOf('t="array"')>-1)f.F=(E.match(r)||[])[1],f.F.indexOf(":")>-1&&P.push([dn(f.F),f.F]);else if(x[0].indexOf('t="shared"')>-1){m=Re(x[0]);var H=Ne(qe(x[1]));h.xlfn||(H=Io(H)),R[parseInt(m.si,10)]=[m,H,p.r]}}else(x=E.match(/<f[^>]*\/>/))&&R[(m=Re(x[0])).si]&&(f.f=Ro(R[m.si][1],R[m.si][2],p.r));var X=ln(p.r);for(S=0;S<P.length;++S)X.r>=P[S][0].s.r&&X.r<=P[S][0].e.r&&X.c>=P[S][0].s.c&&X.c<=P[S][0].e.c&&(f.F=P[S][1])}if(null==p.t&&void 0===f.v)if(f.f||f.F)f.v=0,f.t="n";else{if(!F)continue;f.t="z"}else f.t=p.t||"n";switch(c.s.c>C&&(c.s.c=C),c.e.c<C&&(c.e.c=C),f.t){case"n":if(""==f.v||null==f.v){if(!F)continue;f.t="z"}else f.v=parseFloat(f.v);break;case"s":if(void 0===f.v){if(!F)continue;f.t="z"}else g=_l[parseInt(f.v,10)],f.v=g.t,f.r=g.r,h.cellHTML&&(f.h=g.h);break;case"str":f.t="s",f.v=null!=f.v?qe(f.v):"",h.cellHTML&&(f.h=Ge(f.v));break;case"inlineStr":x=E.match(n),f.t="s",null!=x&&(g=na(x[1]))?(f.v=g.t,h.cellHTML&&(f.h=g.h)):f.v="";break;case"b":f.v=He(f.v);break;case"d":h.cellDates?f.v=ae(f.v,1):(f.v=Jt(ae(f.v,1)),f.t="n");break;case"e":h&&!1===h.cellText||(f.w=f.v),f.v=rr[f.v]}if(M=A=0,v=null,O&&void 0!==p.s&&null!=(v=d.CellXf[p.s])&&(null!=v.numFmtId&&(M=v.numFmtId),h.cellStyles&&null!=v.fillId&&(A=v.fillId)),Cl(f,M,A,h,u,d),h.cellDates&&O&&"n"==f.t&&Pt(nt[M])&&(f.t="d",f.v=ee(f.v)),p.cm&&h.xlmeta){var V=(h.xlmeta.Cell||[])[+p.cm-1];V&&"XLDAPR"==V.type&&(f.D=!0)}if(I){var Y=ln(p.r);l[Y.r]||(l[Y.r]=[]),l[Y.r][Y.c]=f}else l[p.r]=f}}}}L.length>0&&(l["!rows"]=L)}}();function Vl(t,e,i,n){var r,s=[ke,ai("worksheet",null,{xmlns:ui[0],"xmlns:r":ci.r})],a=i.SheetNames[t],o="",l=i.Sheets[a];null==l&&(l={});var h=l["!ref"]||"A1",c=dn(h);if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),h=un(c)}n||(n={}),l["!comments"]=[];var u=[];!function(t,e,i,n,r){var s=!1,a={},o=null;if("xlsx"!==n.bookType&&e.vbaraw){var l=e.SheetNames[i];try{e.Workbook&&(l=e.Workbook.Sheets[i].CodeName||l)}catch(t){}s=!0,a.codeName=Ze(Be(l))}if(t&&t["!outline"]){var h={summaryBelow:1,summaryRight:1};t["!outline"].above&&(h.summaryBelow=0),t["!outline"].left&&(h.summaryRight=0),o=(o||"")+ai("outlinePr",null,h)}(s||o)&&(r[r.length]=ai("sheetPr",o,a))}(l,i,t,e,s),s[s.length]=ai("dimension",null,{ref:h}),s[s.length]=function(t,e,i,n){var r={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(r.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ai("sheetViews",ai("sheetView",null,r),{})}(0,0,0,i),e.sheetFormat&&(s[s.length]=ai("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(s[s.length]=function(t,e){for(var i,n=["<cols>"],r=0;r!=e.length;++r)(i=e[r])&&(n[n.length]=ai("col",null,Tl(r,i)));return n[n.length]="</cols>",n.join("")}(0,l["!cols"])),s[r=s.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(o=function(t,e,i,n){var r,s,a=[],o=[],l=dn(t["!ref"]),h="",c="",u=[],d=0,f=0,p=t["!rows"],g=Array.isArray(t),m={r:c},v=-1;for(f=l.s.c;f<=l.e.c;++f)u[f]=on(f);for(d=l.s.r;d<=l.e.r;++d){for(o=[],c=sn(d),f=l.s.c;f<=l.e.c;++f){r=u[f]+c;var y=g?(t[d]||[])[f]:t[r];void 0!==y&&null!=(h=Hl(y,r,t,e))&&o.push(h)}(o.length>0||p&&p[d])&&(m={r:c},p&&p[d]&&((s=p[d]).hidden&&(m.hidden=1),v=-1,s.hpx?v=ja(s.hpx):s.hpt&&(v=s.hpt),v>-1&&(m.ht=v,m.customHeight=1),s.level&&(m.outlineLevel=s.level)),a[a.length]=ai("row",o.join(""),m))}if(p)for(;d<p.length;++d)p&&p[d]&&(m={r:d+1},(s=p[d]).hidden&&(m.hidden=1),v=-1,s.hpx?v=ja(s.hpx):s.hpt&&(v=s.hpt),v>-1&&(m.ht=v,m.customHeight=1),s.level&&(m.outlineLevel=s.level),a[a.length]=ai("row","",m));return a.join("")}(l,e,0,0),o.length>0&&(s[s.length]=o)),s.length>r+1&&(s[s.length]="</sheetData>",s[r]=s[r].replace("/>",">")),l["!protect"]&&(s[s.length]=function(t){var e={sheet:1};return Wl.forEach((function(i){null!=t[i]&&t[i]&&(e[i]="1")})),Gl.forEach((function(i){null==t[i]||t[i]||(e[i]="0")})),t.password&&(e.password=_a(t.password).toString(16).toUpperCase()),ai("sheetProtection",null,e)}(l["!protect"])),null!=l["!autofilter"]&&(s[s.length]=function(t,e,i,n){var r="string"==typeof t.ref?t.ref:un(t.ref);i.Workbook||(i.Workbook={Sheets:[]}),i.Workbook.Names||(i.Workbook.Names=[]);var s=i.Workbook.Names,a=cn(r);a.s.r==a.e.r&&(a.e.r=cn(e["!ref"]).e.r,r=un(a));for(var o=0;o<s.length;++o){var l=s[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==n){l.Ref="'"+i.SheetNames[n]+"'!"+r;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+i.SheetNames[n]+"'!"+r}),ai("autoFilter",null,{ref:r})}(l["!autofilter"],l,i,t)),null!=l["!merges"]&&l["!merges"].length>0&&(s[s.length]=function(t){if(0===t.length)return"";for(var e='<mergeCells count="'+t.length+'">',i=0;i!=t.length;++i)e+='<mergeCell ref="'+un(t[i])+'"/>';return e+"</mergeCells>"}(l["!merges"]));var d,f,p=-1,g=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach((function(t){t[1].Target&&(d={ref:t[0]},"#"!=t[1].Target.charAt(0)&&(g=dr(n,-1,Be(t[1].Target).replace(/#.*$/,""),lr.HLINK),d["r:id"]="rId"+g),(p=t[1].Target.indexOf("#"))>-1&&(d.location=Be(t[1].Target.slice(p+1))),t[1].Tooltip&&(d.tooltip=Be(t[1].Tooltip)),s[s.length]=ai("hyperlink",null,d))})),s[s.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(s[s.length]=(El(f=l["!margins"]),ai("pageMargins",null,f))),e&&!e.ignoreEC&&null!=e.ignoreEC||(s[s.length]=ri("ignoredErrors",ai("ignoredError",null,{numberStoredAsText:1,sqref:h}))),u.length>0&&(g=dr(n,-1,"../drawings/drawing"+(t+1)+".xml",lr.DRAW),s[s.length]=ai("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=u),l["!comments"].length>0&&(g=dr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",lr.VML),s[s.length]=ai("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Yl(t,e,i,n){var r=function(t,e,i){var n=qi(145),r=(i["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;r.hpx?s=20*ja(r.hpx):r.hpt&&(s=20*r.hpt),n.write_shift(2,s),n.write_shift(1,0);var a=0;r.level&&(a|=r.level),r.hidden&&(a|=16),(r.hpx||r.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var h={r:t,c:0},c=0;c<16;++c)if(!(e.s.c>c+1<<10||e.e.c<c<<10)){for(var u=-1,d=-1,f=c<<10;f<c+1<<10;++f)h.c=f,(Array.isArray(i)?(i[h.r]||[])[h.c]:i[hn(h)])&&(u<0&&(u=f),d=f);u<0||(++o,n.write_shift(4,u),n.write_shift(4,d))}var p=n.l;return n.l=l,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}(n,i,e);(r.length>17||(e["!rows"]||[])[n])&&$i(t,0,r)}var Kl=Bn,ql=zn;function Zl(t){return[Cn(t),Wn(t),"n"]}var Jl=Bn,$l=zn;var Ql=["left","right","top","bottom","header","footer"];function th(t,e,i,n,r,s,a){if(void 0===e.v)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":(e=le(e)).z=e.z||nt[14],e.v=Jt(ae(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v}var l={r:i,c:n};switch(l.s=kl(r.cellXfs,e,r),e.l&&s["!links"].push([hn(l),e.l]),e.c&&s["!comments"].push([hn(l),e.c]),e.t){case"s":case"str":return r.bookSST?(o=Sl(r.Strings,e.v,r.revStrings),l.t="s",l.v=o,a?$i(t,18,function(t,e,i){return null==i&&(i=qi(8)),Mn(e,i),i.write_shift(4,e.v),i}(0,l)):$i(t,7,function(t,e,i){return null==i&&(i=qi(12)),kn(e,i),i.write_shift(4,e.v),i}(0,l))):(l.t="str",a?$i(t,17,function(t,e,i){return null==i&&(i=qi(8+4*t.v.length)),Mn(e,i),_n(t.v,i),i.length>i.l?i.slice(0,i.l):i}(e,l)):$i(t,6,function(t,e,i){return null==i&&(i=qi(12+4*t.v.length)),kn(e,i),_n(t.v,i),i.length>i.l?i.slice(0,i.l):i}(e,l))),!0;case"n":return e.v==(0|e.v)&&e.v>-1e3&&e.v<1e3?a?$i(t,13,function(t,e,i){return null==i&&(i=qi(8)),Mn(e,i),Fn(t.v,i),i}(e,l)):$i(t,2,function(t,e,i){return null==i&&(i=qi(12)),kn(e,i),Fn(t.v,i),i}(e,l)):a?$i(t,16,function(t,e,i){return null==i&&(i=qi(12)),Mn(e,i),Gn(t.v,i),i}(e,l)):$i(t,5,function(t,e,i){return null==i&&(i=qi(16)),kn(e,i),Gn(t.v,i),i}(e,l)),!0;case"b":return l.t="b",a?$i(t,15,function(t,e,i){return null==i&&(i=qi(5)),Mn(e,i),i.write_shift(1,t.v?1:0),i}(e,l)):$i(t,4,function(t,e,i){return null==i&&(i=qi(9)),kn(e,i),i.write_shift(1,t.v?1:0),i}(e,l)),!0;case"e":return l.t="e",a?$i(t,14,function(t,e,i){return null==i&&(i=qi(8)),Mn(e,i),i.write_shift(1,t.v),i.write_shift(2,0),i.write_shift(1,0),i}(e,l)):$i(t,3,function(t,e,i){return null==i&&(i=qi(9)),kn(e,i),i.write_shift(1,t.v),i}(e,l)),!0}return a?$i(t,12,function(t,e,i){return null==i&&(i=qi(4)),Mn(e,i)}(0,l)):$i(t,1,function(t,e,i){return null==i&&(i=qi(8)),kn(e,i)}(0,l)),!0}function eh(t,e){var i,n;e&&e["!merges"]&&($i(t,177,(i=e["!merges"].length,null==n&&(n=qi(4)),n.write_shift(4,i),n)),e["!merges"].forEach((function(e){$i(t,176,$l(e))})),$i(t,178))}function ih(t,e){e&&e["!cols"]&&($i(t,390),e["!cols"].forEach((function(e,i){e&&$i(t,60,function(t,e,i){null==i&&(i=qi(18));var n=Tl(t,e);i.write_shift(-4,t),i.write_shift(-4,t),i.write_shift(4,256*(n.width||10)),i.write_shift(4,0);var r=0;return e.hidden&&(r|=1),"number"==typeof n.width&&(r|=2),e.level&&(r|=e.level<<8),i.write_shift(2,r),i}(i,e))})),$i(t,391))}function nh(t,e){var i,n;e&&e["!ref"]&&($i(t,648),$i(t,649,(i=dn(e["!ref"]),(n=qi(24)).write_shift(4,4),n.write_shift(4,1),zn(i,n),n)),$i(t,650))}function rh(t,e,i){e["!links"].forEach((function(e){if(e[1].Target){var n=dr(i,-1,e[1].Target.replace(/#.*$/,""),lr.HLINK);$i(t,494,function(t,e){var i=qi(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));zn({s:ln(t[0]),e:ln(t[0])},i),Dn("rId"+e,i);var n=t[1].Target.indexOf("#");return _n((-1==n?"":t[1].Target.slice(n+1))||"",i),_n(t[1].Tooltip||"",i),_n("",i),i.slice(0,i.l)}(e,n))}})),delete e["!links"]}function sh(t,e,i){$i(t,133),$i(t,137,function(t,e,i){null==i&&(i=qi(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),i.write_shift(2,n),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(1,0),i.write_shift(1,0),i.write_shift(2,0),i.write_shift(2,100),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i}(0,i)),$i(t,138),$i(t,134)}function ah(t,e){var i,n;e["!protect"]&&$i(t,535,(i=e["!protect"],null==n&&(n=qi(66)),n.write_shift(2,i.password?_a(i.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach((function(t){t[1]?n.write_shift(4,null==i[t[0]]||i[t[0]]?0:1):n.write_shift(4,null!=i[t[0]]&&i[t[0]]?0:1)})),n))}function oh(t,e,i,n){var r=Ji(),s=i.SheetNames[t],a=i.Sheets[s]||{},o=s;try{i&&i.Workbook&&(o=i.Workbook.Sheets[t].CodeName||o)}catch(t){}var l,h,c=dn(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],$i(r,129),(i.vbaraw||a["!outline"])&&$i(r,147,function(t,e,i){null==i&&(i=qi(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),i.write_shift(1,n);for(var r=1;r<3;++r)i.write_shift(1,0);return Un({auto:1},i),i.write_shift(-4,-1),i.write_shift(-4,-1),On(t,i),i.slice(0,i.l)}(o,a["!outline"])),$i(r,148,ql(c)),sh(r,0,i.Workbook),ih(r,a),function(t,e,i,n){var r,s=dn(e["!ref"]||"A1"),a="",o=[];$i(t,145);var l=Array.isArray(e),h=s.e.r;e["!rows"]&&(h=Math.max(s.e.r,e["!rows"].length-1));for(var c=s.s.r;c<=h;++c){a=sn(c),Yl(t,e,s,c);var u=!1;if(c<=s.e.r)for(var d=s.s.c;d<=s.e.c;++d){c===s.s.r&&(o[d]=on(d)),r=o[d]+a;var f=l?(e[c]||[])[d]:e[r];u=!!f&&th(t,f,c,d,n,e,u)}}$i(t,146)}(r,a,0,e),ah(r,a),function(t,e,i,n){if(e["!autofilter"]){var r=e["!autofilter"],s="string"==typeof r.ref?r.ref:un(r.ref);i.Workbook||(i.Workbook={Sheets:[]}),i.Workbook.Names||(i.Workbook.Names=[]);var a=i.Workbook.Names,o=cn(s);o.s.r==o.e.r&&(o.e.r=cn(e["!ref"]).e.r,s=un(o));for(var l=0;l<a.length;++l){var h=a[l];if("_xlnm._FilterDatabase"==h.Name&&h.Sheet==n){h.Ref="'"+i.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+i.SheetNames[n]+"'!"+s}),$i(t,161,zn(dn(s))),$i(t,162)}}(r,a,i,t),eh(r,a),rh(r,a,n),a["!margins"]&&$i(r,476,(l=a["!margins"],null==h&&(h=qi(48)),El(l),Ql.forEach((function(t){Gn(l[t],h)})),h)),e&&!e.ignoreEC&&null!=e.ignoreEC||nh(r,a),function(t,e,i,n){if(e["!comments"].length>0){var r=dr(n,-1,"../drawings/vmlDrawing"+(i+1)+".vml",lr.VML);$i(t,551,Dn("rId"+r)),e["!legacy"]=r}}(r,a,t,n),$i(r,130),r.end()}function lh(t,e,i,n,r,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,h="A",c={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach((function(t){var e=function(t){var e,i=[],n=t.match(/^<c:numCache>/);(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach((function(t){var e=t.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);e&&(i[+e[1]]=n?+e[2]:e[2])}));var r=Ne((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach((function(t){e=t.replace(/<.*?>/g,"")})),[i,r,e]}(t);c.s.r=c.s.c=0,c.e.c=o,h=on(o),e[0].forEach((function(t,i){a[h+sn(i)]={t:"n",v:t,z:e[1]},l=i})),c.e.r<l&&(c.e.r=l),++o})),o>0&&(a["!ref"]=un(c)),a}var hh=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],ch=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],uh=[],dh=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function fh(t,e){for(var i=0;i!=t.length;++i)for(var n=t[i],r=0;r!=e.length;++r){var s=e[r];if(null==n[s[0]])n[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof n[s[0]]&&(n[s[0]]=He(n[s[0]]));break;case"int":"string"==typeof n[s[0]]&&(n[s[0]]=parseInt(n[s[0]],10))}}}function ph(t,e){for(var i=0;i!=e.length;++i){var n=e[i];if(null==t[n[0]])t[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof t[n[0]]&&(t[n[0]]=He(t[n[0]]));break;case"int":"string"==typeof t[n[0]]&&(t[n[0]]=parseInt(t[n[0]],10))}}}function gh(t){ph(t.WBProps,hh),ph(t.CalcPr,dh),fh(t.WBView,ch),fh(t.Sheets,uh),xl.date1904=He(t.WBProps.date1904)}var mh="][*?/\\".split("");function vh(t,e){if(t.length>31){if(e)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var i=!0;return mh.forEach((function(n){if(-1!=t.indexOf(n)){if(!e)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");i=!1}})),i}function yh(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];!function(t,e,i){t.forEach((function(n,r){vh(n);for(var s=0;s<r;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(i){var a=e&&e[r]&&e[r].CodeName||n;if(95==a.charCodeAt(0)&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}}))}(t.SheetNames,e,!!t.vbaraw);for(var i=0;i<t.SheetNames.length;++i)Ml(t.Sheets[t.SheetNames[i]],t.SheetNames[i],i)}var bh=/<\w+:workbook/;function _h(t){var e=[ke];e[e.length]=ai("workbook",null,{xmlns:ui[0],"xmlns:r":ci.r});var i=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(hh.forEach((function(e){null!=t.Workbook.WBProps[e[0]]&&t.Workbook.WBProps[e[0]]!=e[1]&&(n[e[0]]=t.Workbook.WBProps[e[0]])})),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=ai("workbookPr",null,n);var r=t.Workbook&&t.Workbook.Sheets||[],s=0;if(r&&r[0]&&r[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&r[s]&&r[s].Hidden;++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:Be(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),r[s])switch(r[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden"}e[e.length]=ai("sheet",null,a)}return e[e.length]="</sheets>",i&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach((function(t){var i={name:t.Name};t.Comment&&(i.comment=t.Comment),null!=t.Sheet&&(i.localSheetId=""+t.Sheet),t.Hidden&&(i.hidden="1"),t.Ref&&(e[e.length]=ai("definedName",Be(t.Ref),i))})),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function xh(t,e){var i={};return t.read_shift(4),i.ArchID=t.read_shift(4),t.l+=e-8,i}function wh(t,e){if(e.Workbook&&e.Workbook.Sheets){for(var i,n,r=e.Workbook.Sheets,s=0,a=-1,o=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&-1==a?a=s:1==r[s].Hidden&&-1==o&&(o=s);if(!(o>a))$i(t,135),$i(t,158,(i=a,n||(n=qi(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,i),n.write_shift(4,i),n.write_shift(1,120),n.length>n.l?n.slice(0,n.l):n)),$i(t,136)}}function Sh(t,e){var i=Ji();return $i(i,131),$i(i,128,function(t,e){e||(e=qi(127));for(var i=0;4!=i;++i)e.write_shift(4,0);return _n("SheetJS",e),_n(y.version,e),_n(y.version,e),_n("7262",e),e.length>e.l?e.slice(0,e.l):e}()),$i(i,153,function(t,e){e||(e=qi(72));var i=0;return t&&t.filterPrivacy&&(i|=8),e.write_shift(4,i),e.write_shift(4,0),On(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}(t.Workbook&&t.Workbook.WBProps||null)),wh(i,t),function(t,e){$i(t,143);for(var i=0;i!=e.SheetNames.length;++i){$i(t,156,(n={Hidden:e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[i]&&e.Workbook.Sheets[i].Hidden||0,iTabID:i+1,strRelID:"rId"+(i+1),name:e.SheetNames[i]},(r=void 0)||(r=qi(127)),r.write_shift(4,n.Hidden),r.write_shift(4,n.iTabID),Dn(n.strRelID,r),_n(n.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r))}var n,r;$i(t,144)}(i,t),$i(i,132),i.end()}function Th(t,e,i){return".bin"===e.slice(-4)?function(t,e){var i={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],r=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],lc[16]={n:"BrtFRTArchID$",f:xh},Zi(t,(function(t,o,l){switch(l){case 156:a.SheetNames.push(t.name),i.Sheets.push(t);break;case 153:i.WBProps=t;break;case 39:null!=t.Sheet&&(e.SID=t.Sheet),t.Ref=sl(t.Ptg,0,null,a,e),delete e.SID,delete t.Ptg,s.push(t);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:a[0].length?a.push([l,t]):a[0]=[l,t],a[a.length-1].XTI=[];break;case 362:0===a.length&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(t),a.XTI=a.XTI.concat(t);break;case 35:case 37:n.push(l),r=!0;break;case 36:case 38:n.pop(),r=!1;break;default:if(o.T);else if(!r||e.WTF&&37!=n[n.length-1]&&35!=n[n.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}}),e),gh(i),i.Names=s,i.supbooks=a,i}(t,i):function(t,e){if(!t)throw new Error("Could not find file");var i={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,r="xmlns",s={},a=0;if(t.replace(Ae,(function(o,l){var h=Re(o);switch(Ie(h[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(bh)&&(r="xmlns"+o.match(/<(\w+):/)[1]),i.xmlns=h[r];break;case"<fileVersion":delete h[0],i.AppVersion=h;break;case"<workbookPr":case"<workbookPr/>":hh.forEach((function(t){if(null!=h[t[0]])switch(t[2]){case"bool":i.WBProps[t[0]]=He(h[t[0]]);break;case"int":i.WBProps[t[0]]=parseInt(h[t[0]],10);break;default:i.WBProps[t[0]]=h[t[0]]}})),h.codeName&&(i.WBProps.CodeName=qe(h.codeName));break;case"<workbookView":case"<workbookView/>":delete h[0],i.WBView.push(h);break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=Ne(qe(h.name)),delete h[0],i.Sheets.push(h);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":n=!1;break;case"<definedName":(s={}).Name=qe(h.name),h.comment&&(s.Comment=h.comment),h.localSheetId&&(s.Sheet=+h.localSheetId),He(h.hidden||"0")&&(s.Hidden=!0),a=l+o.length;break;case"</definedName>":s.Ref=Ne(qe(t.slice(a,l))),i.Names.push(s);break;case"<calcPr":case"<calcPr/>":delete h[0],i.CalcPr=h;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return o})),-1===ui.indexOf(i.xmlns))throw new Error("Unknown Namespace: "+i.xmlns);return gh(i),i}(t,i)}function Eh(t,e,i,n,r,s,a,o){return".bin"===e.slice(-4)?function(t,e,i,n,r,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}}),null!=R&&null==o.dense&&(o.dense=R);var l,h,c,u,d,f,p,g,m,v,y=o.dense?[]:{},b={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=[],x=!1,w=!1,S=[];o.biff=12,o["!row"]=0;var T=0,E=!1,k=[],C={},M=o.supbooks||r.supbooks||[[]];if(M.sharedf=C,M.arrayf=k,M.SheetNames=r.SheetNames||r.Sheets.map((function(t){return t.name})),!o.supbooks&&(o.supbooks=M,r.Names))for(var A=0;A<r.Names.length;++A)M[0][A+1]=r.Names[A];var O,P,I=[],L=[],D=!1;if(lc[16]={n:"BrtShortReal",f:Zl},Zi(t,(function(t,e,A){if(!w)switch(A){case 148:l=t;break;case 0:h=t,o.sheetRows&&o.sheetRows<=h.r&&(w=!0),m=sn(d=h.r),o["!row"]=h.r,(t.hidden||t.hpt||null!=t.level)&&(t.hpt&&(t.hpx=Ba(t.hpt)),L[t.r]=t);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(c={t:t[2]},t[2]){case"n":c.v=t[1];break;case"s":g=_l[t[1]],c.v=g.t,c.r=g.r;break;case"b":c.v=!!t[1];break;case"e":c.v=t[1],!1!==o.cellText&&(c.w=nr[c.v]);break;case"str":c.t="s",c.v=t[1];break;case"is":c.t="s",c.v=t[1].t}if((u=a.CellXf[t[0].iStyleRef])&&Cl(c,u.numFmtId,null,o,s,a),f=-1==t[0].c?f+1:t[0].c,o.dense?(y[d]||(y[d]=[]),y[d][f]=c):y[on(f)+m]=c,o.cellFormula){for(E=!1,T=0;T<k.length;++T){var R=k[T];h.r>=R[0].s.r&&h.r<=R[0].e.r&&f>=R[0].s.c&&f<=R[0].e.c&&(c.F=un(R[0]),E=!0)}!E&&t.length>3&&(c.f=t[3])}if(b.s.r>h.r&&(b.s.r=h.r),b.s.c>f&&(b.s.c=f),b.e.r<h.r&&(b.e.r=h.r),b.e.c<f&&(b.e.c=f),o.cellDates&&u&&"n"==c.t&&Pt(nt[u.numFmtId])){var N=ot(c.v);N&&(c.t="d",c.v=new Date(N.y,N.m-1,N.d,N.H,N.M,N.S,N.u))}O&&("XLDAPR"==O.type&&(c.D=!0),O=void 0),P&&(P=void 0);break;case 1:case 12:if(!o.sheetStubs||x)break;c={t:"z",v:void 0},f=-1==t[0].c?f+1:t[0].c,o.dense?(y[d]||(y[d]=[]),y[d][f]=c):y[on(f)+m]=c,b.s.r>h.r&&(b.s.r=h.r),b.s.c>f&&(b.s.c=f),b.e.r<h.r&&(b.e.r=h.r),b.e.c<f&&(b.e.c=f),O&&("XLDAPR"==O.type&&(c.D=!0),O=void 0),P&&(P=void 0);break;case 176:S.push(t);break;case 49:O=((o.xlmeta||{}).Cell||[])[t-1];break;case 494:var F=n["!id"][t.relId];for(F?(t.Target=F.Target,t.loc&&(t.Target+="#"+t.loc),t.Rel=F):""==t.relId&&(t.Target="#"+t.loc),d=t.rfx.s.r;d<=t.rfx.e.r;++d)for(f=t.rfx.s.c;f<=t.rfx.e.c;++f)o.dense?(y[d]||(y[d]=[]),y[d][f]||(y[d][f]={t:"z",v:void 0}),y[d][f].l=t):(p=hn({c:f,r:d}),y[p]||(y[p]={t:"z",v:void 0}),y[p].l=t);break;case 426:if(!o.cellFormula)break;k.push(t),(v=o.dense?y[d][f]:y[on(f)+m]).f=sl(t[1],0,{r:h.r,c:f},M,o),v.F=un(t[0]);break;case 427:if(!o.cellFormula)break;C[hn(t[0].s)]=t[1],(v=o.dense?y[d][f]:y[on(f)+m]).f=sl(t[1],0,{r:h.r,c:f},M,o);break;case 60:if(!o.cellStyles)break;for(;t.e>=t.s;)I[t.e--]={width:t.w/256,hidden:!!(1&t.flags),level:t.level},D||(D=!0,Da(t.w/256)),Na(I[t.e+1]);break;case 161:y["!autofilter"]={ref:un(t)};break;case 476:y["!margins"]=t;break;case 147:r.Sheets[i]||(r.Sheets[i]={}),t.name&&(r.Sheets[i].CodeName=t.name),(t.above||t.left)&&(y["!outline"]={above:t.above,left:t.left});break;case 137:r.Views||(r.Views=[{}]),r.Views[0]||(r.Views[0]={}),t.RTL&&(r.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:_.push(A),x=!0;break;case 38:_.pop(),x=!1;break;default:if(e.T);else if(!x||o.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}),o),delete o.supbooks,delete o["!row"],!y["!ref"]&&(b.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(y["!ref"]=un(l||b)),o.sheetRows&&y["!ref"]){var N=dn(y["!ref"]);o.sheetRows<=+N.e.r&&(N.e.r=o.sheetRows-1,N.e.r>b.e.r&&(N.e.r=b.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>b.e.c&&(N.e.c=b.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),y["!fullref"]=y["!ref"],y["!ref"]=un(N))}return S.length>0&&(y["!merges"]=S),I.length>0&&(y["!cols"]=I),L.length>0&&(y["!rows"]=L),y}(t,n,i,r,s,a,o):Bl(t,n,i,r,s,a,o)}function kh(t,e,i,n,r,s,a,o){return".bin"===e.slice(-4)?function(t,e,i,n,r){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=[],o=!1;return Zi(t,(function(t,n,l){switch(l){case 550:s["!rel"]=t;break;case 651:r.Sheets[i]||(r.Sheets[i]={}),t.name&&(r.Sheets[i].CodeName=t.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(l);break;case 38:a.pop();break;default:if(n.T>0)a.push(l);else if(n.T<0)a.pop();else if(!o||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}(t,n,i,r,s):function(t,e,i,n,r){if(!t)return t;n||(n={"!id":{}});var s,a={"!type":"chart","!drawel":null,"!rel":""},o=t.match(Nl);return o&&zl(o[0],0,r,i),(s=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=s[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}(t,0,i,r,s)}function Ch(t,e,i,n){return".bin"===e.slice(-4)?function(t,e,i){var n={NumberFmt:[]};for(var r in nt)n.NumberFmt[r]=nt[r];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return Zi(t,(function(t,r,o){switch(o){case 44:n.NumberFmt[t[0]]=t[1],Nt(t[1],t[0]);break;case 43:n.Fonts.push(t),null!=t.color.theme&&e&&e.themeElements&&e.themeElements.clrScheme&&(t.color.rgb=ka(e.themeElements.clrScheme[t.color.theme].rgb,t.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==s[s.length-1]&&n.CellXf.push(t);break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(o),a=!0;break;case 38:s.pop(),a=!1;break;default:if(r.T>0)s.push(o);else if(r.T<0)s.pop();else if(!a||i.WTF&&37!=s[s.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}})),n}(t,i,n):Ua(t,i,n)}function Mh(t,e,i){return".bin"===e.slice(-4)?function(t,e){var i=[],n=!1;return Zi(t,(function(t,r,s){switch(s){case 159:i.Count=t[0],i.Unique=t[1];break;case 19:i.push(t);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(r.T,!n||e.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}})),i}(t,i):function(t,e){var i=[],n="";if(!t)return i;var r=t.match(ra);if(r){n=r[2].replace(sa,"").split(aa);for(var s=0;s!=n.length;++s){var a=na(n[s].trim(),e);null!=a&&(i[i.length]=a)}r=Re(r[1]),i.Count=r.count,i.Unique=r.uniqueCount}return i}(t,i)}function Ah(t,e,i){return".bin"===e.slice(-4)?function(t,e){var i=[],n=[],r={},s=!1;return Zi(t,(function(t,a,o){switch(o){case 632:n.push(t);break;case 635:r=t;break;case 637:r.t=t.t,r.h=t.h,r.r=t.r;break;case 636:if(r.author=n[r.iauthor],delete r.iauthor,e.sheetRows&&r.rfx&&e.sheetRows<=r.rfx.r)break;r.t||(r.t=""),delete r.rfx,i.push(r);break;case 3072:case 37:case 38:break;case 35:s=!0;break;case 36:s=!1;break;default:if(a.T);else if(!s||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}})),i}(t,i):function(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var i=[],n=[],r=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);r&&r[1]&&r[1].split(/<\/\w*:?author>/).forEach((function(t){if(""!==t&&""!==t.trim()){var e=t.match(/<(?:\w+:)?author[^>]*>(.*)/);e&&i.push(e[1])}}));var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach((function(t){if(""!==t&&""!==t.trim()){var r=t.match(/<(?:\w+:)?comment[^>]*>/);if(r){var s=Re(r[0]),a={author:s.authorId&&i[s.authorId]||"sheetjsghost",ref:s.ref,guid:s.guid},o=ln(s.ref);if(!(e.sheetRows&&e.sheetRows<=o.r)){var l=t.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!l&&!!l[1]&&na(l[1])||{r:"",t:"",h:""};a.r=h.r,"<t></t>"==h.r&&(h.t=h.h=""),a.t=(h.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.cellHTML&&(a.h=h.h),n.push(a)}}}})),n}(t,i)}function Oh(t,e,i){return".bin"===e.slice(-4)?function(t,e,i){var n=[];return Zi(t,(function(t,e,i){if(63===i)n.push(t);else if(!e.T)throw new Error("Unexpected record 0x"+i.toString(16))})),n}(t):function(t){var e=[];if(!t)return e;var i=1;return(t.match(Ae)||[]).forEach((function(t){var n=Re(t);switch(n[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?i=n.i:n.i=i,e.push(n)}})),e}(t)}function Ph(t,e,i,n){if(".bin"===i.slice(-4))return function(t,e,i,n){if(!t)return t;var r=n||{},s=!1;Zi(t,(function(t,e,i){switch(i){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(e.T);else if(!s||r.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}}),r)}(t,0,0,n)}function Rh(t,e,i){return".bin"===e.slice(-4)?function(t,e,i){var n={Types:[],Cell:[],Value:[]},r=i||{},s=[],a=!1,o=2;return Zi(t,(function(t,e,i){switch(i){case 335:n.Types.push({name:t.name});break;case 51:t.forEach((function(t){1==o?n.Cell.push({type:n.Types[t[0]-1].name,index:t[1]}):0==o&&n.Value.push({type:n.Types[t[0]-1].name,index:t[1]})}));break;case 337:o=t?1:0;break;case 338:o=2;break;case 35:s.push(i),a=!0;break;case 36:s.pop(),a=!1;break;default:if(e.T);else if(!a||r.WTF&&35!=s[s.length-1])throw new Error("Unexpected record 0x"+i.toString(16))}})),n}(t,0,i):function(t,e,i){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var r,s=!1,a=2;return t.replace(Ae,(function(t){var e=Re(t);switch(Ie(e[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":n.Types.push({name:e.name});break;case"<futureMetadata":for(var o=0;o<n.Types.length;++o)n.Types[o].name==e.name&&(r=n.Types[o]);break;case"<rc":1==a?n.Cell.push({type:n.Types[e.t-1].name,index:+e.v}):0==a&&n.Value.push({type:n.Types[e.t-1].name,index:+e.v});break;case"<cellMetadata":a=1;break;case"</cellMetadata>":case"</valueMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!r)break;r.offsets||(r.offsets=[]),r.offsets.push(+e.i);break;default:if(!s&&i.WTF)throw new Error("unrecognized "+e[0]+" in metadata")}return t})),n}(t,0,i)}function Ih(t,e,i,n,r){return(".bin"===e.slice(-4)?oh:Vl)(t,i,n,r)}function Lh(t,e,i){return(".bin"===e.slice(-4)?Eo:wo)(t,i)}var Dh,Nh=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Fh=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function jh(t,e){var i=t.split(/\s+/),n=[];if(e||(n[0]=i[0]),1===i.length)return n;var r,s,a,o=t.match(Nh);if(o)for(a=0;a!=o.length;++a)-1===(s=(r=o[a].match(Fh))[1].indexOf(":"))?n[r[1]]=r[2].slice(1,r[2].length-1):n["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(s+1)]=r[2].slice(1,r[2].length-1);return n}function Bh(t){var e={};if(1===t.split(/\s+/).length)return e;var i,n,r,s=t.match(Nh);if(s)for(r=0;r!=s.length;++r)-1===(n=(i=s[r].match(Fh))[1].indexOf(":"))?e[i[1]]=i[2].slice(1,i[2].length-1):e["xmlns:"===i[1].slice(0,6)?"xmlns"+i[1].slice(6):i[1].slice(n+1)]=i[2].slice(1,i[2].length-1);return e}function zh(t,e,i,n){var r=n;switch((i[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":r=He(n);break;case"i2":case"int":r=parseInt(n,10);break;case"r4":case"float":r=parseFloat(n);break;case"date":case"dateTime.tz":r=ae(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+i[0])}t[Ne(e)]=r}function Wh(t,e,i){if("z"!==t.t){if(!i||!1!==i.cellText)try{"e"===t.t?t.w=t.w||nr[t.v]:"General"===e?"n"===t.t?(0|t.v)===t.v?t.w=t.v.toString(10):t.w=ft(t.v):t.w=pt(t.v):t.w=function(t,e){var i=Dh[t]||Ne(t);return"General"===i?pt(e):Dt(i,e)}(e||"General",t.v)}catch(t){if(i.WTF)throw t}try{var n=Dh[e]||e||"General";if(i.cellNF&&(t.z=n),i.cellDates&&"n"==t.t&&Pt(n)){var r=ot(t.v);r&&(t.t="d",t.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}catch(t){if(i.WTF)throw t}}}function Gh(t,e,i){if(i.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=za[n.Pattern]||n.Pattern)}t[e.ID]=e}function Uh(t,e,i,n,r,s,a,o,l,h){var c="General",u=n.StyleID,d={};h=h||{};var f=[],p=0;for(void 0===u&&o&&(u=o.StyleID),void 0===u&&a&&(u=a.StyleID);void 0!==s[u]&&(s[u].nf&&(c=s[u].nf),s[u].Interior&&f.push(s[u].Interior),s[u].Parent);)u=s[u].Parent;switch(i.Type){case"Boolean":n.t="b",n.v=He(t);break;case"String":n.t="s",n.r=Ue(Ne(t)),n.v=t.indexOf("<")>-1?Ne(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":"Z"!=t.slice(-1)&&(t+="Z"),n.v=(ae(t)-new Date(Date.UTC(1899,11,30)))/864e5,n.v!=n.v?n.v=Ne(t):n.v<60&&(n.v=n.v-1),c&&"General"!=c||(c="yyyy-mm-dd");case"Number":void 0===n.v&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=rr[t],!1!==h.cellText&&(n.w=t);break;default:""==t&&""==e?n.t="z":(n.t="s",n.v=Ue(e||t))}if(Wh(n,c,h),!1!==h.cellFormula)if(n.Formula){var g=Ne(n.Formula);61==g.charCodeAt(0)&&(g=g.slice(1)),n.f=Mo(g,r),delete n.Formula,"RC"==n.ArrayRange?n.F=Mo("RC:RC",r):n.ArrayRange&&(n.F=Mo(n.ArrayRange,r),l.push([dn(n.F),n.F]))}else for(p=0;p<l.length;++p)r.r>=l[p][0].s.r&&r.r<=l[p][0].e.r&&r.c>=l[p][0].s.c&&r.c<=l[p][0].e.c&&(n.F=l[p][1]);h.cellStyles&&(f.forEach((function(t){!d.patternType&&t.patternType&&(d.patternType=t.patternType)})),n.s=d),void 0!==n.StyleID&&(n.ixfe=n.StyleID)}function Hh(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.v=t.w=t.ixfe=void 0}function Xh(t,e){var i=e||{};jt();var n=A(li(t));"binary"!=i.type&&"array"!=i.type&&"base64"!=i.type||(n=void 0!==M?M.utils.decode(65001,k(n)):qe(n));var r,s=n.slice(0,1024).toLowerCase(),a=!1;if((1023&(s=s.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&s.indexOf(","),1023&s.indexOf(";"))){var o=le(i);return o.type="string",Zs.to_workbook(n,o)}if(-1==s.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(t){s.indexOf("<"+t)>=0&&(a=!0)})),a)return function(t,e){var i=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!i||0==i.length)throw new Error("Invalid HTML: could not find <table>");if(1==i.length)return gn(_c(i[0],e),e);var n={SheetNames:[],Sheets:{}};return i.forEach((function(t,i){Fu(n,_c(t,e),"Sheet"+(i+1))})),n}(n,i);Dh={"General Number":"General","General Date":nt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":nt[15],"Short Date":nt[14],"Long Time":nt[19],"Medium Time":nt[18],"Short Time":nt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:nt[2],Standard:nt[4],Percent:nt[10],Scientific:nt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,h=[];null!=R&&null==i.dense&&(i.dense=R);var c,u={},d=[],f=i.dense?[]:{},p="",g={},m={},v=jh('<Data ss:Type="String">'),y=0,b=0,_=0,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},w={},S={},T="",E=0,C=[],O={},P={},I=0,L=[],D=[],N={},F=[],j=!1,B=[],z=[],W={},G=0,U=0,H={Sheets:[],WBProps:{date1904:!1}},X={};hi.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/gm,"");for(var V="";r=hi.exec(n);)switch(r[3]=(V=r[3]).toLowerCase()){case"data":if("data"==V){if("/"===r[1]){if((l=h.pop())[0]!==r[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&h.push([r[3],!0]);break}if(h[h.length-1][1])break;"/"===r[1]?Uh(n.slice(y,r.index),T,v,"comment"==h[h.length-1][0]?N:g,{c:b,r:_},w,F[b],m,B,i):(T="",v=jh(r[0]),y=r.index+r[0].length);break;case"cell":if("/"===r[1])if(D.length>0&&(g.c=D),(!i.sheetRows||i.sheetRows>_)&&void 0!==g.v&&(i.dense?(f[_]||(f[_]=[]),f[_][b]=g):f[on(b)+sn(_)]=g),g.HRef&&(g.l={Target:Ne(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(G=b+(0|parseInt(g.MergeAcross,10)),U=_+(0|parseInt(g.MergeDown,10)),C.push({s:{c:b,r:_},e:{c:G,r:U}})),i.sheetStubs)if(g.MergeAcross||g.MergeDown){for(var Y=b;Y<=G;++Y)for(var K=_;K<=U;++K)(Y>b||K>_)&&(i.dense?(f[K]||(f[K]=[]),f[K][Y]={t:"z"}):f[on(Y)+sn(K)]={t:"z"});b=G+1}else++b;else g.MergeAcross?b=G+1:++b;else(g=Bh(r[0])).Index&&(b=+g.Index-1),b<x.s.c&&(x.s.c=b),b>x.e.c&&(x.e.c=b),"/>"===r[0].slice(-2)&&++b,D=[];break;case"row":"/"===r[1]||"/>"===r[0].slice(-2)?(_<x.s.r&&(x.s.r=_),_>x.e.r&&(x.e.r=_),"/>"===r[0].slice(-2)&&(m=jh(r[0])).Index&&(_=+m.Index-1),b=0,++_):((m=jh(r[0])).Index&&(_=+m.Index-1),W={},("0"==m.AutoFitHeight||m.Height)&&(W.hpx=parseInt(m.Height,10),W.hpt=ja(W.hpx),z[_]=W),"1"==m.Hidden&&(W.hidden=!0,z[_]=W));break;case"worksheet":if("/"===r[1]){if((l=h.pop())[0]!==r[3])throw new Error("Bad state: "+l.join("|"));d.push(p),x.s.r<=x.e.r&&x.s.c<=x.e.c&&(f["!ref"]=un(x),i.sheetRows&&i.sheetRows<=x.e.r&&(f["!fullref"]=f["!ref"],x.e.r=i.sheetRows-1,f["!ref"]=un(x))),C.length&&(f["!merges"]=C),F.length>0&&(f["!cols"]=F),z.length>0&&(f["!rows"]=z),u[p]=f}else x={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=b=0,h.push([r[3],!1]),l=jh(r[0]),p=Ne(l.Name),f=i.dense?[]:{},C=[],B=[],z=[],X={name:p,Hidden:0},H.Sheets.push(X);break;case"table":if("/"===r[1]){if((l=h.pop())[0]!==r[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==r[0].slice(-2))break;h.push([r[3],!1]),F=[],j=!1}break;case"style":"/"===r[1]?Gh(w,S,i):S=jh(r[0]);break;case"numberformat":S.nf=Ne(jh(r[0]).Format||"General"),Dh[S.nf]&&(S.nf=Dh[S.nf]);for(var q=0;392!=q&&nt[q]!=S.nf;++q);if(392==q)for(q=57;392!=q;++q)if(null==nt[q]){Nt(S.nf,q);break}break;case"column":if("table"!==h[h.length-1][0])break;if((c=jh(r[0])).Hidden&&(c.hidden=!0,delete c.Hidden),c.Width&&(c.wpx=parseInt(c.Width,10)),!j&&c.wpx>10){j=!0,Oa=Ca;for(var Z=0;Z<F.length;++Z)F[Z]&&Na(F[Z])}j&&Na(c),F[c.Index-1||F.length]=c;for(var J=0;J<+c.Span;++J)F[F.length]=le(c);break;case"namedrange":if("/"===r[1])break;H.Names||(H.Names=[]);var $=Re(r[0]),Q={Name:$.Name,Ref:Mo($.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(Q.Sheet=H.Sheets.length-1),H.Names.push(Q);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===r[0].slice(-2))break;"/"===r[1]?T+=n.slice(E,r.index):E=r.index+r[0].length;break;case"interior":if(!i.cellStyles)break;S.Interior=jh(r[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===r[0].slice(-2))break;"/"===r[1]?Ar(O,V,n.slice(I,r.index)):I=r.index+r[0].length;break;case"styles":case"workbook":if("/"===r[1]){if((l=h.pop())[0]!==r[3])throw new Error("Bad state: "+l.join("|"))}else h.push([r[3],!1]);break;case"comment":if("/"===r[1]){if((l=h.pop())[0]!==r[3])throw new Error("Bad state: "+l.join("|"));Hh(N),D.push(N)}else h.push([r[3],!1]),N={a:(l=jh(r[0])).Author};break;case"autofilter":if("/"===r[1]){if((l=h.pop())[0]!==r[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==r[0].charAt(r[0].length-2)){var tt=jh(r[0]);f["!autofilter"]={ref:Mo(tt.Range).replace(/\$/g,"")},h.push([r[3],!0])}break;case"datavalidation":if("/"===r[1]){if((l=h.pop())[0]!==r[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&h.push([r[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===r[1]){if((l=h.pop())[0]!==r[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&h.push([r[3],!0]);break;default:if(0==h.length&&"document"==r[3])return Rc(n,i);if(0==h.length&&"uof"==r[3])return Rc(n,i);var et=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(r[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:et=!1}break;case"componentoptions":switch(r[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:et=!1}break;case"excelworkbook":switch(r[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:et=!1}break;case"workbookoptions":switch(r[3]){case"owcversion":case"height":case"width":break;default:et=!1}break;case"worksheetoptions":switch(r[3]){case"visible":if("/>"===r[0].slice(-2));else if("/"===r[1])switch(n.slice(I,r.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2}else I=r.index+r[0].length;break;case"header":f["!margins"]||El(f["!margins"]={},"xlml"),isNaN(+Re(r[0]).Margin)||(f["!margins"].header=+Re(r[0]).Margin);break;case"footer":f["!margins"]||El(f["!margins"]={},"xlml"),isNaN(+Re(r[0]).Margin)||(f["!margins"].footer=+Re(r[0]).Margin);break;case"pagemargins":var it=Re(r[0]);f["!margins"]||El(f["!margins"]={},"xlml"),isNaN(+it.Top)||(f["!margins"].top=+it.Top),isNaN(+it.Left)||(f["!margins"].left=+it.Left),isNaN(+it.Right)||(f["!margins"].right=+it.Right),isNaN(+it.Bottom)||(f["!margins"].bottom=+it.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;default:et=!1}break;case"pivottable":case"pivotcache":switch(r[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:et=!1}break;case"pagebreaks":switch(r[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:et=!1}break;case"autofilter":switch(r[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:et=!1}break;case"querytable":switch(r[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:et=!1}break;case"datavalidation":switch(r[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:et=!1}break;case"sorting":case"conditionalformatting":switch(r[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:et=!1}break;case"mapinfo":case"schema":case"data":switch(r[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:et=!1}break;case"smarttags":break;default:et=!1}if(et)break;if(r[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+r[3]+"|"+h.join("|");if("customdocumentproperties"===h[h.length-1][0]){if("/>"===r[0].slice(-2))break;"/"===r[1]?zh(P,V,L,n.slice(I,r.index)):(L=r,I=r.index+r[0].length);break}if(i.WTF)throw"Unrecognized tag: "+r[3]+"|"+h.join("|")}var rt={};return i.bookSheets||i.bookProps||(rt.Sheets=u),rt.SheetNames=d,rt.Workbook=H,rt.SSF=le(nt),rt.Props=O,rt.Custprops=P,rt}function Vh(t,e){switch(cu(e=e||{}),e.type||"base64"){case"base64":return Xh(D(t),e);case"binary":case"buffer":case"file":return Xh(t,e);case"array":return Xh(G(t),e)}}function Yh(t,e){var i=[];return t.Props&&i.push(function(t,e){var i=[];return Vt(Mr).map((function(t){for(var e=0;e<mr.length;++e)if(mr[e][1]==t)return mr[e];for(e=0;e<xr.length;++e)if(xr[e][1]==t)return xr[e];throw t})).forEach((function(n){if(null!=t[n[1]]){var r=e&&e.Props&&null!=e.Props[n[1]]?e.Props[n[1]]:t[n[1]];"date"===n[2]&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof r?r=String(r):!0===r||!1===r?r=r?"1":"0":r instanceof Date&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"")),i.push(ri(Mr[n[1]]||n[1],r))}})),ai("DocumentProperties",i.join(""),{xmlns:di.o})}(t.Props,e)),t.Custprops&&i.push(function(t,e){var i=["Worksheets","SheetNames"],n="CustomDocumentProperties",r=[];return t&&Vt(t).forEach((function(e){if(Object.prototype.hasOwnProperty.call(t,e)){for(var n=0;n<mr.length;++n)if(e==mr[n][1])return;for(n=0;n<xr.length;++n)if(e==xr[n][1])return;for(n=0;n<i.length;++n)if(e==i[n])return;var s=t[e],a="string";"number"==typeof s?(a="float",s=String(s)):!0===s||!1===s?(a="boolean",s=s?"1":"0"):s=String(s),r.push(ai(ze(e),s,{"dt:dt":a}))}})),e&&Vt(e).forEach((function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&(!t||!Object.prototype.hasOwnProperty.call(t,i))){var n=e[i],s="string";"number"==typeof n?(s="float",n=String(n)):!0===n||!1===n?(s="boolean",n=n?"1":"0"):n instanceof Date?(s="dateTime.tz",n=n.toISOString()):n=String(n),r.push(ai(ze(i),n,{"dt:dt":s}))}})),"<"+n+' xmlns="'+di.o+'">'+r.join("")+"</"+n+">"}(t.Props,t.Custprops)),i.join("")}function Kh(t){return ai("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Oo(t.Ref,{r:0,c:0})})}function qh(t,e,i,n,r,s,a){if(!t||null==t.v&&null==t.f)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Be(Oo(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=ln(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Be(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Be(t.l.Tooltip))),i["!merges"])for(var h=i["!merges"],c=0;c!=h.length;++c)h[c].s.c==a.c&&h[c].s.r==a.r&&(h[c].e.c>h[c].s.c&&(o["ss:MergeAcross"]=h[c].e.c-h[c].s.c),h[c].e.r>h[c].s.r&&(o["ss:MergeDown"]=h[c].e.r-h[c].s.r));var u="",d="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":u="Number",d=String(t.v);break;case"b":u="Boolean",d=t.v?"1":"0";break;case"e":u="Error",d=nr[t.v];break;case"d":u="DateTime",d=new Date(t.v).toISOString(),null==t.z&&(t.z=t.z||nt[14]);break;case"s":u="String",d=((t.v||"")+"").replace(Fe,(function(t){return De[t]})).replace(We,(function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"}))}var f=kl(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=a.c+1;var p=null!=t.v?d:"",g="z"==t.t?"":'<Data ss:Type="'+u+'">'+p+"</Data>";return(t.c||[]).length>0&&(g+=t.c.map((function(t){var e=ai("ss:Data",(t.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return ai("Comment",e,{"ss:Author":t.a})})).join("")),ai("Cell",g,o)}function Zh(t,e){var i='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Ba(e.hpt)),e.hpx&&(i+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(i+=' ss:Hidden="1"')),i+">"}function Jh(t,e,i){var n=[],r=i.SheetNames[t],s=i.Sheets[r],a=s?function(t,e,i,n){if(!t)return"";if(!((n||{}).Workbook||{}).Names)return"";for(var r=n.Workbook.Names,s=[],a=0;a<r.length;++a){var o=r[a];o.Sheet==i&&(o.Name.match(/^_xlfn\./)||s.push(Kh(o)))}return s.join("")}(s,0,t,i):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?function(t,e,i,n){if(!t["!ref"])return"";var r=dn(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach((function(t,e){Na(t);var i=!!t.width,n=Tl(e,t),r={"ss:Index":e+1};i&&(r["ss:Width"]=Pa(n.width)),t.hidden&&(r["ss:Hidden"]="1"),o.push(ai("Column",null,r))}));for(var l=Array.isArray(t),h=r.s.r;h<=r.e.r;++h){for(var c=[Zh(h,(t["!rows"]||[])[h])],u=r.s.c;u<=r.e.c;++u){var d=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>u||s[a].s.r>h||s[a].e.c<u||s[a].e.r<h)){s[a].s.c==u&&s[a].s.r==h||(d=!0);break}if(!d){var f={r:h,c:u},p=hn(f),g=l?(t[h]||[])[u]:t[p];c.push(qh(g,p,t,e,0,0,f))}}c.push("</Row>"),c.length>2&&o.push(c.join(""))}return o.join("")}(s,e):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(function(t,e,i,n){if(!t)return"";var r=[];if(t["!margins"]&&(r.push("<PageSetup>"),t["!margins"].header&&r.push(ai("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&r.push(ai("Footer",null,{"x:Margin":t["!margins"].footer})),r.push(ai("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),r.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[i])if(n.Workbook.Sheets[i].Hidden)r.push(ai("Visible",1==n.Workbook.Sheets[i].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<i&&(!n.Workbook.Sheets[s]||n.Workbook.Sheets[s].Hidden);++s);s==i&&r.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),t["!protect"]&&(r.push(ri("ProtectContents","True")),t["!protect"].objects&&r.push(ri("ProtectObjects","True")),t["!protect"].scenarios&&r.push(ri("ProtectScenarios","True")),null==t["!protect"].selectLockedCells||t["!protect"].selectLockedCells?null==t["!protect"].selectUnlockedCells||t["!protect"].selectUnlockedCells||r.push(ri("EnableSelection","UnlockedCells")):r.push(ri("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach((function(e){t["!protect"][e[0]]&&r.push("<"+e[1]+"/>")}))),0==r.length?"":ai("WorksheetOptions",r.join(""),{xmlns:di.x})}(s,0,t,i)),n.join("")}function $h(t,e){e||(e={}),t.SSF||(t.SSF=le(nt)),t.SSF&&(jt(),Ft(t.SSF),e.revssf=qt(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],kl(e.cellXfs,{},{revssf:{General:0}}));var i=[];i.push(Yh(t,e)),i.push(""),i.push(""),i.push("");for(var n=0;n<t.SheetNames.length;++n)i.push(ai("Worksheet",Jh(n,e,t),{"ss:Name":Be(t.SheetNames[n])}));return i[2]=function(t,e){var i=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach((function(t,e){var n=[];n.push(ai("NumberFormat",null,{"ss:Format":Be(nt[t.numFmtId])}));var r={"ss:ID":"s"+(21+e)};i.push(ai("Style",n.join(""),r))})),ai("Styles",i.join(""))}(0,e),i[3]=function(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,i=[],n=0;n<e.length;++n){var r=e[n];null==r.Sheet&&(r.Name.match(/^_xlfn\./)||i.push(Kh(r)))}return ai("Names",i.join(""))}(t),ke+ai("Workbook",i.join(""),{xmlns:di.ss,"xmlns:o":di.o,"xmlns:x":di.x,"xmlns:ss":di.ss,"xmlns:dt":di.dt,"xmlns:html":di.html})}function Qh(t){var e={},i=t.content;if(i.l=28,e.AnsiUserType=i.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=function(t){return Hn(t,1)}(i),i.length-i.l<=4)return e;var n=i.read_shift(4);return 0==n||n>40?e:(i.l-=4,e.Reserved1=i.read_shift(0,"lpstr-ansi"),i.length-i.l<=4||1907505652!==(n=i.read_shift(4))?e:(e.UnicodeClipboardFormat=function(t){return Hn(t,2)}(i),0==(n=i.read_shift(4))||n>40?e:(i.l-=4,void(e.Reserved2=i.read_shift(0,"lpwstr")))))}var tc=[60,1084,2066,2165,2175];function ec(t,e,i,n,r){var s=n,a=[],o=i.slice(i.l,i.l+s);if(r&&r.enc&&r.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:r.enc.insitu(o)}a.push(o),i.l+=s;for(var l=Ni(i,i.l),h=hc[l],c=0;null!=h&&tc.indexOf(l)>-1;)s=Ni(i,i.l+2),c=i.l+4,2066==l?c+=4:2165!=l&&2175!=l||(c+=12),o=i.slice(c,i.l+4+s),a.push(o),i.l+=4+s,h=hc[l=Ni(i,i.l)];var u=H(a);Yi(u,0);var d=0;u.lens=[];for(var f=0;f<a.length;++f)u.lens.push(d),d+=a[f].length;if(u.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+u.length+" < "+n;return e.f(u,u.length,r)}function ic(t,e,i){if("z"!==t.t&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=nt[n])}catch(t){if(e.WTF)throw t}if(!e||!1!==e.cellText)try{"e"===t.t?t.w=t.w||nr[t.v]:0===n||"General"==n?"n"===t.t?(0|t.v)===t.v?t.w=t.v.toString(10):t.w=ft(t.v):t.w=pt(t.v):t.w=Dt(n,t.v,{date1904:!!i,dateNF:e&&e.dateNF})}catch(t){if(e.WTF)throw t}if(e.cellDates&&n&&"n"==t.t&&Pt(nt[n]||String(n))){var r=ot(t.v);r&&(t.t="d",t.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}}function nc(t,e,i){return{v:t,ixfe:e,t:i}}function rc(t,e){var i={opts:{}},n={};null!=R&&null==e.dense&&(e.dense=R);var r,s,a,o,l,h,c,u,d=e.dense?[]:{},f={},p={},g=null,m=[],v="",y={},b="",_={},x=[],w=[],S=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},C=function(t){return t<8?ir[t]:t<64&&S[t-8]||ir[t]},M=function(t,e,i){if(!(B>1||i.sheetRows&&t.r>=i.sheetRows)){if(i.cellStyles&&e.XF&&e.XF.data&&function(t,e,i){var n,r=e.XF.data;r&&r.patternType&&i&&i.cellStyles&&(e.s={},e.s.patternType=r.patternType,(n=Ea(C(r.icvFore)))&&(e.s.fgColor={rgb:n}),(n=Ea(C(r.icvBack)))&&(e.s.bgColor={rgb:n}))}(0,e,i),delete e.ixfe,delete e.XF,r=t,b=hn(t),p&&p.s&&p.e||(p={s:{r:0,c:0},e:{r:0,c:0}}),t.r<p.s.r&&(p.s.r=t.r),t.c<p.s.c&&(p.s.c=t.c),t.r+1>p.e.r&&(p.e.r=t.r+1),t.c+1>p.e.c&&(p.e.c=t.c+1),i.cellFormula&&e.f)for(var n=0;n<x.length;++n)if(!(x[n][0].s.c>t.c||x[n][0].s.r>t.r||x[n][0].e.c<t.c||x[n][0].e.r<t.r)){e.F=un(x[n][0]),x[n][0].s.c==t.c&&x[n][0].s.r==t.r||delete e.f,e.f&&(e.f=""+sl(x[n][1],0,t,N,A));break}i.dense?(d[t.r]||(d[t.r]=[]),d[t.r][t.c]=e):d[b]=e}},A={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:x,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(A.password=e.password);var O=[],P=[],I=[],L=[],D=!1,N=[];N.SheetNames=A.snames,N.sharedf=A.sharedf,N.arrayf=A.arrayf,N.names=[],N.XTI=[];var F,j=0,B=0,z=0,W=[],G=[];A.codepage=1200,T(1200);for(var U=!1;t.l<t.length-1;){var H=t.l,X=t.read_shift(2);if(0===X&&10===j)break;var V=t.l===t.length?0:t.read_shift(2),Y=hc[X];if(Y&&Y.f){if(e.bookSheets&&133===j&&133!==X)break;if(j=X,2===Y.r||12==Y.r){var K=t.read_shift(2);if(V-=2,!A.enc&&K!==X&&((255&K)<<8|K>>8)!==X)throw new Error("rt mismatch: "+K+"!="+X);12==Y.r&&(t.l+=10,V-=10)}var q={};if(q=10===X?Y.f(t,V,A):ec(X,Y,t,V,A),0==B&&-1===[9,521,1033,2057].indexOf(j))continue;switch(X){case 34:i.opts.Date1904=E.WBProps.date1904=q;break;case 134:i.opts.WriteProtect=!0;break;case 47:if(A.enc||(t.l=0),A.enc=q,!e.password)throw new Error("File is password-protected");if(null==q.valid)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=q;break;case 66:var Z=Number(q);switch(Z){case 21010:Z=1200;break;case 32768:Z=1e4;break;case 32769:Z=1252}T(A.codepage=Z),U=!0;break;case 317:A.rrtabid=q;break;case 25:A.winlocked=q;break;case 439:i.opts.RefreshAll=q;break;case 12:i.opts.CalcCount=q;break;case 16:i.opts.CalcDelta=q;break;case 17:i.opts.CalcIter=q;break;case 13:i.opts.CalcMode=q;break;case 14:i.opts.CalcPrecision=q;break;case 95:i.opts.CalcSaveRecalc=q;break;case 15:A.CalcRefMode=q;break;case 2211:i.opts.FullCalc=q;break;case 129:q.fDialog&&(d["!type"]="dialog"),q.fBelow||((d["!outline"]||(d["!outline"]={})).above=!0),q.fRight||((d["!outline"]||(d["!outline"]={})).left=!0);break;case 224:w.push(q);break;case 430:N.push([q]),N[N.length-1].XTI=[];break;case 35:case 547:N[N.length-1].push(q);break;case 24:case 536:F={Name:q.Name,Ref:sl(q.rgce,0,null,N,A)},q.itab>0&&(F.Sheet=q.itab-1),N.names.push(F),N[0]||(N[0]=[],N[0].XTI=[]),N[N.length-1].push(q),"_xlnm._FilterDatabase"==q.Name&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&"PtgArea3d"==q.rgce[0][0][0]&&(G[q.itab-1]={ref:un(q.rgce[0][0][1][2])});break;case 22:A.ExternCount=q;break;case 23:0==N.length&&(N[0]=[],N[0].XTI=[]),N[N.length-1].XTI=N[N.length-1].XTI.concat(q),N.XTI=N.XTI.concat(q);break;case 2196:if(A.biff<8)break;null!=F&&(F.Comment=q[1]);break;case 18:d["!protect"]=q;break;case 19:0!==q&&A.WTF&&console.error("Password verifier: "+q);break;case 133:f[q.pos]=q,A.snames.push(q.name);break;case 10:if(--B)break;if(p.e){if(p.e.r>0&&p.e.c>0){if(p.e.r--,p.e.c--,d["!ref"]=un(p),e.sheetRows&&e.sheetRows<=p.e.r){var J=p.e.r;p.e.r=e.sheetRows-1,d["!fullref"]=d["!ref"],d["!ref"]=un(p),p.e.r=J}p.e.r++,p.e.c++}O.length>0&&(d["!merges"]=O),P.length>0&&(d["!objects"]=P),I.length>0&&(d["!cols"]=I),L.length>0&&(d["!rows"]=L),E.Sheets.push(k)}""===v?y=d:n[v]=d,d=e.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===A.biff&&(A.biff={9:2,521:3,1033:4}[X]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),A.biffguess=0==q.BIFFVer,0==q.BIFFVer&&4096==q.dt&&(A.biff=5,U=!0,T(A.codepage=28591)),8==A.biff&&0==q.BIFFVer&&16==q.dt&&(A.biff=2),B++)break;if(d=e.dense?[]:{},A.biff<8&&!U&&(U=!0,T(A.codepage=e.codepage||1252)),A.biff<5||0==q.BIFFVer&&4096==q.dt){""===v&&(v="Sheet1"),p={s:{r:0,c:0},e:{r:0,c:0}};var $={pos:t.l-V,name:v};f[$.pos]=$,A.snames.push(v)}else v=(f[H]||{name:""}).name;32==q.dt&&(d["!type"]="chart"),64==q.dt&&(d["!type"]="macro"),O=[],P=[],A.arrayf=x=[],I=[],L=[],D=!1,k={Hidden:(f[H]||{hs:0}).hs,name:v};break;case 515:case 3:case 2:"chart"==d["!type"]&&(e.dense?(d[q.r]||[])[q.c]:d[hn({c:q.c,r:q.r})])&&++q.c,h={ixfe:q.ixfe,XF:w[q.ixfe]||{},v:q.val,t:"n"},z>0&&(h.z=W[h.ixfe>>8&63]),ic(h,e,i.opts.Date1904),M({c:q.c,r:q.r},h,e);break;case 5:case 517:h={ixfe:q.ixfe,XF:w[q.ixfe],v:q.val,t:q.t},z>0&&(h.z=W[h.ixfe>>8&63]),ic(h,e,i.opts.Date1904),M({c:q.c,r:q.r},h,e);break;case 638:h={ixfe:q.ixfe,XF:w[q.ixfe],v:q.rknum,t:"n"},z>0&&(h.z=W[h.ixfe>>8&63]),ic(h,e,i.opts.Date1904),M({c:q.c,r:q.r},h,e);break;case 189:for(var Q=q.c;Q<=q.C;++Q){var tt=q.rkrec[Q-q.c][0];h={ixfe:tt,XF:w[tt],v:q.rkrec[Q-q.c][1],t:"n"},z>0&&(h.z=W[h.ixfe>>8&63]),ic(h,e,i.opts.Date1904),M({c:Q,r:q.r},h,e)}break;case 6:case 518:case 1030:if("String"==q.val){g=q;break}if((h=nc(q.val,q.cell.ixfe,q.tt)).XF=w[h.ixfe],e.cellFormula){var et=q.formula;if(et&&et[0]&&et[0][0]&&"PtgExp"==et[0][0][0]){var it=et[0][0][1][0],rt=et[0][0][1][1],st=hn({r:it,c:rt});_[st]?h.f=""+sl(q.formula,0,q.cell,N,A):h.F=((e.dense?(d[it]||[])[rt]:d[st])||{}).F}else h.f=""+sl(q.formula,0,q.cell,N,A)}z>0&&(h.z=W[h.ixfe>>8&63]),ic(h,e,i.opts.Date1904),M(q.cell,h,e),g=q;break;case 7:case 519:if(!g)throw new Error("String record expects Formula");g.val=q,(h=nc(q,g.cell.ixfe,"s")).XF=w[h.ixfe],e.cellFormula&&(h.f=""+sl(g.formula,0,g.cell,N,A)),z>0&&(h.z=W[h.ixfe>>8&63]),ic(h,e,i.opts.Date1904),M(g.cell,h,e),g=null;break;case 33:case 545:x.push(q);var at=hn(q[0].s);if(s=e.dense?(d[q[0].s.r]||[])[q[0].s.c]:d[at],e.cellFormula&&s){if(!g)break;if(!at||!s)break;s.f=""+sl(q[1],0,q[0],N,A),s.F=un(q[0])}break;case 1212:if(!e.cellFormula)break;if(b){if(!g)break;_[hn(g.cell)]=q[0],((s=e.dense?(d[g.cell.r]||[])[g.cell.c]:d[hn(g.cell)])||{}).f=""+sl(q[0],0,r,N,A)}break;case 253:h=nc(m[q.isst].t,q.ixfe,"s"),m[q.isst].h&&(h.h=m[q.isst].h),h.XF=w[h.ixfe],z>0&&(h.z=W[h.ixfe>>8&63]),ic(h,e,i.opts.Date1904),M({c:q.c,r:q.r},h,e);break;case 513:e.sheetStubs&&(h={ixfe:q.ixfe,XF:w[q.ixfe],t:"z"},z>0&&(h.z=W[h.ixfe>>8&63]),ic(h,e,i.opts.Date1904),M({c:q.c,r:q.r},h,e));break;case 190:if(e.sheetStubs)for(var ot=q.c;ot<=q.C;++ot){var lt=q.ixfe[ot-q.c];h={ixfe:lt,XF:w[lt],t:"z"},z>0&&(h.z=W[h.ixfe>>8&63]),ic(h,e,i.opts.Date1904),M({c:ot,r:q.r},h,e)}break;case 214:case 516:case 4:(h=nc(q.val,q.ixfe,"s")).XF=w[h.ixfe],z>0&&(h.z=W[h.ixfe>>8&63]),ic(h,e,i.opts.Date1904),M({c:q.c,r:q.r},h,e);break;case 0:case 512:1===B&&(p=q);break;case 252:m=q;break;case 1054:if(4==A.biff){W[z++]=q[1];for(var ht=0;ht<z+163&&nt[ht]!=q[1];++ht);ht>=163&&Nt(q[1],z+163)}else Nt(q[1],q[0]);break;case 30:W[z++]=q;for(var ct=0;ct<z+163&&nt[ct]!=q;++ct);ct>=163&&Nt(q,z+163);break;case 229:O=O.concat(q);break;case 93:P[q.cmo[0]]=A.lastobj=q;break;case 438:A.lastobj.TxO=q;break;case 127:A.lastobj.ImData=q;break;case 440:for(l=q[0].s.r;l<=q[0].e.r;++l)for(o=q[0].s.c;o<=q[0].e.c;++o)(s=e.dense?(d[l]||[])[o]:d[hn({c:o,r:l})])&&(s.l=q[1]);break;case 2048:for(l=q[0].s.r;l<=q[0].e.r;++l)for(o=q[0].s.c;o<=q[0].e.c;++o)(s=e.dense?(d[l]||[])[o]:d[hn({c:o,r:l})])&&s.l&&(s.l.Tooltip=q[1]);break;case 28:if(A.biff<=5&&A.biff>=2)break;s=e.dense?(d[q[0].r]||[])[q[0].c]:d[hn(q[0])];var ut=P[q[2]];s||(e.dense?(d[q[0].r]||(d[q[0].r]=[]),s=d[q[0].r][q[0].c]={t:"z"}):s=d[hn(q[0])]={t:"z"},p.e.r=Math.max(p.e.r,q[0].r),p.s.r=Math.min(p.s.r,q[0].r),p.e.c=Math.max(p.e.c,q[0].c),p.s.c=Math.min(p.s.c,q[0].c)),s.c||(s.c=[]),a={a:q[1],t:ut.TxO.t},s.c.push(a);break;case 2173:w[q.ixfe],q.ext.forEach((function(t){t[0]}));break;case 125:if(!A.cellStyles)break;for(;q.e>=q.s;)I[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(1&q.flags)},D||(D=!0,Da(q.w/256)),Na(I[q.e+1]);break;case 520:var dt={};null!=q.level&&(L[q.r]=dt,dt.level=q.level),q.hidden&&(L[q.r]=dt,dt.hidden=!0),q.hpt&&(L[q.r]=dt,dt.hpt=q.hpt,dt.hpx=Ba(q.hpt));break;case 38:case 39:case 40:case 41:d["!margins"]||El(d["!margins"]={}),d["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[X]]=q;break;case 161:d["!margins"]||El(d["!margins"]={}),d["!margins"].header=q.header,d["!margins"].footer=q.footer;break;case 574:q.RTL&&(E.Views[0].RTL=!0);break;case 146:S=q;break;case 2198:u=q;break;case 140:c=q;break;case 442:v?k.CodeName=q||k.name:E.WBProps.CodeName=q||"ThisWorkbook"}}else Y||console.error("Missing Info for XLS Record 0x"+X.toString(16)),t.l+=V}return i.SheetNames=Vt(f).sort((function(t,e){return Number(t)-Number(e)})).map((function(t){return f[t].name})),e.bookSheets||(i.Sheets=n),!i.SheetNames.length&&y["!ref"]?(i.SheetNames.push("Sheet1"),i.Sheets&&(i.Sheets.Sheet1=y)):i.Preamble=y,i.Sheets&&G.forEach((function(t,e){i.Sheets[i.SheetNames[e]]["!autofilter"]=t})),i.Strings=m,i.SSF=le(nt),A.enc&&(i.Encryption=A.enc),u&&(i.Themes=u),i.Metadata={},void 0!==c&&(i.Metadata.Country=c),N.names.length>0&&(E.Names=N.names),i.Workbook=E,i}var sc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function ac(t,e){var i,n,r,s;if(e||(e={}),cu(e),E(),e.codepage&&S(e.codepage),t.FullPaths){if(Gt.find(t,"/encryption"))throw new Error("File is password-protected");i=Gt.find(t,"!CompObj"),n=Gt.find(t,"/Workbook")||Gt.find(t,"/Book")}else{switch(e.type){case"base64":t=z(D(t));break;case"binary":t=z(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t))}Yi(t,0),n={content:t}}if(i&&Qh(i),e.bookProps&&!e.bookSheets)r={};else{var a=N?"buffer":"array";if(n&&n.content)r=rc(n.content,e);else if((s=Gt.find(t,"PerfectOffice_MAIN"))&&s.content)r=Js.to_workbook(s.content,(e.type=a,e));else{if(!(s=Gt.find(t,"NativeContent_MAIN"))||!s.content)throw(s=Gt.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r=Js.to_workbook(s.content,(e.type=a,e))}e.bookVBA&&t.FullPaths&&Gt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(r.vbaraw=function(t){var e=Gt.utils.cfb_new({root:"R"});return t.FullPaths.forEach((function(i,n){if("/"!==i.slice(-1)&&i.match(/_VBA_PROJECT_CUR/)){var r=i.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Gt.utils.cfb_add(e,r,t.FileIndex[n].content)}})),Gt.write(e)}(t))}var o={};return t.FullPaths&&function(t,e,i){var n=Gt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var r=Hr(n,Jn,sc.DSI);for(var s in r)e[s]=r[s]}catch(t){if(i.WTF)throw t}var a=Gt.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=Hr(a,$n,sc.SI);for(var l in o)null==e[l]&&(e[l]=o[l])}catch(t){if(i.WTF)throw t}e.HeadingPairs&&e.TitlesOfParts&&(Sr(e.HeadingPairs,e.TitlesOfParts,e,i),delete e.HeadingPairs,delete e.TitlesOfParts)}(t,o,e),r.Props=r.Custprops=o,e.bookFiles&&(r.cfb=t),r}function oc(t,e){var i=e||{},n=Gt.utils.cfb_new({root:"R"}),r="/Workbook";switch(i.bookType||"xls"){case"xls":i.bookType="biff8";case"xla":i.bookType||(i.bookType="xla");case"biff8":r="/Workbook",i.biff=8;break;case"biff5":r="/Book",i.biff=5;break;default:throw new Error("invalid type "+i.bookType+" for XLS CFB")}return Gt.utils.cfb_add(n,r,bc(t,i)),8==i.biff&&(t.Props||t.Custprops)&&function(t,e){var i,n=[],r=[],s=[],a=0,o=Yt(Jn,"n"),l=Yt($n,"n");if(t.Props)for(i=Vt(t.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?n:Object.prototype.hasOwnProperty.call(l,i[a])?r:s).push([i[a],t.Props[i[a]]]);if(t.Custprops)for(i=Vt(t.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(t.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?n:Object.prototype.hasOwnProperty.call(l,i[a])?r:s).push([i[a],t.Custprops[i[a]]]);var h=[];for(a=0;a<s.length;++a)Wr.indexOf(s[a][0])>-1||wr.indexOf(s[a][0])>-1||null!=s[a][1]&&h.push(s[a]);r.length&&Gt.utils.cfb_add(e,"/SummaryInformation",Xr(r,sc.SI,l,$n)),(n.length||h.length)&&Gt.utils.cfb_add(e,"/DocumentSummaryInformation",Xr(n,sc.DSI,o,Jn,h.length?h:null,sc.UDI))}(t,n),8==i.biff&&t.vbaraw&&function(t,e){e.FullPaths.forEach((function(i,n){if(0!=n){var r=i.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==r.slice(-1)&&Gt.utils.cfb_add(t,r,e.FileIndex[n].content)}}))}(n,Gt.read(t.vbaraw,{type:"string"==typeof t.vbaraw?"binary":"buffer"})),n}var lc={0:{f:function(t,e){var i={},n=t.l+e;i.r=t.read_shift(4),t.l+=4;var r=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,7&s&&(i.level=7&s),16&s&&(i.hidden=!0),32&s&&(i.hpt=r/20),i}},1:{f:function(t){return[En(t)]}},2:{f:function(t){return[En(t),Nn(t),"n"]}},3:{f:function(t){return[En(t),t.read_shift(1),"e"]}},4:{f:function(t){return[En(t),t.read_shift(1),"b"]}},5:{f:function(t){return[En(t),Wn(t),"n"]}},6:{f:function(t){return[En(t),bn(t),"str"]}},7:{f:function(t){return[En(t),t.read_shift(4),"s"]}},8:{f:function(t,e,i){var n=t.l+e,r=En(t);r.r=i["!row"];var s=[r,bn(t),"str"];if(i.cellFormula){t.l+=2;var a=dl(t,n-t.l,i);s[3]=sl(a,0,r,i.supbooks,i)}else t.l=n;return s}},9:{f:function(t,e,i){var n=t.l+e,r=En(t);r.r=i["!row"];var s=[r,Wn(t),"n"];if(i.cellFormula){t.l+=2;var a=dl(t,n-t.l,i);s[3]=sl(a,0,r,i.supbooks,i)}else t.l=n;return s}},10:{f:function(t,e,i){var n=t.l+e,r=En(t);r.r=i["!row"];var s=[r,t.read_shift(1),"b"];if(i.cellFormula){t.l+=2;var a=dl(t,n-t.l,i);s[3]=sl(a,0,r,i.supbooks,i)}else t.l=n;return s}},11:{f:function(t,e,i){var n=t.l+e,r=En(t);r.r=i["!row"];var s=[r,t.read_shift(1),"e"];if(i.cellFormula){t.l+=2;var a=dl(t,n-t.l,i);s[3]=sl(a,0,r,i.supbooks,i)}else t.l=n;return s}},12:{f:function(t){return[Cn(t)]}},13:{f:function(t){return[Cn(t),Nn(t),"n"]}},14:{f:function(t){return[Cn(t),t.read_shift(1),"e"]}},15:{f:function(t){return[Cn(t),t.read_shift(1),"b"]}},16:{f:Zl},17:{f:function(t){return[Cn(t),bn(t),"str"]}},18:{f:function(t){return[Cn(t),t.read_shift(4),"s"]}},19:{f:wn},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(t,e,i){var n=t.l+e;t.l+=4,t.l+=1;var r=t.read_shift(4),s=In(t),a=fl(t,0,i),o=Pn(t);t.l=n;var l={Name:s,Ptg:a};return r<268435455&&(l.Sheet=r),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(t,e,i){var n={};n.sz=t.read_shift(2)/20;var r=function(t){var e=t.read_shift(1);return t.l++,{fBold:1&e,fItalic:2&e,fUnderline:4&e,fStrikeout:8&e,fOutline:16&e,fShadow:32&e,fCondense:64&e,fExtend:128&e}}(t);switch(r.fItalic&&(n.italic=1),r.fCondense&&(n.condense=1),r.fExtend&&(n.extend=1),r.fShadow&&(n.shadow=1),r.fOutline&&(n.outline=1),r.fStrikeout&&(n.strike=1),700===t.read_shift(2)&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var s=t.read_shift(1);0!=s&&(n.underline=s);var a=t.read_shift(1);a>0&&(n.family=a);var o=t.read_shift(1);switch(o>0&&(n.charset=o),t.l++,n.color=function(t){var e={},i=t.read_shift(1)>>>1,n=t.read_shift(1),r=t.read_shift(2,"i"),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(1);switch(t.l++,i){case 0:e.auto=1;break;case 1:e.index=n;var l=ir[n];l&&(e.rgb=Ea(l));break;case 2:e.rgb=Ea([s,a,o]);break;case 3:e.theme=n}return 0!=r&&(e.tint=r>0?r/32767:r/32768),e}(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=bn(t),n}},44:{f:function(t,e){return[t.read_shift(2),bn(t)]}},45:{f:qa},46:{f:Qa},47:{f:function(t,e){var i=t.l+e,n=t.read_shift(2),r=t.read_shift(2);return t.l=i,{ixfe:n,numFmtId:r}}},48:{},49:{f:function(t){return t.read_shift(4,"i")}},50:{},51:{f:function(t){for(var e=[],i=t.read_shift(4);i-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ws},62:{f:function(t){return[En(t),wn(t),"is"]}},63:{f:function(t){var e={};e.i=t.read_shift(4);var i={};i.r=t.read_shift(4),i.c=t.read_shift(4),e.r=hn(i);var n=t.read_shift(1);return 2&n&&(e.l="1"),8&n&&(e.a="1"),e}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ki,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(t){var e=t.read_shift(2);return t.l+=28,{RTL:32&e}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(t,e){var i={},n=t[t.l];return++t.l,i.above=!(64&n),i.left=!(128&n),t.l+=18,i.name=An(t,e-19),i}},148:{f:Kl,p:16},151:{f:function(){}},152:{},153:{f:function(t,e){var i={},n=t.read_shift(4);i.defaultThemeVersion=t.read_shift(4);var r=e>8?bn(t):"";return r.length>0&&(i.CodeName=r),i.autoCompressPictures=!!(65536&n),i.backupFile=!!(64&n),i.checkCompatibility=!!(4096&n),i.date1904=!!(1&n),i.filterPrivacy=!!(8&n),i.hidePivotFieldList=!!(1024&n),i.promptedSolutions=!!(16&n),i.publishItems=!!(2048&n),i.refreshAllConnections=!!(262144&n),i.saveExternalLinkValues=!!(128&n),i.showBorderUnselectedTables=!!(4&n),i.showInkAnnotation=!!(32&n),i.showObjects=["all","placeholders","none"][n>>13&3],i.showPivotChartFilter=!!(32768&n),i.updateLinks=["userSet","never","always"][n>>8&3],i}},154:{},155:{},156:{f:function(t,e){var i={};return i.Hidden=t.read_shift(4),i.iTabID=t.read_shift(4),i.strRelID=Ln(t,e-8),i.name=bn(t),i}},157:{},158:{},159:{T:1,f:function(t){return[t.read_shift(4),t.read_shift(4)]}},160:{T:-1},161:{T:1,f:Bn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Jl},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:bn(t)}}},336:{T:-1},337:{f:function(t){return t.l+=4,0!=t.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ln},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ns},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(t,e,i){var n=t.l+e,r=jn(t),s=t.read_shift(1),a=[r];if(a[2]=s,i.cellFormula){var o=ul(t,n-t.l,i);a[1]=o}else t.l=n;return a}},427:{f:function(t,e,i){var n=t.l+e,r=[Bn(t,16)];if(i.cellFormula){var s=pl(t,n-t.l,i);r[1]=s,t.l=n}else t.l=n;return r}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(t){var e={};return Ql.forEach((function(i){e[i]=Wn(t)})),e}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(t,e){var i=t.l+e,n=Bn(t,16),r=Pn(t),s=bn(t),a=bn(t),o=bn(t);t.l=i;var l={rfx:n,relId:r,loc:s,display:o};return a&&(l.Tooltip=a),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ln},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:To},633:{T:1},634:{T:-1},635:{T:1,f:function(t){var e={};e.iauthor=t.read_shift(4);var i=Bn(t,16);return e.rfx=i.s,e.ref=hn(i.s),t.l+=16,e}},636:{T:-1},637:{f:Sn},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(t,e){return t.l+=10,{name:bn(t)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},hc={6:{f:ll},10:{f:Vr},12:{f:qr},13:{f:qr},14:{f:Yr},15:{f:Yr},16:{f:Wn},17:{f:Yr},18:{f:Yr},19:{f:qr},20:{f:Rs},21:{f:Rs},23:{f:Ns},24:{f:Ds},25:{f:Yr},26:{},27:{},28:{f:function(t,e,i){return function(t,e,i){if(!(i.biff<8)){var n=t.read_shift(2),r=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=rs(t,0,i);return i.biff<8&&t.read_shift(1),[{r:n,c:r},o,a,s]}}(t,0,i)}},29:{},34:{f:Yr},35:{f:Is},38:{f:Wn},39:{f:Wn},40:{f:Wn},41:{f:Wn},42:{f:Yr},43:{f:Yr},47:{f:function(t,e,i){var n={Type:i.biff>=8?t.read_shift(2):0};return n.Type?Sa(t,e-2,n):function(t,e,i,n){var r={key:qr(t),verificationBytes:qr(t)};i.password&&(r.verifier=_a(i.password)),n.valid=r.verificationBytes===r.verifier,n.valid&&(n.insitu=wa(i.password))}(t,i.biff,i,n),n}},49:{f:function(t,e,i){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(i&&i.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10}return n.name=Qr(t,0,i),n}},51:{f:qr},60:{},61:{f:function(t){return{Pos:[t.read_shift(2),t.read_shift(2)],Dim:[t.read_shift(2),t.read_shift(2)],Flags:t.read_shift(2),CurTab:t.read_shift(2),FirstTab:t.read_shift(2),Selected:t.read_shift(2),TabRatio:t.read_shift(2)}}},64:{f:Yr},65:{f:function(){}},66:{f:qr},77:{},80:{},81:{},82:{},85:{f:qr},89:{},90:{},91:{},92:{f:function(t,e,i){if(i.enc)return t.l+=e,"";var n=t.l,r=rs(t,0,i);return t.read_shift(e+n-t.l),r}},93:{f:function(t,e,i){if(i&&i.biff<8)return function(t,e,i){t.l+=4;var n=t.read_shift(2),r=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((js[n]||Ki)(t,e,i)),{cmo:[r,n,s],ft:a}}(t,e,i);var n=_s(t),r=function(t,e){for(var i=t.l+e,n=[];t.l<i;){var r=t.read_shift(2);t.l-=2;try{n.push(ws[r](t,i-t.l))}catch(e){return t.l=i,n}}return t.l!=i&&(t.l=i),n}(t,e-22,n[1]);return{cmo:n,ft:r}}},94:{},95:{f:Yr},96:{},97:{},99:{f:Yr},125:{f:Ws},128:{f:function(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(0!==e[0]&&e[0]--,0!==e[1]&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}},129:{f:function(t,e,i){var n=i&&8==i.biff||2==e?t.read_shift(2):(t.l+=e,0);return{fDialog:16&n,fBelow:64&n,fRight:128&n}}},130:{f:qr},131:{f:Yr},132:{f:Yr},133:{f:function(t,e,i){var n=t.read_shift(4),r=3&t.read_shift(1),s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule"}var a=Qr(t,0,i);return 0===a.length&&(a="Sheet1"),{pos:n,hs:r,dt:s,name:a}}},134:{},140:{f:function(t){var e,i=[0,0];return e=t.read_shift(2),i[0]=Qn[e]||e,e=t.read_shift(2),i[1]=Qn[e]||e,i}},141:{f:qr},144:{},146:{f:function(t){for(var e=t.read_shift(2),i=[];e-- >0;)i.push(us(t));return i}},151:{},152:{},153:{},154:{},155:{},156:{f:qr},157:{},158:{},160:{f:Us},161:{f:function(t,e){var i={};return e<32||(t.l+=16,i.header=Wn(t),i.footer=Wn(t),t.l+=2),i}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(t,e){for(var i=t.l+e-2,n=t.read_shift(2),r=t.read_shift(2),s=[];t.l<i;)s.push(gs(t));if(t.l!==i)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-r+1)throw new Error("MulRK length mismatch");return{r:n,c:r,C:a,rkrec:s}}},190:{f:function(t,e){for(var i=t.l+e-2,n=t.read_shift(2),r=t.read_shift(2),s=[];t.l<i;)s.push(t.read_shift(2));if(t.l!==i)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-r+1)throw new Error("MulBlank length mismatch");return{r:n,c:r,C:a,ixfe:s}}},193:{f:Vr},197:{},198:{},199:{},200:{},201:{},202:{f:Yr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:qr},220:{},221:{f:Yr},222:{},224:{f:function(t,e,i){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,6,n.data=function(t,e,i,n){var r={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return r.patternType=tr[o>>26],n.cellStyles?(r.alc=7&s,r.fWrap=s>>3&1,r.alcV=s>>4&7,r.fJustLast=s>>7&1,r.trot=s>>8&255,r.cIndent=s>>16&15,r.fShrinkToFit=s>>20&1,r.iReadOrder=s>>22&2,r.fAtrNum=s>>26&1,r.fAtrFnt=s>>27&1,r.fAtrAlc=s>>28&1,r.fAtrBdr=s>>29&1,r.fAtrPat=s>>30&1,r.fAtrProt=s>>31&1,r.dgLeft=15&a,r.dgRight=a>>4&15,r.dgTop=a>>8&15,r.dgBottom=a>>12&15,r.icvLeft=a>>16&127,r.icvRight=a>>23&127,r.grbitDiag=a>>30&3,r.icvTop=127&o,r.icvBottom=o>>7&127,r.icvDiag=o>>14&127,r.dgDiag=o>>21&15,r.icvFore=127&l,r.icvBack=l>>7&127,r.fsxButton=l>>14&1,r):r}(t,0,n.fStyle,i),n}},225:{f:function(t,e){return 0===e||t.read_shift(2),1200}},226:{f:Vr},227:{},229:{f:function(t,e){for(var i=[],n=t.read_shift(2);n--;)i.push(ms(t));return i}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(t,e){for(var i=t.l+e,n=t.read_shift(4),r=t.read_shift(4),s=[],a=0;a!=r&&t.l<i;++a)s.push(ts(t));return s.Count=n,s.Unique=r,s}},253:{f:function(t){var e=ds(t);return e.isst=t.read_shift(4),e}},255:{f:function(t,e){var i={};return i.dsst=t.read_shift(2),t.l+=e-2,i}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Jr},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Yr},353:{f:Vr},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(t,e,i){var n=t.l+e,r=t.read_shift(2),s=t.read_shift(2);if(i.sbcch=s,1025==s||14849==s)return[s,r];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=is(t,s),o=[];n>t.l;)o.push(ns(t));return[s,r,a,o]}},431:{f:Yr},432:{},433:{},434:{},437:{},438:{f:function(t,e,i){var n=t.l,r="";try{t.l+=4;var s=(i.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(s)?t.l+=6:function(t){var e=t.read_shift(1);t.l++;var i=t.read_shift(2);return t.l+=2,[e,i]}(t);var a=t.read_shift(2);t.read_shift(2),qr(t);var o=t.read_shift(2);t.l+=o;for(var l=1;l<t.lens.length-1;++l){if(t.l-n!=t.lens[l])throw new Error("TxO: bad continue record");var h=t[t.l];if((r+=is(t,t.lens[l+1]-t.lens[l]-1)).length>=(h?a:2*a))break}if(r.length!==a&&r.length!==2*a)throw new Error("cchText: "+a+" != "+r.length);return t.l=n+e,{t:r}}catch(i){return t.l=n+e,{t:r}}}},439:{f:Yr},440:{f:function(t,e){var i=ms(t);t.l+=16;var n=function(t,e){var i=t.l+e,n=t.read_shift(4);if(2!==n)throw new Error("Unrecognized streamVersion: "+n);var r=t.read_shift(2);t.l+=2;var s,a,o,l,h,c,u="";16&r&&(s=os(t,t.l)),128&r&&(a=os(t,t.l)),257==(257&r)&&(o=os(t,t.l)),1==(257&r)&&(l=as(t,t.l)),8&r&&(u=os(t,t.l)),32&r&&(h=t.read_shift(16)),64&r&&(c=Or(t)),t.l=i;var d=a||o||l||"";d&&u&&(d+="#"+u),d||(d="#"+u),2&r&&"/"==d.charAt(0)&&"/"!=d.charAt(1)&&(d="file://"+d);var f={Target:d};return h&&(f.guid=h),c&&(f.time=c),s&&(f.Tooltip=s),f}(t,e-24);return[i,n]}},441:{},442:{f:ns},443:{},444:{f:qr},445:{},446:{},448:{f:Vr},449:{f:function(t){return t.read_shift(2),t.read_shift(4)},r:2},450:{f:Vr},512:{f:As},513:{f:Gs},515:{f:function(t,e,i){i.biffguess&&2==i.biff&&(i.biff=5);var n=ds(t),r=Wn(t);return n.val=r,n}},516:{f:function(t,e,i){i.biffguess&&2==i.biff&&(i.biff=5),t.l;var n=ds(t);2==i.biff&&t.l++;var r=ns(t,t.l,i);return n.val=r,n}},517:{f:Ps},519:{f:Hs},520:{f:function(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var i=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,7&n&&(e.level=7&n),32&n&&(e.hidden=!0),64&n&&(e.hpt=i/20),e}},523:{},545:{f:Fs},549:{f:ks},566:{},574:{f:function(t,e,i){return i&&i.biff>=2&&i.biff<5?{}:{RTL:64&t.read_shift(2)}}},638:{f:function(t){var e=t.read_shift(2),i=t.read_shift(2),n=gs(t);return{r:e,c:i,ixfe:n[0],rknum:n[1]}}},659:{},1048:{},1054:{f:function(t,e,i){return[t.read_shift(2),rs(t,0,i)]}},1084:{},1212:{f:function(t,e,i){var n=ys(t);t.l++;var r=t.read_shift(1);return[ol(t,e-=8,i),r,n]}},2048:{f:function(t,e){t.read_shift(2);var i=ms(t),n=t.read_shift((e-10)/2,"dbcs-cont");return[i,n=n.replace(X,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ss},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Vr},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e},r:12},2173:{f:function(t,e){t.l,t.l+=2;var i=t.read_shift(2);t.l+=2;for(var n=t.read_shift(2),r=[];n-- >0;)r.push(mo(t,t.l));return{ixfe:i,ext:r}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Yr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(t,e,i){if(!(i.biff<8)){var n=t.read_shift(2),r=t.read_shift(2);return[is(t,n,i),is(t,r,i)]}t.l+=e},r:12},2197:{},2198:{f:function(t,e,i){var n=t.l+e;if(124226!==t.read_shift(4))if(i.cellStyles){var r,s=t.slice(t.l);t.l=n;try{r=Te(s,{type:"array"})}catch(t){return}var a=be(r,"theme/theme/theme1.xml",!0);if(a)return fo(a,i)}else t.l=n},r:12},2199:{},2200:{},2201:{},2202:{f:function(t){return[0!==t.read_shift(4),0!==t.read_shift(4),t.read_shift(4)]},r:12},2203:{f:Vr},2204:{},2205:{},2206:{},2207:{},2211:{f:function(t){var e=function(t){var e=t.read_shift(2),i=t.read_shift(2);return t.l+=8,{type:e,flags:i}}(t);if(2211!=e.type)throw new Error("Invalid Future Record "+e.type);return 0!==t.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:qr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(t,e,i){var n={area:!1};if(5!=i.biff)return t.l+=e,n;var r=t.read_shift(1);return t.l+=3,16&r&&(n.area=!0),n}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(t){for(var e=t.read_shift(2),i=[];e-- >0;)i.push(us(t));return i}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:As},1:{},2:{f:function(t){var e=ds(t);++t.l;var i=t.read_shift(2);return e.t="n",e.val=i,e}},3:{f:function(t){var e=ds(t);++t.l;var i=Wn(t);return e.t="n",e.val=i,e}},4:{f:function(t,e,i){i.biffguess&&5==i.biff&&(i.biff=2);var n=ds(t);++t.l;var r=rs(t,0,i);return n.t="str",n.val=r,n}},5:{f:Ps},7:{f:function(t){var e=t.read_shift(1);return 0===e?(t.l++,""):t.read_shift(e,"sbcs-cont")}},8:{},9:{f:Ss},11:{},22:{f:qr},30:{f:Ms},31:{},32:{},33:{f:Fs},36:{},37:{f:ks},50:{f:function(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}},62:{},52:{},67:{},68:{f:qr},69:{},86:{},126:{},127:{f:function(t){var e=t.read_shift(2),i=t.read_shift(2),n=t.read_shift(4),r={fmt:e,env:i,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,r}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(t,e,i){var n=t.l+e,r=ds(t),s=t.read_shift(2),a=is(t,s,i);return t.l=n,r.t="str",r.val=a,r}},223:{},234:{},354:{},421:{},518:{f:ll},521:{f:Ss},536:{f:Ds},547:{f:Is},561:{},579:{},1030:{f:ll},1033:{f:Ss},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function cc(t,e,i,n){var r=e;if(!isNaN(r)){var s=n||(i||[]).length||0,a=t.next(4);a.write_shift(2,r),a.write_shift(2,s),s>0&&Ii(i)&&t.push(i)}}function uc(t,e,i){return t||(t=qi(7)),t.write_shift(2,e),t.write_shift(2,i),t.write_shift(2,0),t.write_shift(1,0),t}function dc(t,e,i,n){if(null!=e.v)switch(e.t){case"d":case"n":var r="d"==e.t?Jt(ae(e.v)):e.v;return void(r==(0|r)&&r>=0&&r<65536?cc(t,2,(s=i,a=n,o=r,l=qi(9),uc(l,s,a),l.write_shift(2,o),l)):cc(t,3,function(t,e,i){var n=qi(15);return uc(n,t,e),n.write_shift(8,i,"f"),n}(i,n,r)));case"b":case"e":return void cc(t,5,function(t,e,i,n){var r=qi(9);return uc(r,t,e),$r(i,n||"b",r),r}(i,n,e.v,e.t));case"s":case"str":return void cc(t,4,function(t,e,i){var n=qi(8+2*i.length);return uc(n,t,e),n.write_shift(1,i.length),n.write_shift(i.length,i,"sbcs"),n.l<n.length?n.slice(0,n.l):n}(i,n,(e.v||"").slice(0,255)))}var s,a,o,l;cc(t,1,uc(null,i,n))}function fc(t,e){var i=e||{};null!=R&&null==i.dense&&(i.dense=R);for(var n=Ji(),r=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==i.sheet&&(r=s);if(0==r&&i.sheet&&t.SheetNames[0]!=i.sheet)throw new Error("Sheet not found: "+i.sheet);return cc(n,4==i.biff?1033:3==i.biff?521:9,Ts(0,16,i)),function(t,e,i,n){var r,s=Array.isArray(e),a=dn(e["!ref"]||"A1"),o="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),r=un(a)}for(var h=a.s.r;h<=a.e.r;++h){o=sn(h);for(var c=a.s.c;c<=a.e.c;++c){h===a.s.r&&(l[c]=on(c)),r=l[c]+o;var u=s?(e[h]||[])[c]:e[r];u&&dc(t,u,h,c)}}}(n,t.Sheets[t.SheetNames[r]],0,i),cc(n,10),n.end()}function pc(t,e,i){cc(t,49,function(t,e){var i=t.name||"Arial",n=e&&5==e.biff,r=qi(n?15+i.length:16+2*i.length);return r.write_shift(2,20*(t.sz||12)),r.write_shift(4,0),r.write_shift(2,400),r.write_shift(4,0),r.write_shift(2,0),r.write_shift(1,i.length),n||r.write_shift(1,1),r.write_shift((n?1:2)*i.length,i,n?"sbcs":"utf16le"),r}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},i))}function gc(t,e){if(e){var i=0;e.forEach((function(e,n){++i<=256&&e&&cc(t,125,function(t,e){var i=qi(12);i.write_shift(2,e),i.write_shift(2,e),i.write_shift(2,256*t.width),i.write_shift(2,0);var n=0;return t.hidden&&(n|=1),i.write_shift(1,n),n=t.level||0,i.write_shift(1,n),i.write_shift(2,0),i}(Tl(n,e),n))}))}}function mc(t,e,i,n,r){var s=16+kl(r.cellXfs,e,r);if(null!=e.v||e.bf)if(e.bf)cc(t,6,hl(e,i,n,0,s));else switch(e.t){case"d":case"n":cc(t,515,function(t,e,i,n){var r=qi(14);return fs(t,e,n,r),Gn(i,r),r}(i,n,"d"==e.t?Jt(ae(e.v)):e.v,s));break;case"b":case"e":cc(t,517,function(t,e,i,n,r,s){var a=qi(8);return fs(t,e,n,a),$r(i,s,a),a}(i,n,e.v,s,0,e.t));break;case"s":case"str":if(r.bookSST)cc(t,253,function(t,e,i,n){var r=qi(10);return fs(t,e,n,r),r.write_shift(4,i),r}(i,n,Sl(r.Strings,e.v,r.revStrings),s));else cc(t,516,function(t,e,i,n,r){var s=!r||8==r.biff,a=qi(+s+8+(1+s)*i.length);return fs(t,e,n,a),a.write_shift(2,i.length),s&&a.write_shift(1,1),a.write_shift((1+s)*i.length,i,s?"utf16le":"sbcs"),a}(i,n,(e.v||"").slice(0,255),s,r));break;default:cc(t,513,fs(i,n,s))}else cc(t,513,fs(i,n,s))}function vc(t,e,i){var n,r,s,a=Ji(),o=i.SheetNames[t],l=i.Sheets[o]||{},h=(i||{}).Workbook||{},c=(h.Sheets||[])[t]||{},u=Array.isArray(l),d=8==e.biff,f="",p=[],g=dn(l["!ref"]||"A1"),m=d?65536:16384;if(g.e.c>255||g.e.r>=m){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,m-1)}cc(a,2057,Ts(0,16,e)),cc(a,13,Zr(1)),cc(a,12,Zr(100)),cc(a,15,Kr(!0)),cc(a,17,Kr(!1)),cc(a,16,Gn(.001)),cc(a,95,Kr(!0)),cc(a,42,Kr(!1)),cc(a,43,Kr(!1)),cc(a,130,Zr(1)),cc(a,128,(r=[0,0],(s=qi(8)).write_shift(4,0),s.write_shift(2,r[0]?r[0]+1:0),s.write_shift(2,r[1]?r[1]+1:0),s)),cc(a,131,Kr(!1)),cc(a,132,Kr(!1)),d&&gc(a,l["!cols"]),cc(a,512,function(t,e){var i=8!=e.biff&&e.biff?2:4,n=qi(2*i+6);return n.write_shift(i,t.s.r),n.write_shift(i,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}(g,e)),d&&(l["!links"]=[]);for(var v=g.s.r;v<=g.e.r;++v){f=sn(v);for(var y=g.s.c;y<=g.e.c;++y){v===g.s.r&&(p[y]=on(y)),n=p[y]+f;var b=u?(l[v]||[])[y]:l[n];b&&(mc(a,b,v,y,e),d&&b.l&&l["!links"].push([n,b.l]))}}var _=c.CodeName||c.name||o;return d&&cc(a,574,function(t){var e=qi(18),i=1718;return t&&t.RTL&&(i|=64),e.write_shift(2,i),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}((h.Views||[])[0])),d&&(l["!merges"]||[]).length&&cc(a,229,function(t){var e=qi(2+8*t.length);e.write_shift(2,t.length);for(var i=0;i<t.length;++i)vs(t[i],e);return e}(l["!merges"])),d&&function(t,e){for(var i=0;i<e["!links"].length;++i){var n=e["!links"][i];cc(t,440,Bs(n)),n[1].Tooltip&&cc(t,2048,zs(n))}delete e["!links"]}(a,l),cc(a,442,ss(_)),d&&function(t,e){var i=qi(19);i.write_shift(4,2151),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(2,3),i.write_shift(1,1),i.write_shift(4,0),cc(t,2151,i),(i=qi(39)).write_shift(4,2152),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(2,3),i.write_shift(1,0),i.write_shift(4,0),i.write_shift(2,1),i.write_shift(4,4),i.write_shift(2,0),vs(dn(e["!ref"]||"A1"),i),i.write_shift(4,4),cc(t,2152,i)}(a,l),cc(a,10),a.end()}function yc(t,e,i){var n,r=Ji(),s=(t||{}).Workbook||{},a=s.Sheets||[],o=s.WBProps||{},l=8==i.biff,h=5==i.biff;(cc(r,2057,Ts(0,5,i)),"xla"==i.bookType&&cc(r,135),cc(r,225,l?Zr(1200):null),cc(r,193,function(t,e){e||(e=qi(t));for(var i=0;i<t;++i)e.write_shift(1,0);return e}(2)),h&&cc(r,191),h&&cc(r,192),cc(r,226),cc(r,92,function(t,e){var i=!e||8==e.biff,n=qi(i?112:54);for(n.write_shift(8==e.biff?2:1,7),i&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(i?0:536870912));n.l<n.length;)n.write_shift(1,i?0:32);return n}(0,i)),cc(r,66,Zr(l?1200:1252)),l&&cc(r,353,Zr(0)),l&&cc(r,448),cc(r,317,function(t){for(var e=qi(2*t),i=0;i<t;++i)e.write_shift(2,i+1);return e}(t.SheetNames.length)),l&&t.vbaraw&&cc(r,211),l&&t.vbaraw)&&cc(r,442,ss(o.CodeName||"ThisWorkbook"));cc(r,156,Zr(17)),cc(r,25,Kr(!1)),cc(r,18,Kr(!1)),cc(r,19,Zr(0)),l&&cc(r,431,Kr(!1)),l&&cc(r,444,Zr(0)),cc(r,61,((n=qi(18)).write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n)),cc(r,64,Kr(!1)),cc(r,141,Zr(0)),cc(r,34,Kr("true"==function(t){return t.Workbook&&t.Workbook.WBProps&&He(t.Workbook.WBProps.date1904)?"true":"false"}(t))),cc(r,14,Kr(!0)),l&&cc(r,439,Kr(!1)),cc(r,218,Zr(0)),pc(r,0,i),function(t,e,i){e&&[[5,8],[23,26],[41,44],[50,392]].forEach((function(n){for(var r=n[0];r<=n[1];++r)null!=e[r]&&cc(t,1054,Cs(r,e[r],i))}))}(r,t.SSF,i),function(t,e){for(var i=0;i<16;++i)cc(t,224,Os({numFmtId:0,style:!0},0,e));e.cellXfs.forEach((function(i){cc(t,224,Os(i,0,e))}))}(r,i),l&&cc(r,352,Kr(!1));var c=r.end(),u=Ji();l&&cc(u,140,function(t){return t||(t=qi(4)),t.write_shift(2,1),t.write_shift(2,1),t}()),l&&i.Strings&&function(t,e,i,n){var r=n||(i||[]).length||0;if(r<=8224)return cc(t,e,i,r);var s=e;if(!isNaN(s)){for(var a=i.parts||[],o=0,l=0,h=0;h+(a[o]||8224)<=8224;)h+=a[o]||8224,o++;var c=t.next(4);for(c.write_shift(2,s),c.write_shift(2,h),t.push(i.slice(l,l+h)),l+=h;l<r;){for((c=t.next(4)).write_shift(2,60),h=0;h+(a[o]||8224)<=8224;)h+=a[o]||8224,o++;c.write_shift(2,h),t.push(i.slice(l,l+h)),l+=h}}}(u,252,function(t,e){var i=qi(8);i.write_shift(4,t.Count),i.write_shift(4,t.Unique);for(var n=[],r=0;r<t.length;++r)n[r]=es(t[r]);var s=H([i].concat(n));return s.parts=[i.length].concat(n.map((function(t){return t.length}))),s}(i.Strings)),cc(u,10);var d=u.end(),f=Ji(),p=0,g=0;for(g=0;g<t.SheetNames.length;++g)p+=(l?12:11)+(l?2:1)*t.SheetNames[g].length;var m=c.length+p+d.length;for(g=0;g<t.SheetNames.length;++g){cc(f,133,Es({pos:m,hs:(a[g]||{}).Hidden||0,dt:0,name:t.SheetNames[g]},i)),m+=e[g].length}var v=f.end();if(p!=v.length)throw new Error("BS8 "+p+" != "+v.length);var y=[];return c.length&&y.push(c),v.length&&y.push(v),d.length&&y.push(d),H(y)}function bc(t,e){for(var i=0;i<=t.SheetNames.length;++i){var n=t.Sheets[t.SheetNames[i]];if(n&&n["!ref"])cn(n["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+t.SheetNames[i]+"' extends beyond column IV (255).  Data may be lost.")}var r=e||{};switch(r.biff||2){case 8:case 5:return function(t,e){var i=e||{},n=[];t&&!t.SSF&&(t.SSF=le(nt)),t&&t.SSF&&(jt(),Ft(t.SSF),i.revssf=qt(t.SSF),i.revssf[t.SSF[65535]]=0,i.ssf=t.SSF),i.Strings=[],i.Strings.Count=0,i.Strings.Unique=0,uu(i),i.cellXfs=[],kl(i.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var r=0;r<t.SheetNames.length;++r)n[n.length]=vc(r,i,t);return n.unshift(yc(t,n,i)),H(n)}(t,e);case 4:case 3:case 2:return fc(t,e)}throw new Error("invalid type "+r.bookType+" for BIFF")}function _c(t,e){var i=e||{};null!=R&&null==i.dense&&(i.dense=R);var n=i.dense?[]:{},r=(t=t.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!r)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=r.index,o=s&&s.index||t.length,l=fe(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,c=0,u=0,d=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(a=0;a<l.length;++a){var g=l[a].trim(),m=g.slice(0,3).toLowerCase();if("<tr"!=m){if("<td"==m||"<th"==m){var v=g.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var y=v[o].trim();if(y.match(/<t[dh]/i)){for(var b=y,_=0;"<"==b.charAt(0)&&(_=b.indexOf(">"))>-1;)b=b.slice(_+1);for(var x=0;x<p.length;++x){var w=p[x];w.s.c==c&&w.s.r<h&&h<=w.e.r&&(c=w.e.c+1,x=-1)}var S=Re(y.slice(0,y.indexOf(">")));d=S.colspan?+S.colspan:1,((u=+S.rowspan)>1||d>1)&&p.push({s:{r:h,c},e:{r:h+(u||1)-1,c:c+d-1}});var T=S.t||S["data-t"]||"";if(b.length)if(b=$e(b),f.s.r>h&&(f.s.r=h),f.e.r<h&&(f.e.r=h),f.s.c>c&&(f.s.c=c),f.e.c<c&&(f.e.c=c),b.length){var E={t:"s",v:b};i.raw||!b.trim().length||"s"==T||("TRUE"===b?E={t:"b",v:!0}:"FALSE"===b?E={t:"b",v:!1}:isNaN(ce(b))?isNaN(de(b).getDate())||(E={t:"d",v:ae(b)},i.cellDates||(E={t:"n",v:Jt(E.v)}),E.z=i.dateNF||nt[14]):E={t:"n",v:ce(b)}),i.dense?(n[h]||(n[h]=[]),n[h][c]=E):n[hn({r:h,c})]=E,c+=d}else c+=d;else c+=d}}}}else{if(++h,i.sheetRows&&i.sheetRows<=h){--h;break}c=0}}return n["!ref"]=un(f),p.length&&(n["!merges"]=p),n}function xc(t,e,i,n){for(var r=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,h=0;h<r.length;++h)if(!(r[h].s.r>i||r[h].s.c>a||r[h].e.r<i||r[h].e.c<a)){if(r[h].s.r<i||r[h].s.c<a){o=-1;break}o=r[h].e.r-r[h].s.r+1,l=r[h].e.c-r[h].s.c+1;break}if(!(o<0)){var c=hn({r:i,c:a}),u=n.dense?(t[i]||[])[a]:t[c],d=u&&null!=u.v&&(u.h||Ge(u.w||(pn(u),u.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":u&&(f["data-t"]=u&&u.t||"z",null!=u.v&&(f["data-v"]=u.v),null!=u.z&&(f["data-z"]=u.z),u.l&&"#"!=(u.l.Target||"#").charAt(0)&&(d='<a href="'+u.l.Target+'">'+d+"</a>")),f.id=(n.id||"sjs")+"-"+c,s.push(ai("td",d,f))}}return"<tr>"+s.join("")+"</tr>"}var wc='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Sc="</body></html>";function Tc(t,e,i){return[].join("")+"<table"+(i&&i.id?' id="'+i.id+'"':"")+">"}function Ec(t,e){var i=e||{},n=null!=i.header?i.header:wc,r=null!=i.footer?i.footer:Sc,s=[n],a=cn(t["!ref"]);i.dense=Array.isArray(t),s.push(Tc(0,0,i));for(var o=a.s.r;o<=a.e.r;++o)s.push(xc(t,a,o,i));return s.push("</table>"+r),s.join("")}function kc(t,e,i){var n=i||{};null!=R&&(n.dense=R);var r=0,s=0;if(null!=n.origin)if("number"==typeof n.origin)r=n.origin;else{var a="string"==typeof n.origin?ln(n.origin):n.origin;r=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),h={s:{r:0,c:0},e:{r,c:s}};if(t["!ref"]){var c=cn(t["!ref"]);h.s.r=Math.min(h.s.r,c.s.r),h.s.c=Math.min(h.s.c,c.s.c),h.e.r=Math.max(h.e.r,c.e.r),h.e.c=Math.max(h.e.c,c.e.c),-1==r&&(h.e.r=r=c.e.r+1)}var u=[],d=0,f=t["!rows"]||(t["!rows"]=[]),p=0,g=0,m=0,v=0,y=0,b=0;for(t["!cols"]||(t["!cols"]=[]);p<o.length&&g<l;++p){var _=o[p];if(Mc(_)){if(n.display)continue;f[g]={hidden:!0}}var x=_.children;for(m=v=0;m<x.length;++m){var w=x[m];if(!n.display||!Mc(w)){var S=w.hasAttribute("data-v")?w.getAttribute("data-v"):w.hasAttribute("v")?w.getAttribute("v"):$e(w.innerHTML),T=w.getAttribute("data-z")||w.getAttribute("z");for(d=0;d<u.length;++d){var E=u[d];E.s.c==v+s&&E.s.r<g+r&&g+r<=E.e.r&&(v=E.e.c+1-s,d=-1)}b=+w.getAttribute("colspan")||1,((y=+w.getAttribute("rowspan")||1)>1||b>1)&&u.push({s:{r:g+r,c:v+s},e:{r:g+r+(y||1)-1,c:v+s+(b||1)-1}});var k={t:"s",v:S},C=w.getAttribute("data-t")||w.getAttribute("t")||"";null!=S&&(0==S.length?k.t=C||"z":n.raw||0==S.trim().length||"s"==C||("TRUE"===S?k={t:"b",v:!0}:"FALSE"===S?k={t:"b",v:!1}:isNaN(ce(S))?isNaN(de(S).getDate())||(k={t:"d",v:ae(S)},n.cellDates||(k={t:"n",v:Jt(k.v)}),k.z=n.dateNF||nt[14]):k={t:"n",v:ce(S)})),void 0===k.z&&null!=T&&(k.z=T);var M="",A=w.getElementsByTagName("A");if(A&&A.length)for(var O=0;O<A.length&&(!A[O].hasAttribute("href")||"#"==(M=A[O].getAttribute("href")).charAt(0));++O);M&&"#"!=M.charAt(0)&&(k.l={Target:M}),n.dense?(t[g+r]||(t[g+r]=[]),t[g+r][v+s]=k):t[hn({c:v+s,r:g+r})]=k,h.e.c<v+s&&(h.e.c=v+s),v+=b}}++g}return u.length&&(t["!merges"]=(t["!merges"]||[]).concat(u)),h.e.r=Math.max(h.e.r,g-1+r),t["!ref"]=un(h),g>=l&&(t["!fullref"]=un((h.e.r=o.length-p+g-1+r,h))),t}function Cc(t,e){return kc((e||{}).dense?[]:{},t,e)}function Mc(t){var e="",i=function(t){return t.ownerDocument.defaultView&&"function"==typeof t.ownerDocument.defaultView.getComputedStyle?t.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(t);return i&&(e=i(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),"none"===e}var Ac={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Oc(t,e){var i=e||{};null!=R&&null==i.dense&&(i.dense=R);var n,r,s,a,o,l,h,c,u=li(t),d=[],f={name:""},p="",g=0,m={},v=[],y=i.dense?[]:{},b={value:""},_="",x=0,w=[],S=-1,T=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,C={},M=[],A={},O=[],P=1,I=1,L=[],D={Names:[]},N={},F=["",""],j=[],B={},z="",W=0,G=!1,U=!1,H=0;for(hi.lastIndex=0,u=u.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");o=hi.exec(u);)switch(o[3]=o[3].replace(/_.*$/,"")){case"table":case"工作表":"/"===o[1]?(E.e.c>=E.s.c&&E.e.r>=E.s.r?y["!ref"]=un(E):y["!ref"]="A1:A1",i.sheetRows>0&&i.sheetRows<=E.e.r&&(y["!fullref"]=y["!ref"],E.e.r=i.sheetRows-1,y["!ref"]=un(E)),M.length&&(y["!merges"]=M),O.length&&(y["!rows"]=O),s.name=s["名称"]||s.name,"undefined"!=typeof JSON&&JSON.stringify(s),v.push(s.name),m[s.name]=y,U=!1):"/"!==o[0].charAt(o[0].length-2)&&(s=Re(o[0],!1),S=T=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,y=i.dense?[]:{},M=[],O=[],U=!0);break;case"table-row-group":"/"===o[1]?--k:++k;break;case"table-row":case"行":if("/"===o[1]){S+=P,P=1;break}if((a=Re(o[0],!1))["行号"]?S=a["行号"]-1:-1==S&&(S=0),(P=+a["number-rows-repeated"]||1)<10)for(H=0;H<P;++H)k>0&&(O[S+H]={level:k});T=-1;break;case"covered-table-cell":"/"!==o[1]&&++T,i.sheetStubs&&(i.dense?(y[S]||(y[S]=[]),y[S][T]={t:"z"}):y[hn({r:S,c:T})]={t:"z"}),_="",w=[];break;case"table-cell":case"数据":if("/"===o[0].charAt(o[0].length-2))++T,b=Re(o[0],!1),I=parseInt(b["number-columns-repeated"]||"1",10),l={t:"z",v:null},b.formula&&0!=i.cellFormula&&(l.f=yl(Ne(b.formula))),"string"==(b["数据类型"]||b["value-type"])&&(l.t="s",l.v=Ne(b["string-value"]||""),i.dense?(y[S]||(y[S]=[]),y[S][T]=l):y[hn({r:S,c:T})]=l),T+=I-1;else if("/"!==o[1]){_="",x=0,w=[],I=1;var X=P?S+P-1:S;if(++T>E.e.c&&(E.e.c=T),T<E.s.c&&(E.s.c=T),S<E.s.r&&(E.s.r=S),X>E.e.r&&(E.e.r=X),j=[],B={},l={t:(b=Re(o[0],!1))["数据类型"]||b["value-type"],v:null},i.cellFormula)if(b.formula&&(b.formula=Ne(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(A={s:{r:S,c:T},e:{r:S+(parseInt(b["number-matrix-rows-spanned"],10)||0)-1,c:T+(parseInt(b["number-matrix-columns-spanned"],10)||0)-1}},l.F=un(A),L.push([A,l.F])),b.formula)l.f=yl(b.formula);else for(H=0;H<L.length;++H)S>=L[H][0].s.r&&S<=L[H][0].e.r&&T>=L[H][0].s.c&&T<=L[H][0].e.c&&(l.F=L[H][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(A={s:{r:S,c:T},e:{r:S+(parseInt(b["number-rows-spanned"],10)||0)-1,c:T+(parseInt(b["number-columns-spanned"],10)||0)-1}},M.push(A)),b["number-columns-repeated"]&&(I=parseInt(b["number-columns-repeated"],10)),l.t){case"boolean":l.t="b",l.v=He(b["boolean-value"]);break;case"float":case"percentage":case"currency":l.t="n",l.v=parseFloat(b.value);break;case"date":l.t="d",l.v=ae(b["date-value"]),i.cellDates||(l.t="n",l.v=Jt(l.v)),l.z="m/d/yy";break;case"time":l.t="n",l.v=ie(b["time-value"])/86400,i.cellDates&&(l.t="d",l.v=ee(l.v)),l.z="HH:MM:SS";break;case"number":l.t="n",l.v=parseFloat(b["数据数值"]);break;default:if("string"!==l.t&&"text"!==l.t&&l.t)throw new Error("Unsupported value type "+l.t);l.t="s",null!=b["string-value"]&&(_=Ne(b["string-value"]),w=[])}}else{if(G=!1,"s"===l.t&&(l.v=_||"",w.length&&(l.R=w),G=0==x),N.Target&&(l.l=N),j.length>0&&(l.c=j,j=[]),_&&!1!==i.cellText&&(l.w=_),G&&(l.t="z",delete l.v),(!G||i.sheetStubs)&&!(i.sheetRows&&i.sheetRows<=S))for(var V=0;V<P;++V){if(I=parseInt(b["number-columns-repeated"]||"1",10),i.dense)for(y[S+V]||(y[S+V]=[]),y[S+V][T]=0==V?l:le(l);--I>0;)y[S+V][T+I]=le(l);else for(y[hn({r:S+V,c:T})]=l;--I>0;)y[hn({r:S+V,c:T+I})]=le(l);E.e.c<=T&&(E.e.c=T)}T+=(I=parseInt(b["number-columns-repeated"]||"1",10))-1,I=0,l={},_="",w=[]}N={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===o[1]){if((n=d.pop())[0]!==o[3])throw"Bad state: "+n}else"/"!==o[0].charAt(o[0].length-2)&&d.push([o[3],!0]);break;case"annotation":if("/"===o[1]){if((n=d.pop())[0]!==o[3])throw"Bad state: "+n;B.t=_,w.length&&(B.R=w),B.a=z,j.push(B)}else"/"!==o[0].charAt(o[0].length-2)&&d.push([o[3],!1]);z="",W=0,_="",x=0,w=[];break;case"creator":"/"===o[1]?z=u.slice(W,o.index):W=o.index+o[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===o[1]){if((n=d.pop())[0]!==o[3])throw"Bad state: "+n}else"/"!==o[0].charAt(o[0].length-2)&&d.push([o[3],!1]);_="",x=0,w=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"电子表格":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"标题":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===o[1]){if(C[f.name]=p,(n=d.pop())[0]!==o[3])throw"Bad state: "+n}else"/"!==o[0].charAt(o[0].length-2)&&(p="",f=Re(o[0],!1),d.push([o[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(d[d.length-1][0]){case"time-style":case"date-style":r=Re(o[0],!1),p+=Ac[o[3]]["long"===r.style?1:0]}break;case"text":if("/>"===o[0].slice(-2))break;if("/"===o[1])switch(d[d.length-1][0]){case"number-style":case"date-style":case"time-style":p+=u.slice(g,o.index)}else g=o.index+o[0].length;break;case"named-range":F=bl((r=Re(o[0],!1))["cell-range-address"]);var Y={Name:r.name,Ref:F[0]+"!"+F[1]};U&&(Y.Sheet=v.length),D.Names.push(Y);break;case"p":case"文本串":if(["master-styles"].indexOf(d[d.length-1][0])>-1)break;if("/"!==o[1]||b&&b["string-value"])Re(o[0],!1),x=o.index+o[0].length;else{var K=(h=u.slice(x,o.index),c=void 0,c=h.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(t,e){return Array(parseInt(e,10)+1).join(" ")})).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n"),[Ne(c.replace(/<[^>]*>/g,""))]);_=(_.length>0?_+"\n":"")+K[0]}break;case"database-range":if("/"===o[1])break;try{m[(F=bl(Re(o[0])["target-range-address"]))[0]]["!autofilter"]={ref:F[1]}}catch(t){}break;case"a":if("/"!==o[1]){if(!(N=Re(o[0],!1)).href)break;N.Target=Ne(N.href),delete N.href,"#"==N.Target.charAt(0)&&N.Target.indexOf(".")>-1?(F=bl(N.Target.slice(1)),N.Target="#"+F[0]+"!"+F[1]):N.Target.match(/^\.\.[\\\/]/)&&(N.Target=N.Target.slice(3))}break;default:switch(o[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(i.WTF)throw new Error(o)}}var q={Sheets:m,SheetNames:v,Workbook:D};return i.bookSheets&&delete q.Sheets,q}function Pc(t,e){e=e||{},me(t,"META-INF/manifest.xml")&&function(t,e){for(var i,n,r=li(t);i=hi.exec(r);)switch(i[3]){case"manifest":break;case"file-entry":if("/"==(n=Re(i[0],!1)).path&&n.type!==fr)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw i}}(ye(t,"META-INF/manifest.xml"),e);var i=be(t,"content.xml");if(!i)throw new Error("Missing content.xml in ODS / UOF file");var n=Oc(qe(i),e);return me(t,"meta.xml")&&(n.Props=yr(ye(t,"meta.xml"))),n}function Rc(t,e){return Oc(t,e)}var Ic=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+si({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return ke+e}}(),Lc=function(){var t="          <table:table-cell />\n",e=function(e,i,n){var r=[];r.push('      <table:table table:name="'+Be(i.SheetNames[n])+'" table:style-name="ta1">\n');var s=0,a=0,o=cn(e["!ref"]||"A1"),l=e["!merges"]||[],h=0,c=Array.isArray(e);if(e["!cols"])for(a=0;a<=o.e.c;++a)r.push("        <table:table-column"+(e["!cols"][a]?' table:style-name="co'+e["!cols"][a].ods+'"':"")+"></table:table-column>\n");var u="",d=e["!rows"]||[];for(s=0;s<o.s.r;++s)u=d[s]?' table:style-name="ro'+d[s].ods+'"':"",r.push("        <table:table-row"+u+"></table:table-row>\n");for(;s<=o.e.r;++s){for(u=d[s]?' table:style-name="ro'+d[s].ods+'"':"",r.push("        <table:table-row"+u+">\n"),a=0;a<o.s.c;++a)r.push(t);for(;a<=o.e.c;++a){var f=!1,p={},g="";for(h=0;h!=l.length;++h)if(!(l[h].s.c>a||l[h].s.r>s||l[h].e.c<a||l[h].e.r<s)){l[h].s.c==a&&l[h].s.r==s||(f=!0),p["table:number-columns-spanned"]=l[h].e.c-l[h].s.c+1,p["table:number-rows-spanned"]=l[h].e.r-l[h].s.r+1;break}if(f)r.push("          <table:covered-table-cell/>\n");else{var m=hn({r:s,c:a}),v=c?(e[s]||[])[a]:e[m];if(v&&v.f&&(p["table:formula"]=Be(("of:="+v.f.replace(Ao,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),v.F&&v.F.slice(0,m.length)==m)){var y=cn(v.F);p["table:number-matrix-columns-spanned"]=y.e.c-y.s.c+1,p["table:number-matrix-rows-spanned"]=y.e.r-y.s.r+1}if(v){switch(v.t){case"b":g=v.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=v.v?"true":"false";break;case"n":g=v.w||String(v.v||0),p["office:value-type"]="float",p["office:value"]=v.v||0;break;case"s":case"str":g=null==v.v?"":v.v,p["office:value-type"]="string";break;case"d":g=v.w||ae(v.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=ae(v.v).toISOString(),p["table:style-name"]="ce1";break;default:r.push(t);continue}var b=Be(g).replace(/  +/g,(function(t){return'<text:s text:c="'+t.length+'"/>'})).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");if(v.l&&v.l.Target){var _=v.l.Target;"#"==(_="#"==_.charAt(0)?"#"+_.slice(1).replace(/\./,"!"):_).charAt(0)||_.match(/^\w+:/)||(_="../"+_),b=ai("text:a",b,{"xlink:href":_.replace(/&/g,"&amp;")})}r.push("          "+ai("table:table-cell",ai("text:p",b,{}),p)+"\n")}else r.push(t)}}r.push("        </table:table-row>\n")}return r.push("      </table:table>\n"),r.join("")};return function(t,i){var n=[ke],r=si({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),s=si({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==i.bookType?(n.push("<office:document"+r+s+">\n"),n.push(gr().replace(/office:document-meta/g,"office:meta"))):n.push("<office:document-content"+r+">\n"),function(t,e){t.push(" <office:automatic-styles>\n"),t.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),t.push('   <number:month number:style="long"/>\n'),t.push("   <number:text>/</number:text>\n"),t.push('   <number:day number:style="long"/>\n'),t.push("   <number:text>/</number:text>\n"),t.push("   <number:year/>\n"),t.push("  </number:date-style>\n");var i=0;e.SheetNames.map((function(t){return e.Sheets[t]})).forEach((function(e){if(e&&e["!cols"])for(var n=0;n<e["!cols"].length;++n)if(e["!cols"][n]){var r=e["!cols"][n];if(null==r.width&&null==r.wpx&&null==r.wch)continue;Na(r),r.ods=i;var s=e["!cols"][n].wpx+"px";t.push('  <style:style style:name="co'+i+'" style:family="table-column">\n'),t.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+s+'"/>\n'),t.push("  </style:style>\n"),++i}}));var n=0;e.SheetNames.map((function(t){return e.Sheets[t]})).forEach((function(e){if(e&&e["!rows"])for(var i=0;i<e["!rows"].length;++i)if(e["!rows"][i]){e["!rows"][i].ods=n;var r=e["!rows"][i].hpx+"px";t.push('  <style:style style:name="ro'+n+'" style:family="table-row">\n'),t.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+r+'"/>\n'),t.push("  </style:style>\n"),++n}})),t.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),t.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),t.push("  </style:style>\n"),t.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),t.push(" </office:automatic-styles>\n")}(n,t),n.push("  <office:body>\n"),n.push("    <office:spreadsheet>\n");for(var a=0;a!=t.SheetNames.length;++a)n.push(e(t.Sheets[t.SheetNames[a]],t,a));return n.push("    </office:spreadsheet>\n"),n.push("  </office:body>\n"),"fods"==i.bookType?n.push("</office:document>"):n.push("</office:document-content>"),n.join("")}}();function Dc(t,e){if("fods"==e.bookType)return Lc(t,e);var i=Se(),n="",r=[],s=[];return we(i,n="mimetype","application/vnd.oasis.opendocument.spreadsheet"),we(i,n="content.xml",Lc(t,e)),r.push([n,"text/xml"]),s.push([n,"ContentFile"]),we(i,n="styles.xml",Ic(t,e)),r.push([n,"text/xml"]),s.push([n,"StylesFile"]),we(i,n="meta.xml",ke+gr()),r.push([n,"text/xml"]),s.push([n,"MetadataFile"]),we(i,n="manifest.rdf",function(t){var e,i,n=[ke];n.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=t.length;++r)n.push(pr(t[r][0],t[r][1])),n.push((e="",i=t[r][0],['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+i+'"/>\n',"  </rdf:Description>\n"].join("")));return n.push(pr("","Document","pkg")),n.push("</rdf:RDF>"),n.join("")}(s)),r.push([n,"application/rdf+xml"]),we(i,n="META-INF/manifest.xml",function(t){var e=[ke];e.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),e.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var i=0;i<t.length;++i)e.push('  <manifest:file-entry manifest:full-path="'+t[i][0]+'" manifest:media-type="'+t[i][1]+'"/>\n');return e.push("</manifest:manifest>"),e.join("")}(r)),i}
/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Nc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Fc(t){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(t):qe(G(t))}function jc(t){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(t):z(Ze(t))}function Bc(t){var e=t.reduce((function(t,e){return t+e.length}),0),i=new Uint8Array(e),n=0;return t.forEach((function(t){i.set(t,n),n+=t.length})),i}function zc(t){return 16843009*((t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135)>>>24}function Wc(t,e){var i=e?e[0]:0,n=127&t[i];t:if(t[i++]>=128){if(n|=(127&t[i])<<7,t[i++]<128)break t;if(n|=(127&t[i])<<14,t[i++]<128)break t;if(n|=(127&t[i])<<21,t[i++]<128)break t;if(n+=(127&t[i])*Math.pow(2,28),++i,t[i++]<128)break t;if(n+=(127&t[i])*Math.pow(2,35),++i,t[i++]<128)break t;if(n+=(127&t[i])*Math.pow(2,42),++i,t[i++]<128)break t}return e&&(e[0]=i),n}function Gc(t){var e=new Uint8Array(7);e[0]=127&t;var i=1;t:if(t>127){if(e[i-1]|=128,e[i]=t>>7&127,++i,t<=16383)break t;if(e[i-1]|=128,e[i]=t>>14&127,++i,t<=2097151)break t;if(e[i-1]|=128,e[i]=t>>21&127,++i,t<=268435455)break t;if(e[i-1]|=128,e[i]=t/256>>>21&127,++i,t<=34359738367)break t;if(e[i-1]|=128,e[i]=t/65536>>>21&127,++i,t<=4398046511103)break t;e[i-1]|=128,e[i]=t/16777216>>>21&127,++i}return e.slice(0,i)}function Uc(t){var e=0,i=127&t[e];t:if(t[e++]>=128){if(i|=(127&t[e])<<7,t[e++]<128)break t;if(i|=(127&t[e])<<14,t[e++]<128)break t;if(i|=(127&t[e])<<21,t[e++]<128)break t;i|=(127&t[e])<<28}return i}function Hc(t){for(var e=[],i=[0];i[0]<t.length;){var n,r=i[0],s=Wc(t,i),a=7&s,o=0;if(0==(s=Math.floor(s/8)))break;switch(a){case 0:for(var l=i[0];t[i[0]++]>=128;);n=t.slice(l,i[0]);break;case 5:o=4,n=t.slice(i[0],i[0]+o),i[0]+=o;break;case 1:o=8,n=t.slice(i[0],i[0]+o),i[0]+=o;break;case 2:o=Wc(t,i),n=t.slice(i[0],i[0]+o),i[0]+=o;break;default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(r))}var h={data:n,type:a};null==e[s]?e[s]=[h]:e[s].push(h)}return e}function Xc(t){var e=[];return t.forEach((function(t,i){t.forEach((function(t){t.data&&(e.push(Gc(8*i+t.type)),2==t.type&&e.push(Gc(t.data.length)),e.push(t.data))}))})),Bc(e)}function Vc(t,e){return(null==t?void 0:t.map((function(t){return e(t.data)})))||[]}function Yc(t){for(var e,i=[],n=[0];n[0]<t.length;){var r=Wc(t,n),s=Hc(t.slice(n[0],n[0]+r));n[0]+=r;var a={id:Uc(s[1][0].data),messages:[]};s[2].forEach((function(e){var i=Hc(e.data),r=Uc(i[3][0].data);a.messages.push({meta:i,data:t.slice(n[0],n[0]+r)}),n[0]+=r})),(null==(e=s[3])?void 0:e[0])&&(a.merge=Uc(s[3][0].data)>>>0>0),i.push(a)}return i}function Kc(t){var e=[];return t.forEach((function(t){var i=[];i[1]=[{data:Gc(t.id),type:0}],i[2]=[],null!=t.merge&&(i[3]=[{data:Gc(+!!t.merge),type:0}]);var n=[];t.messages.forEach((function(t){n.push(t.data),t.meta[3]=[{type:0,data:Gc(t.data.length)}],i[2].push({data:Xc(t.meta),type:2})}));var r=Xc(i);e.push(Gc(r.length)),e.push(r),n.forEach((function(t){return e.push(t)}))})),Bc(e)}function qc(t,e){if(0!=t)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var i=[0],n=Wc(e,i),r=[];i[0]<e.length;){var s=3&e[i[0]];if(0!=s){var a=0,o=0;if(1==s?(o=4+(e[i[0]]>>2&7),a=(224&e[i[0]++])<<3,a|=e[i[0]++]):(o=1+(e[i[0]++]>>2),2==s?(a=e[i[0]]|e[i[0]+1]<<8,i[0]+=2):(a=(e[i[0]]|e[i[0]+1]<<8|e[i[0]+2]<<16|e[i[0]+3]<<24)>>>0,i[0]+=4)),r=[Bc(r)],0==a)throw new Error("Invalid offset 0");if(a>r[0].length)throw new Error("Invalid offset beyond length");if(o>=a)for(r.push(r[0].slice(-a)),o-=a;o>=r[r.length-1].length;)r.push(r[r.length-1]),o-=r[r.length-1].length;r.push(r[0].slice(-a,-a+o))}else{var l=e[i[0]++]>>2;if(l<60)++l;else{var h=l-59;l=e[i[0]],h>1&&(l|=e[i[0]+1]<<8),h>2&&(l|=e[i[0]+2]<<16),h>3&&(l|=e[i[0]+3]<<24),l>>>=0,l++,i[0]+=h}r.push(e.slice(i[0],i[0]+l)),i[0]+=l}}var c=Bc(r);if(c.length!=n)throw new Error("Unexpected length: ".concat(c.length," != ").concat(n));return c}function Zc(t){for(var e=[],i=0;i<t.length;){var n=t[i++],r=t[i]|t[i+1]<<8|t[i+2]<<16;i+=3,e.push(qc(n,t.slice(i,i+r))),i+=r}if(i!==t.length)throw new Error("data is not a valid framed stream!");return Bc(e)}function Jc(t){for(var e=[],i=0;i<t.length;){var n=Math.min(t.length-i,268435455),r=new Uint8Array(4);e.push(r);var s=Gc(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(i,i+n)),a+=n,r[0]=0,r[1]=255&a,r[2]=a>>8&255,r[3]=a>>16&255,i+=n}return Bc(e)}function $c(t,e,i){var n,r=Nc(t),s=r.getUint32(8,!0),a=12,o=-1,l=-1,h=NaN,c=NaN,u=new Date(2001,0,1);switch(1&s&&(h=function(t,e){for(var i=(127&t[e+15])<<7|t[e+14]>>1,n=1&t[e+14],r=e+13;r>=e;--r)n=256*n+t[r];return(128&t[e+15]?-n:n)*Math.pow(10,i-6176)}(t,a),a+=16),2&s&&(c=r.getFloat64(a,!0),a+=8),4&s&&(u.setTime(u.getTime()+1e3*r.getFloat64(a,!0)),a+=8),8&s&&(l=r.getUint32(a,!0),a+=4),16&s&&(o=r.getUint32(a,!0),a+=4),t[1]){case 0:break;case 2:case 10:n={t:"n",v:h};break;case 3:n={t:"s",v:e[l]};break;case 5:n={t:"d",v:u};break;case 6:n={t:"b",v:c>0};break;case 7:n={t:"n",v:c/86400};break;case 8:n={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(31&s," : ").concat(t.slice(0,4)));n={t:"s",v:i[o]};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(31&s," : ").concat(t.slice(0,4)))}return n}function Qc(t,e){var i=new Uint8Array(32),n=Nc(i),r=12,s=0;switch(i[0]=5,t.t){case"n":i[1]=2,function(t,e,i){var n=Math.floor(0==i?0:Math.LOG10E*Math.log(Math.abs(i)))+6176-20,r=i/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(127&n)<<1;for(var s=0;r>=1;++s,r/=256)t[e+s]=255&r;t[e+15]|=i>=0?0:128}(i,r,t.v),s|=1,r+=16;break;case"b":i[1]=6,n.setFloat64(r,t.v?1:0,!0),s|=2,r+=8;break;case"s":if(-1==e.indexOf(t.v))throw new Error("Value ".concat(t.v," missing from SST!"));i[1]=3,n.setUint32(r,e.indexOf(t.v),!0),s|=8,r+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),i.slice(0,r)}function tu(t,e){var i=new Uint8Array(32),n=Nc(i),r=12,s=0;switch(i[0]=3,t.t){case"n":i[2]=2,n.setFloat64(r,t.v,!0),s|=32,r+=8;break;case"b":i[2]=6,n.setFloat64(r,t.v?1:0,!0),s|=32,r+=8;break;case"s":if(-1==e.indexOf(t.v))throw new Error("Value ".concat(t.v," missing from SST!"));i[2]=3,n.setUint32(r,e.indexOf(t.v),!0),s|=16,r+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),i.slice(0,r)}function eu(t,e,i){switch(t[0]){case 0:case 1:case 2:case 3:return function(t,e,i,n){var r,s=Nc(t),a=s.getUint32(4,!0),o=(n>1?12:8)+4*zc(a&(n>1?3470:398)),l=-1,h=-1,c=NaN,u=new Date(2001,0,1);switch(512&a&&(l=s.getUint32(o,!0),o+=4),o+=4*zc(a&(n>1?12288:4096)),16&a&&(h=s.getUint32(o,!0),o+=4),32&a&&(c=s.getFloat64(o,!0),o+=8),64&a&&(u.setTime(u.getTime()+1e3*s.getFloat64(o,!0)),o+=8),t[2]){case 0:break;case 2:r={t:"n",v:c};break;case 3:r={t:"s",v:e[h]};break;case 5:r={t:"d",v:u};break;case 6:r={t:"b",v:c>0};break;case 7:r={t:"n",v:c/86400};break;case 8:r={t:"e",v:0};break;case 9:if(l>-1)r={t:"s",v:i[l]};else if(h>-1)r={t:"s",v:e[h]};else{if(isNaN(c))throw new Error("Unsupported cell type ".concat(t.slice(0,4)));r={t:"n",v:c}}break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return r}(t,e,i,t[0]);case 5:return $c(t,e,i);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function iu(t){return Wc(Hc(t)[1][0].data)}function nu(t,e){var i=Hc(e.data),n=Uc(i[1][0].data),r=i[3],s=[];return(r||[]).forEach((function(e){var i=Hc(e.data),r=Uc(i[1][0].data)>>>0;switch(n){case 1:s[r]=Fc(i[3][0].data);break;case 8:var a=Hc(t[iu(i[9][0].data)][0].data),o=t[iu(a[1][0].data)][0],l=Uc(o.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var h=Hc(o.data);s[r]=h[3].map((function(t){return Fc(t.data)})).join("")}})),s}function ru(t,e){var i,n=Hc(e.data),r=(null==(i=null==n?void 0:n[7])?void 0:i[0])?Uc(n[7][0].data)>>>0>0?1:0:-1,s=Vc(n[5],(function(t){return function(t,e){var i,n,r,s,a,o,l,h,c,u,d,f,p,g,m,v,y=Hc(t),b=Uc(y[1][0].data)>>>0,_=Uc(y[2][0].data)>>>0,x=(null==(n=null==(i=y[8])?void 0:i[0])?void 0:n.data)&&Uc(y[8][0].data)>0||!1;if((null==(s=null==(r=y[7])?void 0:r[0])?void 0:s.data)&&0!=e)m=null==(o=null==(a=y[7])?void 0:a[0])?void 0:o.data,v=null==(h=null==(l=y[6])?void 0:l[0])?void 0:h.data;else{if(!(null==(u=null==(c=y[4])?void 0:c[0])?void 0:u.data)||1==e)throw"NUMBERS Tile missing ".concat(e," cell storage");m=null==(f=null==(d=y[4])?void 0:d[0])?void 0:f.data,v=null==(g=null==(p=y[3])?void 0:p[0])?void 0:g.data}for(var w=x?4:1,S=Nc(m),T=[],E=0;E<m.length/2;++E){var k=S.getUint16(2*E,!0);k<65535&&T.push([E,k])}if(T.length!=_)throw"Expected ".concat(_," cells, found ").concat(T.length);var C=[];for(E=0;E<T.length-1;++E)C[T[E][0]]=v.subarray(T[E][1]*w,T[E+1][1]*w);return T.length>=1&&(C[T[T.length-1][0]]=v.subarray(T[T.length-1][1]*w)),{R:b,cells:C}}(t,r)}));return{nrows:Uc(n[4][0].data)>>>0,data:s.reduce((function(t,e){return t[e.R]||(t[e.R]=[]),e.cells.forEach((function(i,n){if(t[e.R][n])throw new Error("Duplicate cell r=".concat(e.R," c=").concat(n));t[e.R][n]=i})),t}),[])}}function su(t,e){var i={"!ref":"A1"},n=t[iu(Hc(e.data)[2][0].data)],r=Uc(n[0].meta[1][0].data);if(6001!=r)throw new Error("6000 unexpected reference to ".concat(r));return function(t,e,i){var n,r=Hc(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Uc(r[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(r[6][0].data));if(s.e.c=(Uc(r[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(r[7][0].data));i["!ref"]=un(s);var a=Hc(r[4][0].data),o=nu(t,t[iu(a[4][0].data)][0]),l=(null==(n=a[17])?void 0:n[0])?nu(t,t[iu(a[17][0].data)][0]):[],h=Hc(a[3][0].data),c=0;h[1].forEach((function(e){var n=Hc(e.data),r=t[iu(n[2][0].data)][0],s=Uc(r.meta[1][0].data);if(6002!=s)throw new Error("6001 unexpected reference to ".concat(s));var a=ru(0,r);a.data.forEach((function(t,e){t.forEach((function(t,n){var r=hn({r:c+e,c:n}),s=eu(t,o,l);s&&(i[r]=s)}))})),c+=a.nrows}))}(t,n[0],i),i}function au(t,e){var i={SheetNames:[],Sheets:{}};if(Vc(Hc(e.data)[1],iu).forEach((function(e){t[e].forEach((function(e){if(2==Uc(e.meta[1][0].data)){var n=function(t,e){var i,n=Hc(e.data),r={name:(null==(i=n[1])?void 0:i[0])?Fc(n[1][0].data):"",sheets:[]};return Vc(n[2],iu).forEach((function(e){t[e].forEach((function(e){6e3==Uc(e.meta[1][0].data)&&r.sheets.push(su(t,e))}))})),r}(t,e);n.sheets.forEach((function(t,e){Fu(i,t,0==e?n.name:n.name+"_"+e,!0)}))}}))})),0==i.SheetNames.length)throw new Error("Empty NUMBERS file");return i}function ou(t){var e,i,n,r,s={},a=[];if(t.FullPaths.forEach((function(t){if(t.match(/\.iwpv2/))throw new Error("Unsupported password protection")})),t.FileIndex.forEach((function(t){if(t.name.match(/\.iwa$/)){var e,i;try{e=Zc(t.content)}catch(e){return console.log("?? "+t.content.length+" "+(e.message||e))}try{i=Yc(e)}catch(t){return console.log("## "+(t.message||t))}i.forEach((function(t){s[t.id]=t.messages,a.push(t.id)}))}})),!a.length)throw new Error("File has no messages");var o=(null==(r=null==(n=null==(i=null==(e=null==s?void 0:s[1])?void 0:e[0])?void 0:i.meta)?void 0:n[1])?void 0:r[0].data)&&1==Uc(s[1][0].meta[1][0].data)&&s[1][0];if(o||a.forEach((function(t){s[t].forEach((function(t){if(1==Uc(t.meta[1][0].data)>>>0){if(o)throw new Error("Document has multiple roots");o=t}}))})),!o)throw new Error("Cannot find Document root");return au(s,o)}function lu(t,e,i){var n,r,s,a;if(!(null==(n=t[6])?void 0:n[0])||!(null==(r=t[7])?void 0:r[0]))throw"Mutation only works on post-BNC storages!";if((null==(a=null==(s=t[8])?void 0:s[0])?void 0:a.data)&&Uc(t[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var o=0,l=Nc(t[7][0].data),h=0,c=[],u=Nc(t[4][0].data),d=0,f=[],p=0;p<e.length;++p)if(null!=e[p]){var g,m;switch(l.setUint16(2*p,h,!0),u.setUint16(2*p,d,!0),typeof e[p]){case"string":g=Qc({t:"s",v:e[p]},i),m=tu({t:"s",v:e[p]},i);break;case"number":g=Qc({t:"n",v:e[p]},i),m=tu({t:"n",v:e[p]},i);break;case"boolean":g=Qc({t:"b",v:e[p]},i),m=tu({t:"b",v:e[p]},i);break;default:throw new Error("Unsupported value "+e[p])}c.push(g),h+=g.length,f.push(m),d+=m.length,++o}else l.setUint16(2*p,65535,!0),u.setUint16(2*p,65535);for(t[2][0].data=Gc(o);p<t[7][0].data.length/2;++p)l.setUint16(2*p,65535,!0),u.setUint16(2*p,65535,!0);return t[6][0].data=Bc(c),t[3][0].data=Bc(f),o}function hu(t){return function(e){for(var i=0;i!=t.length;++i){var n=t[i];void 0===e[n[0]]&&(e[n[0]]=n[1]),"n"===n[2]&&(e[n[0]]=Number(e[n[0]]))}}}function cu(t){hu([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function uu(t){hu([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function du(t,e,i,n,r,s,a,o,l,h,c,u){try{s[n]=cr(be(t,i,!0),e);var d,f=ye(t,e);switch(o){case"sheet":d=Eh(f,e,r,l,s[n],h,c,u);break;case"chart":if(!(d=kh(f,e,r,l,s[n],h))||!d["!drawel"])break;var p=Ee(d["!drawel"].Target,e),g=hr(p),m=function(t,e){if(!t)return"??";var i=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][i].Target}(be(t,p,!0),cr(be(t,g,!0),p)),v=Ee(m,p),y=hr(v);d=lh(be(t,v,!0),0,0,cr(be(t,y,!0),v),0,d);break;case"macro":_=e,s[n],_.slice(-4),d={"!type":"macro"};break;case"dialog":d=function(t,e,i,n,r,s,a,o){return e.slice(-4),{"!type":"dialog"}}(0,e,0,0,s[n]);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=d;var b=[];s&&s[n]&&Vt(s[n]).forEach((function(i){var r="";if(s[n][i].Type==lr.CMNT){r=Ee(s[n][i].Target,e);var a=Ah(ye(t,r,!0),r,l);if(!a||!a.length)return;xo(d,a,!1)}s[n][i].Type==lr.TCMNT&&(r=Ee(s[n][i].Target,e),b=b.concat(function(t,e){var i=[],n=!1,r={},s=0;return t.replace(Ae,(function(a,o){var l=Re(a);switch(Ie(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":r={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=r.t&&i.push(r);break;case"<text>":case"<text":s=o+a.length;break;case"</text>":r.t=t.slice(s,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":n=!0;break;case"</mentions>":case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return a})),i}(ye(t,r,!0),l)))})),b&&b.length&&xo(d,b,!0,l.people||[])}catch(t){if(l.WTF)throw t}var _}function fu(t){return"/"==t.charAt(0)?t.slice(1):t}function pu(t,e){if(jt(),cu(e=e||{}),me(t,"META-INF/manifest.xml"))return Pc(t,e);if(me(t,"objectdata.xml"))return Pc(t,e);if(me(t,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(void 0!==ou){if(t.FileIndex)return ou(t);var i=Gt.utils.cfb_new();return xe(t).forEach((function(e){we(i,e,_e(t,e))})),ou(i)}throw new Error("Unsupported NUMBERS file")}if(!me(t,"[Content_Types].xml")){if(me(t,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(me(t,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var n,r,s=xe(t),a=function(t){var e={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!t||!t.match)return e;var i={};if((t.match(Ae)||[]).forEach((function(t){var n=Re(t);switch(n[0].replace(Oe,"<")){case"<?xml":break;case"<Types":e.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":i[n.Extension]=n.ContentType;break;case"<Override":void 0!==e[sr[n.ContentType]]&&e[sr[n.ContentType]].push(n.PartName)}})),e.xmlns!==ci.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=i,delete e.calcchains,e}(be(t,"[Content_Types].xml")),o=!1;if(0===a.workbooks.length&&ye(t,r="xl/workbook.xml",!0)&&a.workbooks.push(r),0===a.workbooks.length){if(!ye(t,r="xl/workbook.bin",!0))throw new Error("Could not find workbook");a.workbooks.push(r),o=!0}"bin"==a.workbooks[0].slice(-3)&&(o=!0);var l={},h={};if(!e.bookSheets&&!e.bookProps){if(_l=[],a.sst)try{_l=Mh(ye(t,fu(a.sst)),a.sst,e)}catch(t){if(e.WTF)throw t}e.cellStyles&&a.themes.length&&(l=function(t,e,i){return fo(t,i)}(be(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(h=Ch(ye(t,fu(a.style)),a.style,l,e))}a.links.map((function(i){try{cr(be(t,hr(fu(i))),i);return Ph(ye(t,fu(i)),0,i,e)}catch(t){}}));var c=Th(ye(t,fu(a.workbooks[0])),a.workbooks[0],e),u={},d="";a.coreprops.length&&((d=ye(t,fu(a.coreprops[0]),!0))&&(u=yr(d)),0!==a.extprops.length&&(d=ye(t,fu(a.extprops[0]),!0))&&function(t,e,i){var n={};e||(e={}),t=qe(t),xr.forEach((function(i){var r=(t.match(Je(i[0]))||[])[1];switch(i[2]){case"string":r&&(e[i[1]]=Ne(r));break;case"bool":e[i[1]]="true"===r;break;case"raw":var s=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));s&&s.length>0&&(n[i[1]]=s[1])}})),n.HeadingPairs&&n.TitlesOfParts&&Sr(n.HeadingPairs,n.TitlesOfParts,e,i)}(d,u,e));var f={};e.bookSheets&&!e.bookProps||0!==a.custprops.length&&(d=be(t,fu(a.custprops[0]),!0))&&(f=function(t,e){var i={},n="",r=t.match(Er);if(r)for(var s=0;s!=r.length;++s){var a=r[s],o=Re(a);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":n=Ne(o.name);break;case"</property>":n=null;break;default:if(0===a.indexOf("<vt:")){var l=a.split(">"),h=l[0].slice(4),c=l[1];switch(h){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":i[n]=Ne(c);break;case"bool":i[n]=He(c);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":i[n]=parseInt(c,10);break;case"r4":case"r8":case"decimal":i[n]=parseFloat(c);break;case"filetime":case"date":i[n]=ae(c);break;default:if("/"==h.slice(-1))break;e.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",a,h,l)}}else if("</"===a.slice(0,2));else if(e.WTF)throw new Error(a)}}return i}(d,e));var p={};if((e.bookSheets||e.bookProps)&&(c.Sheets?n=c.Sheets.map((function(t){return t.name})):u.Worksheets&&u.SheetNames.length>0&&(n=u.SheetNames),e.bookProps&&(p.Props=u,p.Custprops=f),e.bookSheets&&void 0!==n&&(p.SheetNames=n),e.bookSheets?p.SheetNames:e.bookProps))return p;n={};var g={};e.bookDeps&&a.calcchain&&(g=Oh(ye(t,fu(a.calcchain)),a.calcchain));var m,v,y=0,b={},_=c.Sheets;u.Worksheets=_.length,u.SheetNames=[];for(var x=0;x!=_.length;++x)u.SheetNames[x]=_[x].name;var w=o?"bin":"xml",S=a.workbooks[0].lastIndexOf("/"),T=(a.workbooks[0].slice(0,S+1)+"_rels/"+a.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");me(t,T)||(T="xl/_rels/workbook."+w+".rels");var E=cr(be(t,T,!0),T.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=Rh(ye(t,fu(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=function(t,e){var i=[],n=!1;return t.replace(Ae,(function(t){var r=Re(t);switch(Ie(r[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":i.push({name:r.displayname,id:r.id});break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+r[0]+" in threaded comments")}return t})),i}(ye(t,fu(a.people[0])),e)),E&&(E=function(t,e){if(!t)return 0;try{t=e.map((function(e){return e.id||(e.id=e.strRelID),[e.name,t["!id"][e.id].Target,(i=t["!id"][e.id].Type,lr.WS.indexOf(i)>-1?"sheet":lr.CS&&i==lr.CS?"chart":lr.DS&&i==lr.DS?"dialog":lr.MS&&i==lr.MS?"macro":i&&i.length?i:"sheet")];var i}))}catch(t){return null}return t&&0!==t.length?t:null}(E,c.Sheets));var k=ye(t,"xl/worksheets/sheet.xml",!0)?1:0;t:for(y=0;y!=u.Worksheets;++y){var C="sheet";if(E&&E[y]?(m="xl/"+E[y][1].replace(/[\/]?xl\//,""),me(t,m)||(m=E[y][1]),me(t,m)||(m=T.replace(/_rels\/.*$/,"")+E[y][1]),C=E[y][2]):m=(m="xl/worksheets/sheet"+(y+1-k)+"."+w).replace(/sheet0\./,"sheet."),v=m.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&null!=e.sheets)switch(typeof e.sheets){case"number":if(y!=e.sheets)continue t;break;case"string":if(u.SheetNames[y].toLowerCase()!=e.sheets.toLowerCase())continue t;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var M=!1,A=0;A!=e.sheets.length;++A)"number"==typeof e.sheets[A]&&e.sheets[A]==y&&(M=1),"string"==typeof e.sheets[A]&&e.sheets[A].toLowerCase()==u.SheetNames[y].toLowerCase()&&(M=1);if(!M)continue t}}du(t,m,v,u.SheetNames[y],y,b,n,C,e,c,l,h)}return p={Directory:a,Workbook:c,Props:u,Custprops:f,Deps:g,Sheets:n,SheetNames:u.SheetNames,Strings:_l,Styles:h,Themes:l,SSF:le(nt)},e&&e.bookFiles&&(t.files?(p.keys=s,p.files=t.files):(p.keys=[],p.files={},t.FullPaths.forEach((function(e,i){e=e.replace(/^Root Entry[\/]/,""),p.keys.push(e),p.files[e]=t.FileIndex[i]})))),e&&e.bookVBA&&(a.vba.length>0?p.vbaraw=ye(t,fu(a.vba[0]),!0):a.defaults&&a.defaults.bin===ko&&(p.vbaraw=ye(t,"xl/vbaProject.bin",!0))),p}function gu(t,e){var i,n,r=e||{},s="Workbook",a=Gt.find(t,s);try{if(s="/!DataSpaces/Version",!(a=Gt.find(t,s))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(i=a.content,(n={}).id=i.read_shift(0,"lpp4"),n.R=da(i,4),n.U=da(i,4),n.W=da(i,4),s="/!DataSpaces/DataSpaceMap",!(a=Gt.find(t,s))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=function(t){var e=[];t.l+=4;for(var i=t.read_shift(4);i-- >0;)e.push(fa(t));return e}(a.content);if(1!==o.length||1!==o[0].comps.length||0!==o[0].comps[0].t||"StrongEncryptionDataSpace"!==o[0].name||"EncryptedPackage"!==o[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(a=Gt.find(t,s))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);var l=function(t){var e=[];t.l+=4;for(var i=t.read_shift(4);i-- >0;)e.push(t.read_shift(0,"lpp4"));return e}(a.content);if(1!=l.length||"StrongEncryptionTransform"!=l[0])throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(a=Gt.find(t,s))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);pa(a.content)}catch(t){}if(s="/EncryptionInfo",!(a=Gt.find(t,s))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);var h=function(t){var e=da(t);switch(e.Minor){case 2:return[e.Minor,va(t)];case 3:return[e.Minor,ya()];case 4:return[e.Minor,ba(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}(a.content);if(s="/EncryptedPackage",!(a=Gt.find(t,s))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(4==h[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(h[1],a.content,r.password||"",r);if(2==h[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(h[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function mu(t,e){return"ods"==e.bookType?Dc(t,e):"numbers"==e.bookType?function(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var i=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=cn(i["!ref"]);n.s.r=n.s.c=0;var r=!1;n.e.c>9&&(r=!0,n.e.c=9),n.e.r>49&&(r=!0,n.e.r=49),r&&console.error("The Numbers writer is currently limited to ".concat(un(n)));var s=Au(i,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach((function(t){return t.forEach((function(t){"string"==typeof t&&a.push(t)}))}));var o={},l=[],h=Gt.read(e.numbers,{type:"base64"});h.FileIndex.map((function(t,e){return[t,h.FullPaths[e]]})).forEach((function(t){var e=t[0],i=t[1];2==e.type&&e.name.match(/\.iwa/)&&Yc(Zc(e.content)).forEach((function(t){l.push(t.id),o[t.id]={deps:[],location:i,type:Uc(t.messages[0].meta[1][0].data)}}))})),l.sort((function(t,e){return t-e}));var c=l.filter((function(t){return t>1})).map((function(t){return[t,Gc(t)]}));h.FileIndex.map((function(t,e){return[t,h.FullPaths[e]]})).forEach((function(t){var e=t[0];t[1],e.name.match(/\.iwa/)&&Yc(Zc(e.content)).forEach((function(t){t.messages.forEach((function(e){c.forEach((function(e){t.messages.some((function(t){return 11006!=Uc(t.meta[1][0].data)&&function(t,e){t:for(var i=0;i<=t.length-e.length;++i){for(var n=0;n<e.length;++n)if(t[i+n]!=e[n])continue t;return!0}return!1}(t.data,e[1])}))&&o[e[0]].deps.push(t.id)}))}))}))}));for(var u,d=Gt.find(h,o[1].location),f=Yc(Zc(d.content)),p=0;p<f.length;++p){var g=f[p];1==g.id&&(u=g)}var m=iu(Hc(u.messages[0].data)[1][0].data);for(f=Yc(Zc((d=Gt.find(h,o[m].location)).content)),p=0;p<f.length;++p)(g=f[p]).id==m&&(u=g);for(m=iu(Hc(u.messages[0].data)[2][0].data),f=Yc(Zc((d=Gt.find(h,o[m].location)).content)),p=0;p<f.length;++p)(g=f[p]).id==m&&(u=g);for(m=iu(Hc(u.messages[0].data)[2][0].data),f=Yc(Zc((d=Gt.find(h,o[m].location)).content)),p=0;p<f.length;++p)(g=f[p]).id==m&&(u=g);var v=Hc(u.messages[0].data);v[6][0].data=Gc(n.e.r+1),v[7][0].data=Gc(n.e.c+1);for(var y=iu(v[46][0].data),b=Gt.find(h,o[y].location),_=Yc(Zc(b.content)),x=0;x<_.length&&_[x].id!=y;++x);if(_[x].id!=y)throw"Bad ColumnRowUIDMapArchive";var w=Hc(_[x].messages[0].data);w[1]=[],w[2]=[],w[3]=[];for(var S=0;S<=n.e.c;++S){var T=[];T[1]=T[2]=[{type:0,data:Gc(S+420690)}],w[1].push({type:2,data:Xc(T)}),w[2].push({type:0,data:Gc(S)}),w[3].push({type:0,data:Gc(S)})}w[4]=[],w[5]=[],w[6]=[];for(var E=0;E<=n.e.r;++E)(T=[])[1]=T[2]=[{type:0,data:Gc(E+726270)}],w[4].push({type:2,data:Xc(T)}),w[5].push({type:0,data:Gc(E)}),w[6].push({type:0,data:Gc(E)});_[x].messages[0].data=Xc(w),b.content=Jc(Kc(_)),b.size=b.content.length,delete v[46];var k=Hc(v[4][0].data);k[7][0].data=Gc(n.e.r+1);var C=iu(Hc(k[1][0].data)[2][0].data);if((_=Yc(Zc((b=Gt.find(h,o[C].location)).content)))[0].id!=C)throw"Bad HeaderStorageBucket";var M=Hc(_[0].messages[0].data);for(E=0;E<s.length;++E){var A=Hc(M[2][0].data);A[1][0].data=Gc(E),A[4][0].data=Gc(s[E].length),M[2][E]={type:M[2][0].type,data:Xc(A)}}_[0].messages[0].data=Xc(M),b.content=Jc(Kc(_)),b.size=b.content.length;var O=iu(k[2][0].data);if((_=Yc(Zc((b=Gt.find(h,o[O].location)).content)))[0].id!=O)throw"Bad HeaderStorageBucket";for(M=Hc(_[0].messages[0].data),S=0;S<=n.e.c;++S)(A=Hc(M[2][0].data))[1][0].data=Gc(S),A[4][0].data=Gc(n.e.r+1),M[2][S]={type:M[2][0].type,data:Xc(A)};_[0].messages[0].data=Xc(M),b.content=Jc(Kc(_)),b.size=b.content.length;var P=iu(k[4][0].data);!function(){for(var t,e=Gt.find(h,o[P].location),i=Yc(Zc(e.content)),n=0;n<i.length;++n){var r=i[n];r.id==P&&(t=r)}var s=Hc(t.messages[0].data);s[3]=[];var l=[];a.forEach((function(t,e){l[1]=[{type:0,data:Gc(e)}],l[2]=[{type:0,data:Gc(1)}],l[3]=[{type:2,data:jc(t)}],s[3].push({type:2,data:Xc(l)})})),t.messages[0].data=Xc(s);var c=Jc(Kc(i));e.content=c,e.size=e.content.length}();var R=Hc(k[3][0].data),I=R[1][0];delete R[2];var L=Hc(I.data),D=iu(L[2][0].data);!function(){for(var t,e=Gt.find(h,o[D].location),i=Yc(Zc(e.content)),r=0;r<i.length;++r){var l=i[r];l.id==D&&(t=l)}var c=Hc(t.messages[0].data);delete c[6],delete R[7];var u=new Uint8Array(c[5][0].data);c[5]=[];for(var d=0,f=0;f<=n.e.r;++f){var p=Hc(u);d+=lu(p,s[f],a),p[1][0].data=Gc(f),c[5].push({data:Xc(p),type:2})}c[1]=[{type:0,data:Gc(n.e.c+1)}],c[2]=[{type:0,data:Gc(n.e.r+1)}],c[3]=[{type:0,data:Gc(d)}],c[4]=[{type:0,data:Gc(n.e.r+1)}],t.messages[0].data=Xc(c);var g=Jc(Kc(i));e.content=g,e.size=e.content.length}(),I.data=Xc(L),k[3][0].data=Xc(R),v[4][0].data=Xc(k),u.messages[0].data=Xc(v);var N=Jc(Kc(f));return d.content=N,d.size=d.content.length,h}(t,e):"xlsb"==e.bookType?function(t,e){bo=1024,t&&!t.SSF&&(t.SSF=le(nt));t&&t.SSF&&(jt(),Ft(t.SSF),e.revssf=qt(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF);e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,wl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var i="xlsb"==e.bookType?"bin":"xml",n=Co.indexOf(e.bookType)>-1,r={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};uu(e=e||{});var s=Se(),a="",o=0;e.cellXfs=[],kl(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});if(we(s,a="docProps/core.xml",_r(t.Props,e)),r.coreprops.push(a),dr(e.rels,2,a,lr.CORE_PROPS),a="docProps/app.xml",t.Props&&t.Props.SheetNames);else if(t.Workbook&&t.Workbook.Sheets){for(var l=[],h=0;h<t.SheetNames.length;++h)2!=(t.Workbook.Sheets[h]||{}).Hidden&&l.push(t.SheetNames[h]);t.Props.SheetNames=l}else t.Props.SheetNames=t.SheetNames;t.Props.Worksheets=t.Props.SheetNames.length,we(s,a,Tr(t.Props)),r.extprops.push(a),dr(e.rels,3,a,lr.EXT_PROPS),t.Custprops!==t.Props&&Vt(t.Custprops||{}).length>0&&(we(s,a="docProps/custom.xml",kr(t.Custprops)),r.custprops.push(a),dr(e.rels,4,a,lr.CUST_PROPS));for(o=1;o<=t.SheetNames.length;++o){var c={"!id":{}},u=t.Sheets[t.SheetNames[o-1]];(u||{})["!type"];if(we(s,a="xl/worksheets/sheet"+o+"."+i,Ih(o-1,a,e,t,c)),r.sheets.push(a),dr(e.wbrels,-1,"worksheets/sheet"+o+"."+i,lr.WS[0]),u){var d=u["!comments"],f=!1,p="";d&&d.length>0&&(we(s,p="xl/comments"+o+"."+i,Lh(d,p,e)),r.comments.push(p),dr(c,-1,"../comments"+o+"."+i,lr.CMNT),f=!0),u["!legacy"]&&f&&we(s,"xl/drawings/vmlDrawing"+o+".vml",_o(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}c["!id"].rId1&&we(s,hr(a),ur(c))}null!=e.Strings&&e.Strings.length>0&&(we(s,a="xl/sharedStrings."+i,function(t,e,i){return(".bin"===e.slice(-4)?ca:la)(t,i)}(e.Strings,a,e)),r.strs.push(a),dr(e.wbrels,-1,"sharedStrings."+i,lr.SST));we(s,a="xl/workbook."+i,function(t,e,i){return(".bin"===e.slice(-4)?Sh:_h)(t,i)}(t,a,e)),r.workbooks.push(a),dr(e.rels,1,a,lr.WB),we(s,a="xl/theme/theme1.xml",po(t.Themes,e)),r.themes.push(a),dr(e.wbrels,-1,"theme/theme1.xml",lr.THEME),we(s,a="xl/styles."+i,function(t,e,i){return(".bin"===e.slice(-4)?no:Ha)(t,i)}(t,a,e)),r.styles.push(a),dr(e.wbrels,-1,"styles."+i,lr.STY),t.vbaraw&&n&&(we(s,a="xl/vbaProject.bin",t.vbaraw),r.vba.push(a),dr(e.wbrels,-1,"vbaProject.bin",lr.VBA));return we(s,a="xl/metadata."+i,function(t){return(".bin"===t.slice(-4)?vo:yo)()}(a)),r.metadata.push(a),dr(e.wbrels,-1,"metadata."+i,lr.XLMETA),we(s,"[Content_Types].xml",or(r,e)),we(s,"_rels/.rels",ur(e.rels)),we(s,"xl/_rels/workbook."+i+".rels",ur(e.wbrels)),delete e.revssf,delete e.ssf,s}(t,e):vu(t,e)}function vu(t,e){bo=1024,t&&!t.SSF&&(t.SSF=le(nt)),t&&t.SSF&&(jt(),Ft(t.SSF),e.revssf=qt(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,wl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var i="xml",n=Co.indexOf(e.bookType)>-1,r={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};uu(e=e||{});var s=Se(),a="",o=0;if(e.cellXfs=[],kl(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),we(s,a="docProps/core.xml",_r(t.Props,e)),r.coreprops.push(a),dr(e.rels,2,a,lr.CORE_PROPS),a="docProps/app.xml",t.Props&&t.Props.SheetNames);else if(t.Workbook&&t.Workbook.Sheets){for(var l=[],h=0;h<t.SheetNames.length;++h)2!=(t.Workbook.Sheets[h]||{}).Hidden&&l.push(t.SheetNames[h]);t.Props.SheetNames=l}else t.Props.SheetNames=t.SheetNames;t.Props.Worksheets=t.Props.SheetNames.length,we(s,a,Tr(t.Props)),r.extprops.push(a),dr(e.rels,3,a,lr.EXT_PROPS),t.Custprops!==t.Props&&Vt(t.Custprops||{}).length>0&&(we(s,a="docProps/custom.xml",kr(t.Custprops)),r.custprops.push(a),dr(e.rels,4,a,lr.CUST_PROPS));var c=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var u={"!id":{}},d=t.Sheets[t.SheetNames[o-1]];(d||{})["!type"];if(we(s,a="xl/worksheets/sheet"+o+"."+i,Vl(o-1,e,t,u)),r.sheets.push(a),dr(e.wbrels,-1,"worksheets/sheet"+o+"."+i,lr.WS[0]),d){var f=d["!comments"],p=!1,g="";if(f&&f.length>0){var m=!1;f.forEach((function(t){t[1].forEach((function(t){1==t.T&&(m=!0)}))})),m&&(we(s,g="xl/threadedComments/threadedComment"+o+"."+i,So(f,c,e)),r.threadedcomments.push(g),dr(u,-1,"../threadedComments/threadedComment"+o+"."+i,lr.TCMNT)),we(s,g="xl/comments"+o+"."+i,wo(f)),r.comments.push(g),dr(u,-1,"../comments"+o+"."+i,lr.CMNT),p=!0}d["!legacy"]&&p&&we(s,"xl/drawings/vmlDrawing"+o+".vml",_o(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&we(s,hr(a),ur(u))}return null!=e.Strings&&e.Strings.length>0&&(we(s,a="xl/sharedStrings."+i,la(e.Strings,e)),r.strs.push(a),dr(e.wbrels,-1,"sharedStrings."+i,lr.SST)),we(s,a="xl/workbook."+i,_h(t)),r.workbooks.push(a),dr(e.rels,1,a,lr.WB),we(s,a="xl/theme/theme1.xml",po(t.Themes,e)),r.themes.push(a),dr(e.wbrels,-1,"theme/theme1.xml",lr.THEME),we(s,a="xl/styles."+i,Ha(t,e)),r.styles.push(a),dr(e.wbrels,-1,"styles."+i,lr.STY),t.vbaraw&&n&&(we(s,a="xl/vbaProject.bin",t.vbaraw),r.vba.push(a),dr(e.wbrels,-1,"vbaProject.bin",lr.VBA)),we(s,a="xl/metadata."+i,yo()),r.metadata.push(a),dr(e.wbrels,-1,"metadata."+i,lr.XLMETA),c.length>1&&(we(s,a="xl/persons/person.xml",function(t){var e=[ke,ai("personList",null,{xmlns:ci.TCMNT,"xmlns:x":ui[0]}).replace(/[\/]>/,">")];return t.forEach((function(t,i){e.push(ai("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:t,providerId:"None"}))})),e.push("</personList>"),e.join("")}(c)),r.people.push(a),dr(e.wbrels,-1,"persons/person.xml",lr.PEOPLE)),we(s,"[Content_Types].xml",or(r,e)),we(s,"_rels/.rels",ur(e.rels)),we(s,"xl/_rels/workbook.xml.rels",ur(e.wbrels)),delete e.revssf,delete e.ssf,s}function yu(t,e){var i="";switch((e||{}).type||"base64"){case"buffer":case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":i=D(t.slice(0,12));break;case"binary":i=t;break;default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[i.charCodeAt(0),i.charCodeAt(1),i.charCodeAt(2),i.charCodeAt(3),i.charCodeAt(4),i.charCodeAt(5),i.charCodeAt(6),i.charCodeAt(7)]}function bu(t,e){var i=0;t:for(;i<t.length;)switch(t.charCodeAt(i)){case 10:case 13:case 32:++i;break;case 60:return Vh(t.slice(i),e);default:break t}return Zs.to_workbook(t,e)}function _u(t,e,i,n){return n?(i.type="string",Zs.to_workbook(t,i)):Zs.to_workbook(e,i)}function xu(t,e){E();var i=e||{};if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer)return xu(new Uint8Array(t),((i=le(i)).type="array",i));"undefined"!=typeof Uint8Array&&t instanceof Uint8Array&&!i.type&&(i.type="undefined"!=typeof Deno?"buffer":"array");var n,r=t,s=!1;if(i.cellStyles&&(i.cellNF=!0,i.sheetStubs=!0),xl={},i.dateNF&&(xl.dateNF=i.dateNF),i.type||(i.type=N&&Buffer.isBuffer(t)?"buffer":"base64"),"file"==i.type&&(i.type=N?"buffer":"binary",r=function(t){if(void 0!==Ut)return Ut.readFileSync(t);if("undefined"!=typeof Deno)return Deno.readFileSync(t);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var e=File(t);e.open("r"),e.encoding="binary";var i=e.read();return e.close(),i}catch(t){if(!t.message||!t.message.match(/onstruct/))throw t}throw new Error("Cannot access file "+t)}(t),"undefined"==typeof Uint8Array||N||(i.type="array")),"string"==i.type&&(s=!0,i.type="binary",i.codepage=65001,r=function(t){return t.match(/[^\x00-\x7F]/)?Ze(t):t}(t)),"array"==i.type&&"undefined"!=typeof Uint8Array&&t instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return(i=le(i)).type="array",xu(U(r),i)}switch((n=yu(r,i))[0]){case 208:if(207===n[1]&&17===n[2]&&224===n[3]&&161===n[4]&&177===n[5]&&26===n[6]&&225===n[7])return function(t,e){return Gt.find(t,"EncryptedPackage")?gu(t,e):ac(t,e)}(Gt.read(r,i),i);break;case 9:if(n[1]<=8)return ac(r,i);break;case 60:return Vh(r,i);case 73:if(73===n[1]&&42===n[2]&&0===n[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===n[1])return function(t,e){var i=e||{},n=!!i.WTF;i.WTF=!0;try{var r=Ys.to_workbook(t,i);return i.WTF=n,r}catch(r){if(i.WTF=n,!r.message.match(/SYLK bad record ID/)&&n)throw r;return Zs.to_workbook(t,e)}}(r,i);break;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return Ks.to_workbook(r,i);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?function(t,e){var i=t,n=e||{};return n.type||(n.type=N&&Buffer.isBuffer(t)?"buffer":"base64"),pu(Te(i,n),n)}(r,i):_u(t,r,i,s);case 239:return 60===n[3]?Vh(r,i):_u(t,r,i,s);case 255:if(254===n[1])return function(t,e){var i=t;return"base64"==e.type&&(i=D(i)),i=M.utils.decode(1200,i.slice(2),"str"),e.type="binary",bu(i,e)}(r,i);if(0===n[1]&&2===n[2]&&0===n[3])return Js.to_workbook(r,i);break;case 0:if(0===n[1]){if(n[2]>=2&&0===n[3])return Js.to_workbook(r,i);if(0===n[2]&&(8===n[3]||9===n[3]))return Js.to_workbook(r,i)}break;case 3:case 131:case 139:case 140:return Vs.to_workbook(r,i);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return Ta.to_workbook(r,i);break;case 10:case 13:case 32:return function(t,e){var i="",n=yu(t,e);switch(e.type){case"base64":i=D(t);break;case"binary":i=t;break;case"buffer":i=t.toString("binary");break;case"array":i=oe(t);break;default:throw new Error("Unrecognized type "+e.type)}return 239==n[0]&&187==n[1]&&191==n[2]&&(i=qe(i)),e.type="binary",bu(i,e)}(r,i);case 137:if(80===n[1]&&78===n[2]&&71===n[3])throw new Error("PNG Image File is not a spreadsheet")}return Xs.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Vs.to_workbook(r,i):_u(t,r,i,s)}function wu(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Xt(e.file,Gt.write(t,{type:N?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Gt.write(t,e)}function Su(t,e){var i={},n=N?"nodebuffer":"undefined"!=typeof Uint8Array?"array":"string";if(e.compression&&(i.compression="DEFLATE"),e.password)i.type=n;else switch(e.type){case"base64":i.type="base64";break;case"binary":i.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":i.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var r=t.FullPaths?Gt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[i.type]||i.type,compression:!!e.compression}):t.generate(i);if("undefined"!=typeof Deno&&"string"==typeof r){if("binary"==e.type||"base64"==e.type)return r;r=new Uint8Array(W(r))}return e.password&&"undefined"!=typeof encrypt_agile?wu(encrypt_agile(r,e.password),e):"file"===e.type?Xt(e.file,r):"string"==e.type?qe(r):r}function Tu(t,e,i){i||(i="");var n=i+t;switch(e.type){case"base64":return L(Ze(n));case"binary":return Ze(n);case"string":return t;case"file":return Xt(e.file,n,"utf8");case"buffer":return N?F(n,"utf8"):"undefined"!=typeof TextEncoder?(new TextEncoder).encode(n):Tu(n,{type:"binary"}).split("").map((function(t){return t.charCodeAt(0)}))}throw new Error("Unrecognized type "+e.type)}function Eu(t,e){switch(e.type){case"string":case"base64":case"binary":for(var i="",n=0;n<t.length;++n)i+=String.fromCharCode(t[n]);return"base64"==e.type?L(i):"string"==e.type?qe(i):i;case"file":return Xt(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function ku(t,e){E(),yh(t);var i=le(e||{});if(i.cellStyles&&(i.cellNF=!0,i.sheetStubs=!0),"array"==i.type){i.type="binary";var n=ku(t,i);return i.type="array",W(n)}var r=0;if(i.sheet&&(r="number"==typeof i.sheet?i.sheet:t.SheetNames.indexOf(i.sheet),!t.SheetNames[r]))throw new Error("Sheet not found: "+i.sheet+" : "+typeof i.sheet);switch(i.bookType||"xlsb"){case"xml":case"xlml":return Tu($h(t,i),i);case"slk":case"sylk":return Tu(Ys.from_sheet(t.Sheets[t.SheetNames[r]],i),i);case"htm":case"html":return Tu(Ec(t.Sheets[t.SheetNames[r]],i),i);case"txt":return function(t,e){switch(e.type){case"base64":return L(t);case"binary":case"string":return t;case"file":return Xt(e.file,t,"binary");case"buffer":return N?F(t,"binary"):t.split("").map((function(t){return t.charCodeAt(0)}))}throw new Error("Unrecognized type "+e.type)}(Iu(t.Sheets[t.SheetNames[r]],i),i);case"csv":return Tu(Ru(t.Sheets[t.SheetNames[r]],i),i,"\ufeff");case"dif":return Tu(Ks.from_sheet(t.Sheets[t.SheetNames[r]],i),i);case"dbf":return Eu(Vs.from_sheet(t.Sheets[t.SheetNames[r]],i),i);case"prn":return Tu(Zs.from_sheet(t.Sheets[t.SheetNames[r]],i),i);case"rtf":return Tu(Ta.from_sheet(t.Sheets[t.SheetNames[r]],i),i);case"eth":return Tu(qs.from_sheet(t.Sheets[t.SheetNames[r]],i),i);case"fods":return Tu(Dc(t,i),i);case"wk1":return Eu(Js.sheet_to_wk1(t.Sheets[t.SheetNames[r]],i),i);case"wk3":return Eu(Js.book_to_wk3(t,i),i);case"biff2":i.biff||(i.biff=2);case"biff3":i.biff||(i.biff=3);case"biff4":return i.biff||(i.biff=4),Eu(bc(t,i),i);case"biff5":i.biff||(i.biff=5);case"biff8":case"xla":case"xls":return i.biff||(i.biff=8),function(t,e){var i=e||{};return wu(oc(t,i),i)}(t,i);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(t,e){var i=le(e||{});return Su(mu(t,i),i)}(t,i);default:throw new Error("Unrecognized bookType |"+i.bookType+"|")}}function Cu(t){if(!t.bookType){var e=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(t.bookType=e.slice(1)),t.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[t.bookType]||t.bookType}}function Mu(t,e,i,n,r,s,a,o){var l=sn(i),h=o.defval,c=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,d=1===r?[]:{};if(1!==r)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:i,enumerable:!1})}catch(t){d.__rowNum__=i}else d.__rowNum__=i;if(!a||t[i])for(var f=e.s.c;f<=e.e.c;++f){var p=a?t[i][f]:t[n[f]+l];if(void 0!==p&&void 0!==p.t){var g=p.v;switch(p.t){case"z":if(null==g)break;continue;case"e":g=0==g?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=s[f]){if(null==g)if("e"==p.t&&null===g)d[s[f]]=null;else if(void 0!==h)d[s[f]]=h;else{if(!c||null!==g)continue;d[s[f]]=null}else d[s[f]]=c&&("n"!==p.t||"n"===p.t&&!1!==o.rawNumbers)?g:pn(p,g,o);null!=g&&(u=!1)}}else{if(void 0===h)continue;null!=s[f]&&(d[s[f]]=h)}}return{row:d,isempty:u}}function Au(t,e){if(null==t||null==t["!ref"])return[];var i={t:"n",v:0},n=0,r=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},c=null!=h.range?h.range:t["!ref"];switch(1===h.header?n=1:"A"===h.header?n=2:Array.isArray(h.header)?n=3:null==h.header&&(n=0),typeof c){case"string":l=dn(c);break;case"number":(l=dn(t["!ref"])).s.r=c;break;default:l=c}n>0&&(r=0);var u=sn(l.s.r),d=[],f=[],p=0,g=0,m=Array.isArray(t),v=l.s.r,y=0,b={};m&&!t[v]&&(t[v]=[]);var _=h.skipHidden&&t["!cols"]||[],x=h.skipHidden&&t["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(_[y]||{}).hidden)switch(d[y]=on(y),i=m?t[v][y]:t[d[y]+u],n){case 1:s[y]=y-l.s.c;break;case 2:s[y]=d[y];break;case 3:s[y]=h.header[y-l.s.c];break;default:if(null==i&&(i={w:"__EMPTY",t:"s"}),o=a=pn(i,null,h),g=b[a]||0){do{o=a+"_"+g++}while(b[o]);b[a]=g,b[o]=1}else b[a]=1;s[y]=o}for(v=l.s.r+r;v<=l.e.r;++v)if(!(x[v]||{}).hidden){var w=Mu(t,l,v,d,n,s,m,h);(!1===w.isempty||(1===n?!1!==h.blankrows:h.blankrows))&&(f[p++]=w.row)}return f.length=p,f}var Ou=/"/g;function Pu(t,e,i,n,r,s,a,o){for(var l=!0,h=[],c="",u=sn(i),d=e.s.c;d<=e.e.c;++d)if(n[d]){var f=o.dense?(t[i]||[])[d]:t[n[d]+u];if(null==f)c="";else if(null!=f.v){l=!1,c=""+(o.rawNumbers&&"n"==f.t?f.v:pn(f,null,o));for(var p=0,g=0;p!==c.length;++p)if((g=c.charCodeAt(p))===r||g===s||34===g||o.forceQuotes){c='"'+c.replace(Ou,'""')+'"';break}"ID"==c&&(c='"ID"')}else null==f.f||f.F?c="":(l=!1,(c="="+f.f).indexOf(",")>=0&&(c='"'+c.replace(Ou,'""')+'"'));h.push(c)}return!1===o.blankrows&&l?null:h.join(a)}function Ru(t,e){var i=[],n=null==e?{}:e;if(null==t||null==t["!ref"])return"";var r=dn(t["!ref"]),s=void 0!==n.FS?n.FS:",",a=s.charCodeAt(0),o=void 0!==n.RS?n.RS:"\n",l=o.charCodeAt(0),h=new RegExp(("|"==s?"\\|":s)+"+$"),c="",u=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],f=n.skipHidden&&t["!rows"]||[],p=r.s.c;p<=r.e.c;++p)(d[p]||{}).hidden||(u[p]=on(p));for(var g=0,m=r.s.r;m<=r.e.r;++m)(f[m]||{}).hidden||null!=(c=Pu(t,r,m,u,a,l,s,n))&&(n.strip&&(c=c.replace(h,"")),(c||!1!==n.blankrows)&&i.push((g++?o:"")+c));return delete n.dense,i.join("")}function Iu(t,e){e||(e={}),e.FS="\t",e.RS="\n";var i=Ru(t,e);if(void 0===M||"string"==e.type)return i;var n=M.utils.encode(1200,i,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function Lu(t,e,i){var n,r=i||{},s=+!r.skipHeader,a=t||{},o=0,l=0;if(a&&null!=r.origin)if("number"==typeof r.origin)o=r.origin;else{var h="string"==typeof r.origin?ln(r.origin):r.origin;o=h.r,l=h.c}var c={s:{c:0,r:0},e:{c:l,r:o+e.length-1+s}};if(a["!ref"]){var u=dn(a["!ref"]);c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==o&&(o=u.e.r+1,c.e.r=o+e.length-1+s)}else-1==o&&(o=0,c.e.r=e.length-1+s);var d=r.header||[],f=0;e.forEach((function(t,e){Vt(t).forEach((function(i){-1==(f=d.indexOf(i))&&(d[f=d.length]=i);var h=t[i],c="z",u="",p=hn({c:l+f,r:o+e+s});n=Du(a,p),!h||"object"!=typeof h||h instanceof Date?("number"==typeof h?c="n":"boolean"==typeof h?c="b":"string"==typeof h?c="s":h instanceof Date?(c="d",r.cellDates||(c="n",h=Jt(h)),u=r.dateNF||nt[14]):null===h&&r.nullError&&(c="e",h=0),n?(n.t=c,n.v=h,delete n.w,delete n.R,u&&(n.z=u)):a[p]=n={t:c,v:h},u&&(n.z=u)):a[p]=h}))})),c.e.c=Math.max(c.e.c,l+d.length-1);var p=sn(o);if(s)for(f=0;f<d.length;++f)a[on(f+l)+p]={t:"s",v:d[f]};return a["!ref"]=un(c),a}function Du(t,e,i){if("string"==typeof e){if(Array.isArray(t)){var n=ln(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return Du(t,hn("number"!=typeof e?e:{r:e,c:i||0}))}function Nu(){return{SheetNames:[],Sheets:{}}}function Fu(t,e,i,n){var r=1;if(!i)for(;r<=65535&&-1!=t.SheetNames.indexOf(i="Sheet"+r);++r,i=void 0);if(!i||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(i)>=0){var s=i.match(/(^.*?)(\d+)$/);r=s&&+s[2]||0;var a=s&&s[1]||i;for(++r;r<=65535&&-1!=t.SheetNames.indexOf(i=a+r);++r);}if(vh(i),t.SheetNames.indexOf(i)>=0)throw new Error("Worksheet with name |"+i+"| already exists!");return t.SheetNames.push(i),t.Sheets[i]=e,i}function ju(t,e,i){return e?(t.l={Target:e},i&&(t.l.Tooltip=i)):delete t.l,t}var Bu={encode_col:on,encode_row:sn,encode_cell:hn,encode_range:un,decode_col:an,decode_row:rn,split_cell:function(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:ln,decode_range:cn,format_cell:pn,sheet_add_aoa:mn,sheet_add_json:Lu,sheet_add_dom:kc,aoa_to_sheet:vn,json_to_sheet:function(t,e){return Lu(null,t,e)},table_to_sheet:Cc,table_to_book:function(t,e){return gn(Cc(t,e),e)},sheet_to_csv:Ru,sheet_to_txt:Iu,sheet_to_json:Au,sheet_to_html:Ec,sheet_to_formulae:function(t){var e,i="",n="";if(null==t||null==t["!ref"])return[];var r,s=dn(t["!ref"]),a="",o=[],l=[],h=Array.isArray(t);for(r=s.s.c;r<=s.e.c;++r)o[r]=on(r);for(var c=s.s.r;c<=s.e.r;++c)for(a=sn(c),r=s.s.c;r<=s.e.c;++r)if(i=o[r]+a,n="",void 0!==(e=h?(t[c]||[])[r]:t[i])){if(null!=e.F){if(i=e.F,!e.f)continue;n=e.f,-1==i.indexOf(":")&&(i=i+":"+i)}if(null!=e.f)n=e.f;else{if("z"==e.t)continue;if("n"==e.t&&null!=e.v)n=""+e.v;else if("b"==e.t)n=e.v?"TRUE":"FALSE";else if(void 0!==e.w)n="'"+e.w;else{if(void 0===e.v)continue;n="s"==e.t?"'"+e.v:""+e.v}}l[l.length]=i+"="+n}return l},sheet_to_row_object_array:Au,sheet_get_cell:Du,book_new:Nu,book_append_sheet:Fu,book_set_sheet_visibility:function(t,e,i){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=function(t,e){if("number"==typeof e){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}if("string"==typeof e){var i=t.SheetNames.indexOf(e);if(i>-1)return i;throw new Error("Cannot find sheet name |"+e+"|")}throw new Error("Cannot find sheet |"+e+"|")}(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),i){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+i)}t.Workbook.Sheets[n].Hidden=i},cell_set_number_format:function(t,e){return t.z=e,t},cell_set_hyperlink:ju,cell_set_internal_link:function(t,e,i){return ju(t,"#"+e,i)},cell_add_comment:function(t,e,i){t.c||(t.c=[]),t.c.push({t:e,a:i||"SheetJS"})},sheet_set_array_formula:function(t,e,i,n){for(var r="string"!=typeof e?e:dn(e),s="string"==typeof e?e:un(e),a=r.s.r;a<=r.e.r;++a)for(var o=r.s.c;o<=r.e.c;++o){var l=Du(t,a,o);l.t="n",l.F=s,delete l.v,a==r.s.r&&o==r.s.c&&(l.f=i,n&&(l.D=!0))}return t},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};y.version;const zu=function(t){var e=this.constructor;return this.then((function(i){return e.resolve(t()).then((function(){return i}))}),(function(i){return e.resolve(t()).then((function(){return e.reject(i)}))}))};const Wu=function(t){return new this((function(e,i){if(!t||void 0===t.length)return i(new TypeError(typeof t+" "+t+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var n=Array.prototype.slice.call(t);if(0===n.length)return e([]);var r=n.length;function s(t,i){if(i&&("object"==typeof i||"function"==typeof i)){var a=i.then;if("function"==typeof a)return void a.call(i,(function(e){s(t,e)}),(function(i){n[t]={status:"rejected",reason:i},0==--r&&e(n)}))}n[t]={status:"fulfilled",value:i},0==--r&&e(n)}for(var a=0;a<n.length;a++)s(a,n[a])}))};function Gu(t,e){this.name="AggregateError",this.errors=t,this.message=e||""}Gu.prototype=Error.prototype;const Uu=function(t){var e=this;return new e((function(i,n){if(!t||void 0===t.length)return n(new TypeError("Promise.any accepts an array"));var r=Array.prototype.slice.call(t);if(0===r.length)return n();for(var s=[],a=0;a<r.length;a++)try{e.resolve(r[a]).then(i).catch((function(t){s.push(t),s.length===r.length&&n(new Gu(s,"All promises were rejected"))}))}catch(t){n(t)}}))};var Hu=setTimeout;function Xu(t){return Boolean(t&&void 0!==t.length)}function Vu(){}function Yu(t){if(!(this instanceof Yu))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],Qu(t,this)}function Ku(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,Yu._immediateFn((function(){var i=1===t._state?e.onFulfilled:e.onRejected;if(null!==i){var n;try{n=i(t._value)}catch(t){return void Zu(e.promise,t)}qu(e.promise,n)}else(1===t._state?qu:Zu)(e.promise,t._value)}))):t._deferreds.push(e)}function qu(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var i=e.then;if(e instanceof Yu)return t._state=3,t._value=e,void Ju(t);if("function"==typeof i)return void Qu((n=i,r=e,function(){n.apply(r,arguments)}),t)}t._state=1,t._value=e,Ju(t)}catch(e){Zu(t,e)}var n,r}function Zu(t,e){t._state=2,t._value=e,Ju(t)}function Ju(t){2===t._state&&0===t._deferreds.length&&Yu._immediateFn((function(){t._handled||Yu._unhandledRejectionFn(t._value)}));for(var e=0,i=t._deferreds.length;e<i;e++)Ku(t,t._deferreds[e]);t._deferreds=null}function $u(t,e,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=i}function Qu(t,e){var i=!1;try{t((function(t){i||(i=!0,qu(e,t))}),(function(t){i||(i=!0,Zu(e,t))}))}catch(t){if(i)return;i=!0,Zu(e,t)}}Yu.prototype.catch=function(t){return this.then(null,t)},Yu.prototype.then=function(t,e){var i=new this.constructor(Vu);return Ku(this,new $u(t,e,i)),i},Yu.prototype.finally=zu,Yu.all=function(t){return new Yu((function(e,i){if(!Xu(t))return i(new TypeError("Promise.all accepts an array"));var n=Array.prototype.slice.call(t);if(0===n.length)return e([]);var r=n.length;function s(t,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var o=a.then;if("function"==typeof o)return void o.call(a,(function(e){s(t,e)}),i)}n[t]=a,0==--r&&e(n)}catch(t){i(t)}}for(var a=0;a<n.length;a++)s(a,n[a])}))},Yu.any=Uu,Yu.allSettled=Wu,Yu.resolve=function(t){return t&&"object"==typeof t&&t.constructor===Yu?t:new Yu((function(e){e(t)}))},Yu.reject=function(t){return new Yu((function(e,i){i(t)}))},Yu.race=function(t){return new Yu((function(e,i){if(!Xu(t))return i(new TypeError("Promise.race accepts an array"));for(var n=0,r=t.length;n<r;n++)Yu.resolve(t[n]).then(e,i)}))},Yu._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){Hu(t,0)},Yu._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};const td=Yu;function ed(t,e){return t>>e||1}var id=function(){function t(t){this.maxStringLength=1024,this.maxObjectLength=128,this.maxArrayLength=128,this.maxDepth=8,this.keys=[],this.keysBlocklist=[],this.seen=[];var e=t.level||0;this.keysBlocklist=t.keysBlocklist||[],this.maxStringLength=ed(this.maxStringLength,e),this.maxObjectLength=ed(this.maxObjectLength,e),this.maxArrayLength=ed(this.maxArrayLength,e),this.maxDepth=ed(this.maxDepth,e)}return t.prototype.truncate=function(t,e,i){if(void 0===e&&(e=""),void 0===i&&(i=0),null==t)return t;switch(typeof t){case"boolean":case"number":case"function":return t;case"string":return this.truncateString(t);case"object":break;default:return this.truncateString(String(t))}if(t instanceof String)return this.truncateString(t.toString());if(t instanceof Boolean||t instanceof Number||t instanceof Date||t instanceof RegExp)return t;if(t instanceof Error)return this.truncateString(t.toString());if(this.seen.indexOf(t)>=0)return"[Circular ".concat(this.getPath(t),"]");var n=function(t){var e=Object.prototype.toString.apply(t);return e.slice(8,-1)}(t);if(++i>this.maxDepth)return"[Truncated ".concat(n,"]");switch(this.keys.push(e),this.seen.push(t),n){case"Array":return this.truncateArray(t,i);case"Object":return this.truncateObject(t,i);default:var r=this.maxDepth;this.maxDepth=0;var s=this.truncateObject(t,i);return s.__type=n,this.maxDepth=r,s}},t.prototype.getPath=function(t){for(var e=this.seen.indexOf(t),i=[this.keys[e]],n=e;n>=0;n--){var r=this.seen[n];r&&rd(r,i[0])===t&&(t=r,i.unshift(this.keys[n]))}return"~"+i.join(".")},t.prototype.truncateString=function(t){return t.length>this.maxStringLength?t.slice(0,this.maxStringLength)+"...":t},t.prototype.truncateArray=function(t,e){void 0===e&&(e=0);for(var i=0,n=[],r=0;r<t.length;r++){var s=t[r];if(n.push(this.truncate(s,r.toString(),e)),++i>=this.maxArrayLength)break}return n},t.prototype.truncateObject=function(t,e){void 0===e&&(e=0);var i=0,n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r))if(sd(r,this.keysBlocklist))n[r]="[Filtered]";else{var s=rd(t,r);if(void 0!==s&&"function"!=typeof s&&(n[r]=this.truncate(s,r,e),++i>=this.maxObjectLength))break}return n},t}();function nd(t,e){return void 0===e&&(e={}),new id(e).truncate(t)}function rd(t,e){try{return t[e]}catch(t){return}}function sd(t,e){for(var i=0,n=e;i<n.length;i++){var r=n[i];if(r===t)return!0;if(r instanceof RegExp&&t.match(r))return!0}return!1}var ad=function(){function t(t,e,i){this._dur=0,this._level=0,this._metric=t,this.name=e,this.startTime=i||new Date}return t.prototype.end=function(t){this.endTime=t||new Date,this._dur+=this.endTime.getTime()-this.startTime.getTime(),this._metric._incGroup(this.name,this._dur),this._metric=null},t.prototype._pause=function(){if(!this._paused()){var t=new Date;this._dur+=t.getTime()-this.startTime.getTime(),this.startTime=null}},t.prototype._resume=function(){this._paused()&&(this.startTime=new Date)},t.prototype._paused=function(){return null==this.startTime},t}(),od=function(){function t(){this._spans={},this._groups={},this.startTime=new Date}return t.prototype.end=function(t){this.endTime||(this.endTime=t||new Date)},t.prototype.isRecording=function(){return!0},t.prototype.startSpan=function(t,e){var i=this._spans[t];i?i._level++:(i=new ad(this,t,e),this._spans[t]=i)},t.prototype.endSpan=function(t,e){var i=this._spans[t];i?i._level>0?i._level--:(i.end(e),delete this._spans[i.name]):console.error("airbrake: span=%s does not exist",t)},t.prototype._incGroup=function(t,e){this._groups[t]=(this._groups[t]||0)+e},t.prototype._duration=function(){return this.endTime||(this.endTime=new Date),this.endTime.getTime()-this.startTime.getTime()},t}(),ld=function(){function t(){}return t.prototype.isRecording=function(){return!1},t.prototype.startSpan=function(t,e){},t.prototype.endSpan=function(t,e){},t.prototype._incGroup=function(t,e){},t}(),hd=function(){return hd=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},hd.apply(this,arguments)},cd=function(){function t(){this._noopMetric=new ld,this._context={},this._historyMaxLen=20,this._history=[]}return t.prototype.clone=function(){var e=new t;return e._context=hd({},this._context),e._history=this._history.slice(),e},t.prototype.setContext=function(t){this._context=hd(hd({},this._context),t)},t.prototype.context=function(){var t=hd({},this._context);return this._history.length>0&&(t.history=this._history.slice()),t},t.prototype.pushHistory=function(t){this._isDupState(t)?this._lastRecord.num?this._lastRecord.num++:this._lastRecord.num=2:(t.date||(t.date=new Date),this._history.push(t),this._lastRecord=t,this._history.length>this._historyMaxLen&&(this._history=this._history.slice(-this._historyMaxLen)))},t.prototype._isDupState=function(t){if(!this._lastRecord)return!1;for(var e in t)if(t.hasOwnProperty(e)&&"date"!==e&&t[e]!==this._lastRecord[e])return!1;return!0},t.prototype.routeMetric=function(){return this._routeMetric||this._noopMetric},t.prototype.setRouteMetric=function(t){this._routeMetric=t},t.prototype.queueMetric=function(){return this._queueMetric||this._noopMetric},t.prototype.setQueueMetric=function(t){this._queueMetric=t},t}(),ud=i(9180),dd=i.n(ud),fd="object"==typeof console&&console.warn;function pd(t){try{return dd().parse(t)}catch(e){fd&&t.stack&&console.warn("ErrorStackParser:",e.toString(),t.stack)}return t.fileName?[t]:[]}function gd(t){var e=[];if(t.noStack)e.push({function:t.functionName||"",file:t.fileName||"",line:t.lineNumber||0,column:t.columnNumber||0});else{var i=pd(t);if(0===i.length)try{throw new Error("fake")}catch(t){(i=pd(t)).shift(),i.shift()}for(var n=0,r=i;n<r.length;n++){var s=r[n];e.push({function:s.functionName||"",file:s.fileName||"",line:s.lineNumber||0,column:s.columnNumber||0})}}return{type:t.name?t.name:"",message:t.message?String(t.message):String(t),backtrace:e}}var md=new RegExp(["^","\\[(\\$.+)\\]","\\s","([\\s\\S]+)","$"].join(""));function vd(t){var e=t.errors[0];if(""!==e.type&&"Error"!==e.type)return t;var i=e.message.match(md);return null!==i&&(e.type=i[1],e.message=i[2]),t}var yd=["Script error","Script error.","InvalidAccessError"];function bd(t){var e=t.errors[0];if(""===e.type&&-1!==yd.indexOf(e.message))return null;if(e.backtrace&&e.backtrace.length>0&&"<anonymous>"===e.backtrace[0].file)return null;return t}var _d=new RegExp(["^","Uncaught\\s","(.+?)",":\\s","(.+)","$"].join(""));function xd(t){var e=t.errors[0];if(""!==e.type&&"Error"!==e.type)return t;var i=e.message.match(_d);return null!==i&&(e.type=i[1],e.message=i[2]),t}var wd=i(4098),Sd=i.n(wd),Td={unauthorized:new Error("airbrake: unauthorized: project id or key are wrong"),ipRateLimited:new Error("airbrake: IP is rate limited")},Ed=0;function kd(t){if(Date.now()/1e3<Ed)return td.reject(Td.ipRateLimited);var e={method:t.method,body:t.body,headers:t.headers};return Sd()(t.url,e).then((function(t){if(401===t.status)throw Td.unauthorized;if(429===t.status){var e=t.headers.get("X-RateLimit-Delay");if(!e)throw Td.ipRateLimited;var i=parseInt(e,10);throw i>0&&(Ed=Date.now()/1e3+i),Td.ipRateLimited}if(204===t.status)return{json:null};if(404===t.status)throw new Error("404 Not Found");return t.status>=200&&t.status<300?t.json().then((function(t){return{json:t}})):t.status>=400&&t.status<500?t.json().then((function(t){throw new Error(t.message)})):t.text().then((function(e){throw new Error("airbrake: fetch: unexpected response: code=".concat(t.status," body='").concat(e,"'"))}))}))}function Cd(t){return function(e){return function(t,e){if(Date.now()/1e3<Md)return td.reject(Td.ipRateLimited);return new td((function(i,n){e({url:t.url,method:t.method,body:t.body,headers:{"content-type":"application/json"},timeout:t.timeout},(function(t,e,r){if(t)n(t);else{if(!e.statusCode)return t=new Error("airbrake: request: response statusCode is ".concat(e.statusCode)),void n(t);if(401!==e.statusCode)if(429!==e.statusCode)if(204!==e.statusCode)if(e.statusCode>=200&&e.statusCode<300){var s=void 0;try{s=JSON.parse(r)}catch(t){return void n(t)}i(s)}else{if(e.statusCode>=400&&e.statusCode<500){s=void 0;try{s=JSON.parse(r)}catch(t){return void n(t)}return t=new Error(s.message),void n(t)}r=r.trim(),t=new Error("airbrake: node: unexpected response: code=".concat(e.statusCode," body='").concat(r,"'")),n(t)}else i({json:null});else{n(Td.ipRateLimited);var a=e.headers["x-ratelimit-delay"];if(!a)return;var o=void 0;if("string"==typeof a)o=a;else{if(!(a instanceof Array))return;o=a[0]}var l=parseInt(o,10);l>0&&(Md=Date.now()/1e3+l)}else n(Td.unauthorized)}}))}))}(e,t)}}var Md=0;function Ad(t){return t.request?Cd(t.request):kd}var Od,Pd,Rd=(Od=function(t,e){return Od=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},Od(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}Od(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),Id=!1;try{Pd=i(4378),Id=!0}catch(t){}var Ld=function(){function t(){this.count=0,this.sum=0,this.sumsq=0,this._td=new Pd.Digest}return t.prototype.add=function(t){0===t&&(t=1e-5),this.count+=1,this.sum+=t,this.sumsq+=t*t,this._td&&this._td.push(t)},t.prototype.toJSON=function(){return{count:this.count,sum:this.sum,sumsq:this.sumsq,tdigestCentroids:Nd(this._td)}},t}(),Dd=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.groups={},e}return Rd(e,t),e.prototype.addGroups=function(t,e){for(var i in this.add(t),e)e.hasOwnProperty(i)&&this.addGroup(i,e[i])},e.prototype.addGroup=function(t,e){var i=this.groups[t];i||(i=new Ld,this.groups[t]=i),i.add(e)},e.prototype.toJSON=function(){return{count:this.count,sum:this.sum,sumsq:this.sumsq,tdigestCentroids:Nd(this._td),groups:this.groups}},e}(Ld);function Nd(t){var e=[],i=[];return t.centroids.each((function(t){e.push(t.mean),i.push(t.n)})),{mean:e,count:i}}var Fd=function(){return Fd=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Fd.apply(this,arguments)},jd=function(){function t(t){void 0===t&&(t=""),this.method="",this.route="",this.query="",this.func="",this.file="",this.line=0,this.startTime=new Date,this.query=t}return t.prototype._duration=function(){return this.endTime||(this.endTime=new Date),this.endTime.getTime()-this.startTime.getTime()},t}(),Bd=function(){function t(t){this._m={},this._opt=t,this._url="".concat(t.host,"/api/v5/projects/").concat(t.projectId,"/queries-stats?key=").concat(t.projectKey),this._requester=Ad(t)}return t.prototype.start=function(t){return void 0===t&&(t=""),new jd(t)},t.prototype.notify=function(t){var e=this;if(Id&&this._opt.performanceStats&&this._opt.queryStats){var i=t._duration(),n=new Date(6e4*Math.floor(t.startTime.getTime()/6e4)),r={method:t.method,route:t.route,query:t.query,func:t.func,file:t.file,line:t.line,time:n},s=JSON.stringify(r),a=this._m[s];a||(a=new Ld,this._m[s]=a),a.add(i),this._timer||(this._timer=setTimeout((function(){e._flush()}),15e3))}},t.prototype._flush=function(){var t=[];for(var e in this._m)if(this._m.hasOwnProperty(e)){var i=JSON.parse(e),n=Fd(Fd({},i),this._m[e].toJSON());t.push(n)}this._m={},this._timer=null;var r=JSON.stringify({environment:this._opt.environment,queries:t}),s={method:"POST",url:this._url,body:r};this._requester(s).then((function(t){})).catch((function(t){console.error&&console.error("can not report queries stats",t)}))},t}(),zd=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Wd=function(){return Wd=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Wd.apply(this,arguments)},Gd=function(t){function e(e){var i=t.call(this)||this;return i.queue=e,i.startTime=new Date,i}return zd(e,t),e}(od),Ud=function(){function t(t){this._m={},this._opt=t,this._url="".concat(t.host,"/api/v5/projects/").concat(t.projectId,"/queues-stats?key=").concat(t.projectKey),this._requester=Ad(t)}return t.prototype.notify=function(t){var e=this;if(Id&&this._opt.performanceStats&&this._opt.queueStats){var i=t._duration();0===i&&(i=1e-5);var n=new Date(6e4*Math.floor(t.startTime.getTime()/6e4)),r={queue:t.queue,time:n},s=JSON.stringify(r),a=this._m[s];a||(a=new Dd,this._m[s]=a),a.addGroups(i,t._groups),this._timer||(this._timer=setTimeout((function(){e._flush()}),15e3))}},t.prototype._flush=function(){var t=[];for(var e in this._m)if(this._m.hasOwnProperty(e)){var i=JSON.parse(e),n=Wd(Wd({},i),this._m[e].toJSON());t.push(n)}this._m={},this._timer=null;var r=JSON.stringify({environment:this._opt.environment,queues:t}),s={method:"POST",url:this._url,body:r};this._requester(s).then((function(t){})).catch((function(t){console.error&&console.error("can not report queues breakdowns",t)}))},t}(),Hd=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Xd=function(){return Xd=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Xd.apply(this,arguments)},Vd=function(t){function e(e,i,n,r){void 0===e&&(e=""),void 0===i&&(i=""),void 0===n&&(n=0),void 0===r&&(r="");var s=t.call(this)||this;return s.method=e,s.route=i,s.statusCode=n,s.contentType=r,s.startTime=new Date,s}return Hd(e,t),e}(od),Yd=function(){function t(t){this._m={},this._opt=t,this._url="".concat(t.host,"/api/v5/projects/").concat(t.projectId,"/routes-stats?key=").concat(t.projectKey),this._requester=Ad(t)}return t.prototype.notify=function(t){var e=this;if(Id&&this._opt.performanceStats){var i=t._duration(),n=new Date(6e4*Math.floor(t.startTime.getTime()/6e4)),r={method:t.method,route:t.route,statusCode:t.statusCode,time:n},s=JSON.stringify(r),a=this._m[s];a||(a=new Ld,this._m[s]=a),a.add(i),this._timer||(this._timer=setTimeout((function(){e._flush()}),15e3))}},t.prototype._flush=function(){var t=[];for(var e in this._m)if(this._m.hasOwnProperty(e)){var i=JSON.parse(e),n=Xd(Xd({},i),this._m[e].toJSON());t.push(n)}this._m={},this._timer=null;var r=JSON.stringify({environment:this._opt.environment,routes:t}),s={method:"POST",url:this._url,body:r};this._requester(s).then((function(t){})).catch((function(t){console.error&&console.error("can not report routes stats",t)}))},t}(),Kd=function(){function t(t){this._m={},this._opt=t,this._url="".concat(t.host,"/api/v5/projects/").concat(t.projectId,"/routes-breakdowns?key=").concat(t.projectKey),this._requester=Ad(t)}return t.prototype.notify=function(t){var e=this;if(Id&&this._opt.performanceStats&&!(t.statusCode<200||t.statusCode>=300&&t.statusCode<400||404===t.statusCode||0===Object.keys(t._groups).length)){var i=t._duration();0===i&&(i=1e-5);var n=new Date(6e4*Math.floor(t.startTime.getTime()/6e4)),r={method:t.method,route:t.route,responseType:this._responseType(t),time:n},s=JSON.stringify(r),a=this._m[s];a||(a=new Dd,this._m[s]=a),a.addGroups(i,t._groups),this._timer||(this._timer=setTimeout((function(){e._flush()}),15e3))}},t.prototype._flush=function(){var t=[];for(var e in this._m)if(this._m.hasOwnProperty(e)){var i=JSON.parse(e),n=Xd(Xd({},i),this._m[e].toJSON());t.push(n)}this._m={},this._timer=null;var r=JSON.stringify({environment:this._opt.environment,routes:t}),s={method:"POST",url:this._url,body:r};this._requester(s).then((function(t){})).catch((function(t){console.error&&console.error("can not report routes breakdowns",t)}))},t.prototype._responseType=function(t){if(t.statusCode>=500)return"5xx";if(t.statusCode>=400)return"4xx";if(!t.contentType)return"";var e=t.contentType.split(";")[0].split("/");return e[e.length-1]},t}(),qd="airbrake-js/browser",Zd="2.1.8",Jd=function(){return Jd=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Jd.apply(this,arguments)},$d={notifier_name:qd,notifier_version:Zd,os:"undefined"!=typeof window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:void 0,language:"JavaScript"},Qd="errors",tf=function(){function t(t){this._opt=t,this._requester=Ad(t),this._data=new ef(t.projectId,{project_id:null,poll_sec:0,updated_at:0,config_route:"",settings:[]}),this._origErrorNotifications=t.errorNotifications,this._origPerformanceStats=t.performanceStats}return t.prototype.poll=function(){var t=this,e=setInterval((function(){t._doRequest(),clearInterval(e)}),0);return setInterval(this._doRequest.bind(this),6e5)},t.prototype._doRequest=function(){var t=this;this._requester(this._requestParams(this._opt)).then((function(e){t._data.merge(e.json),t._opt.host=t._data.errorHost(),t._opt.apmHost=t._data.apmHost(),t._processErrorNotifications(t._data),t._processPerformanceStats(t._data)})).catch((function(t){}))},t.prototype._requestParams=function(t){return{method:"GET",url:this._pollUrl(t),headers:{Accept:"application/json","Cache-Control":"no-cache,no-store"}}},t.prototype._pollUrl=function(t){for(var e=this._data.configRoute(t.remoteConfigHost),i="?",n=0,r=this._entries($d);n<r.length;n++){var s=r[n],a=s[0],o=s[1];i+="&".concat(encodeURIComponent(a),"=").concat(encodeURIComponent(o))}return e+i},t.prototype._processErrorNotifications=function(t){this._origErrorNotifications&&(this._opt.errorNotifications=t.errorNotifications())},t.prototype._processPerformanceStats=function(t){this._origPerformanceStats&&(this._opt.performanceStats=t.performanceStats())},t.prototype._entries=function(t){for(var e=Object.keys(t),i=e.length,n=new Array(i);i--;)n[i]=[e[i],t[e[i]]];return n},t}(),ef=function(){function t(t,e){this._projectId=t,this._data=e}return t.prototype.merge=function(t){this._data=Jd(Jd({},this._data),t)},t.prototype.configRoute=function(t){var e=t.replace(/\/$/,""),i=this._data.config_route;return null==i||""===i?"".concat(e,"/").concat("2020-06-18","/config/").concat(this._projectId,"/config.json"):"".concat(e,"/").concat(i)},t.prototype.errorNotifications=function(){var t=this._findSetting(Qd);return null===t||t.enabled},t.prototype.performanceStats=function(){var t=this._findSetting("apm");return null===t||t.enabled},t.prototype.errorHost=function(){var t=this._findSetting(Qd);return null===t?null:t.endpoint},t.prototype.apmHost=function(){var t=this._findSetting("apm");return null===t?null:t.endpoint},t.prototype._findSetting=function(t){var e=this._data.settings;if(null==e)return null;var i=e.find((function(e){return e.name===t}));return void 0===i?null:i},t}(),nf=function(){return nf=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},nf.apply(this,arguments)},rf=function(){function t(t){var e,i,n=this;if(this._filters=[],this._performanceFilters=[],this._scope=new cd,this._onClose=[],!t.projectId||!t.projectKey)throw new Error("airbrake: projectId and projectKey are required");if(this._opt=t,this._opt.host=this._opt.host||"https://api.airbrake.io",this._opt.remoteConfigHost=this._opt.remoteConfigHost||"https://notifier-configs.airbrake.io",this._opt.apmHost=this._opt.apmHost||"https://api.airbrake.io",this._opt.timeout=this._opt.timeout||1e4,this._opt.keysBlocklist=this._opt.keysBlocklist||[/password/,/secret/],this._url="".concat(this._opt.host,"/api/v3/projects/").concat(this._opt.projectId,"/notices?key=").concat(this._opt.projectKey),this._opt.errorNotifications=!1!==this._opt.errorNotifications,this._opt.performanceStats=!1!==this._opt.performanceStats,this._opt.queryStats=!1!==this._opt.queryStats,this._opt.queueStats=!1!==this._opt.queueStats,this._opt.remoteConfig=!1!==this._opt.remoteConfig,this._processor=this._opt.processor||gd,this._requester=Ad(this._opt),this.addFilter(bd),this.addFilter((function(t){var n=JSON.stringify(t.errors);return n===e?null:(i&&clearTimeout(i),e=n,i=setTimeout((function(){e=""}),1e3),t)})),this.addFilter(xd),this.addFilter(vd),this.addFilter((function(t){return t.context.notifier={name:qd,version:Zd,url:"https://github.com/airbrake/airbrake-js/tree/master/packages/browser"},n._opt.environment&&(t.context.environment=n._opt.environment),t})),this.routes=new sf(this),this.queues=new af(this),this.queries=new Bd(this._opt),this._opt.remoteConfig){var r=new tf(this._opt).poll();this._onClose.push((function(){return clearInterval(r)}))}}return t.prototype.close=function(){for(var t=0,e=this._onClose;t<e.length;t++){(0,e[t])()}},t.prototype.scope=function(){return this._scope},t.prototype.setActiveScope=function(t){this._scope=t},t.prototype.addFilter=function(t){this._filters.push(t)},t.prototype.addPerformanceFilter=function(t){this._performanceFilters.push(t)},t.prototype.notify=function(t){var e={errors:[],context:nf(nf({severity:"error"},this.scope().context()),t.context),params:t.params||{},environment:t.environment||{},session:t.session||{}};if("object"==typeof t&&void 0!==t.error||(t={error:t}),!this._opt.errorNotifications)return e.error=new Error("airbrake: not sending this error, errorNotifications is disabled err=".concat(JSON.stringify(t.error))),td.resolve(e);if(!t.error)return e.error=new Error("airbrake: got err=".concat(JSON.stringify(t.error),", wanted an Error")),td.resolve(e);var i=this._processor(t.error);e.errors.push(i);for(var n=0,r=this._filters;n<r.length;n++){var s=(0,r[n])(e);if(null===s)return e.error=new Error("airbrake: error is filtered"),td.resolve(e);e=s}return e.context||(e.context={}),e.context.language="JavaScript",this._sendNotice(e)},t.prototype._sendNotice=function(t){var e=function(t,e){var i=void 0===e?{}:e,n=i.maxLength,r=void 0===n?64e3:n,s=i.keysBlocklist,a=void 0===s?[]:s;if(t.errors)for(var o=0;o<t.errors.length;o++){var l=new id({keysBlocklist:a});t.errors[o]=l.truncate(t.errors[o])}for(var h="",c=["params","environment","session"],u=0;u<8;u++){for(var d={level:u,keysBlocklist:a},f=0,p=c;f<p.length;f++)(b=t[y=p[f]])&&(t[y]=nd(b,d));if((h=JSON.stringify(t)).length<r)return h}var g={json:h.slice(0,Math.floor(r/2))+"..."};c.push("errors");for(var m=0,v=c;m<v.length;m++){var y,b;(b=t[y=v[m]])&&(h=JSON.stringify(b),g[y]=h.length)}var _=new Error("airbrake: notice exceeds max length and can't be truncated");throw _.params=g,_}(t,{keysBlocklist:this._opt.keysBlocklist});if(this._opt.reporter){if("function"==typeof this._opt.reporter)return this._opt.reporter(t);console.warn("airbrake: options.reporter must be a function")}var i={method:"POST",url:this._url,body:e};return this._requester(i).then((function(e){return t.id=e.json.id,t.url=e.json.url,t})).catch((function(e){return t.error=e,t}))},t.prototype.wrap=function(t,e){if(void 0===e&&(e=[]),t._airbrake)return t;var i=this,n=function(){var e=Array.prototype.slice.call(arguments),n=i._wrapArguments(e);try{return t.apply(this,n)}catch(t){throw i.notify({error:t,params:{arguments:e}}),i._ignoreNextWindowError(),t}};for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);for(var s=0,a=e;s<a.length;s++){r=a[s];t.hasOwnProperty(r)&&(n[r]=t[r])}return n._airbrake=!0,n.inner=t,n},t.prototype._wrapArguments=function(t){for(var e=0;e<t.length;e++){var i=t[e];"function"==typeof i&&(t[e]=this.wrap(i))}return t},t.prototype._ignoreNextWindowError=function(){},t.prototype.call=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return this.wrap(t).apply(this,Array.prototype.slice.call(arguments,1))},t}(),sf=function(){function t(t){this._notifier=t,this._routes=new Yd(t._opt),this._breakdowns=new Kd(t._opt),this._opt=t._opt}return t.prototype.start=function(t,e,i,n){void 0===t&&(t=""),void 0===e&&(e=""),void 0===i&&(i=0),void 0===n&&(n="");var r=new Vd(t,e,i,n);if(!this._opt.performanceStats)return r;var s=this._notifier.scope().clone();return s.setContext({httpMethod:t,route:e}),s.setRouteMetric(r),this._notifier.setActiveScope(s),r},t.prototype.notify=function(t){if(this._opt.performanceStats){t.end();for(var e=0,i=this._notifier._performanceFilters;e<i.length;e++){if(null===(0,i[e])(t))return}this._routes.notify(t),this._breakdowns.notify(t)}},t}(),af=function(){function t(t){this._notifier=t,this._queues=new Ud(t._opt),this._opt=t._opt}return t.prototype.start=function(t){var e=new Gd(t);if(!this._opt.performanceStats)return e;var i=this._notifier.scope().clone();return i.setContext({queue:t}),i.setQueueMetric(e),this._notifier.setActiveScope(i),e},t.prototype.notify=function(t){this._opt.performanceStats&&(t.end(),this._queues.notify(t))},t}();function of(t){return window.navigator&&window.navigator.userAgent&&(t.context.userAgent=window.navigator.userAgent),window.location&&(t.context.url=String(window.location),t.context.rootDirectory=window.location.protocol+"//"+window.location.host),t}var lf=["debug","log","info","warn","error"];var hf=["type","name","src"];function cf(t){var e=function(t){return function(e){var i=df(e,"target");if(i){var n={type:e.type};try{n.target=function(t){var e=10,i=[],n=t;for(;n;){var r=uf(n);if(""!==r&&(i.push(r),i.length>e))break;n=n.parentNode}if(0===i.length)return String(t);return i.reverse().join(" > ")}(i)}catch(t){n.target="<".concat(String(t),">")}t.scope().pushHistory(n)}}}(t);window.addEventListener&&(window.addEventListener("load",e),window.addEventListener("error",(function(t){df(t,"error")||e(t)}),!0)),"object"==typeof document&&document.addEventListener&&(document.addEventListener("DOMContentLoaded",e),document.addEventListener("click",e),document.addEventListener("keypress",e))}function uf(t){if(!t)return"";var e=[];if(t.tagName&&e.push(t.tagName.toLowerCase()),t.id&&(e.push("#"),e.push(t.id)),t.classList&&Array.from)e.push("."),e.push(Array.from(t.classList).join("."));else if(t.className){var i=function(t){if(t.split)return t.split(" ").join(".");if(t.baseVal&&t.baseVal.split)return t.baseVal.split(" ").join(".");return console.error("unsupported HTMLElement.className type",typeof t),""}(t.className);""!==i&&(e.push("."),e.push(i))}if(t.getAttribute)for(var n=0,r=hf;n<r.length;n++){var s=r[n],a=t.getAttribute(s);a&&e.push("[".concat(s,'="').concat(a,'"]'))}return e.join("")}function df(t,e){try{return t[e]}catch(t){return null}}var ff="";function pf(){return document.location&&document.location.pathname}function gf(t,e){var i=e.indexOf("://");i>=0?(i=(e=e.slice(i+3)).indexOf("/"),e=i>=0?e.slice(i):"/"):"/"!==e.charAt(0)&&(e="/"+e),t.scope().pushHistory({type:"location",from:ff,to:e}),ff=e}function mf(t){var e=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(i,n,r,s,a){0===t._ignoreNextXHR&&(this.__state={type:"xhr",method:i,url:n}),e.apply(this,arguments)};var i=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(e){var n=this.onreadystatechange;return this.onreadystatechange=function(e){var i,r;if(4===this.readyState&&this.__state&&((r=(i=this).__state).statusCode=i.status,r.duration=(new Date).getTime()-r.date.getTime(),t.scope().pushHistory(r)),n)return n.apply(this,arguments)},this.__state&&(this.__state.date=new Date),i.apply(this,arguments)}}var vf=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),yf=function(){return yf=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},yf.apply(this,arguments)},bf=function(t){function e(e){var i=t.call(this,e)||this;return i.offline=!1,i.todo=[],i._ignoreWindowError=0,i._ignoreNextXHR=0,"undefined"==typeof window||(i.addFilter(of),window.addEventListener&&(i.onOnline=i.onOnline.bind(i),window.addEventListener("online",i.onOnline),i.onOffline=i.onOffline.bind(i),window.addEventListener("offline",i.onOffline),i.onUnhandledrejection=i.onUnhandledrejection.bind(i),window.addEventListener("unhandledrejection",i.onUnhandledrejection),i._onClose.push((function(){window.removeEventListener("online",i.onOnline),window.removeEventListener("offline",i.onOffline),window.removeEventListener("unhandledrejection",i.onUnhandledrejection)}))),i._instrument(e.instrumentation)),i}return vf(e,t),e.prototype._instrument=function(t){var e,i,n;if(void 0===t&&(t={}),void 0===t.console&&(t.console=!((e=this._opt.environment)&&e.startsWith&&e.startsWith("dev"))),_f(t.onerror)){var r=this,s=window.onerror;window.onerror=function(){s&&s.apply(this,arguments),r.onerror.apply(r,arguments)}}cf(this),_f(t.fetch)&&"function"==typeof fetch&&(i=this,n=window.fetch,window.fetch=function(t,e){var r={type:"xhr",date:new Date};return r.method=e&&e.method?e.method:"GET","string"==typeof t?r.url=t:(r.method=t.method,r.url=t.url),i._ignoreNextXHR++,setTimeout((function(){return i._ignoreNextXHR--})),n.apply(this,arguments).then((function(t){return r.statusCode=t.status,r.duration=(new Date).getTime()-r.date.getTime(),i.scope().pushHistory(r),t})).catch((function(t){throw r.error=t,r.duration=(new Date).getTime()-r.date.getTime(),i.scope().pushHistory(r),t}))}),_f(t.history)&&"object"==typeof history&&function(t){ff=pf();var e=window.onpopstate;window.onpopstate=function(i){var n=pf();if(n&&gf(t,n),e)return e.apply(this,arguments)};var i=history.pushState;history.pushState=function(e,n,r){r&&gf(t,r.toString()),i.apply(this,arguments)}}(this),_f(t.console)&&"object"==typeof console&&function(t){for(var e=function(e){if(!(e in console))return"continue";var i=console[e],n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];i.apply(console,n),t.scope().pushHistory({type:"log",severity:e,arguments:n})};n.inner=i,console[e]=n},i=0,n=lf;i<n.length;i++)e(n[i])}(this),_f(t.xhr)&&"undefined"!=typeof XMLHttpRequest&&mf(this)},e.prototype.notify=function(e){var i=this;return this.offline?new td((function(t,n){for(i.todo.push({err:e,resolve:t,reject:n});i.todo.length>100;){var r=i.todo.shift();if(void 0===r)break;r.resolve({error:new Error("airbrake: offline queue is too large")})}})):t.prototype.notify.call(this,e)},e.prototype.onOnline=function(){this.offline=!1;for(var t=function(t){e.notify(t.err).then((function(e){t.resolve(e)}))},e=this,i=0,n=this.todo;i<n.length;i++){t(n[i])}this.todo=[]},e.prototype.onOffline=function(){this.offline=!0},e.prototype.onUnhandledrejection=function(t){var e=t.reason||t.detail&&t.detail.reason;if(e){var i=e.message||String(e);i.indexOf&&0===i.indexOf("airbrake: ")||("object"==typeof e&&void 0!==e.error?this.notify(yf(yf({},e),{context:{unhandledRejection:!0}})):this.notify({error:e,context:{unhandledRejection:!0}}))}},e.prototype.onerror=function(t,e,i,n,r){this._ignoreWindowError>0||(r?this.notify({error:r,context:{windowError:!0}}):e&&i&&this.notify({error:{message:t,fileName:e,lineNumber:i,columnNumber:n,noStack:!0},context:{windowError:!0}}))},e.prototype._ignoreNextWindowError=function(){var t=this;this._ignoreWindowError++,setTimeout((function(){return t._ignoreWindowError--}))},e}(rf);function _f(t){return void 0===t||!0===t}var xf=i(3379),wf=i.n(xf),Sf=i(3503),Tf={insert:"head",singleton:!1};wf()(Sf.Z,Tf);Sf.Z.locals;var Ef=i(9275),kf={insert:"head",singleton:!1};wf()(Ef.Z,kf);Ef.Z.locals;var Cf=i(5189),Mf={insert:"head",singleton:!1};wf()(Cf.Z,Mf);Cf.Z.locals;var Af={oninit:function(t){},view:function(t){return r()("div",{class:"comp positionaldialog"+(t.attrs.isOpen?" open":" closed")+(t.attrs.fillcontainer?" fill":""),onclick:function(e){!function(t,e){var i,n;null!=t&&null!==(i=t.target)&&void 0!==i&&null!==(i=i.classList)&&void 0!==i&&null!==(n=i.contains)&&void 0!==n&&n.call(i,"positionaldialog")&&e.attrs.onClose&&e.attrs.onClose()}(e,t)}},r()("div",{class:"content"},t.children))}};const Of="/dist/assets/resources/APWP-online_manual.pdf";var Pf={view:function(t){return r()("div",{class:"page header"},r()("div",{class:"menu content_width_standard"},r()("a",{href:"#!/",class:"unobtrusive"},r()("h1",null,"APWP-online.org")),r()("div",{style:"flex-grow:1;"}),r()("a",{class:"mobile_hidden",href:"#!/"},"Home"),r()("a",{class:"mobile_hidden",href:"#!/apwptool"},"APWP Tool"),r()("a",{class:"mobile_hidden",href:"#!/rpdtool"},"RPD Tool"),r()("a",{class:"mobile_hidden",href:"#!/referencedatabase"},"Reference database"),r()("a",{class:"mobile_hidden",href:"#!/about"},"About"),r()("a",{class:"mobile_hidden",href:Of,target:"_blank"},"Manual (PDF)"),r()("button",{class:"btn_icon mobile_only",onclick:function(){t.state.menuIsOpen=!t.state.menuIsOpen}},r()("i",{class:"fa-solid fa-bars"})),r()(Af,{fillcontainer:!0,isOpen:t.state.menuIsOpen,onClose:function(){t.state.menuIsOpen=!1}},r()("a",{onclick:function(){t.state.menuIsOpen=!1},href:"#!/"},"Home"),r()("a",{onclick:function(){t.state.menuIsOpen=!1},href:"#!/apwptool"},"APWP Tool"),r()("a",{onclick:function(){t.state.menuIsOpen=!1},href:"#!/rpdtool"},"RPD Tool"),r()("a",{onclick:function(){t.state.menuIsOpen=!1},href:"#!/referencedatabase"},"Reference database"),r()("a",{onclick:function(){t.state.menuIsOpen=!1},href:"#!/about"},"About"),r()("a",{href:Of,target:"_blank"},"Manual (PDF)"))))}},Rf=i(6226),If={insert:"head",singleton:!1};wf()(Rf.Z,If);Rf.Z.locals;var Lf={view:function(t){return r()("div",{class:"page footer"},r()("div",{class:"content content_width_standard"},r()("div",null,r()("h4",null,"APWP-online"),r()("a",{href:"#!/"},"Home"),r()("br",null),r()("a",{href:"#!/apwptool"},"APWP Tool"),r()("br",null),r()("a",{href:"#!/rpdtool"},"RPD Tool"),r()("br",null),r()("a",{href:"#!/referencedatabase"},"Reference database"),r()("br",null),r()("a",{href:"#!/about"},"About")),r()("div",null,r()("h4",null,"Contact"),r()("div",{class:"flex"},r()("div",null,r()("a",{href:"mailto:info@apwp-online.org"},"info@apwp-online.org"),r()("br",null)),r()("small",null,"Department of Earth Sciences",r()("br",null),"Utrecht University,",r()("br",null),"Vening Meinesz Building A,",r()("br",null),"Princetonlaan 8A,",r()("br",null),"3584 CB Utrecht, Netherlands"))),r()("div",null,r()("h4",null,"Manual"),r()("a",{href:Of},"APWP-online manual (PDF)"),r()("br",null),r()("br",null),r()("h4",null,"Supported by"),r()("div",{class:"logos"},r()("a",{href:"https://www.nwo.nl/"},r()("img",{src:"/dist/assets/images/LOGO_nwo.png"})),r()("a",{href:"https://www.uu.nl/"},r()("img",{src:"/dist/assets/fonts/LOGO_uu.svg"}))))),r()("div",{class:"siteinfo"},r()("small",null,"© 2022 - ",(new Date).getFullYear(),", version ",v.version.apwp)))}},Df=i(2886),Nf={insert:"head",singleton:!1};wf()(Df.Z,Nf);Df.Z.locals;var Ff={oninit:function(t){},onremove:function(t){},view:function(t){return r()("div",{class:"page home"},r()("div",{class:"section content_width_standard"},r()("div",{class:"content_width_narrow"},r()("h2",null,"APWP-online"),"User-friendly tools to compute apparent polar wander paths (APWPs) from site-level paleomagnetic data and to determine relative paleomagnetic displacements.",r()("br",null),r()("br",null),"You will also find the curated paleomagnetic database used to compute the most recent global APWP of ",r()("a",{href:"#!/referencedatabase"},"Vaes et al. (2023)"),". Do you have new high-quality paleomagnetic data to add to future iterations of the global APWP, ",r()("a",{href:"#!/referencedatabase"},"let us know"),"!",r()("br",null),r()("br",null),"See ",r()("a",{href:Of},"the user manual")," for more information on how to use the tools and the underlying methodology.",r()("br",null),r()("br",null),r()("br",null),r()("br",null)),r()("div",{class:"flex features"},r()("button",{class:"feature",onclick:function(){r().route.set("/apwptool")}},r()("h4",null,"APWP Tool"),r()("div",{class:"txt_default_lesser"},"Compute a custom Apparent Polar Wander Paths based on site-level paleo­magnetic data"),r()("br",null),r()("br",null),r()("i",{class:"fa-duotone fa-bezier-curve fa-8x"})),r()("button",{class:"feature",onclick:function(){r().route.set("/rpdtool")}},r()("h4",null,"RPD Tool"),r()("div",{class:"txt_default_lesser"},"Determine Relative Paleo­magnetic Dis­place­ments to quantify vertical-axis rotations and paleo­latitudinal motions through time"),r()("br",null),r()("br",null),r()("i",{class:"fa-duotone fa-up-down-left-right fa-8x"})),r()("button",{class:"feature",onclick:function(){r().route.set("/referencedatabase")}},r()("h4",null,"Reference database"),r()("div",{class:"txt_default_lesser"},"The reference database that underpins the global APWP for the last 320 Ma from Vaes et al. (2023)."),r()("br",null),r()("br",null),r()("i",{class:"fa-duotone fa-table-list fa-8x"})))),r()("div",{class:"section content_width_narrow"},r()("h2",null,"More"),"See the ",r()("a",{href:"#!/about"},"about page")," for the underlying publications, technical details and contributors.",r()("br",null),r()("br",null),"For more paleomagnetic data analysis tools and tectonic applications, see ",r()("a",{href:"https://paleomagnetism.org/",target:"_blank"},"Paleomagnetism.org")))}},jf=i(6973),Bf={insert:"head",singleton:!1};wf()(jf.Z,Bf);jf.Z.locals;var zf=[],Wf={oninit:function(t){},view:function(t){return r()("div",{class:"comp pyodideinfobox ".concat(0===zf.length?"hidden":"")},0===zf.filter((function(t){return t.messagetime>0})).length?"":r()("div",{class:"close",onclick:function(){zf=zf.filter((function(t){return t.messagetime<0}))}},r()("i",{class:"fa-solid fa-xmark fa-xl"})),zf.map((function(t){var e;return t.content=(null!==(e=t.content)&&void 0!==e?e:"").replace("##__consoleShortcut__##","(".concat(localStorage.getItem("consoleShortcut"),")")),r()("div",{class:"message"},r()("div",{class:"title"},r()("span",{key:t.spinner?"spinner":"nospinner"},t.spinner?r()("i",{class:"spinner fa-solid fa-gear fa-fw fa-spin"}):""),r()("span",{key:"title"},r().trust(t.title))),r()("div",{class:"content"},r().trust(t.content)))})))},show:function(t){void 0===t.messagetime&&(t.messagetime=-1),void 0===t.spinner&&(t.spinner=!0),t.id=g.general.uuid(),zf=zf.filter((function(t){return t.messagetime>0})),t.starttime=Date.now(),zf.push(t),Gf(),r().redraw()}};function Gf(){var t=Date.now();zf.length!==(zf=zf.filter((function(e){return e.messagetime<0||e.starttime+e.messagetime>t}))).length&&r().redraw(),zf.length>0&&window.setTimeout(Gf,150)}function Uf(t){return Uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uf(t)}var Hf=["id","error"];function Xf(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Vf(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Xf(Object(i),!0).forEach((function(e){Yf(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Xf(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Yf(t,e,i){var n;return n=function(t,e){if("object"!=Uf(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=Uf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"),(e="symbol"==Uf(n)?n:String(n))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Kf(t,e){if(null==t)return{};var i,n,r=function(t,e){if(null==t)return{};var i,n,r={},s=Object.keys(t);for(n=0;n<s.length;n++)i=s[n],e.indexOf(i)>=0||(r[i]=t[i]);return r}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)i=s[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(r[i]=t[i])}return r}var qf={0:function(t,e){Wf.show(t),e&&console.error(e)}},Zf=new Worker(new URL(i.p+i.u(556),i.b));Zf.onmessage=function(t){var e=t.data,i=e.id,n=e.error,r=Kf(e,Hf);n&&console.error(n);var s=qf[i];0!==i&&delete qf[i],s(Vf(Vf({},r),{},{error:n}))};var Jf,$f=(Jf=0,function(t,e){return Jf=(Jf+1)%Number.MAX_SAFE_INTEGER,new Promise((function(i){qf[Jf]=i,Zf.postMessage({options:e,cmd:t,id:Jf})}))});var Qf={run:function(t,e){return new Promise((function(i,n){$f(t,e).then((function(t){var e=t.results,r=t.error;r?n(r):e?i(e):n("Empty response from the calculation engine")})).catch((function(t){n("Error in pyWorker.js at ".concat(null==t?void 0:t.filename,", Line: ").concat(null==t?void 0:t.lineno,", ").concat(null==t?void 0:t.message))}))}))}},tp=i(8716),ep={insert:"head",singleton:!1};wf()(tp.Z,ep);tp.Z.locals;const ip="/dist/assets/resources/demo_input.xlsx",np="/dist/assets/resources/demo_input_NEJ.csv";var rp=i(1493),sp={insert:"head",singleton:!1};wf()(rp.Z,sp);rp.Z.locals;var ap=i(5279),op={insert:"head",singleton:!1};wf()(ap.Z,op);ap.Z.locals;var lp={oninit:function(t){},view:function(t){return r()("div",{class:"comp input input_file ".concat(t.state.dragging?"dragging":"")},r()("input",{type:"file",multiple:!0===t.attrs.multiple,disabled:t.attrs.disabled,class:(t.attrs.error?"error ":"")+("auto"==t.attrs.size?"size-auto":""),value:t.attrs.value,onchange:function(e){var i,n;(t.attrs.onblur||function(){})(null==e||null===(i=e.target)||void 0===i||null===(n=i.closest)||void 0===n||null===(n=n.call(i,"input"))||void 0===n?void 0:n.files)},onclick:function(e){var i,n;t.attrs.value=null,void 0!==(null==e||null===(i=e.target)||void 0===i||null===(n=i.closest)||void 0===n?void 0:n.call(i,"input"))&&(e.target.closest("input").value=null)},accept:t.attrs.accept||"application/pdf",ondragenter:function(e){t.state.dragging=!0},ondragover:function(e){t.state.dragging=!0},ondragleave:function(e){t.state.dragging=!1},ondragend:function(e){t.state.dragging=!1},ondrop:function(e){t.state.dragging=!1}}),r()("div",{class:"dropzoneui noselect"},r()("div",{class:"icon"},r()("i",{class:"fas fa-plus fa-4x"})),r().trust(t.attrs.title)))}},hp={oninit:function(t){t.state.value=t.attrs.value},view:function(t){return void 0===t.attrs.options&&(t.attrs.options=[]),r()("div",{class:"comp input input_select ".concat(t.state.saving?"saving":""," ").concat(t.attrs.disabled?"disabled":""," ").concat(t.attrs.autowidth?"autowidth":"")},t.attrs.title?r()("div",{class:"title"},t.attrs.title):"",r()("select",{onchange:function(e){!function(t,e){t.state.value=e,t.attrs.onchange&&t.attrs.onchange(e);t.attrs.onblur&&t.attrs.onblur(e)}(t,e.target.value)},onkeyup:function(t){13===(null==t?void 0:t.which)&&t.target.blur(),t.redraw=!1},tabindex:t.attrs.tabindex||"1",value:t.state.value},t.attrs.placeholder?r()("option",{value:"",disabled:!0},t.attrs.placeholder):"",t.attrs.options.map((function(t){return r()("option",{value:t.value,disabled:!0===t.disabled},t.label)}))),r()("div",{class:"saveui"},r()("i",{class:"saving far fa-spin fa-sync-alt"})," saving"))}};var cp=i(4130),up={insert:"head",singleton:!1};wf()(cp.Z,up);cp.Z.locals;var dp={oninit:function(t){t.state.isOpen=!1},view:function(t){var e;return r()("dialog",{class:"comp dialog ".concat(t.attrs.autowidth?"autowidth":""," ").concat(t.attrs.isLightbox?"isLightbox":""),onclick:function(e){e.redraw=!1,function(t,e){t.dom===(null==e?void 0:e.target)&&fp(t,void 0)}(t,e)},oncancel:function(t){var e;t.redraw=!1,null==t||null===(e=t.preventDefault)||void 0===e||e.call(t)},style:"margin-top: ".concat(null!==(e=t.attrs.topmargin)&&void 0!==e?e:"20vh")},r()("div",{class:"content"},t.children),r()("div",{class:"reactions"},t.attrs.isLightbox?null:t.attrs.isAlert?r()("button",{autofocus:!0,onclick:function(e){e.redraw=!1,fp(t,!0)}},"Ok"):[r()("button",{onclick:function(e){e.redraw=!1,fp(t,!1)},key:"0"},"Cancel"),r()("button",{autofocus:!0,onclick:function(e){e.redraw=!1,fp(t,!0)},key:"1"},"Confirm")]))},onupdate:function(t){t.state.isOpen!==t.attrs.isOpen&&(t.attrs.isOpen?t.dom.showModal():(t.dom.classList.add("hide"),window.setTimeout((function(){t.dom.close(),t.dom.classList.remove("hide")}),200)),t.state.isOpen=t.attrs.isOpen)}};function fp(t,e){var i,n;null===(i=(n=t.attrs).onAnswer)||void 0===i||i.call(n,e),r().redraw()}function pp(t){return pp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pp(t)}function gp(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function mp(t,e,i){var n;return n=function(t,e){if("object"!=pp(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=pp(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"),(e="symbol"==pp(n)?n:String(n))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var vp={oninit:function(t){t.attrs.onnewfile=t.attrs.onnewfile||function(){},t.state.error={dialogIsOpen:!1,message:""},t.state.sheetSelection={dialogIsOpen:!1,sheetNames:[],selectedSheet:void 0,resolve:function(){},reject:function(){}}},view:function(t){return r()("div",{class:"comp loadsourcefile"},r()(lp,{title:"Add your dataset<br/><i>.xlsx or .csv</i>",accept:".csv, .xls, .xlsx, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel, application/vnd.oasis.opendocument.spreadsheet",onblur:function(e){window.setTimeout((function(){var i;(i=e[0],new Promise((function(t,e){try{if(/^image/.test(i.type)||/^application\/pdf/.test(i.type))return console.error(i.type),void e("Something went wrong while reading the file. This is not an XLSX like file. Error: 01");var n=new FileReader;n.onload=function(i){try{var n=xu(new Uint8Array(i.target.result),{type:"array"});t(n)}catch(t){e("Something went wrong while reading the file. This is not an XLSX like file. Error: 04")}},n.readAsArrayBuffer(i)}catch(t){console.error(t),e("Something went wrong while reading the file. Error: 02")}}))).then((function(e){return function(t,e){return new Promise((function(i,n){var s=e.SheetNames;if(0==s.length)console.error(e.Sheets),n("Something went wrong while reading the file. Error: 03");else if(1==s.length)i(e.Sheets[s[0]]);else{var a=s.map((function(t,e){return{value:t,label:t}}));t.state.sheetSelection={dialogIsOpen:!0,sheetNames:a,selectedSheet:a[0].value,reject:n,resolve:function(t){i(e.Sheets[t])}},r().redraw()}}))}(t,e)})).then(yp).then(bp).then(_p).then(xp).then((function(i){var n=e[0].name.split(".").slice(0,-1).join(".");return t.state.sheetSelection.selectedSheet&&(n=t.state.sheetSelection.selectedSheet),g.docstore.set("dataset",{name:n,raw:{name:e[0].name,size:e[0].size,file:e[0]},data:{poles:i,length:i.length}})})).then((function(e){t.state.sheetSelection.selectedSheet=void 0,t.attrs.onnewfile()})).catch((function(e){t.state.error.dialogIsOpen=!0,t.state.error.message=e,r().redraw()}))}),100)}}),r()(dp,{isOpen:t.state.sheetSelection.dialogIsOpen,onAnswer:function(e){void 0===e||!1===e?t.state.sheetSelection.reject("The import was canceled"):t.state.sheetSelection.resolve(t.state.sheetSelection.selectedSheet),t.state.sheetSelection.dialogIsOpen=!1}},r()("h4",{key:"title"},"From what sheet do you want to import data?"),r()("div",{key:t.state.sheetSelection.dialogIsOpen}," ",r()(hp,{title:"Sheet:",autowidth:!0,value:t.state.sheetSelection.selectedSheet,options:t.state.sheetSelection.sheetNames,onblur:function(e){t.state.sheetSelection.selectedSheet=e}}))),r()(dp,{isAlert:!0,isOpen:t.state.error.dialogIsOpen,onAnswer:function(e){t.state.error.dialogIsOpen=!1}},r()("h4",null,"File is not loaded in."),t.state.error.message))}};function yp(t){return new Promise((function(e,i){e(Bu.sheet_to_json(t,{blankrows:!1,defval:null}))}))}function bp(t){return new Promise((function(e,i){!1!==Array.isArray(t)&&0!==t.length?(v.datasetImportAliases.forEach((function(e){t=t.map((function(t){return void 0===t[e.orig]&&void 0!==t[e.alias]&&(t[e.orig]=t[e.alias],delete t[e.alias]),t}))})),v.datasetImportDefaults.forEach((function(e){t=t.map((function(t){return void 0===t[e.field]&&(t[e.field]=e.value),t}))})),console.log(t),e(t)):i("No data was found in this file.")}))}function _p(t){return new Promise((function(e,i){if(!1!==Array.isArray(t)&&0!==t.length){var n=v.datasetImportValidation.map((function(e){return function(t){var e={field:"",type:"number",cond:function(t,e){return!0},condMsg:"",optional:!1,rows:[]};t=g.general.merge(e,t);var i={passed:!0,msg:""};return t.rows.forEach((function(e,n){var r=n+2;if(!1!==i.passed&&(!0!==t.optional||void 0!==e[t.field]&&null!==e[t.field])){if(void 0===e[t.field])return i.msg='The column "'.concat(t.field,'" is required but not present'),void(i.passed=!1);if(null===e[t.field])return i.msg='The value "'.concat(t.field,'" on row ').concat(r," is required but not found"),void(i.passed=!1);if(pp(e[t.field])!==t.type)return i.msg='The field "'.concat(t.field,'" on row ').concat(r," is not a ").concat(t.type,'. The value of "').concat(t.field,'" is "').concat(e[t.field],'" and has type "').concat(pp(e[t.field]),'"'),void(i.passed=!1);if("number"===t.type&&isNaN(e[t.field]))return i.msg='The field "'.concat(t.field,'" on row ').concat(r,' is not a valid number. The value of "').concat(t.field,'" is "').concat(e[t.field],'"'),void(i.passed=!1);if(!1===t.cond(e[t.field],e))return i.msg='The field "'.concat(t.field,'" on row ').concat(r," has to be ").concat(t.condMsg,'. The value of "').concat(t.field,'" is "').concat(e[t.field],'"'),void(i.passed=!1)}})),i}(function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?gp(Object(i),!0).forEach((function(e){mp(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):gp(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({rows:t},e))})),r=n.find((function(t){return!1===t.passed}));void 0===r?(t.forEach((function(t,e){var n=e+2;void 0!==t.plat&&null!==t.plat||void 0!==t.mdec&&null!==t.mdec||i("Either plat and plon, or mdec and minc have to be defined for each row. Row "+n+" is missing both.")})),e(t)):i(r.msg)}else i("No data was found in this file.")}))}function xp(t){return t.map((function(t,e){return void 0!==t.name&&null!==t.name||(t.name="Sample "+(e+1)),t}))}var wp=i(7991),Sp={insert:"head",singleton:!1};wf()(wp.Z,Sp);wp.Z.locals;var Tp=i(3017),Ep={insert:"head",singleton:!1};wf()(Tp.Z,Ep);Tp.Z.locals;var kp=i(9209),Cp={insert:"head",singleton:!1};wf()(kp.Z,Cp);kp.Z.locals;const Mp=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},Ap="propertychange";const Op=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function Pp(t,e){return t>e?1:t<e?-1:0}function Rp(t,e,i){if(t[0]<=e)return 0;const n=t.length;if(e<=t[n-1])return n-1;if("function"==typeof i){for(let r=1;r<n;++r){const n=t[r];if(n===e)return r;if(n<e)return i(e,t[r-1],n)>0?r-1:r}return n-1}if(i>0){for(let i=1;i<n;++i)if(t[i]<e)return i-1;return n-1}if(i<0){for(let i=1;i<n;++i)if(t[i]<=e)return i;return n-1}for(let i=1;i<n;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return n-1}function Ip(t,e,i){for(;e<i;){const n=t[e];t[e]=t[i],t[i]=n,++e,--i}}function Lp(t,e){const i=Array.isArray(e)?e:[e],n=i.length;for(let e=0;e<n;e++)t[t.length]=i[e]}function Dp(t,e){const i=t.length;if(i!==e.length)return!1;for(let n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Np(){return!0}function Fp(){return!1}function jp(){}function Bp(t){for(const e in t)delete t[e]}function zp(t){let e;for(e in t)return!1;return!e}const Wp=class extends Op{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),n=i[t]||(i[t]=[]);n.includes(e)||n.push(e)}dispatchEvent(t){const e="string"==typeof t,i=e?t:t.type,n=this.listeners_&&this.listeners_[i];if(!n)return;const r=e?new Mp(t):t;r.target||(r.target=this.eventTarget_||this);const s=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});let o;i in s||(s[i]=0,a[i]=0),++s[i];for(let t=0,e=n.length;t<e;++t)if(o="handleEvent"in n[t]?n[t].handleEvent(r):n[t].call(this,r),!1===o||r.propagationStopped){o=!1;break}if(0==--s[i]){let t=a[i];for(delete a[i];t--;)this.removeEventListener(i,jp);delete s[i]}return o}disposeInternal(){this.listeners_&&Bp(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(t,e){const i=this.listeners_&&this.listeners_[t];if(i){const n=i.indexOf(e);-1!==n&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[n]=jp,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t]))}}},Gp="change",Up="error",Hp="contextmenu",Xp="click",Vp="dblclick",Yp="keydown",Kp="keypress",qp="load",Zp="touchmove",Jp="wheel";function $p(t,e,i,n,r){if(n&&n!==t&&(i=i.bind(n)),r){const n=i;i=function(){t.removeEventListener(e,i),n.apply(this,arguments)}}const s={target:t,type:e,listener:i};return t.addEventListener(e,i),s}function Qp(t,e,i,n){return $p(t,e,i,n,!0)}function tg(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),Bp(t))}class eg extends Wp{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Gp)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=$p(this,t[r],e);return n}return $p(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const n=t.length;i=new Array(n);for(let r=0;r<n;++r)i[r]=Qp(this,t[r],e)}else i=Qp(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)!function(t){if(Array.isArray(t))for(let e=0,i=t.length;e<i;++e)tg(t[e]);else tg(t)}(i);else if(Array.isArray(t))for(let i=0,n=t.length;i<n;++i)this.removeEventListener(t[i],e);else this.removeEventListener(t,e)}}eg.prototype.on,eg.prototype.once,eg.prototype.un;const ig=eg;function ng(){throw new Error("Unimplemented abstract method.")}let rg=0;function sg(t){return t.ol_uid||(t.ol_uid=String(++rg))}class ag extends Mp{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}const og=class extends ig{constructor(t){super(),this.on,this.once,this.un,sg(this),this.values_=null,void 0!==t&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new ag(i,t,e)),i=Ap,this.hasListener(i)&&this.dispatchEvent(new ag(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const n=this.values_||(this.values_={});if(i)n[t]=e;else{const i=n[t];n[t]=e,i!==e&&this.notify(t,i)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],zp(this.values_)&&(this.values_=null),e||this.notify(t,i)}}},lg={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:'`renderMode` must be `"hybrid"` or `"vector"`',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection",69:"`width` or `height` cannot be provided together with `scale`"};class hg extends Error{constructor(t){const e=lg[t];super(e),this.code=t,this.name="AssertionError",this.message=e}}const cg=hg,ug="add",dg="remove",fg="length";class pg extends Mp{constructor(t,e,i){super(t),this.element=e,this.index=i}}const gg=class extends og{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(fg)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new pg(ug,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new pg(dg,e,t)),e}setAt(t,e){if(t>=this.getLength())return void this.insertAt(t,e);if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new pg(dg,i,t)),this.dispatchEvent(new pg(ug,e,t))}updateLength_(){this.set(fg,this.array_.length)}assertUnique_(t,e){for(let i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new cg(58)}},mg="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",vg=mg.includes("firefox"),yg=(mg.includes("safari")&&!mg.includes("chrom")&&(mg.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(mg)),mg.includes("webkit")&&!mg.includes("edge")),bg=mg.includes("macintosh"),_g="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,xg="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,wg="undefined"!=typeof Image&&Image.prototype.decode,Sg=function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}();function Tg(t,e){if(!t)throw new cg(e)}new Array(6);function Eg(t,e){const i=t[0],n=t[1],r=t[2],s=t[3],a=t[4],o=t[5],l=e[0],h=e[1],c=e[2],u=e[3],d=e[4],f=e[5];return t[0]=i*l+r*h,t[1]=n*l+s*h,t[2]=i*c+r*u,t[3]=n*c+s*u,t[4]=i*d+r*f+a,t[5]=n*d+s*f+o,t}function kg(t,e,i,n,r,s,a){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=s,t[5]=a,t}function Cg(t,e){const i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function Mg(t,e,i,n,r,s,a,o){const l=Math.sin(s),h=Math.cos(s);return t[0]=n*h,t[1]=r*l,t[2]=-n*l,t[3]=r*h,t[4]=a*n*h-o*n*l+e,t[5]=a*r*l+o*r*h+i,t}function Ag(t,e){const i=(n=e)[0]*n[3]-n[1]*n[2];var n;Tg(0!==i,32);const r=e[0],s=e[1],a=e[2],o=e[3],l=e[4],h=e[5];return t[0]=o/i,t[1]=-s/i,t[2]=-a/i,t[3]=r/i,t[4]=(a*h-o*l)/i,t[5]=-(r*h-s*l)/i,t}let Og;function Pg(t){const e="matrix("+t.join(", ")+")";if(xg)return e;const i=Og||(Og=document.createElement("div"));return i.style.transform=e,i.style.transform}const Rg={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Ig(t){const e=Wg();for(let i=0,n=t.length;i<n;++i)Xg(e,t[i]);return e}function Lg(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function Dg(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function Ng(t,e,i){let n,r;return n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0,r=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0,n*n+r*r}function Fg(t,e){return Bg(t,e[0],e[1])}function jg(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function Bg(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function zg(t,e){const i=t[0],n=t[1],r=t[2],s=t[3],a=e[0],o=e[1];let l=Rg.UNKNOWN;return a<i?l|=Rg.LEFT:a>r&&(l|=Rg.RIGHT),o<n?l|=Rg.BELOW:o>s&&(l|=Rg.ABOVE),l===Rg.UNKNOWN&&(l=Rg.INTERSECTING),l}function Wg(){return[1/0,1/0,-1/0,-1/0]}function Gg(t,e,i,n,r){return r?(r[0]=t,r[1]=e,r[2]=i,r[3]=n,r):[t,e,i,n]}function Ug(t){return Gg(1/0,1/0,-1/0,-1/0,t)}function Hg(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function Xg(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Vg(t,e,i,n,r){for(;i<n;i+=r)Yg(t,e[i],e[i+1]);return t}function Yg(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function Kg(t,e){let i;return i=e(Zg(t)),i||(i=e(Jg(t)),i||(i=e(sm(t)),i||(i=e(rm(t)),i||!1)))}function qg(t){let e=0;return lm(t)||(e=am(t)*im(t)),e}function Zg(t){return[t[0],t[1]]}function Jg(t){return[t[2],t[1]]}function $g(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function Qg(t,e){let i;return"bottom-left"===e?i=Zg(t):"bottom-right"===e?i=Jg(t):"top-left"===e?i=rm(t):"top-right"===e?i=sm(t):Tg(!1,13),i}function tm(t,e,i,n,r){const[s,a,o,l,h,c,u,d]=em(t,e,i,n);return Gg(Math.min(s,o,h,u),Math.min(a,l,c,d),Math.max(s,o,h,u),Math.max(a,l,c,d),r)}function em(t,e,i,n){const r=e*n[0]/2,s=e*n[1]/2,a=Math.cos(i),o=Math.sin(i),l=r*a,h=r*o,c=s*a,u=s*o,d=t[0],f=t[1];return[d-l+u,f-h-c,d-l-u,f-h+c,d+l-u,f+h+c,d+l+u,f+h-c,d-l+u,f-h-c]}function im(t){return t[3]-t[1]}function nm(t,e,i){const n=i||[1/0,1/0,-1/0,-1/0];return om(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):Ug(n),n}function rm(t){return[t[0],t[3]]}function sm(t){return[t[2],t[3]]}function am(t){return t[2]-t[0]}function om(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function lm(t){return t[2]<t[0]||t[3]<t[1]}function hm(t,e,i,n){if(lm(t))return Ug(i);let r=[];if(n>1){const e=t[2]-t[0],i=t[3]-t[1];for(let s=0;s<n;++s)r.push(t[0]+e*s/n,t[1],t[2],t[1]+i*s/n,t[2]-e*s/n,t[3],t[0],t[3]-i*s/n)}else r=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(r,r,2);const s=[],a=[];for(let t=0,e=r.length;t<e;t+=2)s.push(r[t]),a.push(r[t+1]);return function(t,e,i){return Gg(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),i)}(s,a,i)}function cm(t,e){const i=e.getExtent(),n=$g(t);if(e.canWrapX()&&(n[0]<i[0]||n[0]>=i[2])){const e=am(i),r=Math.floor((n[0]-i[0])/e)*e;t[0]-=r,t[2]-=r}return t}function um(t,e,i){return Math.min(Math.max(t,e),i)}function dm(t,e,i,n,r,s){const a=r-i,o=s-n;if(0!==a||0!==o){const l=((t-i)*a+(e-n)*o)/(a*a+o*o);l>1?(i=r,n=s):l>0&&(i+=a*l,n+=o*l)}return fm(t,e,i,n)}function fm(t,e,i,n){const r=i-t,s=n-e;return r*r+s*s}function pm(t){return 180*t/Math.PI}function gm(t){return t*Math.PI/180}function mm(t,e){const i=t%e;return i*e<0?i+e:i}function vm(t,e,i){return t+i*(e-t)}function ym(t,e){const i=Math.pow(10,e);return Math.round(t*i)/i}function bm(t,e){return Math.floor(ym(t,e))}function _m(t,e){return Math.ceil(ym(t,e))}const xm=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,wm=/^([a-z]*)$|^hsla?\(.*\)$/i;function Sm(t){return"string"==typeof t?t:Mm(t)}function Tm(t){const e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);const t=getComputedStyle(e).color;return document.body.removeChild(e),t}return""}const Em=function(){const t={};let e=0;return function(i){let n;if(t.hasOwnProperty(i))n=t[i];else{if(e>=1024){let i=0;for(const n in t)0==(3&i++)&&(delete t[n],--e)}n=function(t){let e,i,n,r,s;wm.exec(t)&&(t=Tm(t));if(xm.exec(t)){const a=t.length-1;let o;o=a<=4?1:2;const l=4===a||8===a;e=parseInt(t.substr(1+0*o,o),16),i=parseInt(t.substr(1+1*o,o),16),n=parseInt(t.substr(1+2*o,o),16),r=l?parseInt(t.substr(1+3*o,o),16):255,1==o&&(e=(e<<4)+e,i=(i<<4)+i,n=(n<<4)+n,l&&(r=(r<<4)+r)),s=[e,i,n,r/255]}else t.startsWith("rgba(")?(s=t.slice(5,-1).split(",").map(Number),Cm(s)):t.startsWith("rgb(")?(s=t.slice(4,-1).split(",").map(Number),s.push(1),Cm(s)):Tg(!1,14);return s}(i),t[i]=n,++e}return n}}();function km(t){return Array.isArray(t)?t:Em(t)}function Cm(t){return t[0]=um(t[0]+.5|0,0,255),t[1]=um(t[1]+.5|0,0,255),t[2]=um(t[2]+.5|0,0,255),t[3]=um(t[3],0,1),t}function Mm(t){let e=t[0];e!=(0|e)&&(e=e+.5|0);let i=t[1];i!=(0|i)&&(i=i+.5|0);let n=t[2];n!=(0|n)&&(n=n+.5|0);return"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:Math.round(100*t[3])/100)+")"}class Am{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}}get(t,e,i){const n=Om(t,e,i);return n in this.cache_?this.cache_[n]:null}set(t,e,i,n){const r=Om(t,e,i);this.cache_[r]=n,++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function Om(t,e,i){return e+":"+t+":"+(i?Sm(i):"null")}const Pm=new Am,Rm="opacity",Im="visible",Lm="extent",Dm="zIndex",Nm="maxResolution",Fm="minResolution",jm="maxZoom",Bm="minZoom",zm="source",Wm="map";const Gm=class extends og{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);"object"==typeof t.properties&&(delete e.properties,Object.assign(e,t.properties)),e[Rm]=void 0!==t.opacity?t.opacity:1,Tg("number"==typeof e[Rm],64),e[Im]=void 0===t.visible||t.visible,e[Dm]=t.zIndex,e[Nm]=void 0!==t.maxResolution?t.maxResolution:1/0,e[Fm]=void 0!==t.minResolution?t.minResolution:0,e[Bm]=void 0!==t.minZoom?t.minZoom:-1/0,e[jm]=void 0!==t.maxZoom?t.maxZoom:1/0,this.className_=void 0!==e.className?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:void 0===t||t},i=this.getZIndex();return e.opacity=um(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==i||e.managed?i:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return ng()}getLayerStatesArray(t){return ng()}getExtent(){return this.get(Lm)}getMaxResolution(){return this.get(Nm)}getMinResolution(){return this.get(Fm)}getMinZoom(){return this.get(Bm)}getMaxZoom(){return this.get(jm)}getOpacity(){return this.get(Rm)}getSourceState(){return ng()}getVisible(){return this.get(Im)}getZIndex(){return this.get(Dm)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(Lm,t)}setMaxResolution(t){this.set(Nm,t)}setMinResolution(t){this.set(Fm,t)}setMaxZoom(t){this.set(jm,t)}setMinZoom(t){this.set(Bm,t)}setOpacity(t){Tg("number"==typeof t,64),this.set(Rm,t)}setVisible(t){this.set(Im,t)}setZIndex(t){this.set(Dm,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},Um="prerender",Hm="postrender",Xm="precompose",Vm="postcompose",Ym="rendercomplete",Km=0,qm=1,Zm={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},Jm=42,$m=256;const Qm={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};const tv=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Qm[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},ev=6378137,iv=Math.PI*ev,nv=[-iv,-iv,iv,iv],rv=[-180,-85,180,85],sv=ev*Math.log(Math.tan(Math.PI/2));class av extends tv{constructor(t){super({code:t,units:"m",extent:nv,global:!0,worldExtent:rv,getPointResolution:function(t,e){return t/Math.cosh(e[1]/ev)}})}}const ov=[new av("EPSG:3857"),new av("EPSG:102100"),new av("EPSG:102113"),new av("EPSG:900913"),new av("http://www.opengis.net/def/crs/EPSG/0/3857"),new av("http://www.opengis.net/gml/srs/epsg.xml#3857")];function lv(t,e,i){const n=t.length;i=i>1?i:2,void 0===e&&(e=i>2?t.slice():new Array(n));for(let r=0;r<n;r+=i){e[r]=iv*t[r]/180;let i=ev*Math.log(Math.tan(Math.PI*(+t[r+1]+90)/360));i>sv?i=sv:i<-sv&&(i=-sv),e[r+1]=i}return e}function hv(t,e,i){const n=t.length;i=i>1?i:2,void 0===e&&(e=i>2?t.slice():new Array(n));for(let r=0;r<n;r+=i)e[r]=180*t[r]/iv,e[r+1]=360*Math.atan(Math.exp(t[r+1]/ev))/Math.PI-90;return e}const cv=[-180,-90,180,90],uv=6378137*Math.PI/180;class dv extends tv{constructor(t,e){super({code:t,units:"degrees",extent:cv,axisOrientation:e,global:!0,metersPerUnit:uv,worldExtent:cv})}}const fv=[new dv("CRS:84"),new dv("EPSG:4326","neu"),new dv("urn:ogc:def:crs:OGC:1.3:CRS84"),new dv("urn:ogc:def:crs:OGC:2:84"),new dv("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new dv("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new dv("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let pv={};let gv={};function mv(t,e,i){const n=t.getCode(),r=e.getCode();n in gv||(gv[n]={}),gv[n][r]=i}function vv(t,e){let i;return t in gv&&e in gv[t]&&(i=gv[t][e]),i}function yv(t,e,i){const n=void 0!==i?t.toFixed(i):""+t;let r=n.indexOf(".");return r=-1===r?n.length:r,r>e?n:new Array(1+e-r).join("0")+n}function bv(t,e,i){const n=mm(e+180,360)-180,r=Math.abs(3600*n),s=i||0;let a=Math.floor(r/3600),o=Math.floor((r-3600*a)/60),l=ym(r-3600*a-60*o,s);l>=60&&(l=0,o+=1),o>=60&&(o=0,a+=1);let h=a+"°";return 0===o&&0===l||(h+=" "+yv(o,2)+"′"),0!==l&&(h+=" "+yv(l,2,s)+"″"),0!==n&&(h+=" "+t.charAt(n<0?1:0)),h}function _v(t,e){let i=!0;for(let n=t.length-1;n>=0;--n)if(t[n]!=e[n]){i=!1;break}return i}function xv(t,e){const i=Math.cos(e),n=Math.sin(e),r=t[0]*i-t[1]*n,s=t[1]*i+t[0]*n;return t[0]=r,t[1]=s,t}function wv(t,e){if(e.canWrapX()){const i=am(e.getExtent()),n=Sv(t,e,i);n&&(t[0]-=n*i)}return t}function Sv(t,e,i){const n=e.getExtent();let r=0;return e.canWrapX()&&(t[0]<n[0]||t[0]>n[2])&&(i=i||am(n),r=Math.floor((t[0]-n[0])/i)),r}const Tv=6371008.8;function Ev(t,e,i){i=i||Tv;const n=gm(t[1]),r=gm(e[1]),s=(r-n)/2,a=gm(e[0]-t[0])/2,o=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(n)*Math.cos(r);return 2*i*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}function kv(t,e,i,n){n=n||Tv;const r=gm(t[1]),s=gm(t[0]),a=e/n,o=Math.asin(Math.sin(r)*Math.cos(a)+Math.cos(r)*Math.sin(a)*Math.cos(i));return[pm(s+Math.atan2(Math.sin(i)*Math.sin(a)*Math.cos(r),Math.cos(a)-Math.sin(r)*Math.sin(o))),pm(o)]}const Cv={info:1,warn:2,error:3,none:4};let Mv=Cv.info;function Av(...t){Mv>Cv.warn||console.warn(...t)}let Ov=!0;function Pv(t){Ov=!(void 0===t||t)}function Rv(t,e){if(void 0!==e)for(let i=0,n=t.length;i<n;++i)e[i]=t[i];else e=t.slice();return e}function Iv(t,e){if(void 0!==e&&t!==e){for(let i=0,n=t.length;i<n;++i)e[i]=t[i];t=e}return t}function Lv(t){!function(t,e){pv[t]=e}(t.getCode(),t),mv(t,t,Rv)}function Dv(t){return"string"==typeof t?pv[e=t]||pv[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function Nv(t,e,i,n){let r;const s=(t=Dv(t)).getPointResolutionFunc();if(s){if(r=s(e,i),n&&n!==t.getUnits()){const e=t.getMetersPerUnit();e&&(r=r*e/Qm[n])}}else{const s=t.getUnits();if("degrees"==s&&!n||"degrees"==n)r=e;else{const a=Gv(t,Dv("EPSG:4326"));if(a===Iv&&"degrees"!==s)r=e*t.getMetersPerUnit();else{let t=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];t=a(t,t,2);r=(Ev(t.slice(0,2),t.slice(2,4))+Ev(t.slice(4,6),t.slice(6,8)))/2}const o=n?Qm[n]:t.getMetersPerUnit();void 0!==o&&(r/=o)}}return r}function Fv(t){!function(t){t.forEach(Lv)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&mv(e,t,Rv)}))}))}function jv(t,e){return t?"string"==typeof t?Dv(t):t:Dv(e)}function Bv(t){return function(e,i,n){const r=e.length;n=void 0!==n?n:2,i=void 0!==i?i:new Array(r);for(let s=0;s<r;s+=n){const r=t(e.slice(s,s+n)),a=r.length;for(let t=0,o=n;t<o;++t)i[s+t]=t>=a?e[s+t]:r[t]}return i}}function zv(t,e,i,n){const r=Dv(t),s=Dv(e);mv(r,s,Bv(i)),mv(s,r,Bv(n))}function Wv(t,e){if(t===e)return!0;const i=t.getUnits()===e.getUnits();if(t.getCode()===e.getCode())return i;return Gv(t,e)===Rv&&i}function Gv(t,e){let i=vv(t.getCode(),e.getCode());return i||(i=Iv),i}function Uv(t,e){return Gv(Dv(t),Dv(e))}function Hv(t,e,i){return Uv(e,i)(t,void 0,t.length)}function Xv(t,e,i,n){return hm(t,Uv(e,i),void 0,n)}let Vv=null;function Yv(){return Vv}function Kv(t,e){return Vv?Hv(t,e,Vv):t}function qv(t,e){return Vv?Hv(t,Vv,e):(Ov&&!_v(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(Ov=!1,Av("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t)}function Zv(t,e){return Vv?Xv(t,e,Vv):t}function Jv(t,e){return Vv?Xv(t,Vv,e):t}function $v(t,e){if(!Vv)return t;const i=Dv(e).getUnits(),n=Vv.getUnits();return i&&n?t*Qm[i]/Qm[n]:t}function Qv(t,e,i){return function(n){let r,s;if(t.canWrapX()){const e=t.getExtent(),a=am(e);s=Sv(n=n.slice(0),t,a),s&&(n[0]=n[0]-s*a),n[0]=um(n[0],e[0],e[2]),n[1]=um(n[1],e[1],e[3]),r=i(n)}else r=i(n);return s&&e.canWrapX()&&(r[0]+=s*am(e.getExtent())),r}}var ty,ey,iy;function ny(t,e,i){return function(n,r,s,a,o){if(!n)return;if(!r&&!e)return n;const l=e?0:s[0]*r,h=e?0:s[1]*r,c=o?o[0]:0,u=o?o[1]:0;let d=t[0]+l/2+c,f=t[2]-l/2+c,p=t[1]+h/2+u,g=t[3]-h/2+u;d>f&&(d=(f+d)/2,f=d),p>g&&(p=(g+p)/2,g=p);let m=um(n[0],d,f),v=um(n[1],p,g);if(a&&i&&r){const t=30*r;m+=-t*Math.log(1+Math.max(0,d-n[0])/t)+t*Math.log(1+Math.max(0,n[0]-f)/t),v+=-t*Math.log(1+Math.max(0,p-n[1])/t)+t*Math.log(1+Math.max(0,n[1]-g)/t)}return[m,v]}}function ry(t){return t}function sy(t,e,i,n){const r=am(e)/i[0],s=im(e)/i[1];return n?Math.min(t,Math.max(r,s)):Math.min(t,Math.min(r,s))}function ay(t,e,i){let n=Math.min(t,e);return n*=Math.log(1+50*Math.max(0,t/e-1))/50+1,i&&(n=Math.max(n,i),n/=Math.log(1+50*Math.max(0,i/t-1))/50+1),um(n,i/2,2*e)}function oy(t,e,i,n,r){return i=void 0===i||i,function(s,a,o,l){if(void 0!==s){const a=n?sy(t,n,o,r):t;return i&&l?ay(s,a,e):um(s,e,a)}}}function ly(t){if(void 0!==t)return 0}function hy(t){if(void 0!==t)return t}function cy(t){return Math.pow(t,3)}function uy(t){return 1-cy(1-t)}function dy(t){return 3*t*t-2*t*t*t}function fy(t){return t}function py(t,e,i,n,r,s){s=s||[];let a=0;for(let o=e;o<i;o+=n){const e=t[o],i=t[o+1];s[a++]=r[0]*e+r[2]*i+r[4],s[a++]=r[1]*e+r[3]*i+r[5]}return s&&s.length!=a&&(s.length=a),s}function gy(t,e,i,n,r,s,a){a=a||[];const o=Math.cos(r),l=Math.sin(r),h=s[0],c=s[1];let u=0;for(let r=e;r<i;r+=n){const e=t[r]-h,i=t[r+1]-c;a[u++]=h+e*o-i*l,a[u++]=c+e*l+i*o;for(let e=r+2;e<r+n;++e)a[u++]=t[e]}return a&&a.length!=u&&(a.length=u),a}Fv(ov),Fv(fv),ty=ov,ey=lv,iy=hv,fv.forEach((function(t){ty.forEach((function(e){mv(t,e,ey),mv(e,t,iy)}))}));const my=[1,0,0,1,0,0];const vy=class extends og{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=function(t){let e,i,n,r=!1;return function(){const s=Array.prototype.slice.call(arguments);return r&&this===n&&Dp(s,i)||(r=!0,n=this,i=s,e=t.apply(this,arguments)),e}}((function(t,e,i){if(!i)return this.getSimplifiedGeometry(e);const n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)}))}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return ng()}closestPointXY(t,e,i,n){return ng()}containsXY(t,e){const i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return ng()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Ug(t),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}rotate(t,e){ng()}scale(t,e,i){ng()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return ng()}getType(){return ng()}applyTransform(t){ng()}intersectsExtent(t){return ng()}translate(t,e){ng()}transform(t,e){const i=Dv(t),n="tile-pixels"==i.getUnits()?function(t,n,r){const s=i.getExtent(),a=i.getWorldExtent(),o=im(a)/im(s);return Mg(my,a[0],a[3],o,-o,0,0,0),py(t,0,t.length,r,my,n),Uv(i,e)(t,n,r)}:Uv(i,e);return this.applyTransform(n),this}};function yy(t){let e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}const by=class extends vy{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates=null}computeExtent(t){return function(t,e,i,n,r){return Vg(Ug(r),t,e,i,n)}(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return ng()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=yy(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){ng()}setLayout(t,e,i){let n;if(t)n=yy(t);else{for(let t=0;t<i;++t){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}n=e.length,t=function(t){let e;2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM");return e}(n)}this.layout=t,this.stride=n}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();gy(i,0,i.length,n,t,e,i),this.changed()}}scale(t,e,i){void 0===e&&(e=t),i||(i=$g(this.getExtent()));const n=this.getFlatCoordinates();if(n){const r=this.getStride();!function(t,e,i,n,r,s,a,o){o=o||[];const l=a[0],h=a[1];let c=0;for(let a=e;a<i;a+=n){const e=t[a]-l,i=t[a+1]-h;o[c++]=l+r*e,o[c++]=h+s*i;for(let e=a+2;e<a+n;++e)o[c++]=t[e]}o&&o.length!=c&&(o.length=c)}(n,0,n.length,r,t,e,i,n),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();!function(t,e,i,n,r,s,a){a=a||[];let o=0;for(let l=e;l<i;l+=n){a[o++]=t[l]+r,a[o++]=t[l+1]+s;for(let e=l+2;e<l+n;++e)a[o++]=t[e]}a&&a.length!=o&&(a.length=o)}(i,0,i.length,n,t,e,i),this.changed()}}};function _y(t,e,i,n,r,s,a){const o=t[e],l=t[e+1],h=t[i]-o,c=t[i+1]-l;let u;if(0===h&&0===c)u=e;else{const d=((r-o)*h+(s-l)*c)/(h*h+c*c);if(d>1)u=i;else{if(d>0){for(let r=0;r<n;++r)a[r]=vm(t[e+r],t[i+r],d);return void(a.length=n)}u=e}}for(let e=0;e<n;++e)a[e]=t[u+e];a.length=n}function xy(t,e,i,n,r){let s=t[e],a=t[e+1];for(e+=n;e<i;e+=n){const i=t[e],n=t[e+1],o=fm(s,a,i,n);o>r&&(r=o),s=i,a=n}return r}function wy(t,e,i,n,r){for(let s=0,a=i.length;s<a;++s){const a=i[s];r=xy(t,e,a,n,r),e=a}return r}function Sy(t,e,i,n,r,s,a,o,l,h,c){if(e==i)return h;let u,d;if(0===r){if(d=fm(a,o,t[e],t[e+1]),d<h){for(u=0;u<n;++u)l[u]=t[e+u];return l.length=n,d}return h}c=c||[NaN,NaN];let f=e+n;for(;f<i;)if(_y(t,f-n,f,n,a,o,c),d=fm(a,o,c[0],c[1]),d<h){for(h=d,u=0;u<n;++u)l[u]=c[u];l.length=n,f+=n}else f+=n*Math.max((Math.sqrt(d)-Math.sqrt(h))/r|0,1);if(s&&(_y(t,i-n,e,n,a,o,c),d=fm(a,o,c[0],c[1]),d<h)){for(h=d,u=0;u<n;++u)l[u]=c[u];l.length=n}return h}function Ty(t,e,i,n,r,s,a,o,l,h,c){c=c||[NaN,NaN];for(let u=0,d=i.length;u<d;++u){const d=i[u];h=Sy(t,e,d,n,r,s,a,o,l,h,c),e=d}return h}function Ey(t,e,i,n){for(let r=0,s=i.length;r<s;++r){const s=i[r];for(let i=0;i<n;++i)t[e++]=s[i]}return e}function ky(t,e,i,n,r){r=r||[];let s=0;for(let a=0,o=i.length;a<o;++a){const o=Ey(t,e,i[a],n);r[s++]=o,e=o}return r.length=s,r}function Cy(t,e,i,n,r,s,a){const o=(i-e)/n;if(o<3){for(;e<i;e+=n)s[a++]=t[e],s[a++]=t[e+1];return a}const l=new Array(o);l[0]=1,l[o-1]=1;const h=[e,i-n];let c=0;for(;h.length>0;){const i=h.pop(),s=h.pop();let a=0;const o=t[s],u=t[s+1],d=t[i],f=t[i+1];for(let e=s+n;e<i;e+=n){const i=dm(t[e],t[e+1],o,u,d,f);i>a&&(c=e,a=i)}a>r&&(l[(c-e)/n]=1,s+n<c&&h.push(s,c),c+n<i&&h.push(c,i))}for(let i=0;i<o;++i)l[i]&&(s[a++]=t[e+i*n],s[a++]=t[e+i*n+1]);return a}function My(t,e){return e*Math.round(t/e)}function Ay(t,e,i,n,r,s,a){if(e==i)return a;let o,l,h=My(t[e],r),c=My(t[e+1],r);e+=n,s[a++]=h,s[a++]=c;do{if(o=My(t[e],r),l=My(t[e+1],r),(e+=n)==i)return s[a++]=o,s[a++]=l,a}while(o==h&&l==c);for(;e<i;){const i=My(t[e],r),u=My(t[e+1],r);if(e+=n,i==o&&u==l)continue;const d=o-h,f=l-c,p=i-h,g=u-c;d*g==f*p&&(d<0&&p<d||d==p||d>0&&p>d)&&(f<0&&g<f||f==g||f>0&&g>f)?(o=i,l=u):(s[a++]=o,s[a++]=l,h=o,c=l,o=i,l=u)}return s[a++]=o,s[a++]=l,a}function Oy(t,e,i,n,r,s,a,o){for(let l=0,h=i.length;l<h;++l){const h=i[l];a=Ay(t,e,h,n,r,s,a),o.push(a),e=h}return a}function Py(t,e,i,n,r){r=void 0!==r?r:[];let s=0;for(let a=e;a<i;a+=n)r[s++]=t.slice(a,a+n);return r.length=s,r}function Ry(t,e,i,n,r){r=void 0!==r?r:[];let s=0;for(let a=0,o=i.length;a<o;++a){const o=i[a];r[s++]=Py(t,e,o,n,r[s]),e=o}return r.length=s,r}function Iy(t,e,i,n,r){r=void 0!==r?r:[];let s=0;for(let a=0,o=i.length;a<o;++a){const o=i[a];r[s++]=1===o.length&&o[0]===e?[]:Ry(t,e,o,n,r[s]),e=o[o.length-1]}return r.length=s,r}function Ly(t,e,i,n){let r=0,s=t[i-n],a=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];r+=a*i-s*n,s=i,a=n}return r/2}function Dy(t,e,i,n){let r=0;for(let s=0,a=i.length;s<a;++s){const a=i[s];r+=Ly(t,e,a,n),e=a}return r}class Ny extends by{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new Ny(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,n){return n<Ng(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(xy(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Sy(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))}getArea(){return Ly(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Py(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=Cy(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Ny(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ey(this.flatCoordinates,0,t,this.stride),this.changed()}}const Fy=Ny;class jy extends by{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new jy(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){const r=this.flatCoordinates,s=fm(t,e,r[0],r[1]);if(s<n){const t=this.stride;for(let e=0;e<t;++e)i[e]=r[e];return i.length=t,s}return n}getCoordinates(){return this.flatCoordinates?this.flatCoordinates.slice():[]}computeExtent(t){return function(t,e){const i=t[0],n=t[1];return Gg(i,n,i,n,e)}(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Bg(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,i,n){for(let n=0,r=i.length;n<r;++n)t[e++]=i[n];return e}(this.flatCoordinates,0,t,this.stride),this.changed()}}const By=jy;function zy(t,e,i,n,r){return!Kg(r,(function(r){return!Wy(t,e,i,n,r[0],r[1])}))}function Wy(t,e,i,n,r,s){let a=0,o=t[i-n],l=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];l<=s?n>s&&(i-o)*(s-l)-(r-o)*(n-l)>0&&a++:n<=s&&(i-o)*(s-l)-(r-o)*(n-l)<0&&a--,o=i,l=n}return 0!==a}function Gy(t,e,i,n,r,s){if(0===i.length)return!1;if(!Wy(t,e,i[0],n,r,s))return!1;for(let e=1,a=i.length;e<a;++e)if(Wy(t,i[e-1],i[e],n,r,s))return!1;return!0}function Uy(t,e,i,n,r,s,a){let o,l,h,c,u,d,f;const p=r[s+1],g=[];for(let r=0,s=i.length;r<s;++r){const s=i[r];for(c=t[s-n],d=t[s-n+1],o=e;o<s;o+=n)u=t[o],f=t[o+1],(p<=d&&f<=p||d<=p&&p<=f)&&(h=(p-d)/(f-d)*(u-c)+c,g.push(h)),c=u,d=f}let m=NaN,v=-1/0;for(g.sort(Pp),c=g[0],o=1,l=g.length;o<l;++o){u=g[o];const r=Math.abs(u-c);r>v&&(h=(c+u)/2,Gy(t,e,i,n,h,p)&&(m=h,v=r)),c=u}return isNaN(m)&&(m=r[s]),a?(a.push(m,p,v),a):[m,p,v]}function Hy(t,e,i,n,r){let s;for(e+=n;e<i;e+=n)if(s=r(t.slice(e-n,e),t.slice(e,e+n)),s)return s;return!1}function Xy(t,e,i,n,r){const s=Vg([1/0,1/0,-1/0,-1/0],t,e,i,n);return!!om(r,s)&&(!!jg(r,s)||(s[0]>=r[0]&&s[2]<=r[2]||(s[1]>=r[1]&&s[3]<=r[3]||Hy(t,e,i,n,(function(t,e){return function(t,e,i){let n=!1;const r=zg(t,e),s=zg(t,i);if(r===Rg.INTERSECTING||s===Rg.INTERSECTING)n=!0;else{const a=t[0],o=t[1],l=t[2],h=t[3],c=e[0],u=e[1],d=i[0],f=i[1],p=(f-u)/(d-c);let g,m;s&Rg.ABOVE&&!(r&Rg.ABOVE)&&(g=d-(f-h)/p,n=g>=a&&g<=l),n||!(s&Rg.RIGHT)||r&Rg.RIGHT||(m=f-(d-l)*p,n=m>=o&&m<=h),n||!(s&Rg.BELOW)||r&Rg.BELOW||(g=d-(f-o)/p,n=g>=a&&g<=l),n||!(s&Rg.LEFT)||r&Rg.LEFT||(m=f-(d-a)*p,n=m>=o&&m<=h)}return n}(r,t,e)})))))}function Vy(t,e,i,n,r){return!!Xy(t,e,i,n,r)||(!!Wy(t,e,i,n,r[0],r[1])||(!!Wy(t,e,i,n,r[0],r[3])||(!!Wy(t,e,i,n,r[2],r[1])||!!Wy(t,e,i,n,r[2],r[3]))))}function Yy(t,e,i,n,r){if(!Vy(t,e,i[0],n,r))return!1;if(1===i.length)return!0;for(let e=1,s=i.length;e<s;++e)if(zy(t,i[e-1],i[e],n,r)&&!Xy(t,i[e-1],i[e],n,r))return!1;return!0}function Ky(t,e,i,n){for(;e<i-n;){for(let r=0;r<n;++r){const s=t[e+r];t[e+r]=t[i-n+r],t[i-n+r]=s}e+=n,i-=n}}function qy(t,e,i,n){let r=0,s=t[i-n],a=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];r+=(i-s)*(n+a),s=i,a=n}return 0===r?void 0:r>0}function Zy(t,e,i,n,r){r=void 0!==r&&r;for(let s=0,a=i.length;s<a;++s){const a=i[s],o=qy(t,e,a,n);if(0===s){if(r&&o||!r&&!o)return!1}else if(r&&!o||!r&&o)return!1;e=a}return!0}function Jy(t,e,i,n,r){r=void 0!==r&&r;for(let s=0,a=i.length;s<a;++s){const a=i[s],o=qy(t,e,a,n);(0===s?r&&o||!r&&!o:r&&!o||!r&&o)&&Ky(t,e,a,n),e=a}return e}class $y extends by{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?Lp(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new $y(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Ng(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(wy(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ty(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return Gy(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Dy(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Jy(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Ry(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=$g(this.getExtent());this.flatInteriorPoint_=Uy(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new By(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Fy(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[];let r=0;for(let s=0,a=i.length;s<a;++s){const a=i[s],o=new Fy(e.slice(r,a),t);n.push(o),r=a}return n}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Zy(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Jy(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Oy(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new $y(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return Yy(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=ky(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}const Qy=$y;function tb(t){if(lm(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],i=t[1],n=t[2],r=t[3],s=[e,i,e,r,n,r,n,i,e,i];return new $y(s,"XY",[s.length])}function eb(t,e){setTimeout((function(){t(e)}),0)}function ib(t){return!(t.sourceCenter&&t.targetCenter&&!_v(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}function nb(t,e,i,n,r){const s=Math.cos(-r);let a=Math.sin(-r),o=t[0]*s-t[1]*a,l=t[1]*s+t[0]*a;o+=(e[0]/2-i[0])*n,l+=(i[1]-e[1]/2)*n,a=-a;return[o*s-l*a,l*s+o*a]}const rb=class extends og{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=jv(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&Pv(),t.center&&(t.center=qv(t.center,this.projection_)),t.extent&&(t.extent=Jv(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const t in Zm)delete e[t];this.setProperties(e,!0);const i=function(t){let e,i,n;const r=28,s=2;let a=void 0!==t.minZoom?t.minZoom:0,o=void 0!==t.maxZoom?t.maxZoom:r;const l=void 0!==t.zoomFactor?t.zoomFactor:s,h=void 0!==t.multiWorld&&t.multiWorld,c=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,u=void 0!==t.showFullExtent&&t.showFullExtent,d=jv(t.projection,"EPSG:3857"),f=d.getExtent();let p=t.constrainOnlyCenter,g=t.extent;h||g||!d.isGlobal()||(p=!1,g=f);if(void 0!==t.resolutions){const r=t.resolutions;i=r[a],n=void 0!==r[o]?r[o]:r[r.length-1],e=t.constrainResolution?function(t,e,i,n){return e=void 0===e||e,function(r,s,a,o){if(void 0!==r){const l=t[0],h=t[t.length-1],c=i?sy(l,i,a,n):l;if(o)return e?ay(r,c,h):um(r,h,c);const u=Math.min(c,r),d=Math.floor(Rp(t,u,s));return t[d]>c&&d<t.length-1?t[d+1]:t[d]}}}(r,c,!p&&g,u):oy(i,n,c,!p&&g,u)}else{const h=(f?Math.max(am(f),im(f)):360*Qm.degrees/d.getMetersPerUnit())/$m/Math.pow(s,0),m=h/Math.pow(s,r-0);i=t.maxResolution,void 0!==i?a=0:i=h/Math.pow(l,a),n=t.minResolution,void 0===n&&(n=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(l,o):h/Math.pow(l,o):m),o=a+Math.floor(Math.log(i/n)/Math.log(l)),n=i/Math.pow(l,o-a),e=t.constrainResolution?function(t,e,i,n,r,s){return n=void 0===n||n,i=void 0!==i?i:0,function(a,o,l,h){if(void 0!==a){const c=r?sy(e,r,l,s):e;if(h)return n?ay(a,c,i):um(a,i,c);const u=1e-9,d=Math.ceil(Math.log(e/c)/Math.log(t)-u),f=-o*(.5-u)+.5,p=Math.min(c,a),g=Math.floor(Math.log(e/p)/Math.log(t)+f),m=Math.max(d,g);return um(e/Math.pow(t,m),i,c)}}}(l,i,n,c,!p&&g,u):oy(i,n,c,!p&&g,u)}return{constraint:e,maxResolution:i,minResolution:n,minZoom:a,zoomFactor:l}}(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const n=function(t){if(void 0!==t.extent){const e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return ny(t.extent,t.constrainOnlyCenter,e)}const e=jv(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,ny(t,!1,!1)}return ry}(t),r=i.constraint,s=function(t){const e=void 0===t.enableRotation||t.enableRotation;if(e){const e=t.constrainRotation;return void 0===e||!0===e?(i=i||gm(5),function(t,e){return e?t:void 0!==t?Math.abs(t)<=i?0:t:void 0}):!1===e?hy:"number"==typeof e?function(t){const e=2*Math.PI/t;return function(t,i){return i?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}(e):hy}var i;return ly}(t);this.constraints_={center:n,resolution:r,rotation:s},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const n=t||[0,0,0,0];e=e||[0,0,0,0];const r=this.getResolution(),s=r/2*(n[3]-e[3]+e[1]-n[1]),a=r/2*(n[0]-e[0]+e[2]-n[2]);this.setCenterInternal([i[0]+s,i[1]-a])}}getUpdatedOptions_(t){const e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let t=0;t<e.length;++t){let i=arguments[t];i.center&&(i=Object.assign({},i),i.center=qv(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=qv(i.anchor,this.getProjection())),e[t]=i}this.animateInternal.apply(this,e)}animateInternal(t){let e,i=arguments.length;i>1&&"function"==typeof arguments[i-1]&&(e=arguments[i-1],--i);let n=0;for(;n<i&&!this.isDef();++n){const t=arguments[n];t.center&&this.setCenterInternal(t.center),void 0!==t.zoom?this.setZoom(t.zoom):t.resolution&&this.setResolution(t.resolution),void 0!==t.rotation&&this.setRotation(t.rotation)}if(n===i)return void(e&&eb(e,!0));let r=Date.now(),s=this.targetCenter_.slice(),a=this.targetResolution_,o=this.targetRotation_;const l=[];for(;n<i;++n){const t=arguments[n],i={start:r,complete:!1,anchor:t.anchor,duration:void 0!==t.duration?t.duration:1e3,easing:t.easing||dy,callback:e};if(t.center&&(i.sourceCenter=s,i.targetCenter=t.center.slice(),s=i.targetCenter),void 0!==t.zoom?(i.sourceResolution=a,i.targetResolution=this.getResolutionForZoom(t.zoom),a=i.targetResolution):t.resolution&&(i.sourceResolution=a,i.targetResolution=t.resolution,a=i.targetResolution),void 0!==t.rotation){i.sourceRotation=o;const e=mm(t.rotation-o+Math.PI,2*Math.PI)-Math.PI;i.targetRotation=o+e,o=i.targetRotation}ib(i)?i.complete=!0:r+=i.duration,l.push(i)}this.animations_.push(l),this.setHint(Km,1),this.updateAnimations_()}getAnimating(){return this.hints_[Km]>0}getInteracting(){return this.hints_[qm]>0}cancelAnimations(){let t;this.setHint(Km,-this.hints_[Km]);for(let e=0,i=this.animations_.length;e<i;++e){const i=this.animations_[e];if(i[0].callback&&eb(i[0].callback,!1),!t)for(let e=0,n=i.length;e<n;++e){const n=i[e];if(!n.complete){t=n.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const n=this.animations_[i];let r=!0;for(let i=0,s=n.length;i<s;++i){const s=n[i];if(s.complete)continue;const a=t-s.start;let o=s.duration>0?a/s.duration:1;o>=1?(s.complete=!0,o=1):r=!1;const l=s.easing(o);if(s.sourceCenter){const t=s.sourceCenter[0],e=s.sourceCenter[1],i=s.targetCenter[0],n=s.targetCenter[1];this.nextCenter_=s.targetCenter;const r=t+l*(i-t),a=e+l*(n-e);this.targetCenter_=[r,a]}if(s.sourceResolution&&s.targetResolution){const t=1===l?s.targetResolution:s.sourceResolution+l*(s.targetResolution-s.sourceResolution);if(s.anchor){const e=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(t,0,e,!0);this.targetCenter_=this.calculateCenterZoom(i,s.anchor)}this.nextResolution_=s.targetResolution,this.targetResolution_=t,this.applyTargetState_(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){const t=1===l?mm(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+l*(s.targetRotation-s.sourceRotation);if(s.anchor){const e=this.constraints_.rotation(t,!0);this.targetCenter_=this.calculateCenterRotate(e,s.anchor)}this.nextRotation_=s.targetRotation,this.targetRotation_=t}if(this.applyTargetState_(!0),e=!0,!s.complete)break}if(r){this.animations_[i]=null,this.setHint(Km,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const t=n[0].callback;t&&eb(t,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const n=this.getCenterInternal();var r,s;return void 0!==n&&(i=[n[0]-e[0],n[1]-e[1]],xv(i,t-this.getRotation()),s=e,(r=i)[0]+=+s[0],r[1]+=+s[1]),i}calculateCenterZoom(t,e){let i;const n=this.getCenterInternal(),r=this.getResolution();if(void 0!==n&&void 0!==r){i=[e[0]-t*(e[0]-n[0])/r,e[1]-t*(e[1]-n[1])/r]}return i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],n=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t?Kv(t,this.getProjection()):t}getCenterInternal(){return this.get(Zm.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){return Zv(this.calculateExtentInternal(t),this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();Tg(e,1);const i=this.getResolution();Tg(void 0!==i,2);const n=this.getRotation();return Tg(void 0!==n,3),tm(e,i,n,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(Zm.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Jv(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=am(t)/e[0],n=im(t)/e[1];return Math.max(i,n)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(e/i)/Math.log(t);return function(i){return e/Math.pow(t,i*n)}}getRotation(){return this.get(Zm.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(i/n)/e;return function(t){return Math.log(i/t)/e/r}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let n=this.getCenterInternal();const r=this.padding_;if(r){const t=this.getViewportSizeMinusPadding_();n=nb(n,this.getViewportSize_(),[t[0]/2+r[3],t[1]/2+r[0]],e,i)}return{center:n.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e,i,n=this.minZoom_||0;if(this.resolutions_){const r=Rp(this.resolutions_,t,1);n=r,e=this.resolutions_[r],i=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(e/t)/Math.log(i)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=um(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,um(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(Tg(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t)){Tg(!lm(t),25);i=tb(Jv(t,this.getProjection()))}else if("Circle"===t.getType()){const e=Jv(t.getExtent(),this.getProjection());i=tb(e),i.rotate(this.getRotation(),$g(e))}else{const e=Yv();i=e?t.clone().transform(e,this.getProjection()):t}this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),n=Math.sin(-e),r=t.getFlatCoordinates(),s=t.getStride();let a=1/0,o=1/0,l=-1/0,h=-1/0;for(let t=0,e=r.length;t<e;t+=s){const e=r[t]*i-r[t+1]*n,s=r[t]*n+r[t+1]*i;a=Math.min(a,e),o=Math.min(o,s),l=Math.max(l,e),h=Math.max(h,s)}return[a,o,l,h]}fitInternal(t,e){let i=(e=e||{}).size;i||(i=this.getViewportSizeMinusPadding_());const n=void 0!==e.padding?e.padding:[0,0,0,0],r=void 0!==e.nearest&&e.nearest;let s;s=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;const a=this.rotatedExtentForGeometry(t);let o=this.getResolutionForExtentInternal(a,[i[0]-n[1]-n[3],i[1]-n[0]-n[2]]);o=isNaN(o)?s:Math.max(o,s),o=this.getConstrainedResolution(o,r?0:1);const l=this.getRotation(),h=Math.sin(l),c=Math.cos(l),u=$g(a);u[0]+=(n[1]-n[3])/2*o,u[1]+=(n[0]-n[2])/2*o;const d=u[0]*c-u[1]*h,f=u[1]*c+u[0]*h,p=this.getConstrainedCenter([d,f],o),g=e.callback?e.callback:jp;void 0!==e.duration?this.animateInternal({resolution:o,center:p,duration:e.duration,easing:e.easing},g):(this.targetResolution_=o,this.targetCenter_=p,this.applyTargetState_(!1,!0),eb(g,!0))}centerOn(t,e,i){this.centerOnInternal(qv(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(nb(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,n){let r;const s=this.padding_;if(s&&t){const a=this.getViewportSizeMinusPadding_(-i),o=nb(t,n,[a[0]/2+s[3],a[1]/2+s[0]],e,i);r=[t[0]-o[0],t[1]-o[1]]}return r}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(t){const e=Kv(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&qv(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,n,i);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=qv(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t?qv(t,this.getProjection()):t)}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,i),r=this.getViewportSize_(n),s=this.constraints_.resolution(this.targetResolution_,0,r,i),a=this.constraints_.center(this.targetCenter_,s,r,i,this.calculateCenterShift(this.targetCenter_,s,n,r));this.get(Zm.ROTATION)!==n&&this.set(Zm.ROTATION,n),this.get(Zm.RESOLUTION)!==s&&(this.set(Zm.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),a&&this.get(Zm.CENTER)&&_v(this.get(Zm.CENTER),a)||this.set(Zm.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=void 0!==t?t:200;const n=e||0,r=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(r),a=this.constraints_.resolution(this.targetResolution_,n,s),o=this.constraints_.center(this.targetCenter_,a,s,!1,this.calculateCenterShift(this.targetCenter_,a,r,s));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=r,this.targetCenter_=o,void this.applyTargetState_();i=i||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===a&&this.getRotation()===r&&this.getCenterInternal()&&_v(this.getCenterInternal(),o)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:o,resolution:a,duration:t,easing:uy,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(qm,1)}endInteraction(t,e,i){i=i&&qv(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(qm,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}};function sb(t,e){if(!t.visible)return!1;const i=e.resolution;if(i<t.minResolution||i>=t.maxResolution)return!1;const n=e.zoom;return n>t.minZoom&&n<=t.maxZoom}const ab=class extends Gm{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(zm,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return(t=t||[]).push(this),t}getLayerStatesArray(t){return(t=t||[]).push(this.getLayerState()),t}getSource(){return this.get(zm)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(tg(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=$p(t,Gp,this.handleSourceChange_,this),"ready"===t.getState()&&(this.sourceReady_=!0,setTimeout((()=>{this.dispatchEvent("sourceready")}),0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}isVisible(t){let e;const i=this.getMapInternal();let n;!t&&i&&(t=i.getView()),e=t instanceof rb?{viewState:t.getState(),extent:t.calculateExtent()}:t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray()),n=e.layerStatesArray?e.layerStatesArray.find((t=>t.layer===this)):this.getLayerState();const r=this.getExtent();return sb(n,e.viewState)&&(!r||om(r,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e;const i=this.getSource();if(i&&(e=i.getAttributions()),!e)return[];let n=e(t instanceof rb?t.getViewStateAndExtent():t);return Array.isArray(n)||(n=[n]),n}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}setMapInternal(t){t||this.unrender(),this.set(Wm,t)}getMapInternal(){return this.get(Wm)}setMap(t){this.mapPrecomposeKey_&&(tg(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(tg(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=$p(t,Xm,(function(t){const e=t.frameState.layerStatesArray,i=this.getLayerState(!1);Tg(!e.some((function(t){return t.layer===i.layer})),67),e.push(i)}),this),this.mapRenderKey_=$p(this,Gp,t.render,t),this.changed())}setSource(t){this.set(zm,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}};function ob(t,e){Pm.expire()}const lb=class extends Op{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){ng()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;Mg(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Ag(n,i)}forEachFeatureAtCoordinate(t,e,i,n,r,s,a,o){let l;const h=e.viewState;function c(t,e,i,n){return r.call(s,e,t?i:null,n)}const u=h.projection,d=wv(t.slice(),u),f=[[0,0]];if(u.canWrapX()&&n){const t=am(u.getExtent());f.push([-t,0],[t,0])}const p=e.layerStatesArray,g=p.length,m=[],v=[];for(let n=0;n<f.length;n++)for(let r=g-1;r>=0;--r){const s=p[r],u=s.layer;if(u.hasRenderer()&&sb(s,h)&&a.call(o,u)){const r=u.getRenderer(),a=u.getSource();if(r&&a){const o=a.getWrapX()?d:t,h=c.bind(null,s.managed);v[0]=o[0]+f[n][0],v[1]=o[1]+f[n][1],l=r.forEachFeatureAtCoordinate(v,e,i,h,m)}if(l)return l}}if(0===m.length)return;const y=1/m.length;return m.forEach(((t,e)=>t.distanceSq+=e*y)),m.sort(((t,e)=>t.distanceSq-e.distanceSq)),m.some((t=>l=t.callback(t.feature,t.layer,t.geometry))),l}hasFeatureAtCoordinate(t,e,i,n,r,s){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,n,Np,this,r,s)}getMap(){return this.map_}renderFrame(t){ng()}flushDeclutterItems(t){}scheduleExpireIconCache(t){Pm.canExpireCache()&&t.postRenderFunctions.push(ob)}};const hb=class extends Mp{constructor(t,e,i,n){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=n}},cb="ol-hidden",ub="ol-unselectable",db="ol-control",fb="ol-collapsed",pb=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),gb=["style","variant","weight","size","lineHeight","family"],mb=function(t){const e=t.match(pb);if(!e)return null;const i={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let t=0,n=gb.length;t<n;++t){const n=e[t+1];void 0!==n&&(i[gb[t]]=n)}return i.families=i.family.split(/,\s?/),i};function vb(t,e,i,n){let r;return r=i&&i.length?i.shift():xg?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(r.width=t),e&&(r.height=e),r.getContext("2d",n)}function yb(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function bb(t,e){const i=e.parentNode;i&&i.replaceChild(t,e)}function _b(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}const xb="10px sans-serif",wb="#000",Sb="round",Tb=[],Eb="round",kb="#000",Cb="center",Mb="middle",Ab=[0,0,0,0],Ob=new og;let Pb,Rb=null;const Ib={},Lb=function(){const t="32px ",e=["monospace","serif"],i=e.length,n="wmytzilWMYTZIL@#/&?$%10";let r,s;function a(r,a,o){let l=!0;for(let h=0;h<i;++h){const i=e[h];if(s=Fb(r+" "+a+" "+t+i,n),o!=i){const e=Fb(r+" "+a+" "+t+o+","+i,n);l=l&&e!=s}}return!!l}function o(){let t=!0;const e=Ob.getKeys();for(let i=0,n=e.length;i<n;++i){const n=e[i];Ob.get(n)<100&&(a.apply(this,n.split("\n"))?(Bp(Ib),Rb=null,Pb=void 0,Ob.set(n,100)):(Ob.set(n,Ob.get(n)+1,!0),t=!1))}t&&(clearInterval(r),r=void 0)}return function(t){const e=mb(t);if(!e)return;const i=e.families;for(let t=0,n=i.length;t<n;++t){const n=i[t],s=e.style+"\n"+e.weight+"\n"+n;void 0===Ob.get(s)&&(Ob.set(s,100,!0),a(e.style,e.weight,n)||(Ob.set(s,0,!0),void 0===r&&(r=setInterval(o,32))))}}}(),Db=function(){let t;return function(e){let i=Ib[e];if(null==i){if(xg){const t=mb(e),n=Nb(e,"Žg");i=(isNaN(Number(t.lineHeight))?1.2:Number(t.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),i=t.offsetHeight,document.body.removeChild(t);Ib[e]=i}return i}}();function Nb(t,e){return Rb||(Rb=vb(1,1)),t!=Pb&&(Rb.font=t,Pb=Rb.font),Rb.measureText(e)}function Fb(t,e){return Nb(t,e).width}function jb(t,e,i){if(e in i)return i[e];const n=e.split("\n").reduce(((e,i)=>Math.max(e,Fb(t,i))),0);return i[e]=n,n}function Bb(t,e,i,n,r,s,a,o,l,h,c){t.save(),1!==i&&(t.globalAlpha*=i),e&&t.setTransform.apply(t,e),n.contextInstructions?(t.translate(l,h),t.scale(c[0],c[1]),function(t,e){const i=t.contextInstructions;for(let t=0,n=i.length;t<n;t+=2)Array.isArray(i[t+1])?e[i[t]].apply(e,i[t+1]):e[i[t]]=i[t+1]}(n,t)):c[0]<0||c[1]<0?(t.translate(l,h),t.scale(c[0],c[1]),t.drawImage(n,r,s,a,o,0,0,a,o)):t.drawImage(n,r,s,a,o,l,h,a*c[0],o*c[1]),t.restore()}const zb=class extends lb{constructor(t){super(t),this.fontChangeListenerKey_=$p(Ob,Ap,t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=ub+" ol-layers";const i=t.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0,this.declutterLayers_=[]}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const n=new hb(t,void 0,e);i.dispatchEvent(n)}}disposeInternal(){tg(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(t),this.dispatchRenderEvent(Xm,t);const e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),i=t.viewState;this.children_.length=0;const n=this.declutterLayers_;n.length=0;let r=null;for(let s=0,a=e.length;s<a;++s){const a=e[s];t.layerIndex=s;const o=a.layer,l=o.getSourceState();if(!sb(a,i)||"ready"!=l&&"undefined"!=l){o.unrender();continue}const h=o.render(t,r);h&&(h!==r&&(this.children_.push(h),r=h),"getDeclutter"in o&&n.push(o))}this.flushDeclutterItems(t),function(t,e){const i=t.childNodes;for(let n=0;;++n){const r=i[n],s=e[n];if(!r&&!s)break;r!==s&&(r?s?t.insertBefore(s,r):(t.removeChild(r),--n):t.appendChild(s))}}(this.element_,this.children_),this.dispatchRenderEvent(Vm,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}flushDeclutterItems(t){const e=this.declutterLayers_;for(let i=e.length-1;i>=0;--i)e[i].renderDeclutter(t);e.length=0}};class Wb extends Mp{constructor(t,e){super(t),this.layer=e}}const Gb="layers";class Ub extends Gm{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Gb,this.handleLayersChanged_),i?Array.isArray(i)?i=new gg(i.slice(),{unique:!0}):Tg("function"==typeof i.getArray,43):i=new gg(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(tg),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push($p(t,ug,this.handleLayersAdd_,this),$p(t,dg,this.handleLayersRemove_,this));for(const t in this.listenerKeys_)this.listenerKeys_[t].forEach(tg);Bp(this.listenerKeys_);const e=t.getArray();for(let t=0,i=e.length;t<i;t++){const i=e[t];this.registerLayerListeners_(i),this.dispatchEvent(new Wb("addlayer",i))}this.changed()}registerLayerListeners_(t){const e=[$p(t,Ap,this.handleLayerChange_,this),$p(t,Gp,this.handleLayerChange_,this)];t instanceof Ub&&e.push($p(t,"addlayer",this.handleLayerGroupAdd_,this),$p(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[sg(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new Wb("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new Wb("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new Wb("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=sg(e);this.listenerKeys_[i].forEach(tg),delete this.listenerKeys_[i],this.dispatchEvent(new Wb("removelayer",e)),this.changed()}getLayers(){return this.get(Gb)}setLayers(t){const e=this.getLayers();if(e){const t=e.getArray();for(let e=0,i=t.length;e<i;++e)this.dispatchEvent(new Wb("removelayer",t[e]))}this.set(Gb,t)}getLayersArray(t){return t=void 0!==t?t:[],this.getLayers().forEach((function(e){e.getLayersArray(t)})),t}getLayerStatesArray(t){const e=void 0!==t?t:[],i=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));const n=this.getLayerState();let r=n.zIndex;t||void 0!==n.zIndex||(r=0);for(let t=i,s=e.length;t<s;t++){const i=e[t];i.opacity*=n.opacity,i.visible=i.visible&&n.visible,i.maxResolution=Math.min(i.maxResolution,n.maxResolution),i.minResolution=Math.max(i.minResolution,n.minResolution),i.minZoom=Math.max(i.minZoom,n.minZoom),i.maxZoom=Math.min(i.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==i.extent?i.extent=nm(i.extent,n.extent):i.extent=n.extent),void 0===i.zIndex&&(i.zIndex=r)}return e}getSourceState(){return"ready"}}const Hb=Ub;const Xb=class extends Mp{constructor(t,e,i){super(t),this.map=e,this.frameState=void 0!==i?i:null}};const Vb=class extends Xb{constructor(t,e,i,n,r,s){super(t,e,r),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==n&&n,this.activePointers=s}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},Yb={SINGLECLICK:"singleclick",CLICK:Xp,DBLCLICK:Vp,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Kb="pointermove",qb="pointerdown";const Zb=class extends Wp{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===e?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=$p(i,qb,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=$p(i,Kb,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Zp,this.boundHandleTouchMove_,!!Sg&&{passive:!1})}emulateClick_(t){let e=new Vb(Yb.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Vb(Yb.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout((()=>{this.clickTimeoutId_=void 0;const e=new Vb(Yb.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}),250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==Yb.POINTERUP||e.type==Yb.POINTERCANCEL){delete this.trackedTouches_[i];for(const t in this.trackedTouches_)if(this.trackedTouches_[t].target!==e.target){delete this.trackedTouches_[t];break}}else e.type!=Yb.POINTERDOWN&&e.type!=Yb.POINTERMOVE||(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new Vb(Yb.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(tg),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return 0===t.button}handlePointerDown_(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);const e=new Vb(Yb.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),0===this.dragListenerKeys_.length){const t=this.map_.getOwnerDocument();this.dragListenerKeys_.push($p(t,Yb.POINTERMOVE,this.handlePointerMove_,this),$p(t,Yb.POINTERUP,this.handlePointerUp_,this),$p(this.element_,Yb.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==t&&this.dragListenerKeys_.push($p(this.element_.getRootNode(),Yb.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new Vb(Yb.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new Vb(Yb.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(tg(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Zp,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(tg(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(tg),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},Jb="postrender",$b="movestart",Qb="moveend",t_="loadstart",e_="loadend",i_="layergroup",n_="size",r_="target",s_="view",a_=1/0;const o_=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Bp(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const n=this.keyFunction_(i);return delete this.queuedElements_[n],i}enqueue(t){Tg(!(this.keyFunction_(t)in this.queuedElements_),31);const e=this.priorityFunction_(t);return e!=a_&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return 0===this.elements_.length}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,n=e.length,r=e[t],s=i[t],a=t;for(;t<n>>1;){const r=this.getLeftChildIndex_(t),s=this.getRightChildIndex_(t),a=s<n&&i[s]<i[r]?s:r;e[t]=e[a],i[t]=i[a],t=a}e[t]=r,i[t]=s,this.siftDown_(a,t)}siftDown_(t,e){const i=this.elements_,n=this.priorities_,r=i[e],s=n[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(n[t]>s))break;i[e]=i[t],n[e]=n[t],e=t}i[e]=r,n[e]=s}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let n=0;const r=e.length;let s,a,o;for(a=0;a<r;++a)s=e[a],o=t(s),o==a_?delete this.queuedElements_[this.keyFunction_(s)]:(i[n]=o,e[n++]=s);e.length=n,i.length=n,this.heapify_()}},l_=0,h_=1,c_=2,u_=3,d_=4;const f_=class extends o_{constructor(t,e){super((function(e){return t.apply(null,e)}),(function(t){return t[0].getKey()})),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);if(e){t[0].addEventListener(Gp,this.boundHandleTileChange_)}return e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(i===c_||i===u_||i===d_){i!==u_&&e.removeEventListener(Gp,this.boundHandleTileChange_);const t=e.getKey();t in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[t],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i,n,r,s=0;for(;this.tilesLoading_<t&&s<e&&this.getCount()>0;)n=this.dequeue()[0],r=n.getKey(),i=n.getState(),i!==l_||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++s,n.load())}};const p_=class extends og{constructor(t){super();const e=t.element;!e||t.target||e.style.pointerEvents||(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){_b(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&_b(this.element);for(let t=0,e=this.listenerKeys.length;t<e;++t)tg(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=t,t){(this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==jp&&this.listenerKeys.push($p(t,Jb,this.render,this)),t.render()}}render(t){}setTarget(t){this.target_="string"==typeof t?document.getElementById(t):t}};const g_=class extends p_{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==t.collapsible,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);const e=void 0!==t.className?t.className:"ol-attribution",i=void 0!==t.tipLabel?t.tipLabel:"Attributions",n=void 0!==t.expandClassName?t.expandClassName:e+"-expand",r=void 0!==t.collapseLabel?t.collapseLabel:"›",s=void 0!==t.collapseClassName?t.collapseClassName:e+"-collapse";"string"==typeof r?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r,this.collapseLabel_.className=s):this.collapseLabel_=r;const a=void 0!==t.label?t.label:"i";"string"==typeof a?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=n):this.label_=a;const o=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(o),this.toggleButton_.addEventListener(Xp,this.handleClick_.bind(this),!1);const l=e+" "+ub+" "+db+(this.collapsed_&&this.collapsible_?" "+fb:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=l,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=Array.from(new Set(this.getMap().getAllLayers().flatMap((e=>e.getAttributions(t))))),i=!this.getMap().getAllLayers().some((t=>t.getSource()&&!1===t.getSource().getAttributionsCollapsible()));return this.overrideCollapsible_||this.setCollapsible(i),e}updateElement_(t){if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=this.collectSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Dp(e,this.renderedAttributions_)){!function(t){for(;t.lastChild;)t.removeChild(t.lastChild)}(this.ulElement_);for(let t=0,i=e.length;t<i;++t){const i=document.createElement("li");i.innerHTML=e[t],this.ulElement_.appendChild(i)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(fb),this.collapsed_?bb(this.collapseLabel_,this.label_):bb(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}};const m_=class extends p_{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=void 0!==t.className?t.className:"ol-rotate",i=void 0!==t.label?t.label:"⇧",n=void 0!==t.compassClassName?t.compassClassName:"ol-compass";this.label_=null,"string"==typeof i?(this.label_=document.createElement("span"),this.label_.className=n,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(n));const r=t.tipLabel?t.tipLabel:"Reset rotation",s=document.createElement("button");s.className=e+"-reset",s.setAttribute("type","button"),s.title=r,s.appendChild(this.label_),s.addEventListener(Xp,this.handleClick_.bind(this),!1);const a=e+" "+ub+" "+db,o=this.element;o.className=a,o.appendChild(s),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=void 0!==t.duration?t.duration:250,this.autoHide_=void 0===t.autoHide||t.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(cb)}handleClick_(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:uy}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const t="rotate("+i+"rad)";if(this.autoHide_){const t=this.element.classList.contains(cb);t||0!==i?t&&0!==i&&this.element.classList.remove(cb):this.element.classList.add(cb)}this.label_.style.transform=t}this.rotation_=i}};const v_=class extends p_{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=void 0!==t.className?t.className:"ol-zoom",i=void 0!==t.delta?t.delta:1,n=void 0!==t.zoomInClassName?t.zoomInClassName:e+"-in",r=void 0!==t.zoomOutClassName?t.zoomOutClassName:e+"-out",s=void 0!==t.zoomInLabel?t.zoomInLabel:"+",a=void 0!==t.zoomOutLabel?t.zoomOutLabel:"–",o=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",l=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=n,h.setAttribute("type","button"),h.title=o,h.appendChild("string"==typeof s?document.createTextNode(s):s),h.addEventListener(Xp,this.handleClick_.bind(this,i),!1);const c=document.createElement("button");c.className=r,c.setAttribute("type","button"),c.title=l,c.appendChild("string"==typeof a?document.createTextNode(a):a),c.addEventListener(Xp,this.handleClick_.bind(this,-i),!1);const u=e+" "+ub+" "+db,d=this.element;d.className=u,d.appendChild(h),d.appendChild(c),this.duration_=void 0!==t.duration?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const i=e.getZoom();if(void 0!==i){const n=e.getConstrainedZoom(i+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:n,duration:this.duration_,easing:uy})):e.setZoom(n)}}};function y_(t){t=t||{};const e=new gg;(void 0===t.zoom||t.zoom)&&e.push(new v_(t.zoomOptions));(void 0===t.rotate||t.rotate)&&e.push(new m_(t.rotateOptions));return(void 0===t.attribution||t.attribution)&&e.push(new g_(t.attributionOptions)),e}const b_="active";function __(t,e,i,n){const r=t.getZoom();if(void 0===r)return;const s=t.getConstrainedZoom(r+e),a=t.getResolutionForZoom(s);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:a,anchor:i,duration:void 0!==n?n:250,easing:uy})}const x_=class extends og{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(b_)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(b_,t)}setMap(t){this.map_=t}};const w_=class extends x_{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:250}handleEvent(t){let e=!1;if(t.type==Yb.DBLCLICK){const i=t.originalEvent,n=t.map,r=t.coordinate,s=i.shiftKey?-this.delta_:this.delta_;__(n.getView(),s,r,this.duration_),i.preventDefault(),e=!0}return!e}};function S_(t){const e=t.length;let i=0,n=0;for(let r=0;r<e;r++)i+=t[r].clientX,n+=t[r].clientY;return{clientX:i/e,clientY:n/e}}const T_=class extends x_{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Yb.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Yb.POINTERUP){const e=this.handleUpEvent(t);this.handlingDownUpSequence=e&&this.targetPointers.length>0}}else if(t.type==Yb.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==Yb.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function E_(t){const e=arguments;return function(t){let i=!0;for(let n=0,r=e.length;n<r&&(i=i&&e[n](t),i);++n);return i}}const k_=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},C_=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||function(t){const e=t.map.getTargetElement(),i=t.map.getOwnerDocument().activeElement;return e.contains(i)}(t)},M_=Np,A_=function(t){const e=t.originalEvent;return 0==e.button&&!(yg&&bg&&e.ctrlKey)},O_=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},P_=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},R_=function(t){const e=t.originalEvent,i=e.target.tagName;return"INPUT"!==i&&"SELECT"!==i&&"TEXTAREA"!==i&&!e.target.isContentEditable},I_=function(t){const e=t.originalEvent;return Tg(void 0!==e,56),"mouse"==e.pointerType},L_=function(t){const e=t.originalEvent;return Tg(void 0!==e,56),e.isPrimary&&0===e.button};const D_=class extends T_{constructor(t){super({stopDown:Fp}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:E_(O_,L_);this.condition_=t.onFocusOnly?E_(C_,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const i=this.targetPointers,n=e.getEventPixel(S_(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){const e=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],i=t.map.getView();!function(t,e){t[0]*=e,t[1]*=e}(e,i.getResolution()),xv(e,i.getRotation()),i.adjustCenterInternal(e)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=n,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),n=this.kinetic_.getAngle(),r=i.getCenterInternal(),s=e.getPixelFromCoordinateInternal(r),a=e.getCoordinateFromPixelInternal([s[0]-t*Math.cos(n),s[1]-t*Math.sin(n)]);i.animateInternal({center:i.getConstrainedCenter(a),duration:500,easing:uy})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}};const N_=class extends T_{constructor(t){t=t||{},super({stopDown:Fp}),this.condition_=t.condition?t.condition:k_,this.lastAngle_=void 0,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){if(!I_(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===ly)return;const n=e.getSize(),r=t.pixel,s=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2);if(void 0!==this.lastAngle_){const t=s-this.lastAngle_;i.adjustRotationInternal(-t)}this.lastAngle_=s}handleUpEvent(t){if(!I_(t))return!0;return t.map.getView().endInteraction(this.duration_),!1}handleDownEvent(t){if(!I_(t))return!1;if(A_(t)&&this.condition_(t)){return t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0}return!1}};const F_=class extends Op{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",n=this.element_.style;n.left=Math.min(t[0],e[0])+i,n.top=Math.min(t[1],e[1])+i,n.width=Math.abs(e[0]-t[0])+i,n.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Qy([i])}getGeometry(){return this.geometry_}},j_="boxstart",B_="boxdrag",z_="boxend",W_="boxcancel";class G_ extends Mp{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}const U_=class extends T_{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new F_(t.className||"ol-dragbox"),this.minArea_=void 0!==t.minArea?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:A_,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const n=i[0]-e[0],r=i[1]-e[1];return n*n+r*r>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new G_(B_,t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new G_(e?z_:W_,t.coordinate,t)),!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new G_(j_,t.coordinate,t)),!0)}onBoxEnd(t){}};const H_=class extends U_{constructor(t){super({condition:(t=t||{}).condition?t.condition:P_,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=void 0!==t.duration?t.duration:200,this.out_=void 0!==t.out&&t.out}onBoxEnd(t){const e=this.getMap().getView();let i=this.getGeometry();if(this.out_){const t=e.rotatedExtentForGeometry(i),n=e.getResolutionForExtentInternal(t),r=e.getResolution()/n;i=i.clone(),i.scale(r*r)}e.fitInternal(i,{duration:this.duration_,easing:uy})}},X_="ArrowLeft",V_="ArrowUp",Y_="ArrowRight",K_="ArrowDown";const q_=class extends x_{constructor(t){super(),t=t||{},this.defaultCondition_=function(t){return O_(t)&&R_(t)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==Yp){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&(n==K_||n==X_||n==Y_||n==V_)){const r=t.map.getView(),s=r.getResolution()*this.pixelDelta_;let a=0,o=0;n==K_?o=-s:n==X_?a=-s:n==Y_?a=s:o=s;const l=[a,o];xv(l,r.getRotation()),function(t,e,i){const n=t.getCenterInternal();if(n){const r=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:void 0!==i?i:250,easing:fy,center:t.getConstrainedCenter(r)})}}(r,l,this.duration_),i.preventDefault(),e=!0}}return!e}};const Z_=class extends x_{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(t){return!function(t){const e=t.originalEvent;return bg?e.metaKey:e.ctrlKey}(t)&&R_(t)},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:100}handleEvent(t){let e=!1;if(t.type==Yp||t.type==Kp){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&("+"===n||"-"===n)){const r=t.map,s="+"===n?this.delta_:-this.delta_;__(r.getView(),s,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}};const J_=class{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;const r=this.points_[e]-this.points_[i],s=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(s,r),this.initialVelocity_=Math.sqrt(r*r+s*s)/n,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}};const $_=class extends x_{constructor(t){super(t=t||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,this.duration_=void 0!==t.duration?t.duration:250,this.timeout_=void 0!==t.timeout?t.timeout:80,this.useAnchor_=void 0===t.useAnchor||t.useAnchor,this.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;const e=t.condition?t.condition:M_;this.condition_=t.onFocusOnly?E_(C_,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t))return!0;if(t.type!==Jp)return!0;const e=t.map,i=t.originalEvent;let n;if(i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==Jp&&(n=i.deltaY,vg&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(n/=_g),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(n*=40)),0===n)return!1;this.lastDelta_=n;const r=Date.now();void 0===this.startTime_&&(this.startTime_=r),(!this.mode_||r-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(n)<4?"trackpad":"wheel");const s=e.getView();if("trackpad"===this.mode_&&!s.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(s.getAnimating()&&s.cancelAnimations(),s.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),s.adjustZoom(-n/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=r,!1;this.totalDelta_+=n;const a=Math.max(this.timeout_-(r-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),a),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-um(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),__(e,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}};const Q_=class extends T_{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=Fp),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==t.threshold?t.threshold:.3,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],n=this.targetPointers[1],r=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){const t=r-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=t}this.lastAngle_=r;const s=t.map,a=s.getView();a.getConstraints().rotation!==ly&&(this.anchor_=s.getCoordinateFromPixelInternal(s.getEventPixel(S_(this.targetPointers))),this.rotating_&&(s.render(),a.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){if(this.targetPointers.length<2){return t.map.getView().endInteraction(this.duration_),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}};const tx=class extends T_{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=Fp),super(e),this.anchor_=null,this.duration_=void 0!==t.duration?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],n=this.targetPointers[1],r=i.clientX-n.clientX,s=i.clientY-n.clientY,a=Math.sqrt(r*r+s*s);void 0!==this.lastDistance_&&(e=this.lastDistance_/a),this.lastDistance_=a;const o=t.map,l=o.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(S_(this.targetPointers))),o.render(),l.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const e=t.map.getView(),i=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}};function ex(t){return t[0]>0&&t[1]>0}function ix(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}function nx(t){t instanceof ab?t.setMapInternal(null):t instanceof Hb&&t.getLayers().forEach(nx)}function rx(t,e){if(t instanceof ab)t.setMapInternal(e);else if(t instanceof Hb){const i=t.getLayers().getArray();for(let t=0,n=i.length;t<n;++t)rx(i[t],e)}}const sx=class extends og{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=function(t){let e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const i={},n=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new Hb({layers:t.layers});let r,s,a;i[i_]=n,i[r_]=t.target,i[s_]=t.view instanceof rb?t.view:new rb,void 0!==t.controls&&(Array.isArray(t.controls)?r=new gg(t.controls.slice()):(Tg("function"==typeof t.controls.getArray,47),r=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?s=new gg(t.interactions.slice()):(Tg("function"==typeof t.interactions.getArray,48),s=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?a=new gg(t.overlays.slice()):(Tg("function"==typeof t.overlays.getArray,49),a=t.overlays):a=new gg;return{controls:r,interactions:s,keyboardEventTarget:e,overlays:a,values:i}}(t);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:_g,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver((()=>this.updateSize())),this.controls=e.controls||y_(),this.interactions=e.interactions||function(t){t=t||{};const e=new gg,i=new J_(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&e.push(new N_),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&e.push(new w_({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&e.push(new D_({onFocusOnly:t.onFocusOnly,kinetic:i})),(void 0===t.pinchRotate||t.pinchRotate)&&e.push(new Q_),(void 0===t.pinchZoom||t.pinchZoom)&&e.push(new tx({duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(e.push(new q_),e.push(new Z_({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&e.push(new $_({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&e.push(new H_({duration:t.zoomDuration})),e}({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new f_(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(i_,this.handleLayerGroupChanged_),this.addChangeListener(s_,this.handleViewChanged_),this.addChangeListener(n_,this.handleSizeChanged_),this.addChangeListener(r_,this.handleTargetChanged_),this.setProperties(e.values);const i=this;!t.view||t.view instanceof rb||t.view.then((function(t){i.setView(new rb(t))})),this.controls.addEventListener(ug,(t=>{t.element.setMap(this)})),this.controls.addEventListener(dg,(t=>{t.element.setMap(null)})),this.interactions.addEventListener(ug,(t=>{t.element.setMap(this)})),this.interactions.addEventListener(dg,(t=>{t.element.setMap(null)})),this.overlays_.addEventListener(ug,(t=>{this.addOverlayInternal_(t.element)})),this.overlays_.addEventListener(dg,(t=>{const e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)})),this.controls.forEach((t=>{t.setMap(this)})),this.interactions.forEach((t=>{t.setMap(this)})),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){rx(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;const n=this.getCoordinateFromPixelInternal(t),r=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance:0,s=void 0!==i.layerFilter?i.layerFilter:Np,a=!1!==i.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,a,e,null,s,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,(function(t){i.push(t)}),e),i}getAllLayers(){const t=[];return function e(i){i.forEach((function(i){i instanceof Hb?e(i.getLayers()):t.push(i)}))}(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:Np,r=void 0!==e.hitTolerance?e.hitTolerance:0,s=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,s,n,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),i=this.getSize(),n=e.width/i[0],r=e.height/i[1],s="changedTouches"in t?t.changedTouches[0]:t;return[(s.clientX-e.left)/n,(s.clientY-e.top)/r]}getTarget(){return this.get(r_)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return Kv(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?Cg(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(i_)}setLayers(t){const e=this.getLayerGroup();if(t instanceof gg)return void e.setLayers(t);const i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e];if(!i.visible)continue;const n=i.layer.getRenderer();if(n&&!n.ready)return!0;const r=i.layer.getSource();if(r&&r.loading)return!0}return!1}getPixelFromCoordinate(t){const e=qv(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?Cg(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(n_)}getView(){return this.get(s_)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,n){return function(t,e,i,n,r){if(!t||!(i in t.wantedTiles))return a_;if(!t.wantedTiles[i][e.getKey()])return a_;const s=t.viewState.center,a=n[0]-s[0],o=n[1]-s[1];return 65536*Math.log(r)+Math.sqrt(a*a+o*o)/r}(this.frameState_,t,e,i,n)}handleBrowserEvent(t,e){e=e||t.type;const i=new Vb(e,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if(i===qb||i===Jp||i===Yp){const t=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():t,n=e.target;if(this.overlayContainerStopEvent_.contains(n)||!(i===t?t.documentElement:i).contains(n))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t)){const e=this.getInteractions().getArray().slice();for(let i=e.length-1;i>=0;i--){const n=e[i];if(n.getMap()!==this||!n.getActive()||!this.getTargetElement())continue;if(!n.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let i=this.maxTilesLoading_,n=i;if(t){const e=t.viewHints;if(e[Km]||e[qm]){const e=Date.now()-t.time>8;i=e?0:8,n=e?0:2}}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,n))}t&&this.renderer_&&!t.animate&&(!0===this.renderComplete_?(this.hasListener(Ym)&&this.renderer_.dispatchRenderEvent(Ym,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new Xb(e_,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new Xb(t_,this,t))));const i=this.postRenderFunctions_;for(let e=0,n=i.length;e<n;++e)i[e](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)tg(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Hp,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Jp,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,_b(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const t=this.targetElement_.getRootNode();t instanceof ShadowRoot&&this.resizeObserver_.unobserve(t.host),this.setSize(void 0)}const t=this.getTarget(),e="string"==typeof t?document.getElementById(t):t;if(this.targetElement_=e,e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new zb(this)),this.mapBrowserEventHandler_=new Zb(this,this.moveTolerance_);for(const t in Yb)this.mapBrowserEventHandler_.addEventListener(Yb[t],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Hp,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Jp,this.boundHandleBrowserEvent_,!!Sg&&{passive:!1});const t=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[$p(t,Yp,this.handleBrowserEvent,this),$p(t,Kp,this.handleBrowserEvent,this)];const i=e.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_.observe(e)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(tg(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(tg(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=$p(t,Ap,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=$p(t,Gp,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(tg),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new Wb("addlayer",t)),this.layerGroupPropertyListenerKeys_=[$p(t,Ap,this.render,this),$p(t,Gp,this.render,this),$p(t,"addlayer",this.handleLayerAdd_,this),$p(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}flushDeclutterItems(){const t=this.frameState_;t&&this.renderer_.flushDeclutterItems(t)}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){nx(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),n=this.frameState_;let r=null;if(void 0!==e&&ex(e)&&i&&i.isDef()){const n=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),s=i.getState();if(r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:tm(s.center,s.resolution,s.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:s,viewHints:n,wantedTiles:{},mapId:sg(this),renderTargets:{}},s.nextCenter&&s.nextResolution){const t=isNaN(s.nextRotation)?s.rotation:s.nextRotation;r.nextExtent=tm(s.nextCenter,s.nextResolution,t,e)}}if(this.frameState_=r,this.renderer_.renderFrame(r),r){if(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),n){(!this.previousExtent_||!lm(this.previousExtent_)&&!Hg(r.extent,this.previousExtent_))&&(this.dispatchEvent(new Xb($b,this,n)),this.previousExtent_=Ug(this.previousExtent_))}this.previousExtent_&&!r.viewHints[Km]&&!r.viewHints[qm]&&!Hg(r.extent,this.previousExtent_)&&(this.dispatchEvent(new Xb(Qb,this,r)),Dg(r.extent,this.previousExtent_))}this.dispatchEvent(new Xb(Jb,this,r)),this.renderComplete_=this.hasListener(t_)||this.hasListener(e_)||this.hasListener(Ym)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()}),0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new Wb("removelayer",e)),this.set(i_,t)}setSize(t){this.set(n_,t)}setTarget(t){this.set(r_,t)}setView(t){if(!t||t instanceof rb)return void this.set(s_,t);this.set(s_,new rb);const e=this;t.then((function(t){e.setView(new rb(t))}))}updateSize(){const t=this.getTargetElement();let e;if(t){const i=getComputedStyle(t),n=t.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),r=t.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);isNaN(n)||isNaN(r)||(e=[n,r],!ex(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&Av("No map visible because the map container's width or height are 0."))}const i=this.getSize();!e||i&&Dp(e,i)||(this.setSize(e),this.updateViewportSize_())}updateViewportSize_(){const t=this.getView();if(t){let e;const i=getComputedStyle(this.viewport_);i.width&&i.height&&(e=[parseInt(i.width,10),parseInt(i.height,10)]),t.setViewportSize(e)}}};var ax=1,ox=2,lx=3,hx=5,cx=6378137,ux=6356752.314,dx=.0066943799901413165,fx=484813681109536e-20,px=Math.PI/2,gx=.16666666666666666,mx=.04722222222222222,vx=.022156084656084655,yx=1e-10,bx=.017453292519943295,_x=57.29577951308232,xx=Math.PI/4,wx=2*Math.PI,Sx=3.14159265359,Tx={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667};const Ex={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var kx=/[\s_\-\/\(\)]/g;function Cx(t,e){if(t[e])return t[e];for(var i,n=Object.keys(t),r=e.toLowerCase().replace(kx,""),s=-1;++s<n.length;)if((i=n[s]).toLowerCase().replace(kx,"")===r)return t[i]}function Mx(t){var e,i,n,r={},s=t.split("+").map((function(t){return t.trim()})).filter((function(t){return t})).reduce((function(t,e){var i=e.split("=");return i.push(!0),t[i[0].toLowerCase()]=i[1],t}),{}),a={proj:"projName",datum:"datumCode",rf:function(t){r.rf=parseFloat(t)},lat_0:function(t){r.lat0=t*bx},lat_1:function(t){r.lat1=t*bx},lat_2:function(t){r.lat2=t*bx},lat_ts:function(t){r.lat_ts=t*bx},lon_0:function(t){r.long0=t*bx},lon_1:function(t){r.long1=t*bx},lon_2:function(t){r.long2=t*bx},alpha:function(t){r.alpha=parseFloat(t)*bx},gamma:function(t){r.rectified_grid_angle=parseFloat(t)},lonc:function(t){r.longc=t*bx},x_0:function(t){r.x0=parseFloat(t)},y_0:function(t){r.y0=parseFloat(t)},k_0:function(t){r.k0=parseFloat(t)},k:function(t){r.k0=parseFloat(t)},a:function(t){r.a=parseFloat(t)},b:function(t){r.b=parseFloat(t)},r_a:function(){r.R_A=!0},zone:function(t){r.zone=parseInt(t,10)},south:function(){r.utmSouth=!0},towgs84:function(t){r.datum_params=t.split(",").map((function(t){return parseFloat(t)}))},to_meter:function(t){r.to_meter=parseFloat(t)},units:function(t){r.units=t;var e=Cx(Ex,t);e&&(r.to_meter=e.to_meter)},from_greenwich:function(t){r.from_greenwich=t*bx},pm:function(t){var e=Cx(Tx,t);r.from_greenwich=(e||parseFloat(t))*bx},nadgrids:function(t){"@null"===t?r.datumCode="none":r.nadgrids=t},axis:function(t){var e="ewnsud";3===t.length&&-1!==e.indexOf(t.substr(0,1))&&-1!==e.indexOf(t.substr(1,1))&&-1!==e.indexOf(t.substr(2,1))&&(r.axis=t)},approx:function(){r.approx=!0}};for(e in s)i=s[e],e in a?"function"==typeof(n=a[e])?n(i):r[n]=i:r[e]=i;return"string"==typeof r.datumCode&&"WGS84"!==r.datumCode&&(r.datumCode=r.datumCode.toLowerCase()),r}const Ax=function(t){var e=new Nx(t);return e.output()};var Ox=1,Px=/\s/,Rx=/[A-Za-z]/,Ix=/[A-Za-z84_]/,Lx=/[,\]]/,Dx=/[\d\.E\-\+]/;function Nx(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Ox}function Fx(t,e,i){Array.isArray(e)&&(i.unshift(e),e=null);var n=e?{}:t,r=i.reduce((function(t,e){return jx(e,t),t}),n);e&&(t[e]=r)}function jx(t,e){if(Array.isArray(t)){var i=t.shift();if("PARAMETER"===i&&(i=t.shift()),1===t.length)return Array.isArray(t[0])?(e[i]={},void jx(t[0],e[i])):void(e[i]=t[0]);if(t.length)if("TOWGS84"!==i){if("AXIS"===i)return i in e||(e[i]=[]),void e[i].push(t);var n;switch(Array.isArray(i)||(e[i]={}),i){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[i]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&jx(t[2],e[i]));case"SPHEROID":case"ELLIPSOID":return e[i]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&jx(t[3],e[i]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void Fx(e,i,t);default:for(n=-1;++n<t.length;)if(!Array.isArray(t[n]))return jx(t,e[i]);return Fx(e,i,t)}}else e[i]=t;else e[i]=!0}else e[t]=!0}Nx.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;Px.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case Ox:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},Nx.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(Lx.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},Nx.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=Ox)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=Ox,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},Nx.prototype.number=function(t){if(!Dx.test(t)){if(Lx.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},Nx.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},Nx.prototype.keyword=function(t){if(Ix.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=Ox)}if(!Lx.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},Nx.prototype.neutral=function(t){if(Rx.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(Dx.test(t))return this.word=t,void(this.state=3);if(!Lx.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},Nx.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var Bx=.017453292519943295;function zx(t){return t*Bx}function Wx(t){var e=Ax(t),i=e.shift(),n=e.shift();e.unshift(["name",n]),e.unshift(["type",i]);var r={};return jx(e,r),function(t){if("GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var e="",i=0,n=t.AXIS.length;i<n;++i){var r=[t.AXIS[i][0].toLowerCase(),t.AXIS[i][1].toLowerCase()];-1!==r[0].indexOf("north")||("y"===r[0]||"lat"===r[0])&&"north"===r[1]?e+="n":-1!==r[0].indexOf("south")||("y"===r[0]||"lat"===r[0])&&"south"===r[1]?e+="s":-1!==r[0].indexOf("east")||("x"===r[0]||"lon"===r[0])&&"east"===r[1]?e+="e":-1===r[0].indexOf("west")&&("x"!==r[0]&&"lon"!==r[0]||"west"!==r[1])||(e+="w")}2===e.length&&(e+="u"),3===e.length&&(t.axis=e)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var s=t.GEOGCS;function a(e){return e*(t.to_meter||1)}"GEOGCS"===t.type&&(s=t),s&&(s.DATUM?t.datumCode=s.DATUM.name.toLowerCase():t.datumCode=s.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"!==t.datumCode&&"world_geodetic_system_1984"!==t.datumCode||("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),s.DATUM&&s.DATUM.SPHEROID&&(t.ellps=s.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=s.DATUM.SPHEROID.a,t.rf=parseFloat(s.DATUM.SPHEROID.rf,10)),s.DATUM&&s.DATUM.TOWGS84&&(t.datum_params=s.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",zx],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",zx],["x0","false_easting",a],["y0","false_northing",a],["long0","central_meridian",zx],["lat0","latitude_of_origin",zx],["lat0","standard_parallel_1",zx],["lat1","standard_parallel_1",zx],["lat2","standard_parallel_2",zx],["azimuth","Azimuth"],["alpha","azimuth",zx],["srsCode","name"]].forEach((function(e){return function(t,e){var i=e[0],n=e[1];!(i in t)&&n in t&&(t[i]=t[n],3===e.length&&(t[i]=e[2](t[i])))}(t,e)})),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName?!t.lat_ts&&t.lat0&&"Polar_Stereographic"===t.projName&&(t.lat_ts=t.lat0,t.lat0=zx(t.lat0>0?90:-90)):(t.lat0=zx(t.lat1>0?90:-90),t.lat_ts=t.lat1)}(r),r}function Gx(t){var e=this;if(2===arguments.length){var i=arguments[1];"string"==typeof i?"+"===i.charAt(0)?Gx[t]=Mx(arguments[1]):Gx[t]=Wx(arguments[1]):Gx[t]=i}else if(1===arguments.length){if(Array.isArray(t))return t.map((function(t){Array.isArray(t)?Gx.apply(e,t):Gx(t)}));if("string"==typeof t){if(t in Gx)return Gx[t]}else"EPSG"in t?Gx["EPSG:"+t.EPSG]=t:"ESRI"in t?Gx["ESRI:"+t.ESRI]=t:"IAU2000"in t?Gx["IAU2000:"+t.IAU2000]=t:console.log(t);return}}!function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}(Gx);const Ux=Gx;var Hx=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];var Xx=["3857","900913","3785","102113"];const Vx=function(t){if(!function(t){return"string"==typeof t}(t))return t;if(function(t){return t in Ux}(t))return Ux[t];if(function(t){return Hx.some((function(e){return t.indexOf(e)>-1}))}(t)){var e=Wx(t);if(function(t){var e=Cx(t,"authority");if(e){var i=Cx(e,"epsg");return i&&Xx.indexOf(i)>-1}}(e))return Ux["EPSG:3857"];var i=function(t){var e=Cx(t,"extension");if(e)return Cx(e,"proj4")}(e);return i?Mx(i):e}return function(t){return"+"===t[0]}(t)?Mx(t):void 0};function Yx(t,e){var i,n;if(t=t||{},!e)return t;for(n in e)void 0!==(i=e[n])&&(t[n]=i);return t}function Kx(t,e,i){var n=t*e;return i/Math.sqrt(1-n*n)}function qx(t){return t<0?-1:1}function Zx(t){return Math.abs(t)<=Sx?t:t-qx(t)*wx}function Jx(t,e,i){var n=t*i,r=.5*t;return n=Math.pow((1-n)/(1+n),r),Math.tan(.5*(px-e))/n}function $x(t,e){for(var i,n,r=.5*t,s=px-2*Math.atan(e),a=0;a<=15;a++)if(i=t*Math.sin(s),s+=n=px-2*Math.atan(e*Math.pow((1-i)/(1+i),r))-s,Math.abs(n)<=1e-10)return s;return-9999}function Qx(t){return t}var tw=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Kx(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var e,i,n=t.x,r=t.y;if(r*_x>90&&r*_x<-90&&n*_x>180&&n*_x<-180)return null;if(Math.abs(Math.abs(r)-px)<=yx)return null;if(this.sphere)e=this.x0+this.a*this.k0*Zx(n-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(xx+.5*r));else{var s=Math.sin(r),a=Jx(this.e,r,s);e=this.x0+this.a*this.k0*Zx(n-this.long0),i=this.y0-this.a*this.k0*Math.log(a)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,n=t.x-this.x0,r=t.y-this.y0;if(this.sphere)i=px-2*Math.atan(Math.exp(-r/(this.a*this.k0)));else{var s=Math.exp(-r/(this.a*this.k0));if(-9999===(i=$x(this.e,s)))return null}return e=Zx(this.long0+n/(this.a*this.k0)),t.x=e,t.y=i,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:Qx,inverse:Qx,names:["longlat","identity"]}],ew={},iw=[];function nw(t,e){var i=iw.length;return t.names?(iw[i]=t,t.names.forEach((function(t){ew[t.toLowerCase()]=i})),this):(console.log(e),!0)}const rw={start:function(){tw.forEach(nw)},add:nw,get:function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==ew[e]&&iw[ew[e]]?iw[ew[e]]:void 0}};var sw={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:6378249.2,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},aw=sw.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};sw.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var ow={};ow.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ow.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ow.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},ow.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},ow.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},ow.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},ow.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},ow.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},ow.militargeographische_institut={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},ow.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ow.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},ow.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},ow.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},ow.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},ow.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},ow.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},ow.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},ow.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};const lw=function(t,e,i,n,r,s,a){var o={};return o.datum_type=void 0===t||"none"===t?hx:4,e&&(o.datum_params=e.map(parseFloat),0===o.datum_params[0]&&0===o.datum_params[1]&&0===o.datum_params[2]||(o.datum_type=ax),o.datum_params.length>3&&(0===o.datum_params[3]&&0===o.datum_params[4]&&0===o.datum_params[5]&&0===o.datum_params[6]||(o.datum_type=ox,o.datum_params[3]*=fx,o.datum_params[4]*=fx,o.datum_params[5]*=fx,o.datum_params[6]=o.datum_params[6]/1e6+1))),a&&(o.datum_type=lx,o.grids=a),o.a=i,o.b=n,o.es=r,o.ep2=s,o};var hw={};function cw(t){if(0===t.length)return null;var e="@"===t[0];return e&&(t=t.slice(1)),"null"===t?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:hw[t]||null,isNull:!1}}function uw(t){return t/3600*Math.PI/180}function dw(t,e,i){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,i)))}function fw(t){return t.map((function(t){return[uw(t.longitudeShift),uw(t.latitudeShift)]}))}function pw(t,e,i){return{name:dw(t,e+8,e+16).trim(),parent:dw(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,i),upperLatitude:t.getFloat64(e+88,i),lowerLongitude:t.getFloat64(e+104,i),upperLongitude:t.getFloat64(e+120,i),latitudeInterval:t.getFloat64(e+136,i),longitudeInterval:t.getFloat64(e+152,i),gridNodeCount:t.getInt32(e+168,i)}}function gw(t,e,i,n){for(var r=e+176,s=[],a=0;a<i.gridNodeCount;a++){var o={latitudeShift:t.getFloat32(r+16*a,n),longitudeShift:t.getFloat32(r+16*a+4,n),latitudeAccuracy:t.getFloat32(r+16*a+8,n),longitudeAccuracy:t.getFloat32(r+16*a+12,n)};s.push(o)}return s}function mw(t,e){if(!(this instanceof mw))return new mw(t);e=e||function(t){if(t)throw t};var i=Vx(t);if("object"==typeof i){var n=mw.projections.get(i.projName);if(n){if(i.datumCode&&"none"!==i.datumCode){var r=Cx(ow,i.datumCode);r&&(i.datum_params=i.datum_params||(r.towgs84?r.towgs84.split(","):null),i.ellps=r.ellipse,i.datumName=r.datumName?r.datumName:i.datumCode)}i.k0=i.k0||1,i.axis=i.axis||"enu",i.ellps=i.ellps||"wgs84",i.lat1=i.lat1||i.lat0;var s,a,o,l,h,c,u,d=function(t,e,i,n,r){if(!t){var s=Cx(sw,n);s||(s=aw),t=s.a,e=s.b,i=s.rf}return i&&!e&&(e=(1-1/i)*t),(0===i||Math.abs(t-e)<yx)&&(r=!0,e=t),{a:t,b:e,rf:i,sphere:r}}(i.a,i.b,i.rf,i.ellps,i.sphere),f=(s=d.a,a=d.b,d.rf,o=i.R_A,c=((l=s*s)-(h=a*a))/l,u=0,o?(l=(s*=1-c*(gx+c*(mx+c*vx)))*s,c=0):u=Math.sqrt(c),{es:c,e:u,ep2:(l-h)/h}),p=function(t){return void 0===t?null:t.split(",").map(cw)}(i.nadgrids),g=i.datum||lw(i.datumCode,i.datum_params,d.a,d.b,f.es,f.ep2,p);Yx(this,i),Yx(this,n),this.a=d.a,this.b=d.b,this.rf=d.rf,this.sphere=d.sphere,this.es=f.es,this.e=f.e,this.ep2=f.ep2,this.datum=g,this.init(),e(null,this)}else e(t)}else e(t)}mw.projections=rw,mw.projections.start();const vw=mw;function yw(t,e,i){var n,r,s,a,o=t.x,l=t.y,h=t.z?t.z:0;if(l<-px&&l>-1.001*px)l=-px;else if(l>px&&l<1.001*px)l=px;else{if(l<-px)return{x:-1/0,y:-1/0,z:t.z};if(l>px)return{x:1/0,y:1/0,z:t.z}}return o>Math.PI&&(o-=2*Math.PI),r=Math.sin(l),a=Math.cos(l),s=r*r,{x:((n=i/Math.sqrt(1-e*s))+h)*a*Math.cos(o),y:(n+h)*a*Math.sin(o),z:(n*(1-e)+h)*r}}function bw(t,e,i,n){var r,s,a,o,l,h,c,u,d,f,p,g,m,v,y,b=1e-12,_=t.x,x=t.y,w=t.z?t.z:0;if(r=Math.sqrt(_*_+x*x),s=Math.sqrt(_*_+x*x+w*w),r/i<b){if(v=0,s/i<b)return px,y=-n,{x:t.x,y:t.y,z:t.z}}else v=Math.atan2(x,_);a=w/s,u=(o=r/s)*(1-e)*(l=1/Math.sqrt(1-e*(2-e)*o*o)),d=a*l,m=0;do{m++,h=e*(c=i/Math.sqrt(1-e*d*d))/(c+(y=r*u+w*d-c*(1-e*d*d))),g=(p=a*(l=1/Math.sqrt(1-h*(2-h)*o*o)))*u-(f=o*(1-h)*l)*d,u=f,d=p}while(g*g>1e-24&&m<30);return{x:v,y:Math.atan(p/Math.abs(f)),z:y}}function _w(t){return t===ax||t===ox}function xw(t,e,i){if(function(t,e){return t.datum_type===e.datum_type&&!(t.a!==e.a||Math.abs(t.es-e.es)>5e-11)&&(t.datum_type===ax?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type!==ox||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6])}(t,e))return i;if(t.datum_type===hx||e.datum_type===hx)return i;var n=t.a,r=t.es;if(t.datum_type===lx){if(0!==ww(t,!1,i))return;n=cx,r=dx}var s=e.a,a=e.b,o=e.es;if(e.datum_type===lx&&(s=cx,a=ux,o=dx),r===o&&n===s&&!_w(t.datum_type)&&!_w(e.datum_type))return i;if((i=yw(i,r,n),_w(t.datum_type)&&(i=function(t,e,i){if(e===ax)return{x:t.x+i[0],y:t.y+i[1],z:t.z+i[2]};if(e===ox){var n=i[0],r=i[1],s=i[2],a=i[3],o=i[4],l=i[5],h=i[6];return{x:h*(t.x-l*t.y+o*t.z)+n,y:h*(l*t.x+t.y-a*t.z)+r,z:h*(-o*t.x+a*t.y+t.z)+s}}}(i,t.datum_type,t.datum_params)),_w(e.datum_type)&&(i=function(t,e,i){if(e===ax)return{x:t.x-i[0],y:t.y-i[1],z:t.z-i[2]};if(e===ox){var n=i[0],r=i[1],s=i[2],a=i[3],o=i[4],l=i[5],h=i[6],c=(t.x-n)/h,u=(t.y-r)/h,d=(t.z-s)/h;return{x:c+l*u-o*d,y:-l*c+u+a*d,z:o*c-a*u+d}}}(i,e.datum_type,e.datum_params)),i=bw(i,o,s,a),e.datum_type===lx)&&0!==ww(e,!0,i))return;return i}function ww(t,e,i){if(null===t.grids||0===t.grids.length)return console.log("Grid shift grids not found"),-1;var n={x:-i.x,y:i.y},r={x:Number.NaN,y:Number.NaN},s=[];t:for(var a=0;a<t.grids.length;a++){var o=t.grids[a];if(s.push(o.name),o.isNull){r=n;break}if(o.mandatory,null!==o.grid)for(var l=o.grid.subgrids,h=0,c=l.length;h<c;h++){var u=l[h],d=(Math.abs(u.del[1])+Math.abs(u.del[0]))/1e4,f=u.ll[0]-d,p=u.ll[1]-d,g=u.ll[0]+(u.lim[0]-1)*u.del[0]+d,m=u.ll[1]+(u.lim[1]-1)*u.del[1]+d;if(!(p>n.y||f>n.x||m<n.y||g<n.x)&&(r=Sw(n,e,u),!isNaN(r.x)))break t}else if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-n.x*_x+" "+n.y*_x+" tried: '"+s+"'"),-1):(i.x=-r.x,i.y=r.y,0)}function Sw(t,e,i){var n={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return n;var r={x:t.x,y:t.y};r.x-=i.ll[0],r.y-=i.ll[1],r.x=Zx(r.x-Math.PI)+Math.PI;var s=Tw(r,i);if(e){if(isNaN(s.x))return n;s.x=r.x-s.x,s.y=r.y-s.y;var a,o,l=9;do{if(o=Tw(s,i),isNaN(o.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}a={x:r.x-(o.x+s.x),y:r.y-(o.y+s.y)},s.x+=a.x,s.y+=a.y}while(l--&&Math.abs(a.x)>1e-12&&Math.abs(a.y)>1e-12);if(l<0)return console.log("Inverse grid shift iterator failed to converge."),n;n.x=Zx(s.x+i.ll[0]),n.y=s.y+i.ll[1]}else isNaN(s.x)||(n.x=t.x+s.x,n.y=t.y+s.y);return n}function Tw(t,e){var i,n={x:t.x/e.del[0],y:t.y/e.del[1]},r=Math.floor(n.x),s=Math.floor(n.y),a=n.x-1*r,o=n.y-1*s,l={x:Number.NaN,y:Number.NaN};if(r<0||r>=e.lim[0])return l;if(s<0||s>=e.lim[1])return l;i=s*e.lim[0]+r;var h=e.cvs[i][0],c=e.cvs[i][1];i++;var u=e.cvs[i][0],d=e.cvs[i][1];i+=e.lim[0];var f=e.cvs[i][0],p=e.cvs[i][1];i--;var g=e.cvs[i][0],m=e.cvs[i][1],v=a*o,y=a*(1-o),b=(1-a)*(1-o),_=(1-a)*o;return l.x=b*h+y*u+_*g+v*f,l.y=b*c+y*d+_*m+v*p,l}function Ew(t,e,i){var n,r,s,a=i.x,o=i.y,l=i.z||0,h={};for(s=0;s<3;s++)if(!e||2!==s||void 0!==i.z)switch(0===s?(n=a,r=-1!=="ew".indexOf(t.axis[s])?"x":"y"):1===s?(n=o,r=-1!=="ns".indexOf(t.axis[s])?"y":"x"):(n=l,r="z"),t.axis[s]){case"e":case"n":h[r]=n;break;case"w":case"s":h[r]=-n;break;case"u":void 0!==i[r]&&(h.z=n);break;case"d":void 0!==i[r]&&(h.z=-n);break;default:return null}return h}function kw(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function Cw(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function Mw(t,e,i,n){var r,s=void 0!==(i=Array.isArray(i)?kw(i):{x:i.x,y:i.y,z:i.z,m:i.m}).z;if(function(t){Cw(t.x),Cw(t.y)}(i),t.datum&&e.datum&&function(t,e){return(t.datum.datum_type===ax||t.datum.datum_type===ox||t.datum.datum_type===lx)&&"WGS84"!==e.datumCode||(e.datum.datum_type===ax||e.datum.datum_type===ox||e.datum.datum_type===lx)&&"WGS84"!==t.datumCode}(t,e)&&(i=Mw(t,r=new vw("WGS84"),i,n),t=r),n&&"enu"!==t.axis&&(i=Ew(t,!1,i)),"longlat"===t.projName)i={x:i.x*bx,y:i.y*bx,z:i.z||0};else if(t.to_meter&&(i={x:i.x*t.to_meter,y:i.y*t.to_meter,z:i.z||0}),!(i=t.inverse(i)))return;if(t.from_greenwich&&(i.x+=t.from_greenwich),i=xw(t.datum,e.datum,i))return e.from_greenwich&&(i={x:i.x-e.from_greenwich,y:i.y,z:i.z||0}),"longlat"===e.projName?i={x:i.x*_x,y:i.y*_x,z:i.z||0}:(i=e.forward(i),e.to_meter&&(i={x:i.x/e.to_meter,y:i.y/e.to_meter,z:i.z||0})),n&&"enu"!==e.axis?Ew(e,!0,i):(i&&!s&&delete i.z,i)}var Aw=vw("WGS84");function Ow(t,e,i,n){var r,s,a;return Array.isArray(i)?(r=Mw(t,e,i,n)||{x:NaN,y:NaN},i.length>2?void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name?"number"==typeof r.z?[r.x,r.y,r.z].concat(i.splice(3)):[r.x,r.y,i[2]].concat(i.splice(3)):[r.x,r.y].concat(i.splice(2)):[r.x,r.y]):(s=Mw(t,e,i,n),2===(a=Object.keys(i)).length||a.forEach((function(n){if(void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name){if("x"===n||"y"===n||"z"===n)return}else if("x"===n||"y"===n)return;s[n]=i[n]})),s)}function Pw(t){return t instanceof vw?t:t.oProj?t.oProj:vw(t)}const Rw=function(t,e,i){t=Pw(t);var n,r=!1;return void 0===e?(e=t,t=Aw,r=!0):(void 0!==e.x||Array.isArray(e))&&(i=e,e=t,t=Aw,r=!0),e=Pw(e),i?Ow(t,e,i):(n={forward:function(i,n){return Ow(t,e,i,n)},inverse:function(i,n){return Ow(e,t,i,n)}},r&&(n.oProj=e),n)};var Iw=6,Lw="AJSAJS",Dw="AFAFAF",Nw=65,Fw=73,jw=79,Bw=86,zw=90;const Ww={forward:Gw,inverse:function(t){var e=Vw(qw(t.toUpperCase()));if(e.lat&&e.lon)return[e.lon,e.lat,e.lon,e.lat];return[e.left,e.bottom,e.right,e.top]},toPoint:Uw};function Gw(t,e){return e=e||5,function(t,e){var i="00000"+t.easting,n="00000"+t.northing;return t.zoneNumber+t.zoneLetter+(f=t.easting,p=t.northing,g=t.zoneNumber,m=Kw(g),v=Math.floor(f/1e5),y=Math.floor(p/1e5)%20,r=v,s=y,a=m,o=a-1,l=Lw.charCodeAt(o),h=Dw.charCodeAt(o),c=l+r-1,u=h+s,d=!1,c>zw&&(c=c-zw+Nw-1,d=!0),(c===Fw||l<Fw&&c>Fw||(c>Fw||l<Fw)&&d)&&c++,(c===jw||l<jw&&c>jw||(c>jw||l<jw)&&d)&&++c===Fw&&c++,c>zw&&(c=c-zw+Nw-1),u>Bw?(u=u-Bw+Nw-1,d=!0):d=!1,(u===Fw||h<Fw&&u>Fw||(u>Fw||h<Fw)&&d)&&u++,(u===jw||h<jw&&u>jw||(u>jw||h<jw)&&d)&&++u===Fw&&u++,u>Bw&&(u=u-Bw+Nw-1),String.fromCharCode(c)+String.fromCharCode(u))+i.substr(i.length-5,e)+n.substr(n.length-5,e);var r,s,a,o,l,h,c,u,d;var f,p,g,m,v,y}(function(t){var e,i,n,r,s,a,o,l,h=t.lat,c=t.lon,u=6378137,d=.00669438,f=.9996,p=Hw(h),g=Hw(c);l=Math.floor((c+180)/6)+1,180===c&&(l=60);h>=56&&h<64&&c>=3&&c<12&&(l=32);h>=72&&h<84&&(c>=0&&c<9?l=31:c>=9&&c<21?l=33:c>=21&&c<33?l=35:c>=33&&c<42&&(l=37));o=Hw(6*(l-1)-180+3),e=d/(1-d),i=u/Math.sqrt(1-d*Math.sin(p)*Math.sin(p)),n=Math.tan(p)*Math.tan(p),r=e*Math.cos(p)*Math.cos(p),s=Math.cos(p)*(g-o),a=u*((1-d/4-3*d*d/64-5*d*d*d/256)*p-(3*d/8+3*d*d/32+45*d*d*d/1024)*Math.sin(2*p)+(15*d*d/256+45*d*d*d/1024)*Math.sin(4*p)-35*d*d*d/3072*Math.sin(6*p));var m=f*i*(s+(1-n+r)*s*s*s/6+(5-18*n+n*n+72*r-58*e)*s*s*s*s*s/120)+5e5,v=f*(a+i*Math.tan(p)*(s*s/2+(5-n+9*r+4*r*r)*s*s*s*s/24+(61-58*n+n*n+600*r-330*e)*s*s*s*s*s*s/720));h<0&&(v+=1e7);return{northing:Math.round(v),easting:Math.round(m),zoneNumber:l,zoneLetter:Yw(h)}}({lat:t[1],lon:t[0]}),e)}function Uw(t){var e=Vw(qw(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Hw(t){return t*(Math.PI/180)}function Xw(t){return t/Math.PI*180}function Vw(t){var e=t.northing,i=t.easting,n=t.zoneLetter,r=t.zoneNumber;if(r<0||r>60)return null;var s,a,o,l,h,c,u,d,f,p=.9996,g=6378137,m=.00669438,v=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),y=i-5e5,b=e;n<"N"&&(b-=1e7),u=6*(r-1)-180+3,s=.006739496752268451,f=(d=b/p/6367449.145945056)+(3*v/2-27*v*v*v/32)*Math.sin(2*d)+(21*v*v/16-55*v*v*v*v/32)*Math.sin(4*d)+151*v*v*v/96*Math.sin(6*d),a=g/Math.sqrt(1-m*Math.sin(f)*Math.sin(f)),o=Math.tan(f)*Math.tan(f),l=s*Math.cos(f)*Math.cos(f),h=.99330562*g/Math.pow(1-m*Math.sin(f)*Math.sin(f),1.5),c=y/(a*p);var _=f-a*Math.tan(f)/h*(c*c/2-(5+3*o+10*l-4*l*l-9*s)*c*c*c*c/24+(61+90*o+298*l+45*o*o-1.6983531815716497-3*l*l)*c*c*c*c*c*c/720);_=Xw(_);var x,w=(c-(1+2*o+l)*c*c*c/6+(5-2*l+28*o-3*l*l+8*s+24*o*o)*c*c*c*c*c/120)/Math.cos(f);if(w=u+Xw(w),t.accuracy){var S=Vw({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});x={top:S.lat,right:S.lon,bottom:_,left:w}}else x={lat:_,lon:w};return x}function Yw(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function Kw(t){var e=t%Iw;return 0===e&&(e=Iw),e}function qw(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,i=t.length,n=null,r="",s=0;!/[A-Z]/.test(e=t.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+t;r+=e,s++}var a=parseInt(r,10);if(0===s||s+3>i)throw"MGRSPoint bad conversion from: "+t;var o=t.charAt(s++);if(o<="A"||"B"===o||"Y"===o||o>="Z"||"I"===o||"O"===o)throw"MGRSPoint zone letter "+o+" not handled: "+t;n=t.substring(s,s+=2);for(var l=Kw(a),h=function(t,e){var i=Lw.charCodeAt(e-1),n=1e5,r=!1;for(;i!==t.charCodeAt(0);){if(++i===Fw&&i++,i===jw&&i++,i>zw){if(r)throw"Bad character: "+t;i=Nw,r=!0}n+=1e5}return n}(n.charAt(0),l),c=function(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;var i=Dw.charCodeAt(e-1),n=0,r=!1;for(;i!==t.charCodeAt(0);){if(++i===Fw&&i++,i===jw&&i++,i>Bw){if(r)throw"Bad character: "+t;i=Nw,r=!0}n+=1e5}return n}(n.charAt(1),l);c<Zw(o);)c+=2e6;var u=i-s;if(u%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var d,f,p,g=u/2,m=0,v=0;return g>0&&(d=1e5/Math.pow(10,g),f=t.substring(s,s+g),m=parseFloat(f)*d,p=t.substring(s+g),v=parseFloat(p)*d),{easting:m+h,northing:v+c,zoneLetter:o,zoneNumber:a,accuracy:d}}function Zw(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function Jw(t,e,i){if(!(this instanceof Jw))return new Jw(t,e,i);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var n=t.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=t,this.y=e,this.z=i||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Jw.fromMGRS=function(t){return new Jw(Uw(t))},Jw.prototype.toMGRS=function(t){return Gw([this.x,this.y],t)};const $w=Jw;var Qw=1,tS=.25,eS=.046875,iS=.01953125,nS=.01068115234375,rS=.75,sS=.46875,aS=.013020833333333334,oS=.007120768229166667,lS=.3645833333333333,hS=.005696614583333333,cS=.3076171875;function uS(t){var e=[];e[0]=Qw-t*(tS+t*(eS+t*(iS+t*nS))),e[1]=t*(rS-t*(eS+t*(iS+t*nS)));var i=t*t;return e[2]=i*(sS-t*(aS+t*oS)),i*=t,e[3]=i*(lS-t*hS),e[4]=i*t*cS,e}function dS(t,e,i,n){return i*=e,e*=e,n[0]*t-i*(n[1]+e*(n[2]+e*(n[3]+e*n[4])))}var fS=20;function pS(t,e,i){for(var n=1/(1-e),r=t,s=fS;s;--s){var a=Math.sin(r),o=1-e*a*a;if(r-=o=(dS(r,a,Math.cos(r),i)-t)*(o*Math.sqrt(o))*n,Math.abs(o)<yx)return r}return r}const gS={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=uS(this.es),this.ml0=dS(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,i,n,r=t.x,s=t.y,a=Zx(r-this.long0),o=Math.sin(s),l=Math.cos(s);if(this.es){var h=l*a,c=Math.pow(h,2),u=this.ep2*Math.pow(l,2),d=Math.pow(u,2),f=Math.abs(l)>yx?Math.tan(s):0,p=Math.pow(f,2),g=Math.pow(p,2);e=1-this.es*Math.pow(o,2),h/=Math.sqrt(e);var m=dS(s,o,l,this.en);i=this.a*(this.k0*h*(1+c/6*(1-p+u+c/20*(5-18*p+g+14*u-58*p*u+c/42*(61+179*g-g*p-479*p)))))+this.x0,n=this.a*(this.k0*(m-this.ml0+o*a*h/2*(1+c/12*(5-p+9*u+4*d+c/30*(61+g-58*p+270*u-330*p*u+c/56*(1385+543*g-g*p-3111*p))))))+this.y0}else{var v=l*Math.sin(a);if(Math.abs(Math.abs(v)-1)<yx)return 93;if(i=.5*this.a*this.k0*Math.log((1+v)/(1-v))+this.x0,n=l*Math.cos(a)/Math.sqrt(1-Math.pow(v,2)),(v=Math.abs(n))>=1){if(v-1>yx)return 93;n=0}else n=Math.acos(n);s<0&&(n=-n),n=this.a*this.k0*(n-this.lat0)+this.y0}return t.x=i,t.y=n,t},inverse:function(t){var e,i,n,r,s=(t.x-this.x0)*(1/this.a),a=(t.y-this.y0)*(1/this.a);if(this.es)if(i=pS(e=this.ml0+a/this.k0,this.es,this.en),Math.abs(i)<px){var o=Math.sin(i),l=Math.cos(i),h=Math.abs(l)>yx?Math.tan(i):0,c=this.ep2*Math.pow(l,2),u=Math.pow(c,2),d=Math.pow(h,2),f=Math.pow(d,2);e=1-this.es*Math.pow(o,2);var p=s*Math.sqrt(e)/this.k0,g=Math.pow(p,2);n=i-(e*=h)*g/(1-this.es)*.5*(1-g/12*(5+3*d-9*c*d+c-4*u-g/30*(61+90*d-252*c*d+45*f+46*c-g/56*(1385+3633*d+4095*f+1574*f*d)))),r=Zx(this.long0+p*(1-g/6*(1+2*d+c-g/20*(5+28*d+24*f+8*c*d+6*c-g/42*(61+662*d+1320*f+720*f*d))))/l)}else n=px*qx(a),r=0;else{var m=Math.exp(s/this.k0),v=.5*(m-1/m),y=this.lat0+a/this.k0,b=Math.cos(y);e=Math.sqrt((1-Math.pow(b,2))/(1+Math.pow(v,2))),n=Math.asin(e),a<0&&(n=-n),r=0===v&&0===b?0:Zx(Math.atan2(v,b)+this.long0)}return t.x=r,t.y=n,t},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function mS(t){var e=Math.exp(t);return e=(e-1/e)/2}function vS(t,e){t=Math.abs(t),e=Math.abs(e);var i=Math.max(t,e),n=Math.min(t,e)/(i||1);return i*Math.sqrt(1+Math.pow(n,2))}function yS(t){var e=Math.abs(t);return e=function(t){var e=1+t,i=e-1;return 0===i?t:t*Math.log(e)/i}(e*(1+e/(vS(1,e)+1))),t<0?-e:e}function bS(t,e){for(var i,n=2*Math.cos(2*e),r=t.length-1,s=t[r],a=0;--r>=0;)i=n*s-a+t[r],a=s,s=i;return e+i*Math.sin(2*e)}function _S(t,e,i){for(var n,r,s=Math.sin(e),a=Math.cos(e),o=mS(i),l=function(t){var e=Math.exp(t);return(e+1/e)/2}(i),h=2*a*l,c=-2*s*o,u=t.length-1,d=t[u],f=0,p=0,g=0;--u>=0;)n=p,r=f,d=h*(p=d)-n-c*(f=g)+t[u],g=c*p-r+h*f;return[(h=s*l)*d-(c=a*o)*g,h*g+c*d]}const xS={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(gS.init.apply(this),this.forward=gS.forward,this.inverse=gS.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),i=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),i*=e,this.cgb[1]=i*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=i*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),i*=e,this.cgb[2]=i*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=i*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),i*=e,this.cgb[3]=i*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=i*(1237/630+e*(e*(-24832/14175)-2.4)),i*=e,this.cgb[4]=i*(4174/315+e*(-144838/6237)),this.cbg[4]=i*(-734/315+e*(109598/31185)),i*=e,this.cgb[5]=i*(601676/22275),this.cbg[5]=i*(444337/155925),i=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+i*(1/4+i*(1/64+i/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=i*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=i*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),i*=e,this.utg[2]=i*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=i*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),i*=e,this.utg[3]=i*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=i*(49561/161280+e*(-179/168+e*(6601661/7257600))),i*=e,this.utg[4]=i*(-4583/161280+e*(108847/3991680)),this.gtu[4]=i*(34729/80640+e*(-3418889/1995840)),i*=e,this.utg[5]=i*(-20648693/638668800),this.gtu[5]=.6650675310896665*i;var n=bS(this.cbg,this.lat0);this.Zb=-this.Qn*(n+function(t,e){for(var i,n=2*Math.cos(e),r=t.length-1,s=t[r],a=0;--r>=0;)i=n*s-a+t[r],a=s,s=i;return Math.sin(e)*i}(this.gtu,2*n))},forward:function(t){var e=Zx(t.x-this.long0),i=t.y;i=bS(this.cbg,i);var n=Math.sin(i),r=Math.cos(i),s=Math.sin(e),a=Math.cos(e);i=Math.atan2(n,a*r),e=Math.atan2(s*r,vS(n,r*a)),e=yS(Math.tan(e));var o,l,h=_S(this.gtu,2*i,2*e);return i+=h[0],e+=h[1],Math.abs(e)<=2.623395162778?(o=this.a*(this.Qn*e)+this.x0,l=this.a*(this.Qn*i+this.Zb)+this.y0):(o=1/0,l=1/0),t.x=o,t.y=l,t},inverse:function(t){var e,i,n=(t.x-this.x0)*(1/this.a),r=(t.y-this.y0)*(1/this.a);if(r=(r-this.Zb)/this.Qn,n/=this.Qn,Math.abs(n)<=2.623395162778){var s=_S(this.utg,2*r,2*n);r+=s[0],n+=s[1],n=Math.atan(mS(n));var a=Math.sin(r),o=Math.cos(r),l=Math.sin(n),h=Math.cos(n);r=Math.atan2(a*h,vS(l,h*o)),e=Zx((n=Math.atan2(l,h*o))+this.long0),i=bS(this.cgb,r)}else e=1/0,i=1/0;return t.x=e,t.y=i,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"]};const wS={init:function(){var t=function(t,e){if(void 0===t){if((t=Math.floor(30*(Zx(e)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t}(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*bx,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,xS.init.apply(this),this.forward=xS.forward,this.inverse=xS.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function SS(t,e){return Math.pow((1-t)/(1+t),e)}const TS={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+xx)/(Math.pow(Math.tan(.5*this.lat0+xx),this.C)*SS(this.e*t,this.ratexp))},forward:function(t){var e=t.x,i=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+xx),this.C)*SS(this.e*Math.sin(i),this.ratexp))-px,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,i=t.y,n=Math.pow(Math.tan(.5*i+xx)/this.K,1/this.C),r=20;r>0&&(i=2*Math.atan(n*SS(this.e*Math.sin(t.y),-.5*this.e))-px,!(Math.abs(i-t.y)<1e-14));--r)t.y=i;return r?(t.x=e,t.y=i,t):null},names:["gauss"]};const ES={init:function(){TS.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,i,n,r;return t.x=Zx(t.x-this.long0),TS.forward.apply(this,[t]),e=Math.sin(t.y),i=Math.cos(t.y),n=Math.cos(t.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*i*n),t.x=r*i*Math.sin(t.x),t.y=r*(this.cosc0*e-this.sinc0*i*n),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,i,n,r,s;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,s=vS(t.x,t.y)){var a=2*Math.atan2(s,this.R2);e=Math.sin(a),i=Math.cos(a),r=Math.asin(i*this.sinc0+t.y*e*this.cosc0/s),n=Math.atan2(t.x*e,s*this.cosc0*i-t.y*this.sinc0*e)}else r=this.phic0,n=0;return t.x=n,t.y=r,TS.inverse.apply(this,[t]),t.x=Zx(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]};const kS={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=yx&&(this.k0=.5*(1+qx(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=yx&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=yx&&Math.abs(Math.cos(this.lat_ts))>yx&&(this.k0=.5*this.cons*Kx(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Jx(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Kx(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-px,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,i,n,r,s,a,o=t.x,l=t.y,h=Math.sin(l),c=Math.cos(l),u=Zx(o-this.long0);return Math.abs(Math.abs(o-this.long0)-Math.PI)<=yx&&Math.abs(l+this.lat0)<=yx?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*h+this.coslat0*c*Math.cos(u)),t.x=this.a*e*c*Math.sin(u)+this.x0,t.y=this.a*e*(this.coslat0*h-this.sinlat0*c*Math.cos(u))+this.y0,t):(i=2*Math.atan(this.ssfn_(l,h,this.e))-px,r=Math.cos(i),n=Math.sin(i),Math.abs(this.coslat0)<=yx?(s=Jx(this.e,l*this.con,this.con*h),a=2*this.a*this.k0*s/this.cons,t.x=this.x0+a*Math.sin(o-this.long0),t.y=this.y0-this.con*a*Math.cos(o-this.long0),t):(Math.abs(this.sinlat0)<yx?(e=2*this.a*this.k0/(1+r*Math.cos(u)),t.y=e*n):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*n+this.cosX0*r*Math.cos(u))),t.y=e*(this.cosX0*n-this.sinX0*r*Math.cos(u))+this.y0),t.x=e*r*Math.sin(u)+this.x0,t))},inverse:function(t){var e,i,n,r,s;t.x-=this.x0,t.y-=this.y0;var a=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var o=2*Math.atan(a/(2*this.a*this.k0));return e=this.long0,i=this.lat0,a<=yx?(t.x=e,t.y=i,t):(i=Math.asin(Math.cos(o)*this.sinlat0+t.y*Math.sin(o)*this.coslat0/a),e=Math.abs(this.coslat0)<yx?this.lat0>0?Zx(this.long0+Math.atan2(t.x,-1*t.y)):Zx(this.long0+Math.atan2(t.x,t.y)):Zx(this.long0+Math.atan2(t.x*Math.sin(o),a*this.coslat0*Math.cos(o)-t.y*this.sinlat0*Math.sin(o))),t.x=e,t.y=i,t)}if(Math.abs(this.coslat0)<=yx){if(a<=yx)return i=this.lat0,e=this.long0,t.x=e,t.y=i,t;t.x*=this.con,t.y*=this.con,n=a*this.cons/(2*this.a*this.k0),i=this.con*$x(this.e,n),e=this.con*Zx(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else r=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,a<=yx?s=this.X0:(s=Math.asin(Math.cos(r)*this.sinX0+t.y*Math.sin(r)*this.cosX0/a),e=Zx(this.long0+Math.atan2(t.x*Math.sin(r),a*this.cosX0*Math.cos(r)-t.y*this.sinX0*Math.sin(r)))),i=-1*$x(this.e,Math.tan(.5*(px+s)));return t.x=e,t.y=i,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"],ssfn_:function(t,e,i){return e*=i,Math.tan(.5*(px+t))*Math.pow((1-e)/(1+e),.5*i)}};const CS={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),i=this.a,n=1/this.rf,r=2*n-Math.pow(n,2),s=this.e=Math.sqrt(r);this.R=this.k0*i*Math.sqrt(1-r)/(1-r*Math.pow(e,2)),this.alpha=Math.sqrt(1+r/(1-r)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),o=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+s*e)/(1-s*e));this.K=a-this.alpha*o+this.alpha*s/2*l},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),n=-this.alpha*(e+i)+this.K,r=2*(Math.atan(Math.exp(n))-Math.PI/4),s=this.alpha*(t.x-this.lambda0),a=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(s))),o=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(s));return t.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,t.x=this.R*a+this.x0,t},inverse:function(t){for(var e=t.x-this.x0,i=t.y-this.y0,n=e/this.R,r=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(n)),a=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(r))),o=this.lambda0+a/this.alpha,l=0,h=s,c=-1e3,u=0;Math.abs(h-c)>1e-7;){if(++u>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(h))/2)),c=h,h=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=o,t.y=h,t},names:["somerc"]};var MS=1e-7;const AS={init:function(){var t,e,i,n,r,s,a,o,l,h,c,u,d,f=0,p=0,g=0,m=0,v=0,y=0,b=0;this.no_off=(d="object"==typeof(u=this).PROJECTION?Object.keys(u.PROJECTION)[0]:u.PROJECTION,"no_uoff"in u||"no_off"in u||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(d)),this.no_rot="no_rot"in this;var _=!1;"alpha"in this&&(_=!0);var x=!1;if("rectified_grid_angle"in this&&(x=!0),_&&(b=this.alpha),x&&(f=this.rectified_grid_angle*bx),_||x)p=this.longc;else if(g=this.long1,v=this.lat1,m=this.long2,y=this.lat2,Math.abs(v-y)<=MS||(t=Math.abs(v))<=MS||Math.abs(t-px)<=MS||Math.abs(Math.abs(this.lat0)-px)<=MS||Math.abs(Math.abs(y)-px)<=MS)throw new Error;var w=1-this.es;e=Math.sqrt(w),Math.abs(this.lat0)>yx?(o=Math.sin(this.lat0),i=Math.cos(this.lat0),t=1-this.es*o*o,this.B=i*i,this.B=Math.sqrt(1+this.es*this.B*this.B/w),this.A=this.B*this.k0*e/t,(r=(n=this.B*e/(i*Math.sqrt(t)))*n-1)<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=n,this.E*=Math.pow(Jx(this.e,this.lat0,o),this.B)):(this.B=1/e,this.A=this.k0,this.E=n=r=1),_||x?(_?(c=Math.asin(Math.sin(b)/n),x||(f=b)):(c=f,b=Math.asin(n*Math.sin(c))),this.lam0=p-Math.asin(.5*(r-1/r)*Math.tan(c))/this.B):(s=Math.pow(Jx(this.e,v,Math.sin(v)),this.B),a=Math.pow(Jx(this.e,y,Math.sin(y)),this.B),r=this.E/s,l=(a-s)/(a+s),h=((h=this.E*this.E)-a*s)/(h+a*s),(t=g-m)<-Math.pi?m-=wx:t>Math.pi&&(m+=wx),this.lam0=Zx(.5*(g+m)-Math.atan(h*Math.tan(.5*this.B*(g-m))/l)/this.B),c=Math.atan(2*Math.sin(this.B*Zx(g-this.lam0))/(r-1/r)),f=b=Math.asin(n*Math.sin(c))),this.singam=Math.sin(c),this.cosgam=Math.cos(c),this.sinrot=Math.sin(f),this.cosrot=Math.cos(f),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A,this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(n*n-1)/Math.cos(b))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*c,this.v_pole_n=this.ArB*Math.log(Math.tan(xx-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(xx+r))},forward:function(t){var e,i,n,r,s,a,o,l,h={};if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-px)>yx){if(e=.5*((s=this.E/Math.pow(Jx(this.e,t.y,Math.sin(t.y)),this.B))-(a=1/s)),i=.5*(s+a),r=Math.sin(this.B*t.x),n=(e*this.singam-r*this.cosgam)/i,Math.abs(Math.abs(n)-1)<yx)throw new Error;l=.5*this.ArB*Math.log((1-n)/(1+n)),a=Math.cos(this.B*t.x),o=Math.abs(a)<MS?this.A*t.x:this.ArB*Math.atan2(e*this.cosgam+r*this.singam,a)}else l=t.y>0?this.v_pole_n:this.v_pole_s,o=this.ArB*t.y;return this.no_rot?(h.x=o,h.y=l):(o-=this.u_0,h.x=l*this.cosrot+o*this.sinrot,h.y=o*this.cosrot-l*this.sinrot),h.x=this.a*h.x+this.x0,h.y=this.a*h.y+this.y0,h},inverse:function(t){var e,i,n,r,s,a,o,l={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(i=t.y,e=t.x):(i=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),r=.5*((n=Math.exp(-this.BrA*i))-1/n),s=.5*(n+1/n),o=((a=Math.sin(this.BrA*e))*this.cosgam+r*this.singam)/s,Math.abs(Math.abs(o)-1)<yx)l.x=0,l.y=o<0?-px:px;else{if(l.y=this.E/Math.sqrt((1+o)/(1-o)),l.y=$x(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(r*this.cosgam-a*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]};const OS={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<yx)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),i=Math.cos(this.lat1),n=Kx(this.e,e,i),r=Jx(this.e,this.lat1,e),s=Math.sin(this.lat2),a=Math.cos(this.lat2),o=Kx(this.e,s,a),l=Jx(this.e,this.lat2,s),h=Jx(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>yx?this.ns=Math.log(n/o)/Math.log(r/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=n/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(h,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,i=t.y;Math.abs(2*Math.abs(i)-Math.PI)<=yx&&(i=qx(i)*(px-2*yx));var n,r,s=Math.abs(Math.abs(i)-px);if(s>yx)n=Jx(this.e,i,Math.sin(i)),r=this.a*this.f0*Math.pow(n,this.ns);else{if((s=i*this.ns)<=0)return null;r=0}var a=this.ns*Zx(e-this.long0);return t.x=this.k0*(r*Math.sin(a))+this.x0,t.y=this.k0*(this.rh-r*Math.cos(a))+this.y0,t},inverse:function(t){var e,i,n,r,s,a=(t.x-this.x0)/this.k0,o=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+o*o),i=1):(e=-Math.sqrt(a*a+o*o),i=-1);var l=0;if(0!==e&&(l=Math.atan2(i*a,i*o)),0!==e||this.ns>0){if(i=1/this.ns,n=Math.pow(e/(this.a*this.f0),i),-9999===(r=$x(this.e,n)))return null}else r=-px;return s=Zx(l/this.ns+this.long0),t.x=s,t.y=r,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]};const PS={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,i,n,r,s,a,o,l=t.x,h=t.y,c=Zx(l-this.long0);return e=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/e)-this.s45),n=-c*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(n)),s=Math.asin(Math.cos(i)*Math.sin(n)/Math.cos(r)),a=this.n*s,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),t.y=o*Math.cos(a)/1,t.x=o*Math.sin(a)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,i,n,r,s,a,o,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),s=Math.sqrt(t.x*t.x+t.y*t.y),r=Math.atan2(t.y,t.x)/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/s,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),i=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(e)),t.x=this.long0-i/this.alfa,a=e,o=0;var h=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-t.y)<1e-10&&(o=1),a=t.y,h+=1}while(0===o&&h<15);return h>=15?null:t},names:["Krovak","krovak"]};function RS(t,e,i,n,r){return t*r-e*Math.sin(2*r)+i*Math.sin(4*r)-n*Math.sin(6*r)}function IS(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function LS(t){return.375*t*(1+.25*t*(1+.46875*t))}function DS(t){return.05859375*t*t*(1+.75*t)}function NS(t){return t*t*t*(35/3072)}function FS(t,e,i){var n=e*i;return t/Math.sqrt(1-n*n)}function jS(t){return Math.abs(t)<px?t:t-qx(t)*Math.PI}function BS(t,e,i,n,r){var s,a;s=t/e;for(var o=0;o<15;o++)if(s+=a=(t-(e*s-i*Math.sin(2*s)+n*Math.sin(4*s)-r*Math.sin(6*s)))/(e-2*i*Math.cos(2*s)+4*n*Math.cos(4*s)-6*r*Math.cos(6*s)),Math.abs(a)<=1e-10)return s;return NaN}const zS={init:function(){this.sphere||(this.e0=IS(this.es),this.e1=LS(this.es),this.e2=DS(this.es),this.e3=NS(this.es),this.ml0=this.a*RS(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,i,n=t.x,r=t.y;if(n=Zx(n-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(n)),i=this.a*(Math.atan2(Math.tan(r),Math.cos(n))-this.lat0);else{var s=Math.sin(r),a=Math.cos(r),o=FS(this.a,this.e,s),l=Math.tan(r)*Math.tan(r),h=n*Math.cos(r),c=h*h,u=this.es*a*a/(1-this.es);e=o*h*(1-c*l*(1/6-(8-l+8*u)*c/120)),i=this.a*RS(this.e0,this.e1,this.e2,this.e3,r)-this.ml0+o*s/a*c*(.5+(5-l+6*u)*c/24)}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n=t.x/this.a,r=t.y/this.a;if(this.sphere){var s=r+this.lat0;e=Math.asin(Math.sin(s)*Math.cos(n)),i=Math.atan2(Math.tan(n),Math.cos(s))}else{var a=BS(this.ml0/this.a+r,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-px)<=yx)return t.x=this.long0,t.y=px,r<0&&(t.y*=-1),t;var o=FS(this.a,this.e,Math.sin(a)),l=o*o*o/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(a),2),c=n*this.a/o,u=c*c;e=a-o*Math.tan(a)/l*c*c*(.5-(1+3*h)*c*c/24),i=c*(1-u*(h/3+(1+3*h)*h*u/15))/Math.cos(a)}return t.x=Zx(i+this.long0),t.y=jS(e),t},names:["Cassini","Cassini_Soldner","cass"]};function WS(t,e){var i;return t>1e-7?(1-t*t)*(e/(1-(i=t*e)*i)-.5/t*Math.log((1-i)/(1+i))):2*e}var GS=.3333333333333333,US=.17222222222222222,HS=.10257936507936508,XS=.06388888888888888,VS=.0664021164021164,YS=.016415012942191543;const KS={init:function(){var t,e=Math.abs(this.lat0);if(Math.abs(e-px)<yx?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<yx?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=WS(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(t){var e,i=[];return i[0]=t*GS,e=t*t,i[0]+=e*US,i[1]=e*XS,e*=t,i[0]+=e*HS,i[1]+=e*VS,i[2]=e*YS,i}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=WS(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,i,n,r,s,a,o,l,h,c,u=t.x,d=t.y;if(u=Zx(u-this.long0),this.sphere){if(s=Math.sin(d),c=Math.cos(d),n=Math.cos(u),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((i=this.mode===this.EQUIT?1+c*n:1+this.sinph0*s+this.cosph0*c*n)<=yx)return null;e=(i=Math.sqrt(2/i))*c*Math.sin(u),i*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*c*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(d+this.lat0)<yx)return null;i=xx-.5*d,e=(i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)))*Math.sin(u),i*=n}}else{switch(o=0,l=0,h=0,n=Math.cos(u),r=Math.sin(u),s=Math.sin(d),a=WS(this.e,s),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(o=a/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:h=1+this.sinb1*o+this.cosb1*l*n;break;case this.EQUIT:h=1+l*n;break;case this.N_POLE:h=px+d,a=this.qp-a;break;case this.S_POLE:h=d-px,a=this.qp+a}if(Math.abs(h)<yx)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),i=this.mode===this.OBLIQ?this.ymf*h*(this.cosb1*o-this.sinb1*l*n):(h=Math.sqrt(2/(1+l*n)))*o*this.ymf,e=this.xmf*h*l*r;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(h=Math.sqrt(a))*r,i=n*(this.mode===this.S_POLE?h:-h)):e=i=0}}return t.x=this.a*e+this.x0,t.y=this.a*i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n,r,s,a,o,l,h,c,u=t.x/this.a,d=t.y/this.a;if(this.sphere){var f,p=0,g=0;if((i=.5*(f=Math.sqrt(u*u+d*d)))>1)return null;switch(i=2*Math.asin(i),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(g=Math.sin(i),p=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(f)<=yx?0:Math.asin(d*g/f),u*=g,d=p*f;break;case this.OBLIQ:i=Math.abs(f)<=yx?this.lat0:Math.asin(p*this.sinph0+d*g*this.cosph0/f),u*=g*this.cosph0,d=(p-Math.sin(i)*this.sinph0)*f;break;case this.N_POLE:d=-d,i=px-i;break;case this.S_POLE:i-=px}e=0!==d||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(u,d):0}else{if(o=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(u/=this.dd,d*=this.dd,(a=Math.sqrt(u*u+d*d))<yx)return t.x=this.long0,t.y=this.lat0,t;r=2*Math.asin(.5*a/this.rq),n=Math.cos(r),u*=r=Math.sin(r),this.mode===this.OBLIQ?(o=n*this.sinb1+d*r*this.cosb1/a,s=this.qp*o,d=a*this.cosb1*n-d*this.sinb1*r):(o=d*r/a,s=this.qp*o,d=a*n)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(d=-d),!(s=u*u+d*d))return t.x=this.long0,t.y=this.lat0,t;o=1-s/this.qp,this.mode===this.S_POLE&&(o=-o)}e=Math.atan2(u,d),l=Math.asin(o),h=this.apa,c=l+l,i=l+h[0]*Math.sin(c)+h[1]*Math.sin(c+c)+h[2]*Math.sin(c+c+c)}return t.x=Zx(this.long0+e),t.y=i,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function qS(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}const ZS={init:function(){Math.abs(this.lat1+this.lat2)<yx||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Kx(this.e3,this.sin_po,this.cos_po),this.qs1=WS(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Kx(this.e3,this.sin_po,this.cos_po),this.qs2=WS(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=WS(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>yx?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,i=t.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var n=WS(this.e3,this.sin_phi),r=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,s=this.ns0*Zx(e-this.long0),a=r*Math.sin(s)+this.x0,o=this.rh-r*Math.cos(s)+this.y0;return t.x=a,t.y=o,t},inverse:function(t){var e,i,n,r,s,a;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),n=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),n=-1),r=0,0!==e&&(r=Math.atan2(n*t.x,n*t.y)),n=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-n*n)/(2*this.ns0)):(i=(this.c-n*n)/this.ns0,a=this.phi1z(this.e3,i)),s=Zx(r/this.ns0+this.long0),t.x=s,t.y=a,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,e){var i,n,r,s,a=qS(.5*e);if(t<yx)return a;for(var o=t*t,l=1;l<=25;l++)if(a+=s=.5*(r=1-(n=t*(i=Math.sin(a)))*n)*r/Math.cos(a)*(e/(1-o)-i/r+.5/t*Math.log((1-n)/(1+n))),Math.abs(s)<=1e-7)return a;return null}};const JS={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,i,n,r,s,a,o,l=t.x,h=t.y;return n=Zx(l-this.long0),e=Math.sin(h),i=Math.cos(h),r=Math.cos(n),1,(s=this.sin_p14*e+this.cos_p14*i*r)>0||Math.abs(s)<=yx?(a=this.x0+1*this.a*i*Math.sin(n)/s,o=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*r)/s):(a=this.x0+this.infinity_dist*i*Math.sin(n),o=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*i*r)),t.x=a,t.y=o,t},inverse:function(t){var e,i,n,r,s,a;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(r=Math.atan2(e,this.rc),i=Math.sin(r),a=qS((n=Math.cos(r))*this.sin_p14+t.y*i*this.cos_p14/e),s=Math.atan2(t.x*i,e*this.cos_p14*n-t.y*this.sin_p14*i),s=Zx(this.long0+s)):(a=this.phic0,s=0),t.x=s,t.y=a,t},names:["gnom"]};const $S={init:function(){this.sphere||(this.k0=Kx(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,i,n=t.x,r=t.y,s=Zx(n-this.long0);if(this.sphere)e=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(r)/Math.cos(this.lat_ts);else{var a=WS(this.e,Math.sin(r));e=this.x0+this.a*this.k0*s,i=this.y0+this.a*a*.5/this.k0}return t.x=e,t.y=i,t},inverse:function(t){var e,i;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=Zx(this.long0+t.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(i=function(t,e){var i=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-i)<1e-6)return e<0?-1*px:px;for(var n,r,s,a,o=Math.asin(.5*e),l=0;l<30;l++)if(r=Math.sin(o),s=Math.cos(o),a=t*r,o+=n=Math.pow(1-a*a,2)/(2*s)*(e/(1-t*t)-r/(1-a*a)+.5/t*Math.log((1-a)/(1+a))),Math.abs(n)<=1e-10)return o;return NaN}(this.e,2*t.y*this.k0/this.a),e=Zx(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=i,t},names:["cea"]};const QS={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.x,i=t.y,n=Zx(e-this.long0),r=jS(i-this.lat0);return t.x=this.x0+this.a*n*this.rc,t.y=this.y0+this.a*r,t},inverse:function(t){var e=t.x,i=t.y;return t.x=Zx(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=jS(this.lat0+(i-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]};const tT={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=IS(this.es),this.e1=LS(this.es),this.e2=DS(this.es),this.e3=NS(this.es),this.ml0=this.a*RS(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,i,n,r=t.x,s=t.y,a=Zx(r-this.long0);if(n=a*Math.sin(s),this.sphere)Math.abs(s)<=yx?(e=this.a*a,i=-1*this.a*this.lat0):(e=this.a*Math.sin(n)/Math.tan(s),i=this.a*(jS(s-this.lat0)+(1-Math.cos(n))/Math.tan(s)));else if(Math.abs(s)<=yx)e=this.a*a,i=-1*this.ml0;else{var o=FS(this.a,this.e,Math.sin(s))/Math.tan(s);e=o*Math.sin(n),i=this.a*RS(this.e0,this.e1,this.e2,this.e3,s)-this.ml0+o*(1-Math.cos(n))}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){var e,i,n,r,s,a,o,l,h;if(n=t.x-this.x0,r=t.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=yx)e=Zx(n/this.a+this.long0),i=0;else{var c;for(a=this.lat0+r/this.a,o=n*n/this.a/this.a+a*a,l=a,s=20;s;--s)if(l+=h=-1*(a*(l*(c=Math.tan(l))+1)-l-.5*(l*l+o)*c)/((l-a)/c-1),Math.abs(h)<=yx){i=l;break}e=Zx(this.long0+Math.asin(n*Math.tan(l)/this.a)/Math.sin(i))}else if(Math.abs(r+this.ml0)<=yx)i=0,e=Zx(this.long0+n/this.a);else{var u,d,f,p,g;for(a=(this.ml0+r)/this.a,o=n*n/this.a/this.a+a*a,l=a,s=20;s;--s)if(g=this.e*Math.sin(l),u=Math.sqrt(1-g*g)*Math.tan(l),d=this.a*RS(this.e0,this.e1,this.e2,this.e3,l),f=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),l-=h=(a*(u*(p=d/this.a)+1)-p-.5*u*(p*p+o))/(this.es*Math.sin(2*l)*(p*p+o-2*a*p)/(4*u)+(a-p)*(u*f-2/Math.sin(2*l))-f),Math.abs(h)<=yx){i=l;break}u=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),e=Zx(this.long0+Math.asin(n*u/this.a)/Math.sin(i))}return t.x=e,t.y=i,t},names:["Polyconic","poly"]};const eT={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,i=t.x,n=t.y-this.lat0,r=i-this.long0,s=n/fx*1e-5,a=r,o=1,l=0;for(e=1;e<=10;e++)o*=s,l+=this.A[e]*o;var h,c=l,u=a,d=1,f=0,p=0,g=0;for(e=1;e<=6;e++)h=f*c+d*u,d=d*c-f*u,f=h,p=p+this.B_re[e]*d-this.B_im[e]*f,g=g+this.B_im[e]*d+this.B_re[e]*f;return t.x=g*this.a+this.x0,t.y=p*this.a+this.y0,t},inverse:function(t){var e,i,n=t.x,r=t.y,s=n-this.x0,a=(r-this.y0)/this.a,o=s/this.a,l=1,h=0,c=0,u=0;for(e=1;e<=6;e++)i=h*a+l*o,l=l*a-h*o,h=i,c=c+this.C_re[e]*l-this.C_im[e]*h,u=u+this.C_im[e]*l+this.C_re[e]*h;for(var d=0;d<this.iterations;d++){var f,p=c,g=u,m=a,v=o;for(e=2;e<=6;e++)f=g*c+p*u,p=p*c-g*u,g=f,m+=(e-1)*(this.B_re[e]*p-this.B_im[e]*g),v+=(e-1)*(this.B_im[e]*p+this.B_re[e]*g);p=1,g=0;var y=this.B_re[1],b=this.B_im[1];for(e=2;e<=6;e++)f=g*c+p*u,p=p*c-g*u,g=f,y+=e*(this.B_re[e]*p-this.B_im[e]*g),b+=e*(this.B_im[e]*p+this.B_re[e]*g);var _=y*y+b*b;c=(m*y+v*b)/_,u=(v*y-m*b)/_}var x=c,w=u,S=1,T=0;for(e=1;e<=9;e++)S*=x,T+=this.D[e]*S;var E=this.lat0+T*fx*1e5,k=this.long0+w;return t.x=k,t.y=E,t},names:["New_Zealand_Map_Grid","nzmg"]};const iT={init:function(){},forward:function(t){var e=t.x,i=t.y,n=Zx(e-this.long0),r=this.x0+this.a*n,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+i/2.5))*1.25;return t.x=r,t.y=s,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=Zx(this.long0+t.x/this.a),i=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=i,t},names:["Miller_Cylindrical","mill"]};const nT={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=uS(this.es)},forward:function(t){var e,i,n=t.x,r=t.y;if(n=Zx(n-this.long0),this.sphere){if(this.m)for(var s=this.n*Math.sin(r),a=20;a;--a){var o=(this.m*r+Math.sin(r)-s)/(this.m+Math.cos(r));if(r-=o,Math.abs(o)<yx)break}else r=1!==this.n?Math.asin(this.n*Math.sin(r)):r;e=this.a*this.C_x*n*(this.m+Math.cos(r)),i=this.a*this.C_y*r}else{var l=Math.sin(r),h=Math.cos(r);i=this.a*dS(r,l,h,this.en),e=this.a*n*h/Math.sqrt(1-this.es*l*l)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,n;return t.x-=this.x0,i=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,i/=this.C_x*(this.m+Math.cos(e)),this.m?e=qS((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=qS(Math.sin(e)/this.n)),i=Zx(i+this.long0),e=jS(e)):(e=pS(t.y/this.a,this.es,this.en),(n=Math.abs(e))<px?(n=Math.sin(e),i=Zx(this.long0+t.x*Math.sqrt(1-this.es*n*n)/(this.a*Math.cos(e)))):n-yx<px&&(i=this.long0)),t.x=i,t.y=e,t},names:["Sinusoidal","sinu"]};const rT={init:function(){},forward:function(t){for(var e=t.x,i=t.y,n=Zx(e-this.long0),r=i,s=Math.PI*Math.sin(i);;){var a=-(r+Math.sin(r)-s)/(1+Math.cos(r));if(r+=a,Math.abs(a)<yx)break}r/=2,Math.PI/2-Math.abs(i)<yx&&(n=0);var o=.900316316158*this.a*n*Math.cos(r)+this.x0,l=1.4142135623731*this.a*Math.sin(r)+this.y0;return t.x=o,t.y=l,t},inverse:function(t){var e,i;t.x-=this.x0,t.y-=this.y0,i=t.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),e=Math.asin(i);var n=Zx(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),i=(2*e+Math.sin(2*e))/Math.PI,Math.abs(i)>1&&(i=1);var r=Math.asin(i);return t.x=n,t.y=r,t},names:["Mollweide","moll"]};const sT={init:function(){Math.abs(this.lat1+this.lat2)<yx||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=IS(this.es),this.e1=LS(this.es),this.e2=DS(this.es),this.e3=NS(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Kx(this.e,this.sinphi,this.cosphi),this.ml1=RS(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<yx?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Kx(this.e,this.sinphi,this.cosphi),this.ml2=RS(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=RS(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,i=t.x,n=t.y;if(this.sphere)e=this.a*(this.g-n);else{var r=RS(this.e0,this.e1,this.e2,this.e3,n);e=this.a*(this.g-r)}var s=this.ns*Zx(i-this.long0),a=this.x0+e*Math.sin(s),o=this.y0+this.rh-e*Math.cos(s);return t.x=a,t.y=o,t},inverse:function(t){var e,i,n,r;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(i=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(i=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var s=0;return 0!==i&&(s=Math.atan2(e*t.x,e*t.y)),this.sphere?(r=Zx(this.long0+s/this.ns),n=jS(this.g-i/this.a),t.x=r,t.y=n,t):(n=BS(this.g-i/this.a,this.e0,this.e1,this.e2,this.e3),r=Zx(this.long0+s/this.ns),t.x=r,t.y=n,t)},names:["Equidistant_Conic","eqdc"]};const aT={init:function(){this.R=this.a},forward:function(t){var e,i,n=t.x,r=t.y,s=Zx(n-this.long0);Math.abs(r)<=yx&&(e=this.x0+this.R*s,i=this.y0);var a=qS(2*Math.abs(r/Math.PI));(Math.abs(s)<=yx||Math.abs(Math.abs(r)-px)<=yx)&&(e=this.x0,i=r>=0?this.y0+Math.PI*this.R*Math.tan(.5*a):this.y0+Math.PI*this.R*-Math.tan(.5*a));var o=.5*Math.abs(Math.PI/s-s/Math.PI),l=o*o,h=Math.sin(a),c=Math.cos(a),u=c/(h+c-1),d=u*u,f=u*(2/h-1),p=f*f,g=Math.PI*this.R*(o*(u-p)+Math.sqrt(l*(u-p)*(u-p)-(p+l)*(d-p)))/(p+l);s<0&&(g=-g),e=this.x0+g;var m=l+u;return g=Math.PI*this.R*(f*m-o*Math.sqrt((p+l)*(l+1)-m*m))/(p+l),i=r>=0?this.y0+g:this.y0-g,t.x=e,t.y=i,t},inverse:function(t){var e,i,n,r,s,a,o,l,h,c,u,d;return t.x-=this.x0,t.y-=this.y0,u=Math.PI*this.R,s=(n=t.x/u)*n+(r=t.y/u)*r,u=3*(r*r/(l=-2*(a=-Math.abs(r)*(1+s))+1+2*r*r+s*s)+(2*(o=a-2*r*r+n*n)*o*o/l/l/l-9*a*o/l/l)/27)/(h=(a-o*o/3/l)/l)/(c=2*Math.sqrt(-h/3)),Math.abs(u)>1&&(u=u>=0?1:-1),d=Math.acos(u)/3,i=t.y>=0?(-c*Math.cos(d+Math.PI/3)-o/3/l)*Math.PI:-(-c*Math.cos(d+Math.PI/3)-o/3/l)*Math.PI,e=Math.abs(n)<yx?this.long0:Zx(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(n*n-r*r)+s*s))/2/n),t.x=e,t.y=i,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]};const oT={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var e,i,n,r,s,a,o,l,h,c,u,d,f,p,g,m,v,y,b,_,x,w,S=t.x,T=t.y,E=Math.sin(t.y),k=Math.cos(t.y),C=Zx(S-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=yx?(t.x=this.x0+this.a*(px-T)*Math.sin(C),t.y=this.y0-this.a*(px-T)*Math.cos(C),t):Math.abs(this.sin_p12+1)<=yx?(t.x=this.x0+this.a*(px+T)*Math.sin(C),t.y=this.y0+this.a*(px+T)*Math.cos(C),t):(y=this.sin_p12*E+this.cos_p12*k*Math.cos(C),v=(m=Math.acos(y))?m/Math.sin(m):1,t.x=this.x0+this.a*v*k*Math.sin(C),t.y=this.y0+this.a*v*(this.cos_p12*E-this.sin_p12*k*Math.cos(C)),t):(e=IS(this.es),i=LS(this.es),n=DS(this.es),r=NS(this.es),Math.abs(this.sin_p12-1)<=yx?(s=this.a*RS(e,i,n,r,px),a=this.a*RS(e,i,n,r,T),t.x=this.x0+(s-a)*Math.sin(C),t.y=this.y0-(s-a)*Math.cos(C),t):Math.abs(this.sin_p12+1)<=yx?(s=this.a*RS(e,i,n,r,px),a=this.a*RS(e,i,n,r,T),t.x=this.x0+(s+a)*Math.sin(C),t.y=this.y0+(s+a)*Math.cos(C),t):(o=E/k,l=FS(this.a,this.e,this.sin_p12),h=FS(this.a,this.e,E),c=Math.atan((1-this.es)*o+this.es*l*this.sin_p12/(h*k)),b=0===(u=Math.atan2(Math.sin(C),this.cos_p12*Math.tan(c)-this.sin_p12*Math.cos(C)))?Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.abs(Math.abs(u)-Math.PI)<=yx?-Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.asin(Math.sin(C)*Math.cos(c)/Math.sin(u)),d=this.e*this.sin_p12/Math.sqrt(1-this.es),m=l*b*(1-(_=b*b)*(g=(f=this.e*this.cos_p12*Math.cos(u)/Math.sqrt(1-this.es))*f)*(1-g)/6+(x=_*b)/8*(p=d*f)*(1-2*g)+(w=x*b)/120*(g*(4-7*g)-3*d*d*(1-7*g))-w*b/48*p),t.x=this.x0+m*Math.sin(u),t.y=this.y0+m*Math.cos(u),t))},inverse:function(t){var e,i,n,r,s,a,o,l,h,c,u,d,f,p,g,m,v,y,b,_,x,w,S;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*px*this.a)return;return i=e/this.a,n=Math.sin(i),r=Math.cos(i),s=this.long0,Math.abs(e)<=yx?a=this.lat0:(a=qS(r*this.sin_p12+t.y*n*this.cos_p12/e),o=Math.abs(this.lat0)-px,s=Math.abs(o)<=yx?this.lat0>=0?Zx(this.long0+Math.atan2(t.x,-t.y)):Zx(this.long0-Math.atan2(-t.x,t.y)):Zx(this.long0+Math.atan2(t.x*n,e*this.cos_p12*r-t.y*this.sin_p12*n))),t.x=s,t.y=a,t}return l=IS(this.es),h=LS(this.es),c=DS(this.es),u=NS(this.es),Math.abs(this.sin_p12-1)<=yx?(a=BS(((d=this.a*RS(l,h,c,u,px))-(e=Math.sqrt(t.x*t.x+t.y*t.y)))/this.a,l,h,c,u),s=Zx(this.long0+Math.atan2(t.x,-1*t.y)),t.x=s,t.y=a,t):Math.abs(this.sin_p12+1)<=yx?(d=this.a*RS(l,h,c,u,px),a=BS(((e=Math.sqrt(t.x*t.x+t.y*t.y))-d)/this.a,l,h,c,u),s=Zx(this.long0+Math.atan2(t.x,t.y)),t.x=s,t.y=a,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),g=Math.atan2(t.x,t.y),f=FS(this.a,this.e,this.sin_p12),m=Math.cos(g),y=-(v=this.e*this.cos_p12*m)*v/(1-this.es),b=3*this.es*(1-y)*this.sin_p12*this.cos_p12*m/(1-this.es),w=1-y*(x=(_=e/f)-y*(1+y)*Math.pow(_,3)/6-b*(1+3*y)*Math.pow(_,4)/24)*x/2-_*x*x*x/6,p=Math.asin(this.sin_p12*Math.cos(x)+this.cos_p12*Math.sin(x)*m),s=Zx(this.long0+Math.asin(Math.sin(g)*Math.sin(x)/Math.cos(p))),S=Math.sin(p),a=Math.atan2((S-this.es*w*this.sin_p12)*Math.tan(p),S*(1-this.es)),t.x=s,t.y=a,t)},names:["Azimuthal_Equidistant","aeqd"]};const lT={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,i,n,r,s,a,o,l=t.x,h=t.y;return n=Zx(l-this.long0),e=Math.sin(h),i=Math.cos(h),r=Math.cos(n),1,((s=this.sin_p14*e+this.cos_p14*i*r)>0||Math.abs(s)<=yx)&&(a=1*this.a*i*Math.sin(n),o=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*r)),t.x=a,t.y=o,t},inverse:function(t){var e,i,n,r,s,a,o;return t.x-=this.x0,t.y-=this.y0,i=qS((e=Math.sqrt(t.x*t.x+t.y*t.y))/this.a),n=Math.sin(i),r=Math.cos(i),a=this.long0,Math.abs(e)<=yx?(o=this.lat0,t.x=a,t.y=o,t):(o=qS(r*this.sin_p14+t.y*n*this.cos_p14/e),s=Math.abs(this.lat0)-px,Math.abs(s)<=yx?(a=this.lat0>=0?Zx(this.long0+Math.atan2(t.x,-t.y)):Zx(this.long0-Math.atan2(-t.x,t.y)),t.x=a,t.y=o,t):(a=Zx(this.long0+Math.atan2(t.x*n,e*this.cos_p14*r-t.y*this.sin_p14*n)),t.x=a,t.y=o,t))},names:["ortho"]};var hT=1,cT=2,uT=3,dT=4,fT=5,pT=6,gT={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function mT(t,e,i,n){var r;return t<yx?(n.value=gT.AREA_0,r=0):(r=Math.atan2(e,i),Math.abs(r)<=xx?n.value=gT.AREA_0:r>xx&&r<=px+xx?(n.value=gT.AREA_1,r-=px):r>px+xx||r<=-(px+xx)?(n.value=gT.AREA_2,r=r>=0?r-Sx:r+Sx):(n.value=gT.AREA_3,r+=px)),r}function vT(t,e){var i=t+e;return i<-Sx?i+=wx:i>+Sx&&(i-=wx),i}const yT={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=px-xx/2?this.face=fT:this.lat0<=-(px-xx/2)?this.face=pT:Math.abs(this.long0)<=xx?this.face=hT:Math.abs(this.long0)<=px+xx?this.face=this.long0>0?cT:dT:this.face=uT,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,i,n,r,s,a,o={x:0,y:0},l={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,i=t.x,this.face===fT)r=px-e,i>=xx&&i<=px+xx?(l.value=gT.AREA_0,n=i-px):i>px+xx||i<=-(px+xx)?(l.value=gT.AREA_1,n=i>0?i-Sx:i+Sx):i>-(px+xx)&&i<=-xx?(l.value=gT.AREA_2,n=i+px):(l.value=gT.AREA_3,n=i);else if(this.face===pT)r=px+e,i>=xx&&i<=px+xx?(l.value=gT.AREA_0,n=-i+px):i<xx&&i>=-xx?(l.value=gT.AREA_1,n=-i):i<-xx&&i>=-(px+xx)?(l.value=gT.AREA_2,n=-i-px):(l.value=gT.AREA_3,n=i>0?-i+Sx:-i-Sx);else{var h,c,u,d,f,p;this.face===cT?i=vT(i,+px):this.face===uT?i=vT(i,+Sx):this.face===dT&&(i=vT(i,-px)),d=Math.sin(e),f=Math.cos(e),p=Math.sin(i),h=f*Math.cos(i),c=f*p,u=d,this.face===hT?n=mT(r=Math.acos(h),u,c,l):this.face===cT?n=mT(r=Math.acos(c),u,-h,l):this.face===uT?n=mT(r=Math.acos(-h),u,-c,l):this.face===dT?n=mT(r=Math.acos(-c),u,h,l):(r=n=0,l.value=gT.AREA_0)}return a=Math.atan(12/Sx*(n+Math.acos(Math.sin(n)*Math.cos(xx))-px)),s=Math.sqrt((1-Math.cos(r))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(n))))),l.value===gT.AREA_1?a+=px:l.value===gT.AREA_2?a+=Sx:l.value===gT.AREA_3&&(a+=1.5*Sx),o.x=s*Math.cos(a),o.y=s*Math.sin(a),o.x=o.x*this.a+this.x0,o.y=o.y*this.a+this.y0,t.x=o.x,t.y=o.y,t},inverse:function(t){var e,i,n,r,s,a,o,l,h,c,u,d,f={lam:0,phi:0},p={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,i=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?p.value=gT.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(p.value=gT.AREA_1,e-=px):t.x<0&&-t.x>=Math.abs(t.y)?(p.value=gT.AREA_2,e=e<0?e+Sx:e-Sx):(p.value=gT.AREA_3,e+=px),h=Sx/12*Math.tan(e),s=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),a=Math.atan(s),(o=1-(n=Math.cos(e))*n*(r=Math.tan(i))*r*(1-Math.cos(Math.atan(1/Math.cos(a)))))<-1?o=-1:o>1&&(o=1),this.face===fT)l=Math.acos(o),f.phi=px-l,p.value===gT.AREA_0?f.lam=a+px:p.value===gT.AREA_1?f.lam=a<0?a+Sx:a-Sx:p.value===gT.AREA_2?f.lam=a-px:f.lam=a;else if(this.face===pT)l=Math.acos(o),f.phi=l-px,p.value===gT.AREA_0?f.lam=-a+px:p.value===gT.AREA_1?f.lam=-a:p.value===gT.AREA_2?f.lam=-a-px:f.lam=a<0?-a-Sx:-a+Sx;else{var g,m,v;h=(g=o)*g,m=(h+=(v=h>=1?0:Math.sqrt(1-h)*Math.sin(a))*v)>=1?0:Math.sqrt(1-h),p.value===gT.AREA_1?(h=m,m=-v,v=h):p.value===gT.AREA_2?(m=-m,v=-v):p.value===gT.AREA_3&&(h=m,m=v,v=-h),this.face===cT?(h=g,g=-m,m=h):this.face===uT?(g=-g,m=-m):this.face===dT&&(h=g,g=m,m=-h),f.phi=Math.acos(-v)-px,f.lam=Math.atan2(m,g),this.face===cT?f.lam=vT(f.lam,-px):this.face===uT?f.lam=vT(f.lam,-Sx):this.face===dT&&(f.lam=vT(f.lam,+px))}return 0!==this.es&&(c=f.phi<0?1:0,u=Math.tan(f.phi),d=this.b/Math.sqrt(u*u+this.one_minus_f_squared),f.phi=Math.atan(Math.sqrt(this.a*this.a-d*d)/(this.one_minus_f*d)),c&&(f.phi=-f.phi)),f.lam+=this.long0,t.x=f.lam,t.y=f.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]};var bT=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],_T=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],xT=.8487,wT=1.3523,ST=_x/5,TT=1/ST,ET=18,kT=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))};const CT={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=Zx(t.x-this.long0),i=Math.abs(t.y),n=Math.floor(i*ST);n<0?n=0:n>=ET&&(n=17);var r={x:kT(bT[n],i=_x*(i-TT*n))*e,y:kT(_T[n],i)};return t.y<0&&(r.y=-r.y),r.x=r.x*this.a*xT+this.x0,r.y=r.y*this.a*wT+this.y0,r},inverse:function(t){var e={x:(t.x-this.x0)/(this.a*xT),y:Math.abs(t.y-this.y0)/(this.a*wT)};if(e.y>=1)e.x/=bT[18][0],e.y=t.y<0?-px:px;else{var i=Math.floor(e.y*ET);for(i<0?i=0:i>=ET&&(i=17);;)if(_T[i][0]>e.y)--i;else{if(!(_T[i+1][0]<=e.y))break;++i}var n=_T[i],r=5*(e.y-n[0])/(_T[i+1][0]-n[0]);r=function(t,e,i,n){for(var r=e;n;--n){var s=t(r);if(r-=s,Math.abs(s)<i)break}return r}((function(t){return(kT(n,t)-e.y)/function(t,e){return t[1]+e*(2*t[2]+3*e*t[3])}(n,t)}),r,yx,100),e.x/=kT(bT[i],r),e.y=(5*i+r)*bx,t.y<0&&(e.y=-e.y)}return e.x=Zx(e.x+this.long0),e},names:["Robinson","robin"]};const MT={init:function(){this.name="geocent"},forward:function(t){return yw(t,this.es,this.a)},inverse:function(t){return bw(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};var AT=0,OT=1,PT=2,RT=3,IT={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};const LT={init:function(){if(Object.keys(IT).forEach(function(t){if(void 0===this[t])this[t]=IT[t].def;else{if(IT[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);IT[t].num&&(this[t]=parseFloat(this[t]))}IT[t].degrees&&(this[t]=this[t]*bx)}.bind(this)),Math.abs(Math.abs(this.lat0)-px)<yx?this.mode=this.lat0<0?OT:AT:Math.abs(this.lat0)<yx?this.mode=PT:(this.mode=RT,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)},forward:function(t){t.x-=this.long0;var e,i,n,r,s=Math.sin(t.y),a=Math.cos(t.y),o=Math.cos(t.x);switch(this.mode){case RT:i=this.sinph0*s+this.cosph0*a*o;break;case PT:i=a*o;break;case OT:i=-s;break;case AT:i=s}switch(e=(i=this.pn1/(this.p-i))*a*Math.sin(t.x),this.mode){case RT:i*=this.cosph0*s-this.sinph0*a*o;break;case PT:i*=s;break;case AT:i*=-a*o;break;case OT:i*=a*o}return r=1/((n=i*this.cg+e*this.sg)*this.sw*this.h1+this.cw),e=(e*this.cg-i*this.sg)*this.cw*r,i=n*r,t.x=e*this.a,t.y=i*this.a,t},inverse:function(t){t.x/=this.a,t.y/=this.a;var e,i,n,r={x:t.x,y:t.y};n=1/(this.pn1-t.y*this.sw),e=this.pn1*t.x*n,i=this.pn1*t.y*this.cw*n,t.x=e*this.cg+i*this.sg,t.y=i*this.cg-e*this.sg;var s=vS(t.x,t.y);if(Math.abs(s)<yx)r.x=0,r.y=t.y;else{var a,o;switch(o=1-s*s*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/s+s/this.pn1),a=Math.sqrt(1-o*o),this.mode){case RT:r.y=Math.asin(a*this.sinph0+t.y*o*this.cosph0/s),t.y=(a-this.sinph0*Math.sin(r.y))*s,t.x*=o*this.cosph0;break;case PT:r.y=Math.asin(t.y*o/s),t.y=a*s,t.x*=o;break;case AT:r.y=Math.asin(a),t.y=-t.y;break;case OT:r.y=-Math.asin(a)}r.x=Math.atan2(t.x,t.y)}return t.x=r.x+this.long0,t.y=r.y,t},names:["Tilted_Perspective","tpers"]};const DT={init:function(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(t){var e,i,n,r,s=t.x,a=t.y;if(s-=this.long0,"ellipse"===this.shape){a=Math.atan(this.radius_p2*Math.tan(a));var o=this.radius_p/vS(this.radius_p*Math.cos(a),Math.sin(a));if(i=o*Math.cos(s)*Math.cos(a),n=o*Math.sin(s)*Math.cos(a),r=o*Math.sin(a),(this.radius_g-i)*i-n*n-r*r*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;e=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(n/vS(r,e)),t.y=this.radius_g_1*Math.atan(r/e)):(t.x=this.radius_g_1*Math.atan(n/e),t.y=this.radius_g_1*Math.atan(r/vS(n,e)))}else"sphere"===this.shape&&(e=Math.cos(a),i=Math.cos(s)*e,n=Math.sin(s)*e,r=Math.sin(a),e=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(n/vS(r,e)),t.y=this.radius_g_1*Math.atan(r/e)):(t.x=this.radius_g_1*Math.atan(n/e),t.y=this.radius_g_1*Math.atan(r/vS(n,e))));return t.x=t.x*this.a,t.y=t.y*this.a,t},inverse:function(t){var e,i,n,r,s=-1,a=0,o=0;if(t.x=t.x/this.a,t.y=t.y/this.a,"ellipse"===this.shape){this.flip_axis?(o=Math.tan(t.y/this.radius_g_1),a=Math.tan(t.x/this.radius_g_1)*vS(1,o)):(a=Math.tan(t.x/this.radius_g_1),o=Math.tan(t.y/this.radius_g_1)*vS(1,a));var l=o/this.radius_p;if(e=a*a+l*l+s*s,(n=(i=2*this.radius_g*s)*i-4*e*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=(-i-Math.sqrt(n))/(2*e),s=this.radius_g+r*s,a*=r,o*=r,t.x=Math.atan2(a,s),t.y=Math.atan(o*Math.cos(t.x)/s),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if("sphere"===this.shape){if(this.flip_axis?(o=Math.tan(t.y/this.radius_g_1),a=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+o*o)):(a=Math.tan(t.x/this.radius_g_1),o=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+a*a)),e=a*a+o*o+s*s,(n=(i=2*this.radius_g*s)*i-4*e*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=(-i-Math.sqrt(n))/(2*e),s=this.radius_g+r*s,a*=r,o*=r,t.x=Math.atan2(a,s),t.y=Math.atan(o*Math.cos(t.x)/s)}return t.x=t.x+this.long0,t},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};Rw.defaultDatum="WGS84",Rw.Proj=vw,Rw.WGS84=new Rw.Proj("WGS84"),Rw.Point=$w,Rw.toPoint=kw,Rw.defs=Ux,Rw.nadgrid=function(t,e){var i=new DataView(e),n=function(t){var e=t.getInt32(8,!1);if(11===e)return!1;e=t.getInt32(8,!0),11!==e&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian");return!0}(i),r=function(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:dw(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}(i,n),s=function(t,e,i){for(var n=176,r=[],s=0;s<e.nSubgrids;s++){var a=pw(t,n,i),o=gw(t,n,a,i),l=Math.round(1+(a.upperLongitude-a.lowerLongitude)/a.longitudeInterval),h=Math.round(1+(a.upperLatitude-a.lowerLatitude)/a.latitudeInterval);r.push({ll:[uw(a.lowerLongitude),uw(a.lowerLatitude)],del:[uw(a.longitudeInterval),uw(a.latitudeInterval)],lim:[l,h],count:a.gridNodeCount,cvs:fw(o)}),n+=176+16*a.gridNodeCount}return r}(i,r,n),a={header:r,subgrids:s};return hw[t]=a,a},Rw.transform=Mw,Rw.mgrs=Ww,Rw.version="__VERSION__",function(t){t.Proj.projections.add(gS),t.Proj.projections.add(xS),t.Proj.projections.add(wS),t.Proj.projections.add(ES),t.Proj.projections.add(kS),t.Proj.projections.add(CS),t.Proj.projections.add(AS),t.Proj.projections.add(OS),t.Proj.projections.add(PS),t.Proj.projections.add(zS),t.Proj.projections.add(KS),t.Proj.projections.add(ZS),t.Proj.projections.add(JS),t.Proj.projections.add($S),t.Proj.projections.add(QS),t.Proj.projections.add(tT),t.Proj.projections.add(eT),t.Proj.projections.add(iT),t.Proj.projections.add(nT),t.Proj.projections.add(rT),t.Proj.projections.add(sT),t.Proj.projections.add(aT),t.Proj.projections.add(oT),t.Proj.projections.add(lT),t.Proj.projections.add(yT),t.Proj.projections.add(CT),t.Proj.projections.add(MT),t.Proj.projections.add(LT),t.Proj.projections.add(DT)}(Rw);const NT=Rw;let FT=null;function jT(t){FT=t;const e=Object.keys(t.defs),i=e.length;let n,r;for(n=0;n<i;++n){const i=e[n];if(!Dv(i)){const e=t.defs(i);let n=e.units;n||"longlat"!==e.projName||(n="degrees"),Lv(new tv({code:i,axisOrientation:e.axis,metersPerUnit:e.to_meter,units:n}))}}for(n=0;n<i;++n){const s=e[n],a=Dv(s);for(r=0;r<i;++r){const i=e[r],n=Dv(i);if(!vv(s,i))if(t.defs[s]===t.defs[i])Fv([a,n]);else{const e=t(s,i);zv(a,n,Qv(a,n,e.forward),Qv(n,a,e.inverse))}}}}class BT extends og{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new BT(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(tg(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=$p(t,Gp,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;let e;if(Array.isArray(t))e=t;else{Tg("function"==typeof t.getZIndex,41);e=[t]}return function(){return e}}(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}const zT=BT;class WT{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null}clone(){const t=this.getColor();return new WT({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){this.color_=t}}const GT=WT;function UT(t,e,i,n,r,s,a){let o,l;const h=(i-e)/n;if(1===h)o=e;else if(2===h)o=e,l=r;else if(0!==h){let s=t[e],a=t[e+1],h=0;const c=[0];for(let r=e+n;r<i;r+=n){const e=t[r],i=t[r+1];h+=Math.sqrt((e-s)*(e-s)+(i-a)*(i-a)),c.push(h),s=e,a=i}const u=r*h,d=function(t,e,i){let n,r;i=i||Pp;let s=0,a=t.length,o=!1;for(;s<a;)n=s+(a-s>>1),r=+i(t[n],e),r<0?s=n+1:(a=n,o=!r);return o?s:~s}(c,u);d<0?(l=(u-c[-d-2])/(c[-d-1]-c[-d-2]),o=e+(-d-2)*n):o=e+d*n}a=a>1?a:2,s=s||new Array(a);for(let e=0;e<a;++e)s[e]=void 0===o?NaN:void 0===l?t[o+e]:vm(t[o+e],t[o+n+e],l);return s}function HT(t,e,i,n,r,s){if(i==e)return null;let a;if(r<t[e+n-1])return s?(a=t.slice(e,e+n),a[n-1]=r,a):null;if(t[i-1]<r)return s?(a=t.slice(i-n,i),a[n-1]=r,a):null;if(r==t[e+n-1])return t.slice(e,e+n);let o=e/n,l=i/n;for(;o<l;){const e=o+l>>1;r<t[(e+1)*n-1]?l=e:o=e+1}const h=t[o*n-1];if(r==h)return t.slice((o-1)*n,(o-1)*n+n);const c=(r-h)/(t[(o+1)*n-1]-h);a=[];for(let e=0;e<n-1;++e)a.push(vm(t[(o-1)*n+e],t[o*n+e],c));return a.push(r),a}function XT(t,e,i,n){let r=t[e],s=t[e+1],a=0;for(let o=e+n;o<i;o+=n){const e=t[o],i=t[o+1];a+=Math.sqrt((e-r)*(e-r)+(i-s)*(i-s)),r=e,s=i}return a}class VT extends by{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}appendCoordinate(t){this.flatCoordinates?Lp(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()}clone(){const t=new VT(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Ng(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(xy(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Sy(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))}forEachSegment(t){return Hy(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(e=void 0!==e&&e,HT(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return Py(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return UT(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return XT(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=Cy(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new VT(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return Xy(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ey(this.flatCoordinates,0,t,this.stride),this.changed()}}const YT=VT;class KT{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=void 0!==t.lineDash?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new KT({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}const qT=KT,ZT=0,JT=1,$T=2,QT=3;class tE{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=ix(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new tE({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return ng()}getImage(t){return ng()}getHitDetectionImage(){return ng()}getPixelRatio(t){return 1}getImageState(){return ng()}getImageSize(){return ng()}getOrigin(){return ng()}getSize(){return ng()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=ix(t)}listenImageChange(t){ng()}load(){ng()}unlistenImageChange(t){ng()}}const eE=tE;function iE(t){return Array.isArray(t)?Mm(t):t}class nE extends eE{constructor(t){super({opacity:1,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvas_=void 0,this.hitDetectionCanvas_=null,this.fill_=void 0!==t.fill?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=void 0!==t.radius?t.radius:t.radius1,this.radius2_=t.radius2,this.angle_=void 0!==t.angle?t.angle:0,this.stroke_=void 0!==t.stroke?t.stroke:null,this.size_=null,this.renderOptions_=null,this.render()}clone(){const t=this.getScale(),e=new nE({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_;if(!t)return null;const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_}getImage(t){let e=this.canvas_[t];if(!e){const i=this.renderOptions_,n=vb(i.size*t,i.size*t);this.draw_(i,n,t),e=n.canvas,this.canvas_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return $T}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;let n=this.radius_,r=void 0===this.radius2_?n:this.radius2_;if(n<r){const t=n;n=r,r=t}const s=void 0===this.radius2_?this.points_:2*this.points_,a=2*Math.PI/s,o=r*Math.sin(a),l=n-Math.sqrt(r*r-o*o),h=Math.sqrt(o*o+l*l),c=h/o;if("miter"===t&&c<=i)return c*e;const u=e/2/c,d=e/2*(l/h),f=Math.sqrt((n+u)*(n+u)+d*d)-n;if(void 0===this.radius2_||"bevel"===t)return 2*f;const p=n*Math.sin(a),g=r-Math.sqrt(n*n-p*p),m=Math.sqrt(p*p+g*g)/p;if(m<=i){const t=m*e/2-r-n;return 2*Math.max(f,t)}return 2*f}createRenderOptions(){let t,e=Eb,i=0,n=null,r=0,s=0;this.stroke_&&(t=this.stroke_.getColor(),null===t&&(t=kb),t=iE(t),s=this.stroke_.getWidth(),void 0===s&&(s=1),n=this.stroke_.getLineDash(),r=this.stroke_.getLineDashOffset(),e=this.stroke_.getLineJoin(),void 0===e&&(e=Eb),i=this.stroke_.getMiterLimit(),void 0===i&&(i=10));const a=this.calculateLineJoinSize_(e,s,i),o=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:t,strokeWidth:s,size:Math.ceil(2*o+a),lineDash:n,lineDashOffset:r,lineJoin:e,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvas_={},this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let t=this.fill_.getColor();null===t&&(t=wb),e.fillStyle=iE(t),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){if(this.fill_){let e=this.fill_.getColor(),i=0;if("string"==typeof e&&(e=km(e)),null===e?i=1:Array.isArray(e)&&(i=4===e.length?e[3]:1),0===i){const e=vb(t.size,t.size);this.hitDetectionCanvas_=e.canvas,this.drawHitDetectionCanvas_(t,e)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))}createPath_(t){let e=this.points_;const i=this.radius_;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const n=void 0===this.radius2_?i:this.radius2_;void 0!==this.radius2_&&(e*=2);const r=this.angle_-Math.PI/2,s=2*Math.PI/e;for(let a=0;a<e;a++){const e=r+a*s,o=a%2==0?i:n;t.lineTo(o*Math.cos(e),o*Math.sin(e))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=wb,e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}}const rE=nE;class sE extends rE{constructor(t){super({points:1/0,fill:(t=t||{radius:5}).fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new sE({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius_=t,this.render()}}const aE=sE;class oE{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=cE,void 0!==t.geometry&&this.setGeometry(t.geometry),this.fill_=void 0!==t.fill?t.fill:null,this.image_=void 0!==t.image?t.image:null,this.renderer_=void 0!==t.renderer?t.renderer:null,this.hitDetectionRenderer_=void 0!==t.hitDetectionRenderer?t.hitDetectionRenderer:null,this.stroke_=void 0!==t.stroke?t.stroke:null,this.text_=void 0!==t.text?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new oE({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=cE,this.geometry_=t}setZIndex(t){this.zIndex_=t}}let lE=null;function hE(t,e){if(!lE){const t=new GT({color:"rgba(255,255,255,0.4)"}),e=new qT({color:"#3399CC",width:1.25});lE=[new oE({image:new aE({fill:t,stroke:e,radius:5}),fill:t,stroke:e})]}return lE}function cE(t){return t.getGeometry()}const uE=oE;class dE{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=ix(void 0!==t.scale?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=void 0!==t.fill?t.fill:new GT({color:"#333"}),this.maxAngle_=void 0!==t.maxAngle?t.maxAngle:Math.PI/4,this.placement_=void 0!==t.placement?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=void 0!==t.stroke?t.stroke:null,this.offsetX_=void 0!==t.offsetX?t.offsetX:0,this.offsetY_=void 0!==t.offsetY?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=void 0===t.padding?null:t.padding}clone(){const t=this.getScale();return new dE({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=ix(void 0!==t?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const fE=dE;var pE=i(2582);function gE(t,e,i){const n=t;let r=!0,s=!1,a=!1;const o=[Qp(n,qp,(function(){a=!0,s||e()}))];return n.src&&wg?(s=!0,n.decode().then((function(){r&&e()})).catch((function(t){r&&(a?e():i())}))):o.push(Qp(n,Up,i)),function(){r=!1,o.forEach(tg)}}let mE=null;class vE extends Wp{constructor(t,e,i,n,r,s){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=n,this.canvas_={},this.color_=s,this.unlisten_=null,this.imageState_=r,this.size_=i,this.src_=e,this.tainted_}initializeImage_(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(void 0===this.tainted_&&this.imageState_===$T){mE||(mE=vb(1,1,void 0,{willReadFrequently:!0})),mE.drawImage(this.image_,0,0);try{mE.getImageData(0,0,1,1),this.tainted_=!1}catch(t){mE=null,this.tainted_=!0}}return!0===this.tainted_}dispatchChangeEvent_(){this.dispatchEvent(Gp)}handleImageError_(){this.imageState_=QT,this.unlistenImage_(),this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=$T,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=vb(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===ZT){this.image_||this.initializeImage_(),this.imageState_=JT;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=gE(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==$T)return;const e=this.image_,i=document.createElement("canvas");i.width=Math.ceil(e.width*t),i.height=Math.ceil(e.height*t);const n=i.getContext("2d");n.scale(t,t),n.drawImage(e,0,0),n.globalCompositeOperation="multiply",n.fillStyle=Sm(this.color_),n.fillRect(0,0,i.width/t,i.height/t),n.globalCompositeOperation="destination-in",n.drawImage(e,0,0),this.canvas_[t]=i}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function yE(t,e,i,n){return void 0!==i&&void 0!==n?[i/t,n/e]:void 0!==i?i/t:void 0!==n?n/e:1}class bE extends eE{constructor(t){const e=void 0!==(t=t||{}).opacity?t.opacity:1,i=void 0!==t.rotation?t.rotation:0,n=void 0!==t.scale?t.scale:1,r=void 0!==t.rotateWithView&&t.rotateWithView;super({opacity:e,rotation:i,scale:n,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:r,declutterMode:t.declutterMode}),this.anchor_=void 0!==t.anchor?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",this.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",this.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;const s=void 0!==t.img?t.img:null;this.imgSize_=t.imgSize;let a=t.src;Tg(!(void 0!==a&&s),4),Tg(!s||s&&this.imgSize_,5),void 0!==a&&0!==a.length||!s||(a=s.src||sg(s)),Tg(void 0!==a&&a.length>0,6),Tg(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),69);const o=void 0!==t.src?ZT:$T;if(this.color_=void 0!==t.color?km(t.color):null,this.iconImage_=function(t,e,i,n,r,s){let a=Pm.get(e,n,s);return a||(a=new vE(t,e,i,n,r,s),Pm.set(e,n,s,a)),a}(s,a,void 0!==this.imgSize_?this.imgSize_:null,this.crossOrigin_,o,this.color_),this.offset_=void 0!==t.offset?t.offset:[0,0],this.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",this.origin_=null,this.size_=void 0!==t.size?t.size:null,void 0!==t.width||void 0!==t.height){let e,i;if(t.size)[e,i]=t.size;else{const n=this.getImage(1);if(!(n instanceof HTMLCanvasElement||n.src&&n.complete)){this.initialOptions_=t;const e=()=>{if(this.unlistenImageChange(e),!this.initialOptions_)return;const i=this.iconImage_.getSize();this.setScale(yE(i[0],i[1],t.width,t.height))};return void this.listenImageChange(e)}e=n.width,i=n.height}void 0!==e&&this.setScale(yE(e,i,t.width,t.height))}}clone(){let t,e,i;this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t);return new bE({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,imgSize:this.imgSize_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const e=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!e)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=e[0]),"fraction"==this.anchorYUnits_&&(t[1]*=e[1])}if("top-left"!=this.anchorOrigin_){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[0]=-t[0]+e[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if("top-left"!=this.offsetOrigin_){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[0]=i[0]-e[0]-t[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();return this.size_?this.size_[0]*t[0]:this.iconImage_.getImageState()==$T?this.iconImage_.getSize()[0]*t[0]:void 0}getHeight(){const t=this.getScaleArray();return this.size_?this.size_[1]*t[1]:this.iconImage_.getImageState()==$T?this.iconImage_.getSize()[1]*t[1]:void 0}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(Gp,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(Gp,t)}}const _E=bE;function xE(t){return new uE({fill:wE(t,""),stroke:SE(t,""),text:TE(t),image:EE(t)})}function wE(t,e){const i=t[e+"fill-color"];if(i)return"none"===i?null:new GT({color:i})}function SE(t,e){const i=t[e+"stroke-width"],n=t[e+"stroke-color"];if(i||n)return new qT({width:i,color:n,lineCap:t[e+"stroke-line-cap"],lineJoin:t[e+"stroke-line-join"],lineDash:t[e+"stroke-line-dash"],lineDashOffset:t[e+"stroke-line-dash-offset"],miterLimit:t[e+"stroke-miter-limit"]})}function TE(t){const e=t["text-value"];if(!e)return;return new fE({text:e,font:t["text-font"],maxAngle:t["text-max-angle"],offsetX:t["text-offset-x"],offsetY:t["text-offset-y"],overflow:t["text-overflow"],placement:t["text-placement"],repeat:t["text-repeat"],scale:t["text-scale"],rotateWithView:t["text-rotate-with-view"],rotation:t["text-rotation"],textAlign:t["text-align"],justify:t["text-justify"],textBaseline:t["text-baseline"],padding:t["text-padding"],fill:wE(t,"text-"),backgroundFill:wE(t,"text-background-"),stroke:SE(t,"text-"),backgroundStroke:SE(t,"text-background-")})}function EE(t){const e=t["icon-src"],i=t["icon-img"];if(e||i){return new _E({src:e,img:i,imgSize:t["icon-img-size"],anchor:t["icon-anchor"],anchorOrigin:t["icon-anchor-origin"],anchorXUnits:t["icon-anchor-x-units"],anchorYUnits:t["icon-anchor-y-units"],color:t["icon-color"],crossOrigin:t["icon-cross-origin"],offset:t["icon-offset"],displacement:t["icon-displacement"],opacity:t["icon-opacity"],scale:t["icon-scale"],width:t["icon-width"],height:t["icon-height"],rotation:t["icon-rotation"],rotateWithView:t["icon-rotate-with-view"],size:t["icon-size"],declutterMode:t["icon-declutter-mode"]})}const n=t["shape-points"];if(n){const e="shape-";return new rE({points:n,fill:wE(t,e),stroke:SE(t,e),radius:t["shape-radius"],radius1:t["shape-radius1"],radius2:t["shape-radius2"],angle:t["shape-angle"],displacement:t["shape-displacement"],rotation:t["shape-rotation"],rotateWithView:t["shape-rotate-with-view"],scale:t["shape-scale"],declutterMode:t["shape-declutter-mode"]})}const r=t["circle-radius"];if(r){const e="circle-";return new aE({radius:r,fill:wE(t,e),stroke:SE(t,e),displacement:t["circle-displacement"],scale:t["circle-scale"],rotation:t["circle-rotation"],rotateWithView:t["circle-rotate-with-view"],declutterMode:t["circle-declutter-mode"]})}}const kE="renderOrder";const CE=class extends ab{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=void 0!==t.declutter&&t.declutter,this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,this.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(kE)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t){t.declutterTree||(t.declutterTree=new pE(9)),this.getRenderer().renderDeclutter(t)}setRenderOrder(t){this.set(kE,t)}setStyle(t){let e;if(void 0===t)e=hE;else if(null===t)e=null;else if("function"==typeof t)e=t;else if(t instanceof uE)e=t;else if(Array.isArray(t)){const i=t.length,n=new Array(i);for(let e=0;e<i;++e){const i=t[e];n[e]=i instanceof uE?i:xE(i)}e=n}else e=xE(t);this.style_=e,this.styleFunction_=null===t?void 0:function(t){let e;if("function"==typeof t)e=t;else{let i;Array.isArray(t)?i=t:(Tg("function"==typeof t.getZIndex,41),i=[t]),e=function(){return i}}return e}(this.style_),this.changed()}},ME={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},AE=[ME.FILL],OE=[ME.STROKE],PE=[ME.BEGIN_PATH],RE=[ME.CLOSE_PATH],IE=ME;const LE=class{drawCustom(t,e,i,n){}drawGeometry(t){}setStyle(t){}drawCircle(t,e){}drawFeature(t,e){}drawGeometryCollection(t,e){}drawLineString(t,e){}drawMultiLineString(t,e){}drawMultiPoint(t,e){}drawMultiPolygon(t,e){}drawPoint(t,e){}drawPolygon(t,e){}drawText(t,e){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}};const DE=class extends LE{constructor(t,e,i,n){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,r=this.coordinates;let s=r.length;for(let a=0,o=t.length;a<o;a+=e)n[0]=t[a],n[1]=t[a+1],Fg(i,n)&&(r[s++]=n[0],r[s++]=n[1]);return s}appendFlatLineCoordinates(t,e,i,n,r,s){const a=this.coordinates;let o=a.length;const l=this.getBufferedMaxExtent();s&&(e+=n);let h=t[e],c=t[e+1];const u=this.tmpCoordinate_;let d,f,p,g=!0;for(d=e+n;d<i;d+=n)u[0]=t[d],u[1]=t[d+1],p=zg(l,u),p!==f?(g&&(a[o++]=h,a[o++]=c,g=!1),a[o++]=u[0],a[o++]=u[1]):p===Rg.INTERSECTING?(a[o++]=u[0],a[o++]=u[1],g=!1):g=!0,h=u[0],c=u[1],f=p;return(r&&g||d===e+n)&&(a[o++]=h,a[o++]=c),o}drawCustomCoordinates_(t,e,i,n,r){for(let s=0,a=i.length;s<a;++s){const a=i[s],o=this.appendFlatLineCoordinates(t,e,a,n,!1,!1);r.push(o),e=a}return e}drawCustom(t,e,i,n){this.beginGeometry(t,e);const r=t.getType(),s=t.getStride(),a=this.coordinates.length;let o,l,h,c,u;switch(r){case"MultiPolygon":o=t.getOrientedFlatCoordinates(),c=[];const e=t.getEndss();u=0;for(let t=0,i=e.length;t<i;++t){const i=[];u=this.drawCustomCoordinates_(o,u,e[t],s,i),c.push(i)}this.instructions.push([IE.CUSTOM,a,c,t,i,Iy]),this.hitDetectionInstructions.push([IE.CUSTOM,a,c,t,n||i,Iy]);break;case"Polygon":case"MultiLineString":h=[],o="Polygon"==r?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),u=this.drawCustomCoordinates_(o,0,t.getEnds(),s,h),this.instructions.push([IE.CUSTOM,a,h,t,i,Ry]),this.hitDetectionInstructions.push([IE.CUSTOM,a,h,t,n||i,Ry]);break;case"LineString":case"Circle":o=t.getFlatCoordinates(),l=this.appendFlatLineCoordinates(o,0,o.length,s,!1,!1),this.instructions.push([IE.CUSTOM,a,l,t,i,Py]),this.hitDetectionInstructions.push([IE.CUSTOM,a,l,t,n||i,Py]);break;case"MultiPoint":o=t.getFlatCoordinates(),l=this.appendFlatPointCoordinates(o,s),l>a&&(this.instructions.push([IE.CUSTOM,a,l,t,i,Py]),this.hitDetectionInstructions.push([IE.CUSTOM,a,l,t,n||i,Py]));break;case"Point":o=t.getFlatCoordinates(),this.coordinates.push(o[0],o[1]),l=this.coordinates.length,this.instructions.push([IE.CUSTOM,a,l,t,i]),this.hitDetectionInstructions.push([IE.CUSTOM,a,l,t,n||i])}this.endGeometry(e)}beginGeometry(t,e){this.beginGeometryInstruction1_=[IE.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[IE.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;let e;t.reverse();const i=t.length;let n,r,s=-1;for(e=0;e<i;++e)n=t[e],r=n[0],r==IE.END_GEOMETRY?s=e:r==IE.BEGIN_GEOMETRY&&(n[2]=e,Ip(this.hitDetectionInstructions,s,e),s=-1)}setFillStrokeStyle(t,e){const i=this.state;if(t){const e=t.getColor();i.fillStyle=iE(e||wb)}else i.fillStyle=void 0;if(e){const t=e.getColor();i.strokeStyle=iE(t||kb);const n=e.getLineCap();i.lineCap=void 0!==n?n:Sb;const r=e.getLineDash();i.lineDash=r?r.slice():Tb;const s=e.getLineDashOffset();i.lineDashOffset=s||0;const a=e.getLineJoin();i.lineJoin=void 0!==a?a:Eb;const o=e.getWidth();i.lineWidth=void 0!==o?o:1;const l=e.getMiterLimit();i.miterLimit=void 0!==l?l:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const e=t.fillStyle,i=[IE.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(!0),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[IE.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,n=t.lineCap,r=t.lineDash,s=t.lineDashOffset,a=t.lineJoin,o=t.lineWidth,l=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!Dp(t.currentLineDash,r)||t.currentLineDashOffset!=s||t.currentLineJoin!=a||t.currentLineWidth!=o||t.currentMiterLimit!=l)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=s,t.currentLineJoin=a,t.currentLineWidth=o,t.currentMiterLimit=l)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[IE.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Dg(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;Lg(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}};const NE=class extends DE{constructor(t,e,i,n){super(t,e,i,n),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,s=this.appendFlatPointCoordinates(i,n);this.instructions.push([IE.DRAW_IMAGE,r,s,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([IE.DRAW_IMAGE,r,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,s=this.appendFlatPointCoordinates(i,n);this.instructions.push([IE.DRAW_IMAGE,r,s,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([IE.DRAW_IMAGE,r,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),n=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}};const FE=class extends DE{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinates_(t,e,i,n){const r=this.coordinates.length,s=this.appendFlatLineCoordinates(t,e,i,n,!1,!1),a=[IE.MOVE_TO_LINE_TO,r,s];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(t,e){const i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0===n||void 0===r)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([IE.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Tb,0],PE);const s=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(s,0,s.length,a),this.hitDetectionInstructions.push(OE),this.endGeometry(e)}drawMultiLineString(t,e){const i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0===n||void 0===r)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([IE.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Tb,0],PE);const s=t.getEnds(),a=t.getFlatCoordinates(),o=t.getStride();let l=0;for(let t=0,e=s.length;t<e;++t)l=this.drawFlatCoordinates_(a,l,s[t],o);this.hitDetectionInstructions.push(OE),this.endGeometry(e)}finish(){const t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(OE),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(OE),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(PE)}};const jE=class extends DE{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinatess_(t,e,i,n){const r=this.state,s=void 0!==r.fillStyle,a=void 0!==r.strokeStyle,o=i.length;this.instructions.push(PE),this.hitDetectionInstructions.push(PE);for(let r=0;r<o;++r){const s=i[r],o=this.coordinates.length,l=this.appendFlatLineCoordinates(t,e,s,n,!0,!a),h=[IE.MOVE_TO_LINE_TO,o,l];this.instructions.push(h),this.hitDetectionInstructions.push(h),a&&(this.instructions.push(RE),this.hitDetectionInstructions.push(RE)),e=s}return s&&(this.instructions.push(AE),this.hitDetectionInstructions.push(AE)),a&&(this.instructions.push(OE),this.hitDetectionInstructions.push(OE)),e}drawCircle(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([IE.SET_FILL_STYLE,wb]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([IE.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Tb,0]);const s=t.getFlatCoordinates(),a=t.getStride(),o=this.coordinates.length;this.appendFlatLineCoordinates(s,0,s.length,a,!1,!1);const l=[IE.CIRCLE,o];this.instructions.push(PE,l),this.hitDetectionInstructions.push(PE,l),void 0!==i.fillStyle&&(this.instructions.push(AE),this.hitDetectionInstructions.push(AE)),void 0!==i.strokeStyle&&(this.instructions.push(OE),this.hitDetectionInstructions.push(OE)),this.endGeometry(e)}drawPolygon(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([IE.SET_FILL_STYLE,wb]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([IE.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Tb,0]);const s=t.getEnds(),a=t.getOrientedFlatCoordinates(),o=t.getStride();this.drawFlatCoordinatess_(a,0,s,o),this.endGeometry(e)}drawMultiPolygon(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([IE.SET_FILL_STYLE,wb]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([IE.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Tb,0]);const s=t.getEndss(),a=t.getOrientedFlatCoordinates(),o=t.getStride();let l=0;for(let t=0,e=s.length;t<e;++t)l=this.drawFlatCoordinatess_(a,l,s[t],o);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const e=this.coordinates;for(let i=0,n=e.length;i<n;++i)e[i]=My(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}};function BE(t,e,i,n,r){const s=[];let a=i,o=0,l=e.slice(i,2);for(;o<t&&a+r<n;){const[i,n]=l.slice(-2),h=e[a+r],c=e[a+r+1],u=Math.sqrt((h-i)*(h-i)+(c-n)*(c-n));if(o+=u,o>=t){const e=(t-o+u)/u,d=vm(i,h,e),f=vm(n,c,e);l.push(d,f),s.push(l),l=[d,f],o==t&&(a+=r),o=0}else if(o<t)l.push(e[a+r],e[a+r+1]),a+=r;else{const t=u-o,e=vm(i,h,t/u),d=vm(n,c,t/u);l.push(e,d),s.push(l),l=[e,d],o=0,a+=r}}return o>0&&s.push(l),s}function zE(t,e,i,n,r){let s,a,o,l,h,c,u,d,f,p,g=i,m=i,v=0,y=0,b=i;for(a=i;a<n;a+=r){const i=e[a],n=e[a+1];void 0!==h&&(f=i-h,p=n-c,l=Math.sqrt(f*f+p*p),void 0!==u&&(y+=o,s=Math.acos((u*f+d*p)/(o*l)),s>t&&(y>v&&(v=y,g=b,m=a),y=0,b=a-r)),o=l,u=f,d=p),h=i,c=n}return y+=l,y>v?[b,a]:[g,m]}const WE={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};const GE=class extends DE{constructor(t,e,i,n){super(t,e,i,n),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[wb]={fillStyle:wb},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e){const i=this.textFillState_,n=this.textStrokeState_,r=this.textState_;if(""===this.text_||!r||!i&&!n)return;const s=this.coordinates;let a=s.length;const o=t.getType();let l=null,h=t.getStride();if("line"!==r.placement||"LineString"!=o&&"MultiLineString"!=o&&"Polygon"!=o&&"MultiPolygon"!=o){let i=r.overflow?null:[];switch(o){case"Point":case"MultiPoint":l=t.getFlatCoordinates();break;case"LineString":l=t.getFlatMidpoint();break;case"Circle":l=t.getCenter();break;case"MultiLineString":l=t.getFlatMidpoints(),h=2;break;case"Polygon":l=t.getFlatInteriorPoint(),r.overflow||i.push(l[2]/this.resolution),h=3;break;case"MultiPolygon":const e=t.getFlatInteriorPoints();l=[];for(let t=0,n=e.length;t<n;t+=3)r.overflow||i.push(e[t+2]/this.resolution),l.push(e[t],e[t+1]);if(0===l.length)return;h=2}const n=this.appendFlatPointCoordinates(l,h);if(n===a)return;if(i&&(n-a)/2!=l.length/h){let t=a/2;i=i.filter(((e,i)=>{const n=s[2*(t+i)]===l[i*h]&&s[2*(t+i)+1]===l[i*h+1];return n||--t,n}))}this.saveTextStates_(),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&this.updateFillStyle(this.state,this.createFill),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);let c=r.padding;if(c!=Ab&&(r.scale[0]<0||r.scale[1]<0)){let t=r.padding[0],e=r.padding[1],i=r.padding[2],n=r.padding[3];r.scale[0]<0&&(e=-e,n=-n),r.scale[1]<0&&(t=-t,i=-i),c=[t,e,i,n]}const u=this.pixelRatio;this.instructions.push([IE.DRAW_IMAGE,a,n,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,c==Ab?Ab:c.map((function(t){return t*u})),!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]);const d=1/u,f=this.state.fillStyle;r.backgroundFill&&(this.state.fillStyle=wb,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([IE.DRAW_IMAGE,a,n,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[d,d],NaN,void 0,this.declutterImageWithText_,c,!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?wb:this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]),r.backgroundFill&&(this.state.fillStyle=f,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}else{if(!om(this.getBufferedMaxExtent(),t.getExtent()))return;let i;if(l=t.getFlatCoordinates(),"LineString"==o)i=[l.length];else if("MultiLineString"==o)i=t.getEnds();else if("Polygon"==o)i=t.getEnds().slice(0,1);else if("MultiPolygon"==o){const e=t.getEndss();i=[];for(let t=0,n=e.length;t<n;++t)i.push(e[t][0])}this.beginGeometry(t,e);const n=r.repeat,c=n?void 0:r.textAlign;let u=0;for(let t=0,e=i.length;t<e;++t){let e;e=n?BE(n*this.resolution,l,u,i[t],h):[l.slice(u,i[t])];for(let n=0,o=e.length;n<o;++n){const o=e[n];let l=0,d=o.length;if(null==c){const t=zE(r.maxAngle,o,0,o.length,2);l=t[0],d=t[1]}for(let t=l;t<d;t+=h)s.push(o[t],o[t+1]);const f=s.length;u=i[t],this.drawChars_(a,f),a=f}}this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||Cb,justify:e.justify,textBaseline:e.textBaseline||Mb,scale:e.scale});const s=this.fillKey_;i&&(s in this.fillStates||(this.fillStates[s]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,n=this.textState_,r=this.strokeKey_,s=this.textKey_,a=this.fillKey_;this.saveTextStates_();const o=this.pixelRatio,l=WE[n.textBaseline],h=this.textOffsetY_*o,c=this.text_,u=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([IE.DRAW_CHARS,t,e,l,n.overflow,a,n.maxAngle,o,h,r,u*o,c,s,1]),this.hitDetectionInstructions.push([IE.DRAW_CHARS,t,e,l,n.overflow,a?wb:a,n.maxAngle,1,h,r,u,c,s,1/o])}setTextStyle(t,e){let i,n,r;if(t){const e=t.getFill();e?(n=this.textFillState_,n||(n={},this.textFillState_=n),n.fillStyle=iE(e.getColor()||wb)):(n=null,this.textFillState_=n);const s=t.getStroke();if(s){r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const t=s.getLineDash(),e=s.getLineDashOffset(),i=s.getWidth(),n=s.getMiterLimit();r.lineCap=s.getLineCap()||Sb,r.lineDash=t?t.slice():Tb,r.lineDashOffset=void 0===e?0:e,r.lineJoin=s.getLineJoin()||Eb,r.lineWidth=void 0===i?1:i,r.miterLimit=void 0===n?10:n,r.strokeStyle=iE(s.getColor()||kb)}else r=null,this.textStrokeState_=r;i=this.textState_;const a=t.getFont()||xb;Lb(a);const o=t.getScaleArray();i.overflow=t.getOverflow(),i.font=a,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||Mb,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||Ab,i.scale=void 0===o?[1,1]:o;const l=t.getOffsetX(),h=t.getOffsetY(),c=t.getRotateWithView(),u=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===l?0:l,this.textOffsetY_=void 0===h?0:h,this.textRotateWithView_=void 0!==c&&c,this.textRotation_=void 0===u?0:u,this.strokeKey_=r?("string"==typeof r.strokeStyle?r.strokeStyle:sg(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+sg(n.fillStyle):""}else this.text_="";this.declutterImageWithText_=e}},UE={Circle:jE,Default:DE,Image:NE,LineString:FE,Polygon:jE,Text:GE};const HE=class{constructor(t,e,i,n){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const n in i){const r=i[n].finish();t[e][n]=r}}return t}getBuilder(t,e){const i=void 0!==t?t.toString():"0";let n=this.buildersByZIndex_[i];void 0===n&&(n={},this.buildersByZIndex_[i]=n);let r=n[e];if(void 0===r){r=new(0,UE[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=r}return r}};const XE=class extends ig{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return ng()}getData(t){return null}prepareFrame(t){return ng()}renderFrame(t,e){return ng()}loadedTileCallback(t,e,i){t[e]||(t[e]={}),t[e][i.tileCoord.toString()]=i}createLoadedTileFinder(t,e,i){return(n,r)=>{const s=this.loadedTileCallback.bind(this,i,n);return t.forEachLoadedTile(e,n,r,s)}}forEachFeatureAtCoordinate(t,e,i,n,r){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;e.getState()!==$T&&e.getState()!==QT||this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=$T&&e!=QT&&t.addEventListener(Gp,this.boundHandleImageChange_),e==ZT&&(t.load(),e=t.getState()),e==$T}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}},VE=[];let YE=null;const KE=class extends XE{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=[1,0,0,1,0,0],this.pixelTransform=[1,0,0,1,0,0],this.inversePixelTransform=[1,0,0,1,0,0],this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,i){let n;YE||(YE=vb(1,1,void 0,{willReadFrequently:!0})),YE.clearRect(0,0,1,1);try{YE.drawImage(t,e,i,1,1,0,0,1,1),n=YE.getImageData(0,0,1,1).data}catch(t){return YE=null,null}return n}getBackground(t){let e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,i){const n=this.getLayer().getClassName();let r,s;if(t&&t.className===n&&(!i||t&&t.style.backgroundColor&&Dp(km(t.style.backgroundColor),km(i)))){const e=t.firstElementChild;e instanceof HTMLCanvasElement&&(s=e.getContext("2d"))}if(s&&s.canvas.style.transform===e?(this.container=t,this.context=s,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){r=document.createElement("div"),r.className=n;let t=r.style;t.position="absolute",t.width="100%",t.height="100%",s=vb();const e=s.canvas;r.appendChild(e),t=e.style,t.position="absolute",t.left="0",t.transformOrigin="top left",this.container=r,this.context=s}this.containerReused||!i||this.container.style.backgroundColor||(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const n=rm(i),r=sm(i),s=Jg(i),a=Zg(i);Cg(e.coordinateToPixelTransform,n),Cg(e.coordinateToPixelTransform,r),Cg(e.coordinateToPixelTransform,s),Cg(e.coordinateToPixelTransform,a);const o=this.inversePixelTransform;Cg(o,n),Cg(o,r),Cg(o,s),Cg(o,a),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}dispatchRenderEvent_(t,e,i){const n=this.getLayer();if(n.hasListener(t)){const r=new hb(t,this.inversePixelTransform,i,e);n.dispatchEvent(r)}}preRender(t,e){this.frameState=e,this.dispatchRenderEvent_(Um,t,e)}postRender(t,e){this.dispatchRenderEvent_(Hm,t,e)}getRenderTransform(t,e,i,n,r,s,a){const o=r/2,l=s/2,h=n/e,c=-h,u=-t[0]+a,d=-t[1];return Mg(this.tempTransform,o,l,h,c,-i,u,d)}disposeInternal(){delete this.frameState,super.disposeInternal()}};function qE(t,e,i,n,r,s,a,o,l,h,c,u){let d=t[e],f=t[e+1],p=0,g=0,m=0,v=0;function y(){p=d,g=f,d=t[e+=n],f=t[e+1],v+=m,m=Math.sqrt((d-p)*(d-p)+(f-g)*(f-g))}do{y()}while(e<i-n&&v+m<s);let b=0===m?0:(s-v)/m;const _=vm(p,d,b),x=vm(g,f,b),w=e-n,S=v,T=s+o*l(h,r,c);for(;e<i-n&&v+m<T;)y();b=0===m?0:(T-v)/m;const E=vm(p,d,b),k=vm(g,f,b);let C;if(u){const t=[_,x,E,k];gy(t,0,4,2,u,t,t),C=t[0]>t[2]}else C=_>E;const M=Math.PI,A=[],O=w+n===e;let P;if(m=0,v=S,d=t[e=w],f=t[e+1],O){y(),P=Math.atan2(f-g,d-p),C&&(P+=P>0?-M:M);const t=(E+_)/2,e=(k+x)/2;return A[0]=[t,e,(T-s)/2,P,r],A}for(let t=0,u=(r=r.replace(/\n/g," ")).length;t<u;){y();let _=Math.atan2(f-g,d-p);if(C&&(_+=_>0?-M:M),void 0!==P){let t=_-P;if(t+=t>M?-2*M:t<-M?2*M:0,Math.abs(t)>a)return null}P=_;const x=t;let w=0;for(;t<u;++t){const a=o*l(h,r[C?u-t-1:t],c);if(e+n<i&&v+m<s+w+a/2)break;w+=a}if(t===x)continue;const S=C?r.substring(u-x,u-t):r.substring(x,t);b=0===m?0:(s+w/2-v)/m;const T=vm(p,d,b),E=vm(g,f,b);A.push([T,E,w/2,_,S]),s+=w}return A}const ZE=[1/0,1/0,-1/0,-1/0],JE=[],$E=[],QE=[],tk=[];function ek(t){return t[3].declutterBox}const ik=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function nk(t,e){return"start"===e?e=ik.test(t)?"right":"left":"end"===e&&(e=ik.test(t)?"left":"right"),WE[e]}function rk(t,e,i){return i>0&&t.push("\n",""),t.push(e,""),t}const sk=class{constructor(t,e,i,n){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={}}createLabel(t,e,i,n){const r=t+e+i+n;if(this.labels_[r])return this.labels_[r];const s=n?this.strokeStates[n]:null,a=i?this.fillStates[i]:null,o=this.textStates[e],l=this.pixelRatio,h=[o.scale[0]*l,o.scale[1]*l],c=Array.isArray(t),u=o.justify?WE[o.justify]:nk(Array.isArray(t)?t[0]:t,o.textAlign||Cb),d=n&&s.lineWidth?s.lineWidth:0,f=c?t:t.split("\n").reduce(rk,[]),{width:p,height:g,widths:m,heights:v,lineWidths:y}=function(t,e){const i=[],n=[],r=[];let s=0,a=0,o=0,l=0;for(let h=0,c=e.length;h<=c;h+=2){const u=e[h];if("\n"===u||h===c){s=Math.max(s,a),r.push(a),a=0,o+=l;continue}const d=e[h+1]||t.font,f=Fb(d,u);i.push(f),a+=f;const p=Db(d);n.push(p),l=Math.max(l,p)}return{width:s,height:o,widths:i,heights:n,lineWidths:r}}(o,f),b=p+d,_=[],x=(b+2)*h[0],w=(g+d)*h[1],S={width:x<0?Math.floor(x):Math.ceil(x),height:w<0?Math.floor(w):Math.ceil(w),contextInstructions:_};1==h[0]&&1==h[1]||_.push("scale",h),n&&(_.push("strokeStyle",s.strokeStyle),_.push("lineWidth",d),_.push("lineCap",s.lineCap),_.push("lineJoin",s.lineJoin),_.push("miterLimit",s.miterLimit),_.push("setLineDash",[s.lineDash]),_.push("lineDashOffset",s.lineDashOffset)),i&&_.push("fillStyle",a.fillStyle),_.push("textBaseline","middle"),_.push("textAlign","center");const T=.5-u;let E=u*b+T*d;const k=[],C=[];let M,A=0,O=0,P=0,R=0;for(let t=0,e=f.length;t<e;t+=2){const e=f[t];if("\n"===e){O+=A,A=0,E=u*b+T*d,++R;continue}const r=f[t+1]||o.font;r!==M&&(n&&k.push("font",r),i&&C.push("font",r),M=r),A=Math.max(A,v[P]);const s=[e,E+T*m[P]+u*(m[P]-y[R]),.5*(d+A)+O];E+=m[P],n&&k.push("strokeText",s),i&&C.push("fillText",s),++P}return Array.prototype.push.apply(_,k),Array.prototype.push.apply(_,C),this.labels_[r]=S,S}replayTextBackground_(t,e,i,n,r,s,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,e),s&&(this.alignFill_=s[2],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,n,r,s,a,o,l,h,c,u,d,f,p,g){let m=i-(a*=u[0]),v=n-(o*=u[1]);const y=r+l>t?t-l:r,b=s+h>e?e-h:s,_=f[3]+y*u[0]+f[1],x=f[0]+b*u[1]+f[2],w=m-f[3],S=v-f[0];let T;return(p||0!==c)&&(JE[0]=w,tk[0]=w,JE[1]=S,$E[1]=S,$E[0]=w+_,QE[0]=$E[0],QE[1]=S+x,tk[1]=QE[1]),0!==c?(T=Mg([1,0,0,1,0,0],i,n,1,1,c,-i,-n),Cg(T,JE),Cg(T,$E),Cg(T,QE),Cg(T,tk),Gg(Math.min(JE[0],$E[0],QE[0],tk[0]),Math.min(JE[1],$E[1],QE[1],tk[1]),Math.max(JE[0],$E[0],QE[0],tk[0]),Math.max(JE[1],$E[1],QE[1],tk[1]),ZE)):Gg(Math.min(w,w+_),Math.min(S,S+x),Math.max(w,w+_),Math.max(S,S+x),ZE),d&&(m=Math.round(m),v=Math.round(v)),{drawImageX:m,drawImageY:v,drawImageW:y,drawImageH:b,originX:l,originY:h,declutterBox:{minX:ZE[0],minY:ZE[1],maxX:ZE[2],maxY:ZE[3],value:g},canvasTransform:T,scale:u}}replayImageOrLabel_(t,e,i,n,r,s,a){const o=!(!s&&!a),l=n.declutterBox,h=t.canvas,c=a?a[2]*n.scale[0]/2:0;return l.minX-c<=h.width/e&&l.maxX+c>=0&&l.minY-c<=h.height/e&&l.maxY+c>=0&&(o&&this.replayTextBackground_(t,JE,$E,QE,tk,s,a),Bb(t,n.canvasTransform,r,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}fill_(t){if(this.alignFill_){const e=Cg(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,n){const r=this.textStates[e],s=this.createLabel(t,e,n,i),a=this.strokeStates[i],o=this.pixelRatio,l=nk(Array.isArray(t)?t[0]:t,r.textAlign||Cb),h=WE[r.textBaseline||Mb],c=a&&a.lineWidth?a.lineWidth:0;return{label:s,anchorX:l*(s.width/o-2*r.scale[0])+2*(.5-l)*c,anchorY:h*s.height/o+2*(.5-h)*c}}execute_(t,e,i,n,r,s,a,o){let l;var h,c;this.pixelCoordinates_&&Dp(i,this.renderedTransform_)?l=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),l=py(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),h=this.renderedTransform_,c=i,h[0]=c[0],h[1]=c[1],h[2]=c[2],h[3]=c[3],h[4]=c[4],h[5]=c[5]);let u=0;const d=n.length;let f,p,g,m,v,y,b,_,x,w,S,T,E=0,k=0,C=0,M=null,A=null;const O=this.coordinateCache_,P=this.viewRotation_,R=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,I={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:P},L=this.instructions!=n||this.overlaps?0:200;let D,N,F,j;for(;u<d;){const i=n[u];switch(i[0]){case IE.BEGIN_GEOMETRY:D=i[1],j=i[3],D.getGeometry()?void 0===a||om(a,j.getExtent())?++u:u=i[2]+1:u=i[2];break;case IE.BEGIN_PATH:k>L&&(this.fill_(t),k=0),C>L&&(t.stroke(),C=0),k||C||(t.beginPath(),m=NaN,v=NaN),++u;break;case IE.CIRCLE:E=i[1];const n=l[E],h=l[E+1],c=l[E+2]-n,d=l[E+3]-h,B=Math.sqrt(c*c+d*d);t.moveTo(n+B,h),t.arc(n,h,B,0,2*Math.PI,!0),++u;break;case IE.CLOSE_PATH:t.closePath(),++u;break;case IE.CUSTOM:E=i[1],f=i[2];const z=i[3],W=i[4],G=6==i.length?i[5]:void 0;I.geometry=z,I.feature=D,u in O||(O[u]=[]);const U=O[u];G?G(l,E,f,2,U):(U[0]=l[E],U[1]=l[E+1],U.length=2),W(U,I),++u;break;case IE.DRAW_IMAGE:E=i[1],f=i[2],_=i[3],p=i[4],g=i[5];let H=i[6];const X=i[7],V=i[8],Y=i[9],K=i[10];let q=i[11];const Z=i[12];let J=i[13];const $=i[14],Q=i[15];if(!_&&i.length>=20){x=i[19],w=i[20],S=i[21],T=i[22];const t=this.drawLabelWithPointPlacement_(x,w,S,T);_=t.label,i[3]=_;const e=i[23];p=(t.anchorX-e)*this.pixelRatio,i[4]=p;const n=i[24];g=(t.anchorY-n)*this.pixelRatio,i[5]=g,H=_.height,i[6]=H,J=_.width,i[13]=J}let tt,et,it,nt;i.length>25&&(tt=i[25]),i.length>17?(et=i[16],it=i[17],nt=i[18]):(et=Ab,it=!1,nt=!1),K&&R?q+=P:K||R||(q-=P);let rt=0;for(;E<f;E+=2){if(tt&&tt[rt++]<J/this.pixelRatio)continue;const i=this.calculateImageOrLabelDimensions_(_.width,_.height,l[E],l[E+1],J,H,p,g,V,Y,q,Z,r,et,it||nt,D),n=[t,e,_,i,X,it?M:null,nt?A:null];if(o){if("none"===$)continue;if("obstacle"===$){o.insert(i.declutterBox);continue}{let t,e;if(Q){const i=f-E;if(!Q[i]){Q[i]=n;continue}if(t=Q[i],delete Q[i],e=ek(t),o.collides(e))continue}if(o.collides(i.declutterBox))continue;t&&(o.insert(e),this.replayImageOrLabel_.apply(this,t)),o.insert(i.declutterBox)}}this.replayImageOrLabel_.apply(this,n)}++u;break;case IE.DRAW_CHARS:const st=i[1],at=i[2],ot=i[3],lt=i[4];T=i[5];const ht=i[6],ct=i[7],ut=i[8];S=i[9];const dt=i[10];x=i[11],w=i[12];const ft=[i[13],i[13]],pt=this.textStates[w],gt=pt.font,mt=[pt.scale[0]*ct,pt.scale[1]*ct];let vt;gt in this.widths_?vt=this.widths_[gt]:(vt={},this.widths_[gt]=vt);const yt=XT(l,st,at,2),bt=Math.abs(mt[0])*jb(gt,x,vt);if(lt||bt<=yt){const i=qE(l,st,at,2,x,(yt-bt)*nk(x,this.textStates[w].textAlign),ht,Math.abs(mt[0]),jb,gt,vt,R?0:this.viewRotation_);t:if(i){const n=[];let r,s,a,l,h;if(S)for(r=0,s=i.length;r<s;++r){h=i[r],a=h[4],l=this.createLabel(a,w,"",S),p=h[2]+(mt[0]<0?-dt:dt),g=ot*l.height+2*(.5-ot)*dt*mt[1]/mt[0]-ut;const s=this.calculateImageOrLabelDimensions_(l.width,l.height,h[0],h[1],l.width,l.height,p,g,0,0,h[3],ft,!1,Ab,!1,D);if(o&&o.collides(s.declutterBox))break t;n.push([t,e,l,s,1,null,null])}if(T)for(r=0,s=i.length;r<s;++r){h=i[r],a=h[4],l=this.createLabel(a,w,T,""),p=h[2],g=ot*l.height-ut;const s=this.calculateImageOrLabelDimensions_(l.width,l.height,h[0],h[1],l.width,l.height,p,g,0,0,h[3],ft,!1,Ab,!1,D);if(o&&o.collides(s.declutterBox))break t;n.push([t,e,l,s,1,null,null])}o&&o.load(n.map(ek));for(let t=0,e=n.length;t<e;++t)this.replayImageOrLabel_.apply(this,n[t])}}++u;break;case IE.END_GEOMETRY:if(void 0!==s){D=i[1];const t=s(D,j);if(t)return t}++u;break;case IE.FILL:L?k++:this.fill_(t),++u;break;case IE.MOVE_TO_LINE_TO:for(E=i[1],f=i[2],N=l[E],F=l[E+1],y=N+.5|0,b=F+.5|0,y===m&&b===v||(t.moveTo(N,F),m=y,v=b),E+=2;E<f;E+=2)N=l[E],F=l[E+1],y=N+.5|0,b=F+.5|0,E!=f-2&&y===m&&b===v||(t.lineTo(N,F),m=y,v=b);++u;break;case IE.SET_FILL_STYLE:M=i,this.alignFill_=i[2],k&&(this.fill_(t),k=0,C&&(t.stroke(),C=0)),t.fillStyle=i[1],++u;break;case IE.SET_STROKE_STYLE:A=i,C&&(t.stroke(),C=0),this.setStrokeStyle_(t,i),++u;break;case IE.STROKE:L?C++:t.stroke(),++u;break;default:++u}}k&&this.fill_(t),C&&t.stroke()}execute(t,e,i,n,r,s){this.viewRotation_=n,this.execute_(t,e,i,this.instructions,r,void 0,void 0,s)}executeHitDetection(t,e,i,n,r){return this.viewRotation_=i,this.execute_(t,1,e,this.hitDetectionInstructions,!0,n,r)}},ak=["Polygon","Circle","LineString","Image","Text","Default"];const ok={};const lk=class{constructor(t,e,i,n,r,s){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=s,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(r)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t){for(const e in t){let i=this.executorsByZIndex_[e];void 0===i&&(i={},this.executorsByZIndex_[e]=i);const n=t[e];for(const t in n){const e=n[t];i[t]=new sk(this.resolution_,this.pixelRatio_,this.overlaps_,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let e=0,n=t.length;e<n;++e)if(t[e]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,n,r,s){const a=2*(n=Math.round(n))+1,o=Mg(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),l=!this.hitDetectionContext_;l&&(this.hitDetectionContext_=vb(a,a,void 0,{willReadFrequently:!0}));const h=this.hitDetectionContext_;let c;h.canvas.width!==a||h.canvas.height!==a?(h.canvas.width=a,h.canvas.height=a):l||h.clearRect(0,0,a,a),void 0!==this.renderBuffer_&&(c=[1/0,1/0,-1/0,-1/0],Xg(c,t),Lg(c,e*(this.renderBuffer_+n),c));const u=function(t){if(void 0!==ok[t])return ok[t];const e=2*t+1,i=t*t,n=new Array(i+1);for(let r=0;r<=t;++r)for(let s=0;s<=t;++s){const a=r*r+s*s;if(a>i)break;let o=n[a];o||(o=[],n[a]=o),o.push(4*((t+r)*e+(t+s))+3),r>0&&o.push(4*((t-r)*e+(t+s))+3),s>0&&(o.push(4*((t+r)*e+(t-s))+3),r>0&&o.push(4*((t-r)*e+(t-s))+3))}const r=[];for(let t=0,e=n.length;t<e;++t)n[t]&&r.push(...n[t]);return ok[t]=r,r}(n);let d;function f(t,e){const i=h.getImageData(0,0,a,a).data;for(let o=0,l=u.length;o<l;o++)if(i[u[o]]>0){if(!s||"Image"!==d&&"Text"!==d||s.includes(t)){const i=(u[o]-3)/4,s=n-i%a,l=n-(i/a|0),h=r(t,e,s*s+l*l);if(h)return h}h.clearRect(0,0,a,a);break}}const p=Object.keys(this.executorsByZIndex_).map(Number);let g,m,v,y,b;for(p.sort(Pp),g=p.length-1;g>=0;--g){const t=p[g].toString();for(v=this.executorsByZIndex_[t],m=ak.length-1;m>=0;--m)if(d=ak[m],y=v[d],void 0!==y&&(b=y.executeHitDetection(h,o,i,f,c),b))return b}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],n=e[1],r=e[2],s=e[3],a=[i,n,i,s,r,s,r,n];return py(a,0,8,2,t,a),a}isEmpty(){return zp(this.executorsByZIndex_)}execute(t,e,i,n,r,s,a){const o=Object.keys(this.executorsByZIndex_).map(Number);let l,h,c,u,d,f;for(o.sort(Pp),this.maxExtent_&&(t.save(),this.clip(t,i)),s=s||ak,a&&o.reverse(),l=0,h=o.length;l<h;++l){const h=o[l].toString();for(d=this.executorsByZIndex_[h],c=0,u=s.length;c<u;++c){f=d[s[c]],void 0!==f&&f.execute(t,e,i,n,r,a)}}this.maxExtent_&&t.restore()}};const hk=class extends LE{constructor(t,e,i,n,r,s,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=n,this.transformRotation_=n?ym(Math.atan2(n[1],n[0]),10):0,this.viewRotation_=r,this.squaredTolerance_=s,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=[1,0,0,1,0,0]}drawImages_(t,e,i,n){if(!this.image_)return;const r=py(t,e,i,n,this.transform_,this.pixelCoordinates_),s=this.context_,a=this.tmpLocalTransform_,o=s.globalAlpha;1!=this.imageOpacity_&&(s.globalAlpha=o*this.imageOpacity_);let l=this.imageRotation_;0===this.transformRotation_&&(l-=this.viewRotation_),this.imageRotateWithView_&&(l+=this.viewRotation_);for(let t=0,e=r.length;t<e;t+=2){const e=r[t]-this.imageAnchorX_,i=r[t+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_[0]||1!=this.imageScale_[1]){const t=e+this.imageAnchorX_,n=i+this.imageAnchorY_;Mg(a,t,n,1,1,l,-t,-n),s.setTransform.apply(s,a),s.translate(t,n),s.scale(this.imageScale_[0],this.imageScale_[1]),s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),s.setTransform(1,0,0,1,0,0)}else s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,e,i,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(s.globalAlpha=o)}drawText_(t,e,i,n){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=py(t,e,i,n,this.transform_,this.pixelCoordinates_),s=this.context_;let a=this.textRotation_;for(0===this.transformRotation_&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=n){const t=r[e]+this.textOffsetX_,i=r[e+1]+this.textOffsetY_;0!==a||1!=this.textScale_[0]||1!=this.textScale_[1]?(s.translate(t-this.textOffsetX_,i-this.textOffsetY_),s.rotate(a),s.translate(this.textOffsetX_,this.textOffsetY_),s.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&s.strokeText(this.text_,0,0),this.textFillState_&&s.fillText(this.text_,0,0),s.setTransform(1,0,0,1,0,0)):(this.textStrokeState_&&s.strokeText(this.text_,t,i),this.textFillState_&&s.fillText(this.text_,t,i))}}moveToLineTo_(t,e,i,n,r){const s=this.context_,a=py(t,e,i,n,this.transform_,this.pixelCoordinates_);s.moveTo(a[0],a[1]);let o=a.length;r&&(o-=2);for(let t=2;t<o;t+=2)s.lineTo(a[t],a[t+1]);return r&&s.closePath(),i}drawRings_(t,e,i,n){for(let r=0,s=i.length;r<s;++r)e=this.moveToLineTo_(t,e,i[r],n,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),om(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=function(t,e,i){const n=t.getFlatCoordinates();if(!n)return null;const r=t.getStride();return py(n,0,n.length,r,e,i)}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],r=Math.sqrt(i*i+n*n),s=this.context_;s.beginPath(),s.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&s.fill(),this.strokeState_&&s.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let t=0,i=e.length;t<i;++t)this.drawGeometry(e[t])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),om(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(om(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();let n=0;const r=t.getEnds(),s=t.getStride();e.beginPath();for(let t=0,e=r.length;t<e;++t)n=this.moveToLineTo_(i,n,r[t],s,!1);e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoints();this.drawText_(e,0,e.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),om(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),om(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let n=0;const r=t.getEndss(),s=t.getStride();e.beginPath();for(let t=0,e=r.length;t<e;++t){const e=r[t];n=this.drawRings_(i,n,e,s)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),Dp(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:Cb;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(t){const e=t.getColor();this.fillState_={fillStyle:iE(e||wb)}}else this.fillState_=null;if(e){const t=e.getColor(),i=e.getLineCap(),n=e.getLineDash(),r=e.getLineDashOffset(),s=e.getLineJoin(),a=e.getWidth(),o=e.getMiterLimit(),l=n||Tb;this.strokeState_={lineCap:void 0!==i?i:Sb,lineDash:1===this.pixelRatio_?l:l.map((t=>t*this.pixelRatio_)),lineDashOffset:(r||0)*this.pixelRatio_,lineJoin:void 0!==s?s:Eb,lineWidth:(void 0!==a?a:1)*this.pixelRatio_,miterLimit:void 0!==o?o:10,strokeStyle:iE(t||kb)}}else this.strokeState_=null}setImageStyle(t){let e;if(!t||!(e=t.getSize()))return void(this.image_=null);const i=t.getPixelRatio(this.pixelRatio_),n=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*i,this.imageAnchorY_=n[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const s=t.getScaleArray();this.imageScale_=[s[0]*this.pixelRatio_/i,s[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(t){const e=t.getFill();if(e){const t=e.getColor();this.textFillState_={fillStyle:iE(t||wb)}}else this.textFillState_=null;const i=t.getStroke();if(i){const t=i.getColor(),e=i.getLineCap(),n=i.getLineDash(),r=i.getLineDashOffset(),s=i.getLineJoin(),a=i.getWidth(),o=i.getMiterLimit();this.textStrokeState_={lineCap:void 0!==e?e:Sb,lineDash:n||Tb,lineDashOffset:r||0,lineJoin:void 0!==s?s:Eb,lineWidth:void 0!==a?a:1,miterLimit:void 0!==o?o:10,strokeStyle:iE(t||kb)}}else this.textStrokeState_=null;const n=t.getFont(),r=t.getOffsetX(),s=t.getOffsetY(),a=t.getRotateWithView(),o=t.getRotation(),l=t.getScaleArray(),h=t.getText(),c=t.getTextAlign(),u=t.getTextBaseline();this.textState_={font:void 0!==n?n:xb,textAlign:void 0!==c?c:Cb,textBaseline:void 0!==u?u:Mb},this.text_=void 0!==h?Array.isArray(h)?h.reduce(((t,e,i)=>t+(i%2?" ":e)),""):h:"",this.textOffsetX_=void 0!==r?this.pixelRatio_*r:0,this.textOffsetY_=void 0!==s?this.pixelRatio_*s:0,this.textRotateWithView_=void 0!==a&&a,this.textRotation_=void 0!==o?o:0,this.textScale_=[this.pixelRatio_*l[0],this.pixelRatio_*l[1]]}else this.text_=""}},ck=.5;const uk=.5,dk={Point:function(t,e,i,n,r){const s=i.getImage(),a=i.getText();let o;if(s){if(s.getImageState()!=$T)return;let l=t;if(r){const h=s.getDeclutterMode();if("none"!==h)if(l=r,"obstacle"===h){const r=t.getBuilder(i.getZIndex(),"Image");r.setImageStyle(s,o),r.drawPoint(e,n)}else a&&a.getText()&&(o={})}const h=l.getBuilder(i.getZIndex(),"Image");h.setImageStyle(s,o),h.drawPoint(e,n)}if(a&&a.getText()){let s=t;r&&(s=r);const l=s.getBuilder(i.getZIndex(),"Text");l.setTextStyle(a,o),l.drawText(e,n)}},LineString:function(t,e,i,n,r){const s=i.getStroke();if(s){const r=t.getBuilder(i.getZIndex(),"LineString");r.setFillStrokeStyle(null,s),r.drawLineString(e,n)}const a=i.getText();if(a&&a.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(a),s.drawText(e,n)}},Polygon:function(t,e,i,n,r){const s=i.getFill(),a=i.getStroke();if(s||a){const r=t.getBuilder(i.getZIndex(),"Polygon");r.setFillStrokeStyle(s,a),r.drawPolygon(e,n)}const o=i.getText();if(o&&o.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(o),s.drawText(e,n)}},MultiPoint:function(t,e,i,n,r){const s=i.getImage(),a=i.getText();let o;if(s){if(s.getImageState()!=$T)return;let l=t;if(r){const h=s.getDeclutterMode();if("none"!==h)if(l=r,"obstacle"===h){const r=t.getBuilder(i.getZIndex(),"Image");r.setImageStyle(s,o),r.drawMultiPoint(e,n)}else a&&a.getText()&&(o={})}const h=l.getBuilder(i.getZIndex(),"Image");h.setImageStyle(s,o),h.drawMultiPoint(e,n)}if(a&&a.getText()){let s=t;r&&(s=r);const l=s.getBuilder(i.getZIndex(),"Text");l.setTextStyle(a,o),l.drawText(e,n)}},MultiLineString:function(t,e,i,n,r){const s=i.getStroke();if(s){const r=t.getBuilder(i.getZIndex(),"LineString");r.setFillStrokeStyle(null,s),r.drawMultiLineString(e,n)}const a=i.getText();if(a&&a.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(a),s.drawText(e,n)}},MultiPolygon:function(t,e,i,n,r){const s=i.getFill(),a=i.getStroke();if(a||s){const r=t.getBuilder(i.getZIndex(),"Polygon");r.setFillStrokeStyle(s,a),r.drawMultiPolygon(e,n)}const o=i.getText();if(o&&o.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(o),s.drawText(e,n)}},GeometryCollection:function(t,e,i,n,r){const s=e.getGeometriesArray();let a,o;for(a=0,o=s.length;a<o;++a){(0,dk[s[a].getType()])(t,s[a],i,n,r)}},Circle:function(t,e,i,n,r){const s=i.getFill(),a=i.getStroke();if(s||a){const r=t.getBuilder(i.getZIndex(),"Circle");r.setFillStrokeStyle(s,a),r.drawCircle(e,n)}const o=i.getText();if(o&&o.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(o),s.drawText(e,n)}}};function fk(t,e){return parseInt(sg(t),10)-parseInt(sg(e),10)}function pk(t,e){const i=gk(t,e);return i*i}function gk(t,e){return uk*t/e}function mk(t,e,i,n,r,s,a){let o=!1;const l=i.getImage();if(l){const t=l.getImageState();t==$T||t==QT?l.unlistenImageChange(r):(t==ZT&&l.load(),l.listenImageChange(r),o=!0)}return function(t,e,i,n,r,s){const a=i.getGeometryFunction()(e);if(!a)return;const o=a.simplifyTransformed(n,r),l=i.getRenderer();if(l)vk(t,o,i,e);else{(0,dk[o.getType()])(t,o,i,e,s)}}(t,e,i,n,s,a),o}function vk(t,e,i,n){if("GeometryCollection"==e.getType()){const r=e.getGeometries();for(let e=0,s=r.length;e<s;++e)vk(t,r[e],i,n);return}t.getBuilder(i.getZIndex(),"Default").drawCustom(e,n,i.getRenderer(),i.getHitDetectionRenderer())}const yk=class extends KE{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.declutterExecutorGroup=null,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(t,e,i){const n=e.extent,r=e.viewState,s=r.center,a=r.resolution,o=r.projection,l=r.rotation,h=o.getExtent(),c=this.getLayer().getSource(),u=e.pixelRatio,d=e.viewHints,f=!(d[Km]||d[qm]),p=this.compositionContext_,g=Math.round(e.size[0]*u),m=Math.round(e.size[1]*u),v=c.getWrapX()&&o.canWrapX(),y=v?am(h):null,b=v?Math.ceil((n[2]-h[2])/y)+1:1;let _=v?Math.floor((n[0]-h[0])/y):0;do{const e=this.getRenderTransform(s,a,l,u,g,m,_*y);t.execute(p,1,e,l,f,void 0,i)}while(++_<b)}setupCompositionContext_(){if(1!==this.opacity_){const t=vb(this.context.canvas.width,this.context.canvas.height,VE);this.compositionContext_=t}else this.compositionContext_=this.context}releaseCompositionContext_(){if(1!==this.opacity_){const t=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=t,yb(this.compositionContext_),VE.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(t){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree),this.releaseCompositionContext_())}renderFrame(t,e){const i=t.pixelRatio,n=t.layerStatesArray[t.layerIndex];!function(t,e,i){kg(t,e,0,0,i,0,0)}(this.pixelTransform,1/i,1/i),Ag(this.inversePixelTransform,this.pixelTransform);const r=Pg(this.pixelTransform);this.useContainer(e,r,this.getBackground(t));const s=this.context,a=s.canvas,o=this.replayGroup_,l=this.declutterExecutorGroup;let h=o&&!o.isEmpty()||l&&!l.isEmpty();if(!h){if(!(this.getLayer().hasListener(Um)||this.getLayer().hasListener(Hm)))return null}const c=Math.round(t.size[0]*i),u=Math.round(t.size[1]*i);a.width!=c||a.height!=u?(a.width=c,a.height=u,a.style.transform!==r&&(a.style.transform=r)):this.containerReused||s.clearRect(0,0,c,u),this.preRender(s,t);const d=t.viewState,f=d.projection;this.opacity_=n.opacity,this.setupCompositionContext_();let p=!1;if(h&&n.extent&&this.clipping){const e=Jv(n.extent,f);h=om(e,t.extent),p=h&&!jg(e,t.extent),p&&this.clipUnrotated(this.compositionContext_,t,e)}return h&&this.renderWorlds(o,t),p&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(s,t),this.renderedRotation_!==d.rotation&&(this.renderedRotation_=d.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(t){return new Promise((e=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const t=[this.context.canvas.width,this.context.canvas.height];Cg(this.pixelTransform,t);const e=this.renderedCenter_,i=this.renderedResolution_,n=this.renderedRotation_,r=this.renderedProjection_,s=this.wrappedRenderedExtent_,a=this.getLayer(),o=[],l=t[0]*ck,h=t[1]*ck;o.push(this.getRenderTransform(e,i,n,ck,l,h,0).slice());const c=a.getSource(),u=r.getExtent();if(c.getWrapX()&&r.canWrapX()&&!jg(u,s)){let t=s[0];const r=am(u);let a,c=0;for(;t<u[0];)--c,a=r*c,o.push(this.getRenderTransform(e,i,n,ck,l,h,a).slice()),t+=r;for(c=0,t=s[2];t>u[2];)++c,a=r*c,o.push(this.getRenderTransform(e,i,n,ck,l,h,a).slice()),t-=r}this.hitDetectionImageData_=function(t,e,i,n,r,s,a){const o=vb(t[0]*ck,t[1]*ck);o.imageSmoothingEnabled=!1;const l=o.canvas,h=new hk(o,ck,r,null,a),c=i.length,u=Math.floor(16777215/c),d={};for(let t=1;t<=c;++t){const e=i[t-1],a=e.getStyleFunction()||n;if(!a)continue;let o=a(e,s);if(!o)continue;Array.isArray(o)||(o=[o]);const l=(t*u).toString(16).padStart(7,"#00000");for(let t=0,i=o.length;t<i;++t){const i=o[t],n=i.getGeometryFunction()(e);if(!n||!om(r,n.getExtent()))continue;const s=i.clone(),a=s.getFill();a&&a.setColor(l);const h=s.getStroke();h&&(h.setColor(l),h.setLineDash(null)),s.setText(void 0);const c=i.getImage();if(c){const t=c.getImageSize();if(!t)continue;const e=vb(t[0],t[1],void 0,{alpha:!1}),i=e.canvas;e.fillStyle=l,e.fillRect(0,0,i.width,i.height),s.setImage(new _E({img:i,imgSize:t,anchor:c.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:c.getOrigin(),opacity:1,size:c.getSize(),scale:c.getScale(),rotation:c.getRotation(),rotateWithView:c.getRotateWithView()}))}const u=s.getZIndex()||0;let f=d[u];f||(f={},d[u]=f,f.Polygon=[],f.Circle=[],f.LineString=[],f.Point=[]);const p=n.getType();if("GeometryCollection"===p){const t=n.getGeometriesArrayRecursive();for(let e=0,i=t.length;e<i;++e){const i=t[e];f[i.getType().replace("Multi","")].push(i,s)}}else f[p.replace("Multi","")].push(n,s)}}const f=Object.keys(d).map(Number).sort(Pp);for(let t=0,i=f.length;t<i;++t){const i=d[f[t]];for(const t in i){const n=i[t];for(let t=0,i=n.length;t<i;t+=2){h.setStyle(n[t+1]);for(let i=0,r=e.length;i<r;++i)h.setTransform(e[i]),h.drawGeometry(n[t])}}}return o.getImageData(0,0,l.width,l.height)}(t,o,this.renderedFeatures_,a.getStyleFunction(),s,i,n)}e(function(t,e,i){const n=[];if(i){const r=Math.floor(Math.round(t[0])*ck),s=Math.floor(Math.round(t[1])*ck),a=4*(um(r,0,i.width-1)+um(s,0,i.height-1)*i.width),o=i.data[a],l=i.data[a+1],h=i.data[a+2]+256*(l+256*o),c=Math.floor(16777215/e.length);h&&h%c==0&&n.push(e[h/c-1])}return n}(t,this.renderedFeatures_,this.hitDetectionImageData_))}))}forEachFeatureAtCoordinate(t,e,i,n,r){if(!this.replayGroup_)return;const s=e.viewState.resolution,a=e.viewState.rotation,o=this.getLayer(),l={},h=function(t,e,i){const s=sg(t),a=l[s];if(a){if(!0!==a&&i<a.distanceSq){if(0===i)return l[s]=!0,r.splice(r.lastIndexOf(a),1),n(t,o,e);a.geometry=e,a.distanceSq=i}}else{if(0===i)return l[s]=!0,n(t,o,e);r.push(l[s]={feature:t,layer:o,geometry:e,distanceSq:i,callback:n})}};let c;const u=[this.replayGroup_];return this.declutterExecutorGroup&&u.push(this.declutterExecutorGroup),u.some((n=>c=n.forEachFeatureAtCoordinate(t,s,a,i,h,n===this.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map((t=>t.value)):null))),c}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const n=t.viewHints[Km],r=t.viewHints[qm],s=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!s&&n||!a&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const o=t.extent,l=t.viewState,h=l.projection,c=l.resolution,u=t.pixelRatio,d=e.getRevision(),f=e.getRenderBuffer();let p=e.getRenderOrder();void 0===p&&(p=fk);const g=l.center.slice(),m=Lg(o,f*c),v=m.slice(),y=[m.slice()],b=h.getExtent();if(i.getWrapX()&&h.canWrapX()&&!jg(b,t.extent)){const t=am(b),e=Math.max(am(m)/2,t);m[0]=b[0]-e,m[2]=b[2]+e,wv(g,h);const i=cm(y[0],h);i[0]<b[0]&&i[2]<b[2]?y.push([i[0]+t,i[1],i[2]+t,i[3]]):i[0]>b[0]&&i[2]>b[2]&&y.push([i[0]-t,i[1],i[2]-t,i[3]])}if(this.ready&&this.renderedResolution_==c&&this.renderedRevision_==d&&this.renderedRenderOrder_==p&&jg(this.wrappedRenderedExtent_,m))return Dp(this.renderedExtent_,v)||(this.hitDetectionImageData_=null,this.renderedExtent_=v),this.renderedCenter_=g,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const _=new HE(gk(c,u),m,c,u);let x;this.getLayer().getDeclutter()&&(x=new HE(gk(c,u),m,c,u));const w=Yv();let S;if(w){for(let t=0,e=y.length;t<e;++t){const e=Zv(y[t],h);i.loadFeatures(e,$v(c,h),w)}S=Gv(w,h)}else for(let t=0,e=y.length;t<e;++t)i.loadFeatures(y[t],c,h);const T=pk(c,u);let E=!0;const k=t=>{let i;const n=t.getStyleFunction()||e.getStyleFunction();if(n&&(i=n(t,c)),i){const e=this.renderFeature(t,T,i,_,S,x);E=E&&!e}},C=Zv(m,h),M=i.getFeaturesInExtent(C);p&&M.sort(p);for(let t=0,e=M.length;t<e;++t)k(M[t]);this.renderedFeatures_=M,this.ready=E;const A=_.finish(),O=new lk(m,c,u,i.getOverlaps(),A,e.getRenderBuffer());return x&&(this.declutterExecutorGroup=new lk(m,c,u,i.getOverlaps(),x.finish(),e.getRenderBuffer())),this.renderedResolution_=c,this.renderedRevision_=d,this.renderedRenderOrder_=p,this.renderedExtent_=v,this.wrappedRenderedExtent_=m,this.renderedCenter_=g,this.renderedProjection_=h,this.replayGroup_=O,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,n,r,s){if(!i)return!1;let a=!1;if(Array.isArray(i))for(let o=0,l=i.length;o<l;++o)a=mk(n,t,i[o],e,this.boundHandleStyleImageChange_,r,s)||a;else a=mk(n,t,i,e,this.boundHandleStyleImageChange_,r,s);return a}};const bk=class extends CE{constructor(t){super(t)}createRenderer(){return new yk(this)}};const _k=class{constructor(t){this.rbush_=new pE(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[sg(e)]=i}load(t,e){const i=new Array(e.length);for(let n=0,r=e.length;n<r;n++){const r=t[n],s=e[n],a={minX:r[0],minY:r[1],maxX:r[2],maxY:r[3],value:s};i[n]=a,this.items_[sg(s)]=a}this.rbush_.load(i)}remove(t){const e=sg(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)}update(t,e){const i=this.items_[sg(e)];Hg([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map((function(t){return t.value}))}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let n=0,r=t.length;n<r;n++)if(i=e(t[n]),i)return i;return i}isEmpty(){return zp(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return Gg(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}};function xk(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}const wk=class extends og{constructor(t){super(),this.projection=Dv(t.projection),this.attributions_=xk(t.attributions),this.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,this.loading=!1,this.state_=void 0!==t.state?t.state:"ready",this.wrapX_=void 0!==t.wrapX&&t.wrapX,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise((function(t,i){e.viewResolver=t,e.viewRejector=i}))}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=xk(t),this.changed()}setState(t){this.state_=t,this.changed()}},Sk="addfeature",Tk="changefeature",Ek="clear",kk="removefeature",Ck="featuresloadstart",Mk="featuresloadend",Ak="featuresloaderror";function Ok(t,e){return[[-1/0,-1/0,1/0,1/0]]}let Pk=!1;function Rk(t,e){return function(i,n,r,s,a){const o=this;!function(t,e,i,n,r,s,a){const o=new XMLHttpRequest;o.open("GET","function"==typeof t?t(i,n,r):t,!0),"arraybuffer"==e.getType()&&(o.responseType="arraybuffer"),o.withCredentials=Pk,o.onload=function(t){if(!o.status||o.status>=200&&o.status<300){const t=e.getType();let n;"json"==t||"text"==t?n=o.responseText:"xml"==t?(n=o.responseXML,n||(n=(new DOMParser).parseFromString(o.responseText,"application/xml"))):"arraybuffer"==t&&(n=o.response),n?s(e.readFeatures(n,{extent:i,featureProjection:r}),e.readProjection(n)):a()}else a()},o.onerror=a,o.send()}(t,e,i,n,r,(function(t,e){o.addFeatures(t),void 0!==s&&s(t)}),a||jp)}}class Ik extends Mp{constructor(t,e,i){super(t),this.feature=e,this.features=i}}const Lk=class extends wk{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===t.wrapX||t.wrapX}),this.on,this.once,this.un,this.loader_=jp,this.format_=t.format,this.overlaps_=void 0===t.overlaps||t.overlaps,this.url_=t.url,void 0!==t.loader?this.loader_=t.loader:void 0!==this.url_&&(Tg(this.format_,7),this.loader_=Rk(this.url_,this.format_)),this.strategy_=void 0!==t.strategy?t.strategy:Ok;const e=void 0===t.useSpatialIndex||t.useSpatialIndex;let i,n;this.featuresRtree_=e?new _k:null,this.loadedExtentsRtree_=new _k,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(t.features)?n=t.features:t.features&&(i=t.features,n=i.getArray()),e||void 0!==i||(i=new gg(n)),void 0!==n&&this.addFeaturesInternal(n),void 0!==i&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=sg(t);if(!this.addToIndex_(e,t))return void(this.featuresCollection_&&this.featuresCollection_.remove(t));this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const e=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(e,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Ik(Sk,t))}setupChangeEvents_(t,e){this.featureChangeKeys_[t]=[$p(e,Gp,this.handleFeatureChange_,this),$p(e,Ap,this.handleFeatureChange_,this)]}addToIndex_(t,e){let i=!0;const n=e.getId();return void 0!==n&&(n.toString()in this.idIndex_?i=!1:this.idIndex_[n.toString()]=e),i&&(Tg(!(t in this.uidIndex_),30),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],n=[];for(let e=0,n=t.length;e<n;e++){const n=t[e],r=sg(n);this.addToIndex_(r,n)&&i.push(n)}for(let t=0,r=i.length;t<r;t++){const r=i[t],s=sg(r);this.setupChangeEvents_(s,r);const a=r.getGeometry();if(a){const t=a.getExtent();e.push(t),n.push(r)}else this.nullGeometryFeatures_[s]=r}if(this.featuresRtree_&&this.featuresRtree_.load(e,n),this.hasListener(Sk))for(let t=0,e=i.length;t<e;t++)this.dispatchEvent(new Ik(Sk,i[t]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(Sk,(function(i){e||(e=!0,t.push(i.feature),e=!1)})),this.addEventListener(kk,(function(i){e||(e=!0,t.remove(i.feature),e=!1)})),t.addEventListener(ug,(t=>{e||(e=!0,this.addFeature(t.element),e=!1)})),t.addEventListener(dg,(t=>{e||(e=!0,this.removeFeature(t.element),e=!1)})),this.featuresCollection_=t}clear(t){if(t){for(const t in this.featureChangeKeys_){this.featureChangeKeys_[t].forEach(tg)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const t=t=>{this.removeFeatureInternal(t)};this.featuresRtree_.forEach(t);for(const t in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[t])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new Ik(Ek);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){if(i.getGeometry().intersectsCoordinate(t))return e(i)}))}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,(function(i){if(i.getGeometry().intersectsExtent(t)){const t=e(i);if(t)return t}}))}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),zp(this.nullGeometryFeatures_)||Lp(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const i=function(t,e){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[i[0],t[1],i[2],t[3]]];cm(t,e);const n=am(i);if(am(t)>n)return[[i[0],t[1],i[2],t[3]]];if(t[0]<i[0])return[[t[0]+n,t[1],i[2],t[3]],[i[0],t[1],t[2],t[3]]];if(t[2]>i[2])return[[t[0],t[1],i[2],t[3]],[i[0],t[1],t[2]-n,t[3]]]}return[t]}(t,e);return[].concat(...i.map((t=>this.featuresRtree_.getInExtent(t))))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],n=t[1];let r=null;const s=[NaN,NaN];let a=1/0;const o=[-1/0,-1/0,1/0,1/0];return e=e||Np,this.featuresRtree_.forEachInExtent(o,(function(t){if(e(t)){const e=t.getGeometry(),l=a;if(a=e.closestPointXY(i,n,s,a),a<l){r=t;const e=Math.sqrt(a);o[0]=i-e,o[1]=n-e,o[2]=i+e,o[3]=n+e}}})),r}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return void 0!==e?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return void 0!==e?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=sg(e),n=e.getGeometry();if(n){const t=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(t,e)):this.featuresRtree_&&this.featuresRtree_.update(t,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);const r=e.getId();if(void 0!==r){const t=r.toString();this.idIndex_[t]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[t]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new Ik(Tk,e))}hasFeature(t){const e=t.getId();return void 0!==e?e in this.idIndex_:sg(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&zp(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}loadFeatures(t,e,i){const n=this.loadedExtentsRtree_,r=this.strategy_(t,e,i);for(let t=0,s=r.length;t<s;++t){const s=r[t];n.forEachInExtent(s,(function(t){return jg(t.extent,s)}))||(++this.loadingExtentsCount_,this.dispatchEvent(new Ik(Ck)),this.loader_.call(this,s,e,i,(t=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ik(Mk,void 0,t))}),(()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ik(Ak))})),n.insert(s,{extent:s.slice()}))}this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let i;e.forEachInExtent(t,(function(e){if(Hg(e.extent,t))return i=e,!0})),i&&e.remove(i)}removeFeature(t){if(!t)return;const e=sg(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t);this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=sg(t),i=this.featureChangeKeys_[e];if(!i)return;i.forEach(tg),delete this.featureChangeKeys_[e];const n=t.getId();return void 0!==n&&delete this.idIndex_[n.toString()],delete this.uidIndex_[e],this.dispatchEvent(new Ik(kk,t)),t}removeFromIdIndex_(t){let e=!1;for(const i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e}setLoader(t){this.loader_=t}setUrl(t){Tg(this.format_,7),this.url_=t,this.setLoader(Rk(t,this.format_))}};function Dk(t,e,i){const n=[];let r=t(0),s=t(1),a=e(r),o=e(s);const l=[s,r],h=[o,a],c=[1,0],u={};let d,f,p,g,m,v,y=1e5;for(;--y>0&&c.length>0;)p=c.pop(),r=l.pop(),a=h.pop(),v=p.toString(),v in u||(n.push(a[0],a[1]),u[v]=!0),g=c.pop(),s=l.pop(),o=h.pop(),m=(p+g)/2,d=t(m),f=e(d),dm(f[0],f[1],a[0],a[1],o[0],o[1])<i?(n.push(o[0],o[1]),v=g.toString(),u[v]=!0):(c.push(g,m,m,p),h.push(o,f,f,a),l.push(s,d,d,r));return n}const Nk=new qT({color:"rgba(0,0,0,0.2)"}),Fk=[90,45,30,20,10,5,2,1,.5,20/60,10/60,5/60,2/60,1/60,30/3600,20/3600,10/3600,5/3600,2/3600,1/3600];const jk=class extends bk{constructor(t){t=t||{};const e=Object.assign({updateWhileAnimating:!0,updateWhileInteracting:!0,renderBuffer:0},t);delete e.maxLines,delete e.strokeStyle,delete e.targetSize,delete e.showLabels,delete e.lonLabelFormatter,delete e.latLabelFormatter,delete e.lonLabelPosition,delete e.latLabelPosition,delete e.lonLabelStyle,delete e.latLabelStyle,delete e.intervals,super(e),this.projection_=null,this.maxLat_=1/0,this.maxLon_=1/0,this.minLat_=-1/0,this.minLon_=-1/0,this.maxX_=1/0,this.maxY_=1/0,this.minX_=-1/0,this.minY_=-1/0,this.targetSize_=void 0!==t.targetSize?t.targetSize:100,this.maxLines_=void 0!==t.maxLines?t.maxLines:100,this.meridians_=[],this.parallels_=[],this.strokeStyle_=void 0!==t.strokeStyle?t.strokeStyle:Nk,this.fromLonLatTransform_=void 0,this.toLonLatTransform_=void 0,this.projectionCenterLonLat_=null,this.bottomLeft_=null,this.bottomRight_=null,this.topLeft_=null,this.topRight_=null,this.meridiansLabels_=null,this.parallelsLabels_=null,t.showLabels&&(this.lonLabelFormatter_=null==t.lonLabelFormatter?bv.bind(this,"EW"):t.lonLabelFormatter,this.latLabelFormatter_=null==t.latLabelFormatter?bv.bind(this,"NS"):t.latLabelFormatter,this.lonLabelPosition_=null==t.lonLabelPosition?0:t.lonLabelPosition,this.latLabelPosition_=null==t.latLabelPosition?1:t.latLabelPosition,this.lonLabelStyleBase_=new uE({text:void 0!==t.lonLabelStyle?t.lonLabelStyle.clone():new fE({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new GT({color:"rgba(0,0,0,1)"}),stroke:new qT({color:"rgba(255,255,255,1)",width:3})})}),this.lonLabelStyle_=t=>{const e=t.get("graticule_label");return this.lonLabelStyleBase_.getText().setText(e),this.lonLabelStyleBase_},this.latLabelStyleBase_=new uE({text:void 0!==t.latLabelStyle?t.latLabelStyle.clone():new fE({font:"12px Calibri,sans-serif",textAlign:"right",fill:new GT({color:"rgba(0,0,0,1)"}),stroke:new qT({color:"rgba(255,255,255,1)",width:3})})}),this.latLabelStyle_=t=>{const e=t.get("graticule_label");return this.latLabelStyleBase_.getText().setText(e),this.latLabelStyleBase_},this.meridiansLabels_=[],this.parallelsLabels_=[],this.addEventListener(Hm,this.drawLabels_.bind(this))),this.intervals_=void 0!==t.intervals?t.intervals:Fk,this.setSource(new Lk({loader:this.loaderFunction.bind(this),strategy:this.strategyFunction.bind(this),features:new gg,overlaps:!1,useSpatialIndex:!1,wrapX:t.wrapX})),this.featurePool_=[],this.lineStyle_=new uE({stroke:this.strokeStyle_}),this.loadedExtent_=null,this.renderedExtent_=null,this.renderedResolution_=null,this.setRenderOrder(null)}strategyFunction(t,e){let i=t.slice();var n,r,s;return this.projection_&&this.getSource().getWrapX()&&cm(i,this.projection_),this.loadedExtent_&&(n=this.loadedExtent_,r=i,s=e,Math.abs(n[0]-r[0])<s&&Math.abs(n[2]-r[2])<s&&Math.abs(n[1]-r[1])<s&&Math.abs(n[3]-r[3])<s?i=this.loadedExtent_.slice():this.getSource().removeLoadedExtent(this.loadedExtent_)),[i]}loaderFunction(t,e,i){this.loadedExtent_=t;const n=this.getSource(),r=nm(this.getExtent()||[-1/0,-1/0,1/0,1/0],t);if(this.renderedExtent_&&Hg(this.renderedExtent_,r)&&this.renderedResolution_===e)return;if(this.renderedExtent_=r,this.renderedResolution_=e,lm(r))return;const s=$g(r),a=e*e/4;(!this.projection_||!Wv(this.projection_,i))&&this.updateProjectionInfo_(i),this.createGraticule_(r,s,e,a);let o,l=this.meridians_.length+this.parallels_.length;for(this.meridiansLabels_&&(l+=this.meridians_.length),this.parallelsLabels_&&(l+=this.parallels_.length);l>this.featurePool_.length;)o=new zT,this.featurePool_.push(o);const h=n.getFeaturesCollection();h.clear();let c,u,d=0;for(c=0,u=this.meridians_.length;c<u;++c)o=this.featurePool_[d++],o.setGeometry(this.meridians_[c]),o.setStyle(this.lineStyle_),h.push(o);for(c=0,u=this.parallels_.length;c<u;++c)o=this.featurePool_[d++],o.setGeometry(this.parallels_[c]),o.setStyle(this.lineStyle_),h.push(o)}addMeridian_(t,e,i,n,r,s){const a=this.getMeridian_(t,e,i,n,s);if(om(a.getExtent(),r)){if(this.meridiansLabels_){const e=this.lonLabelFormatter_(t);s in this.meridiansLabels_?this.meridiansLabels_[s].text=e:this.meridiansLabels_[s]={geom:new By([]),text:e}}this.meridians_[s++]=a}return s}addParallel_(t,e,i,n,r,s){const a=this.getParallel_(t,e,i,n,s);if(om(a.getExtent(),r)){if(this.parallelsLabels_){const e=this.latLabelFormatter_(t);s in this.parallelsLabels_?this.parallelsLabels_[s].text=e:this.parallelsLabels_[s]={geom:new By([]),text:e}}this.parallels_[s++]=a}return s}drawLabels_(t){const e=t.frameState.viewState.rotation,i=t.frameState.viewState.resolution,n=t.frameState.size,r=t.frameState.extent,s=$g(r);let a=r;if(e){const t=n[0]*i,e=n[1]*i;a=[s[0]-t/2,s[1]-e/2,s[0]+t/2,s[1]+e/2]}let o=0,l=0,h=this.latLabelPosition_<.5;const c=this.projection_.getExtent(),u=am(c);if(this.getSource().getWrapX()&&this.projection_.canWrapX()&&!jg(c,r)){o=Math.floor((r[0]-c[0])/u),l=Math.ceil((r[2]-c[2])/u);h=h!==Math.abs(e)>Math.PI/2}const d=function(t){if(!(t.context instanceof CanvasRenderingContext2D))throw new Error("Only works for render events from Canvas 2D layers");const e=t.inversePixelTransform[0],i=t.inversePixelTransform[1],n=Math.sqrt(e*e+i*i),r=t.frameState,s=Eg(t.inversePixelTransform.slice(),r.coordinateToPixelTransform),a=pk(r.viewState.resolution,n);let o;const l=Yv();return l&&(o=Gv(l,r.viewState.projection)),new hk(t.context,n,r.extent,s,r.viewState.rotation,a,o)}(t);for(let t=o;t<=l;++t){let i,n,c,f,p=this.meridians_.length+this.parallels_.length;if(this.meridiansLabels_)for(n=0,c=this.meridiansLabels_.length;n<c;++n){const o=this.meridians_[n];if(e||0!==t){const i=o.clone();i.translate(t*u,0),i.rotate(-e,s),f=this.getMeridianPoint_(i,a,n),f.rotate(e,s)}else f=this.getMeridianPoint_(o,r,n);i=this.featurePool_[p++],i.setGeometry(f),i.set("graticule_label",this.meridiansLabels_[n].text),d.drawFeature(i,this.lonLabelStyle_(i))}if(this.parallelsLabels_&&(t===o&&h||t===l&&!h))for(n=0,c=this.parallels_.length;n<c;++n){const o=this.parallels_[n];if(e||0!==t){const i=o.clone();i.translate(t*u,0),i.rotate(-e,s),f=this.getParallelPoint_(i,a,n),f.rotate(e,s)}else f=this.getParallelPoint_(o,r,n);i=this.featurePool_[p++],i.setGeometry(f),i.set("graticule_label",this.parallelsLabels_[n].text),d.drawFeature(i,this.latLabelStyle_(i))}}}createGraticule_(t,e,i,n){const r=this.getInterval_(i);if(-1==r)return this.meridians_.length=0,this.parallels_.length=0,this.meridiansLabels_&&(this.meridiansLabels_.length=0),void(this.parallelsLabels_&&(this.parallelsLabels_.length=0));let s=!1;const a=this.projection_.getExtent(),o=am(a);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!jg(a,t)&&(am(t)>=o?(t[0]=a[0],t[2]=a[2]):s=!0);const l=[um(e[0],this.minX_,this.maxX_),um(e[1],this.minY_,this.maxY_)],h=this.toLonLatTransform_(l);isNaN(h[1])&&(h[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_);let c=um(h[0],this.minLon_,this.maxLon_),u=um(h[1],this.minLat_,this.maxLat_);const d=this.maxLines_;let f,p,g,m,v=t;s||(v=[um(t[0],this.minX_,this.maxX_),um(t[1],this.minY_,this.maxY_),um(t[2],this.minX_,this.maxX_),um(t[3],this.minY_,this.maxY_)]);const y=hm(v,this.toLonLatTransform_,void 0,8);let b=y[3],_=y[2],x=y[1],w=y[0];if(s||(Fg(v,this.bottomLeft_)&&(w=this.minLon_,x=this.minLat_),Fg(v,this.bottomRight_)&&(_=this.maxLon_,x=this.minLat_),Fg(v,this.topLeft_)&&(w=this.minLon_,b=this.maxLat_),Fg(v,this.topRight_)&&(_=this.maxLon_,b=this.maxLat_),b=um(b,u,this.maxLat_),_=um(_,c,this.maxLon_),x=um(x,this.minLat_,u),w=um(w,this.minLon_,c)),c=Math.floor(c/r)*r,m=um(c,this.minLon_,this.maxLon_),p=this.addMeridian_(m,x,b,n,t,0),f=0,s)for(;(m-=r)>=w&&f++<d;)p=this.addMeridian_(m,x,b,n,t,p);else for(;m!=this.minLon_&&f++<d;)m=Math.max(m-r,this.minLon_),p=this.addMeridian_(m,x,b,n,t,p);if(m=um(c,this.minLon_,this.maxLon_),f=0,s)for(;(m+=r)<=_&&f++<d;)p=this.addMeridian_(m,x,b,n,t,p);else for(;m!=this.maxLon_&&f++<d;)m=Math.min(m+r,this.maxLon_),p=this.addMeridian_(m,x,b,n,t,p);for(this.meridians_.length=p,this.meridiansLabels_&&(this.meridiansLabels_.length=p),u=Math.floor(u/r)*r,g=um(u,this.minLat_,this.maxLat_),p=this.addParallel_(g,w,_,n,t,0),f=0;g!=this.minLat_&&f++<d;)g=Math.max(g-r,this.minLat_),p=this.addParallel_(g,w,_,n,t,p);for(g=um(u,this.minLat_,this.maxLat_),f=0;g!=this.maxLat_&&f++<d;)g=Math.min(g+r,this.maxLat_),p=this.addParallel_(g,w,_,n,t,p);this.parallels_.length=p,this.parallelsLabels_&&(this.parallelsLabels_.length=p)}getInterval_(t){const e=this.projectionCenterLonLat_[0],i=this.projectionCenterLonLat_[1];let n=-1;const r=Math.pow(this.targetSize_*t,2),s=[],a=[];for(let t=0,o=this.intervals_.length;t<o;++t){const o=um(this.intervals_[t]/2,0,90),l=um(i,-90+o,90-o);s[0]=e-o,s[1]=l-o,a[0]=e+o,a[1]=l+o,this.fromLonLatTransform_(s,s),this.fromLonLatTransform_(a,a);if(Math.pow(a[0]-s[0],2)+Math.pow(a[1]-s[1],2)<=r)break;n=this.intervals_[t]}return n}getMeridian_(t,e,i,n,r){const s=function(t,e,i,n,r){return Dk((function(n){return[t,e+(i-e)*n]}),Uv(Dv("EPSG:4326"),n),r)}(t,e,i,this.projection_,n);let a=this.meridians_[r];return a?(a.setFlatCoordinates("XY",s),a.changed()):(a=new YT(s,"XY"),this.meridians_[r]=a),a}getMeridianPoint_(t,e,i){const n=t.getFlatCoordinates();let r=1,s=n.length-1;n[r]>n[s]&&(r=s,s=1);const a=Math.max(e[1],n[r]),o=Math.min(e[3],n[s]),l=um(e[1]+Math.abs(e[1]-e[3])*this.lonLabelPosition_,a,o),h=[n[r-1]+(n[s-1]-n[r-1])*(l-n[r])/(n[s]-n[r]),l],c=this.meridiansLabels_[i].geom;return c.setCoordinates(h),c}getMeridians(){return this.meridians_}getParallel_(t,e,i,n,r){const s=function(t,e,i,n,r){return Dk((function(n){return[e+(i-e)*n,t]}),Uv(Dv("EPSG:4326"),n),r)}(t,e,i,this.projection_,n);let a=this.parallels_[r];return a?(a.setFlatCoordinates("XY",s),a.changed()):a=new YT(s,"XY"),a}getParallelPoint_(t,e,i){const n=t.getFlatCoordinates();let r=0,s=n.length-2;n[r]>n[s]&&(r=s,s=0);const a=Math.max(e[0],n[r]),o=Math.min(e[2],n[s]),l=um(e[0]+Math.abs(e[0]-e[2])*this.latLabelPosition_,a,o),h=[l,n[r+1]+(n[s+1]-n[r+1])*(l-n[r])/(n[s]-n[r])],c=this.parallelsLabels_[i].geom;return c.setCoordinates(h),c}getParallels(){return this.parallels_}updateProjectionInfo_(t){const e=Dv("EPSG:4326"),i=t.getWorldExtent();this.maxLat_=i[3],this.maxLon_=i[2],this.minLat_=i[1],this.minLon_=i[0];const n=Uv(t,e);if(this.minLon_<this.maxLon_)this.toLonLatTransform_=n;else{const t=this.minLon_+this.maxLon_/2;this.maxLon_+=360,this.toLonLatTransform_=function(e,i,r){const s=n(e,i,r=r||2);for(let e=0,i=s.length;e<i;e+=r)s[e]<t&&(s[e]+=360);return s}}this.fromLonLatTransform_=Uv(e,t);const r=hm([this.minLon_,this.minLat_,this.maxLon_,this.maxLat_],this.fromLonLatTransform_,void 0,8);this.minX_=r[0],this.maxX_=r[2],this.minY_=r[1],this.maxY_=r[3],this.bottomLeft_=this.fromLonLatTransform_([this.minLon_,this.minLat_]),this.bottomRight_=this.fromLonLatTransform_([this.maxLon_,this.minLat_]),this.topLeft_=this.fromLonLatTransform_([this.minLon_,this.maxLat_]),this.topRight_=this.fromLonLatTransform_([this.maxLon_,this.maxLat_]),this.projectionCenterLonLat_=this.toLonLatTransform_($g(t.getExtent())),isNaN(this.projectionCenterLonLat_[1])&&(this.projectionCenterLonLat_[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_),this.projection_=t}},Bk="preload",zk="useInterimTilesOnError";const Wk=class extends ab{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}getPreload(){return this.get(Bk)}setPreload(t){this.set(Bk,t)}getUseInterimTilesOnError(){return this.get(zk)}setUseInterimTilesOnError(t){this.set(zk,t)}getData(t){return super.getData(t)}};const Gk=class extends Wp{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=void 0===i.transition?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(Gp)}release(){this.state===u_&&this.setState(d_)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){if(!this.interimTile)return this;let t=this.interimTile;do{if(t.getState()==c_)return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){if(!this.interimTile)return;let t=this.interimTile,e=this;do{if(t.getState()==c_){t.interimTile=null;break}t.getState()==h_?e=t:t.getState()==l_?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==u_&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){ng()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;const n=e-i+1e3/60;return n>=this.transition_?1:cy(n/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}};const Uk=class extends Gk{constructor(t,e,i,n,r,s){super(t,e,s),this.crossOrigin_=n,this.src_=i,this.key=i,this.image_=new Image,null!==n&&(this.image_.crossOrigin=n),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(t){this.image_=t,this.state=c_,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=u_,this.unlistenImage_(),this.image_=function(){const t=vb(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=c_:this.state=d_,this.unlistenImage_(),this.changed()}load(){this.state==u_&&(this.state=l_,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==l_&&(this.state=h_,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=gE(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}};const Hk=class{constructor(t,e,i,n,r,s){this.sourceProj_=t,this.targetProj_=e;let a={};const o=Uv(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const e=t[0]+"/"+t[1];return a[e]||(a[e]=o(t)),a[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&am(n)>=am(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?am(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?am(this.targetProj_.getExtent()):null;const l=rm(i),h=sm(i),c=Jg(i),u=Zg(i),d=this.transformInv_(l),f=this.transformInv_(h),p=this.transformInv_(c),g=this.transformInv_(u),m=10+(s?Math.max(0,Math.ceil(Math.log2(qg(i)/(s*s*256*256)))):0);if(this.addQuad_(l,h,c,u,d,f,p,g,m),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach((function(e,i,n){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])})),this.triangles_.forEach((e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const i=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];i[0][0]-t>this.sourceWorldWidth_/2&&(i[0][0]-=this.sourceWorldWidth_),i[1][0]-t>this.sourceWorldWidth_/2&&(i[1][0]-=this.sourceWorldWidth_),i[2][0]-t>this.sourceWorldWidth_/2&&(i[2][0]-=this.sourceWorldWidth_);const n=Math.min(i[0][0],i[1][0],i[2][0]);Math.max(i[0][0],i[1][0],i[2][0])-n<this.sourceWorldWidth_/2&&(e.source=i)}}))}a={}}addTriangle_(t,e,i,n,r,s){this.triangles_.push({source:[n,r,s],target:[t,e,i]})}addQuad_(t,e,i,n,r,s,a,o,l){const h=Ig([r,s,a,o]),c=this.sourceWorldWidth_?am(h)/this.sourceWorldWidth_:null,u=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&c>.5&&c<1;let f=!1;if(l>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){f=am(Ig([t,e,i,n]))/this.targetWorldWidth_>.25||f}!d&&this.sourceProj_.isGlobal()&&c&&(f=c>.25||f)}if(!f&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!om(h,this.maxSourceExtent_))return;let p=0;if(!(f||isFinite(r[0])&&isFinite(r[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(o[0])&&isFinite(o[1])))if(l>0)f=!0;else if(p=(isFinite(r[0])&&isFinite(r[1])?0:8)+(isFinite(s[0])&&isFinite(s[1])?0:4)+(isFinite(a[0])&&isFinite(a[1])?0:2)+(isFinite(o[0])&&isFinite(o[1])?0:1),1!=p&&2!=p&&4!=p&&8!=p)return;if(l>0){if(!f){const e=[(t[0]+i[0])/2,(t[1]+i[1])/2],n=this.transformInv_(e);let s;if(d){s=(mm(r[0],u)+mm(a[0],u))/2-mm(n[0],u)}else s=(r[0]+a[0])/2-n[0];const o=(r[1]+a[1])/2-n[1];f=s*s+o*o>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const h=[(e[0]+i[0])/2,(e[1]+i[1])/2],c=this.transformInv_(h),u=[(n[0]+t[0])/2,(n[1]+t[1])/2],d=this.transformInv_(u);this.addQuad_(t,e,h,u,r,s,c,d,l-1),this.addQuad_(u,h,i,n,d,c,a,o,l-1)}else{const h=[(t[0]+e[0])/2,(t[1]+e[1])/2],c=this.transformInv_(h),u=[(i[0]+n[0])/2,(i[1]+n[1])/2],d=this.transformInv_(u);this.addQuad_(t,h,u,n,r,c,d,o,l-1),this.addQuad_(h,e,i,u,c,s,a,d,l-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&p)&&this.addTriangle_(t,i,n,r,a,o),0==(14&p)&&this.addTriangle_(t,i,e,r,a,s),p&&(0==(13&p)&&this.addTriangle_(e,n,t,s,o,r),0==(7&p)&&this.addTriangle_(e,n,i,s,o,a))}calculateSourceExtent(){const t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,i,n){const r=e.source;Xg(t,r[0]),Xg(t,r[1]),Xg(t,r[2])})),t}getTriangles(){return this.triangles_}};let Xk;const Vk=[];function Yk(t,e,i,n,r){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(n,r),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,n)+1,Math.max(i,r)),t.restore()}function Kk(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function qk(t,e,i,n){const r=Hv(i,e,t);let s=Nv(e,n,i);const a=e.getMetersPerUnit();void 0!==a&&(s*=a);const o=t.getMetersPerUnit();void 0!==o&&(s/=o);const l=t.getExtent();if(!l||Fg(l,r)){const e=Nv(t,s,r)/s;isFinite(e)&&e>0&&(s/=e)}return s}function Zk(t,e,i,n,r,s,a,o,l,h,c,u){const d=vb(Math.round(i*t),Math.round(i*e),Vk);if(u||(d.imageSmoothingEnabled=!1),0===l.length)return d.canvas;function f(t){return Math.round(t*i)/i}d.scale(i,i),d.globalCompositeOperation="lighter";const p=[1/0,1/0,-1/0,-1/0];l.forEach((function(t,e,i){var n,r;n=p,(r=t.extent)[0]<n[0]&&(n[0]=r[0]),r[2]>n[2]&&(n[2]=r[2]),r[1]<n[1]&&(n[1]=r[1]),r[3]>n[3]&&(n[3]=r[3])}));const g=am(p),m=im(p),v=vb(Math.round(i*g/n),Math.round(i*m/n),Vk);u||(v.imageSmoothingEnabled=!1);const y=i/n;l.forEach((function(t,e,i){const n=t.extent[0]-p[0],r=-(t.extent[3]-p[3]),s=am(t.extent),a=im(t.extent);t.image.width>0&&t.image.height>0&&v.drawImage(t.image,h,h,t.image.width-2*h,t.image.height-2*h,n*y,r*y,s*y,a*y)}));const b=rm(a);return o.getTriangles().forEach((function(t,e,r){const a=t.source,o=t.target;let l=a[0][0],h=a[0][1],c=a[1][0],g=a[1][1],m=a[2][0],y=a[2][1];const _=f((o[0][0]-b[0])/s),x=f(-(o[0][1]-b[1])/s),w=f((o[1][0]-b[0])/s),S=f(-(o[1][1]-b[1])/s),T=f((o[2][0]-b[0])/s),E=f(-(o[2][1]-b[1])/s),k=l,C=h;l=0,h=0,c-=k,g-=C,m-=k,y-=C;const M=function(t){const e=t.length;for(let i=0;i<e;i++){let n=i,r=Math.abs(t[i][i]);for(let s=i+1;s<e;s++){const e=Math.abs(t[s][i]);e>r&&(r=e,n=s)}if(0===r)return null;const s=t[n];t[n]=t[i],t[i]=s;for(let n=i+1;n<e;n++){const r=-t[n][i]/t[i][i];for(let s=i;s<e+1;s++)i==s?t[n][s]=0:t[n][s]+=r*t[i][s]}}const i=new Array(e);for(let n=e-1;n>=0;n--){i[n]=t[n][e]/t[n][n];for(let r=n-1;r>=0;r--)t[r][e]-=t[r][n]*i[n]}return i}([[c,g,0,0,w-_],[m,y,0,0,T-_],[0,0,c,g,S-x],[0,0,m,y,E-x]]);if(M){if(d.save(),d.beginPath(),function(){if(void 0===Xk){const t=vb(6,6,Vk);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",Yk(t,4,5,4,0),Yk(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;Xk=Kk(e,0)||Kk(e,4)||Kk(e,8),yb(t),Vk.push(t.canvas)}return Xk}()||!u){d.moveTo(w,S);const t=4,e=_-w,i=x-S;for(let n=0;n<t;n++)d.lineTo(w+f((n+1)*e/t),S+f(n*i/(t-1))),n!=t-1&&d.lineTo(w+f((n+1)*e/t),S+f((n+1)*i/(t-1)));d.lineTo(T,E)}else d.moveTo(w,S),d.lineTo(_,x),d.lineTo(T,E);d.clip(),d.transform(M[0],M[2],M[1],M[3],_,x),d.translate(p[0]-k,p[3]-C),d.scale(n/i,-n/i),d.drawImage(v.canvas,0,0),d.restore()}})),yb(v),Vk.push(v.canvas),c&&(d.save(),d.globalCompositeOperation="source-over",d.strokeStyle="black",d.lineWidth=1,o.getTriangles().forEach((function(t,e,i){const n=t.target,r=(n[0][0]-b[0])/s,a=-(n[0][1]-b[1])/s,o=(n[1][0]-b[0])/s,l=-(n[1][1]-b[1])/s,h=(n[2][0]-b[0])/s,c=-(n[2][1]-b[1])/s;d.beginPath(),d.moveTo(o,l),d.lineTo(r,a),d.lineTo(h,c),d.closePath(),d.stroke()})),d.restore()),d.canvas}const Jk=class extends Gk{constructor(t,e,i,n,r,s,a,o,l,h,c,u){super(r,l_,{interpolate:!!u}),this.renderEdges_=void 0!==c&&c,this.pixelRatio_=a,this.gutter_=o,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=n,this.wrappedTileCoord_=s||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const d=n.getTileCoordExtent(this.wrappedTileCoord_),f=this.targetTileGrid_.getExtent();let p=this.sourceTileGrid_.getExtent();const g=f?nm(d,f):d;if(0===qg(g))return void(this.state=d_);const m=t.getExtent();m&&(p=p?nm(p,m):m);const v=n.getResolution(this.wrappedTileCoord_[0]),y=function(t,e,i,n){const r=$g(i);let s=qk(t,e,r,n);return(!isFinite(s)||s<=0)&&Kg(i,(function(i){return s=qk(t,e,i,n),isFinite(s)&&s>0})),s}(t,i,g,v);if(!isFinite(y)||y<=0)return void(this.state=d_);const b=void 0!==h?h:.5;if(this.triangulation_=new Hk(t,i,g,p,y*b,v),0===this.triangulation_.getTriangles().length)return void(this.state=d_);this.sourceZ_=e.getZForResolution(y);let _=this.triangulation_.calculateSourceExtent();if(p&&(t.canWrapX()?(_[1]=um(_[1],p[1],p[3]),_[3]=um(_[3],p[1],p[3])):_=nm(_,p)),qg(_)){const t=e.getTileRangeForExtentAndZ(_,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let i=t.minY;i<=t.maxY;i++){const t=l(this.sourceZ_,e,i,a);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=d_)}else this.state=d_}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach((e=>{e&&e.getState()==c_&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})})),this.sourceTiles_.length=0,0===t.length)this.state=u_;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n="number"==typeof i?i:i[0],r="number"==typeof i?i:i[1],s=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),o=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Zk(n,r,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),s,o,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=c_}this.changed()}load(){if(this.state==l_){this.state=h_,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((e=>{const i=e.getState();if(i==l_||i==h_){t++;const i=$p(e,Gp,(function(n){const r=e.getState();r!=c_&&r!=u_&&r!=d_||(tg(i),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(i)}})),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,i){t.getState()==l_&&t.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(tg),this.sourcesListenerKeys_=null}release(){this.canvas_&&(yb(this.canvas_.getContext("2d")),Vk.push(this.canvas_),this.canvas_=null),super.release()}};class $k{constructor(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function Qk(t,e,i,n,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=i,r.maxY=n,r):new $k(t,e,i,n)}const tC=$k;const eC=class extends KE{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=[1/0,1/0,-1/0,-1/0],this.tmpTileRange_=new tC(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),i=t.getState(),n=e.getUseInterimTilesOnError();return i==c_||i==d_||i==u_&&!n}getTile(t,e,i,n){const r=n.pixelRatio,s=n.viewState.projection,a=this.getLayer();let o=a.getSource().getTile(t,e,i,r,s);return o.getState()==u_&&a.getUseInterimTilesOnError()&&a.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(o)||(o=o.getInterimTile()),o}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),n=Cg(e.pixelToCoordinateTransform,t.slice()),r=i.getExtent();if(r&&!Fg(r,n))return null;const s=e.pixelRatio,a=e.viewState.projection,o=e.viewState,l=i.getRenderSource(),h=l.getTileGridForProjection(o.projection),c=l.getTilePixelRatio(e.pixelRatio);for(let t=h.getZForResolution(o.resolution);t>=h.getMinZoom();--t){const e=h.getTileCoordForCoordAndZ(n,t),i=l.getTile(t,e[1],e[2],s,a);if(!(i instanceof Uk||i instanceof Jk)||i instanceof Jk&&i.getState()===d_)return null;if(i.getState()!==c_)continue;const r=h.getOrigin(t),u=ix(h.getTileSize(t)),d=h.getResolution(t),f=Math.floor(c*((n[0]-r[0])/d-e[1]*u[0])),p=Math.floor(c*((r[1]-n[1])/d-e[2]*u[1])),g=Math.round(c*l.getGutterForProjection(o.projection));return this.getImageData(i.getImage(),f+g,p+g)}return null}loadedTileCallback(t,e,i){return!!this.isDrawableTile(i)&&super.loadedTileCallback(t,e,i)}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex],n=t.viewState,r=n.projection,s=n.resolution,a=n.center,o=n.rotation,l=t.pixelRatio,h=this.getLayer(),c=h.getSource(),u=c.getRevision(),d=c.getTileGridForProjection(r),f=d.getZForResolution(s,c.zDirection),p=d.getResolution(f);let g=t.extent;const m=t.viewState.resolution,v=c.getTilePixelRatio(l),y=Math.round(am(g)/m*l),b=Math.round(im(g)/m*l),_=i.extent&&Jv(i.extent,r);_&&(g=nm(g,Jv(i.extent,r)));const x=p*y/2/v,w=p*b/2/v,S=[a[0]-x,a[1]-w,a[0]+x,a[1]+w],T=d.getTileRangeForExtentAndZ(g,f),E={};E[f]={};const k=this.createLoadedTileFinder(c,r,E),C=this.tmpExtent,M=this.tmpTileRange_;this.newTiles_=!1;const A=o?em(n.center,m,o,t.size):void 0;for(let e=T.minX;e<=T.maxX;++e)for(let n=T.minY;n<=T.maxY;++n){if(o&&!d.tileCoordIntersectsViewport([f,e,n],A))continue;const r=this.getTile(f,e,n,t);if(this.isDrawableTile(r)){const e=sg(this);if(r.getState()==c_){E[f][r.tileCoord.toString()]=r;let t=r.inTransition(e);t&&1!==i.opacity&&(r.endTransition(e),t=!1),this.newTiles_||!t&&this.renderedTiles.includes(r)||(this.newTiles_=!0)}if(1===r.getAlpha(e,t.time))continue}const s=d.getTileCoordChildTileRange(r.tileCoord,M,C);let a=!1;s&&(a=k(f+1,s)),a||d.forEachTileCoordParentTileRange(r.tileCoord,k,M,C)}const O=p/s*l/v;Mg(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/l,1/l,o,-y/2,-b/2);const P=Pg(this.pixelTransform);this.useContainer(e,P,this.getBackground(t));const R=this.context,I=R.canvas;Ag(this.inversePixelTransform,this.pixelTransform),Mg(this.tempTransform,y/2,b/2,O,O,0,-y/2,-b/2),I.width!=y||I.height!=b?(I.width=y,I.height=b):this.containerReused||R.clearRect(0,0,y,b),_&&this.clipUnrotated(R,t,_),c.getInterpolate()||(R.imageSmoothingEnabled=!1),this.preRender(R,t),this.renderedTiles.length=0;let L,D,N,F=Object.keys(E).map(Number);F.sort(Pp),1!==i.opacity||this.containerReused&&!c.getOpaque(t.viewState.projection)?(L=[],D=[]):F=F.reverse();for(let e=F.length-1;e>=0;--e){const i=F[e],n=c.getTilePixelSize(i,l,r),s=d.getResolution(i)/p,a=n[0]*s*O,o=n[1]*s*O,h=d.getTileCoordForCoordAndZ(rm(S),i),u=d.getTileCoordExtent(h),g=Cg(this.tempTransform,[v*(u[0]-S[0])/p,v*(S[3]-u[3])/p]),m=v*c.getGutterForProjection(r),y=E[i];for(const e in y){const n=y[e],r=n.tileCoord,s=h[1]-r[1],l=Math.round(g[0]-(s-1)*a),u=h[2]-r[2],d=Math.round(g[1]-(u-1)*o),p=Math.round(g[0]-s*a),v=Math.round(g[1]-u*o),b=l-p,_=d-v,x=f===i,w=x&&1!==n.getAlpha(sg(this),t.time);let S=!1;if(!w)if(L){N=[p,v,p+b,v,p+b,v+_,p,v+_];for(let t=0,e=L.length;t<e;++t)if(f!==i&&i<D[t]){const e=L[t];om([p,v,p+b,v+_],[e[0],e[3],e[4],e[7]])&&(S||(R.save(),S=!0),R.beginPath(),R.moveTo(N[0],N[1]),R.lineTo(N[2],N[3]),R.lineTo(N[4],N[5]),R.lineTo(N[6],N[7]),R.moveTo(e[6],e[7]),R.lineTo(e[4],e[5]),R.lineTo(e[2],e[3]),R.lineTo(e[0],e[1]),R.clip())}L.push(N),D.push(i)}else R.clearRect(p,v,b,_);this.drawTileImage(n,t,p,v,b,_,m,x),L&&!w?(S&&R.restore(),this.renderedTiles.unshift(n)):this.renderedTiles.push(n),this.updateUsedTiles(t.usedTiles,c,n)}}return this.renderedRevision=u,this.renderedResolution=p,this.extentChanged=!this.renderedExtent_||!Hg(this.renderedExtent_,S),this.renderedExtent_=S,this.renderedPixelRatio=l,this.renderedProjection=r,this.manageTilePyramid(t,c,d,l,r,g,f,h.getPreload()),this.scheduleExpireCache(t,c),this.postRender(R,t),i.extent&&R.restore(),R.imageSmoothingEnabled=!0,P!==I.style.transform&&(I.style.transform=P),this.container}drawTileImage(t,e,i,n,r,s,a,o){const l=this.getTileImage(t);if(!l)return;const h=sg(this),c=e.layerStatesArray[e.layerIndex],u=c.opacity*(o?t.getAlpha(h,e.time):1),d=u!==this.context.globalAlpha;d&&(this.context.save(),this.context.globalAlpha=u),this.context.drawImage(l,a,a,l.width-2*a,l.height-2*a,i,n,r,s),d&&this.context.restore(),u!==c.opacity?e.animate=!0:o&&t.endTransition(h)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const i=function(t,e,i){const n=sg(t);n in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[n])}.bind(null,e);t.postRenderFunctions.push(i)}}updateUsedTiles(t,e,i){const n=sg(e);n in t||(t[n]={}),t[n][i.getKey()]=!0}manageTilePyramid(t,e,i,n,r,s,a,o,l){const h=sg(e);h in t.wantedTiles||(t.wantedTiles[h]={});const c=t.wantedTiles[h],u=t.tileQueue,d=i.getMinZoom(),f=t.viewState.rotation,p=f?em(t.viewState.center,t.viewState.resolution,f,t.size):void 0;let g,m,v,y,b,_,x=0;for(_=d;_<=a;++_)for(m=i.getTileRangeForExtentAndZ(s,_,m),v=i.getResolution(_),y=m.minX;y<=m.maxX;++y)for(b=m.minY;b<=m.maxY;++b)f&&!i.tileCoordIntersectsViewport([_,y,b],p)||(a-_<=o?(++x,g=e.getTile(_,y,b,n,r),g.getState()==l_&&(c[g.getKey()]=!0,u.isKeyQueued(g.getKey())||u.enqueue([g,h,i.getTileCoordCenter(g.tileCoord),v])),void 0!==l&&l(g)):e.useTile(_,y,b,r));e.updateCacheSize(x,r)}};const iC=class extends Wk{constructor(t){super(t)}createRenderer(){return new eC(this)}};const nC=class{constructor(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return Tg(void 0!==i,15),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return Tg(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.key_;return t}getValues(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){if(this.containsKey(t))return this.entries_[t].value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){Tg(!(t in this.entries_),16);const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}};function rC(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function sC(t,e,i){return t+"/"+e+"/"+i}function aC(t){return sC(t[0],t[1],t[2])}const oC=class extends nC{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache();){if(this.peekLast().getKey()in t)break;this.pop().release()}}pruneExceptNewestZ(){if(0===this.getCount())return;const t=function(t){return t.split("/").map(Number)}(this.peekFirstKey()),e=t[0];this.forEach((t=>{t.tileCoord[0]!==e&&(this.remove(aC(t.tileCoord)),t.release())}))}},lC="tileloadstart",hC="tileloadend",cC="tileloaderror",uC=[0,0,0];const dC=class{constructor(t){let e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,Tg(function(t,e,i){const n=e||Pp;return t.every((function(e,r){if(0===r)return!0;const s=n(t[r-1],e);return!(s>0||i&&0===s)}))}(this.resolutions_,(function(t,e){return e-t}),!0),17),!t.origins)for(let t=0,i=this.resolutions_.length-1;t<i;++t)if(e){if(this.resolutions_[t]/this.resolutions_[t+1]!==e){e=void 0;break}}else e=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,Tg(this.origins_.length==this.resolutions_.length,20));const i=t.extent;void 0===i||this.origin_||this.origins_||(this.origin_=rm(i)),Tg(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,Tg(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:$m,Tg(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==i?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((function(t,e){const n=new tC(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(i){const t=this.getTileRangeForExtentAndZ(i,e);n.minX=Math.max(t.minX,n.minX),n.maxX=Math.min(t.maxX,n.maxX),n.minY=Math.max(t.minY,n.minY),n.maxY=Math.min(t.maxY,n.maxY)}return n}),this):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const n=this.getTileRangeForExtentAndZ(t,e);for(let t=n.minX,r=n.maxX;t<=r;++t)for(let r=n.minY,s=n.maxY;r<=s;++r)i([e,t,r])}forEachTileCoordParentTileRange(t,e,i,n){let r,s,a,o=null,l=t[0]-1;for(2===this.zoomFactor_?(s=t[1],a=t[2]):o=this.getTileCoordExtent(t,n);l>=this.minZoom;){if(2===this.zoomFactor_?(s=Math.floor(s/2),a=Math.floor(a/2),r=Qk(s,s,a,a,i)):r=this.getTileRangeForExtentAndZ(o,l,i),e(l,r))return!0;--l}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const i=2*t[1],n=2*t[2];return Qk(i,i+1,n,n+1,e)}const n=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(n,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const n=t[0],r=t[1],s=t[2];if(e===n)return Qk(r,s,r,s,i);if(this.zoomFactor_){const t=Math.pow(this.zoomFactor_,e-n),a=Math.floor(r*t),o=Math.floor(s*t);if(e<n)return Qk(a,a,o,o,i);return Qk(a,Math.floor(t*(r+1))-1,o,Math.floor(t*(s+1))-1,i)}const a=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,uC);const n=uC[1],r=uC[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,uC);return Qk(n,uC[1],r,uC[2],i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=ix(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=ix(this.getTileSize(t[0]),this.tmpSize_),s=i[0]+t[1]*r[0]*n,a=i[1]-(t[2]+1)*r[1]*n;return Gg(s,a,s+r[0]*n,a+r[1]*n,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,n,r){const s=this.getZForResolution(i),a=i/this.getResolution(s),o=this.getOrigin(s),l=ix(this.getTileSize(s),this.tmpSize_);let h=a*(t-o[0])/i/l[0],c=a*(o[1]-e)/i/l[1];return n?(h=_m(h,5)-1,c=_m(c,5)-1):(h=bm(h,5),c=bm(c,5)),rC(s,h,c,r)}getTileCoordForXYAndZ_(t,e,i,n,r){const s=this.getOrigin(i),a=this.getResolution(i),o=ix(this.getTileSize(i),this.tmpSize_);let l=(t-s[0])/a/o[0],h=(s[1]-e)/a/o[1];return n?(l=_m(l,5)-1,h=_m(h,5)-1):(l=bm(l,5),h=bm(h,5)),rC(i,l,h,r)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){return um(Rp(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return Vy(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i}};function fC(t){let e=t.getDefaultTileGrid();return e||(e=function(t,e,i,n){const r=gC(t);return function(t,e,i,n){n=void 0!==n?n:"top-left";const r=pC(t,e,i);return new dC({extent:t,origin:Qg(t,n),resolutions:r,tileSize:i})}(r,e,i,n)}(t),t.setDefaultTileGrid(e)),e}function pC(t,e,i,n){e=void 0!==e?e:Jm,i=ix(void 0!==i?i:$m);const r=im(t),s=am(t);n=n>0?n:Math.max(s/i[0],r/i[1]);const a=e+1,o=new Array(a);for(let t=0;t<a;++t)o[t]=n/Math.pow(2,t);return o}function gC(t){let e=(t=Dv(t)).getExtent();if(!e){const i=180*Qm.degrees/t.getMetersPerUnit();e=Gg(-i,-i,i,i)}return e}class mC extends Mp{constructor(t,e){super(t),this.tile=e}}const vC=class extends wk{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.opaque_=void 0!==t.opaque&&t.opaque,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;const e=[256,256];this.tileGrid&&ix(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tileCache=new oC(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const i=this.getTileCacheForProjection(t);i&&i.expireCache(e)}forEachLoadedTile(t,e,i,n){const r=this.getTileCacheForProjection(t);if(!r)return!1;let s,a,o,l=!0;for(let t=i.minX;t<=i.maxX;++t)for(let h=i.minY;h<=i.maxY;++h)a=sC(e,t,h),o=!1,r.containsKey(a)&&(s=r.get(a),o=s.getState()===c_,o&&(o=!1!==n(s))),o||(l=!1);return l}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,n,r){return ng()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:fC(t)}getTileCacheForProjection(t){const e=this.getProjection();return Tg(null===e||Wv(e,t),68),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const n=this.getTileGridForProjection(i),r=this.getTilePixelRatio(e),s=ix(n.getTileSize(t),this.tmpSize);return 1==r?s:(a=s,o=r,void 0===(l=this.tmpSize)&&(l=[0,0]),l[0]=a[0]*o+.5|0,l[1]=a[1]*o+.5|0,l);var a,o,l}getTileCoordForTileUrlFunction(t,e){e=void 0!==e?e:this.getProjection();const i=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=function(t,e,i){const n=e[0],r=t.getTileCoordCenter(e),s=gC(i);if(!Fg(s,r)){const e=am(s),i=Math.ceil((s[0]-r[0])/e);return r[0]+=e*i,t.getTileCoordForCoordAndZ(r,n)}return e}(i,t,e)),function(t,e){const i=t[0],n=t[1],r=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;const s=e.getFullTileRange(i);return!s||s.containsXY(n,r)}(t,i)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){const i=this.getTileCacheForProjection(e);t>i.highWaterMark&&(i.highWaterMark=t)}useTile(t,e,i,n){}};function yC(t,e){const i=/\{z\}/g,n=/\{x\}/g,r=/\{y\}/g,s=/\{-y\}/g;return function(a,o,l){if(a)return t.replace(i,a[0].toString()).replace(n,a[1].toString()).replace(r,a[2].toString()).replace(s,(function(){const t=a[0],i=e.getFullTileRange(t);Tg(i,55);return(i.getHeight()-a[2]-1).toString()}))}}function bC(t,e){const i=t.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=yC(t[r],e);return function(t){if(1===t.length)return t[0];return function(e,i,n){if(!e)return;const r=function(t){return(t[1]<<t[0])+t[2]}(e),s=mm(r,t.length);return t[s](e,i,n)}}(n)}class _C extends vC{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===_C.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=sg(e),n=e.getState();let r;n==h_?(this.tileLoadingKeys_[i]=!0,r=lC):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],r=n==u_?cC:n==c_?hC:void 0),null!=r&&this.dispatchEvent(new mC(r,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()}setUrl(t){const e=function(t){const e=[];let i=/\{([a-z])-([a-z])\}/.exec(t);if(i){const n=i[1].charCodeAt(0),r=i[2].charCodeAt(0);let s;for(s=n;s<=r;++s)e.push(t.replace(i[0],String.fromCharCode(s)));return e}if(i=/\{(\d+)-(\d+)\}/.exec(t),i){const n=parseInt(i[2],10);for(let r=parseInt(i[1],10);r<=n;r++)e.push(t.replace(i[0],r.toString()));return e}return e.push(t),e}(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(bC(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}useTile(t,e,i){const n=sC(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)}}const xC=_C;function wC(t,e){t.getImage().src=e}const SC=class extends xC{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:wC,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:Uk,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const i=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==i?e:{});for(const t in this.tileCacheForProjection){const n=this.tileCacheForProjection[t];n.expireCache(n==i?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!Wv(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return!(this.getProjection()&&t&&!Wv(this.getProjection(),t))&&super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||Wv(e,t)))return this.tileGrid;const i=sg(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=fC(t)),this.tileGridForProjection[i]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||Wv(e,t))return this.tileCache;const i=sg(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new oC(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]}createTile_(t,e,i,n,r,s){const a=[t,e,i],o=this.getTileCoordForTileUrlFunction(a,r),l=o?this.tileUrlFunction(o,n,r):void 0,h=new this.tileClass(a,void 0!==l?l_:d_,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=s,h.addEventListener(Gp,this.handleTileChange.bind(this)),h}getTile(t,e,i,n,r){const s=this.getProjection();if(!s||!r||Wv(s,r))return this.getTileInternal(t,e,i,n,s||r);const a=this.getTileCacheForProjection(r),o=[t,e,i];let l;const h=aC(o);a.containsKey(h)&&(l=a.get(h));const c=this.getKey();if(l&&l.key==c)return l;const u=this.getTileGridForProjection(s),d=this.getTileGridForProjection(r),f=this.getTileCoordForTileUrlFunction(o,r),p=new Jk(s,u,r,d,o,f,this.getTilePixelRatio(n),this.getGutter(),((t,e,i,n)=>this.getTileInternal(t,e,i,n,s)),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return p.key=c,l?(p.interimTile=l,p.refreshInterimChain(),a.replace(h,p)):a.set(h,p),p}getTileInternal(t,e,i,n,r){let s=null;const a=sC(t,e,i),o=this.getKey();if(this.tileCache.containsKey(a)){if(s=this.tileCache.get(a),s.key!=o){const l=s;s=this.createTile_(t,e,i,n,r,o),l.getState()==l_?s.interimTile=l.interimTile:s.interimTile=l,s.refreshInterimChain(),this.tileCache.replace(a,s)}}else s=this.createTile_(t,e,i,n,r,o),this.tileCache.set(a,s);return s}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(t,e){const i=Dv(t);if(i){const t=sg(i);t in this.tileGridForProjection||(this.tileGridForProjection[t]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}};const TC=class extends SC{constructor(t){const e=void 0!==(t=t||{}).projection?t.projection:"EPSG:3857",i=void 0!==t.tileGrid?t.tileGrid:function(t){const e=t||{},i=e.extent||Dv("EPSG:3857").getExtent(),n={extent:i,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:pC(i,e.maxZoom,e.tileSize,e.maxResolution)};return new dC(n)}({extent:gC(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=void 0!==t.gutter?t.gutter:0}getGutter(){return this.gutter_}};var EC={oninit:function(t){t.state.id=g.general.uuid(),t.state.prevPath=t.attrs.path,t.state.prevPoles=t.attrs.poles,t.state.mapboundsfitted=!1,t.state.isOpen={export:!1}},oncreate:function(t){kC(t),RC(t)},view:function(t){return void 0!==t.attrs.projection&&void 0!==t.state.projection&&t.attrs.projection.name!==t.state.projection.name&&kC(t),RC(t),r()("div",{class:"comp polarmap"},r()("div",{id:t.state.id,style:(t.attrs.width?"width: ".concat(t.attrs.width,"; "):"")+(t.attrs.height?" height: ".concat(t.attrs.height,"; "):"")}),!1!==t.attrs.controls?[r()("button",{class:"btn_icon export_button",onclick:function(){t.state.isOpen.export=!0},key:"0"},r()("i",{class:"fa-solid fa-bars"})),r()(Af,{fillcontainer:!0,isOpen:t.state.isOpen.export,onClose:function(){t.state.isOpen.export=!1},key:"1"},r()("div",{class:"menu"},r()("a",{onclick:function(){LC(t),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-download fa-fw"})," Download XLSX"),r()("a",{onclick:function(){LC(t,"csv"),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-download fa-fw"})," Download CSV"),r()("a",{onclick:function(){!function(t){var e=3,i=t.state.map;i.once("rendercomplete",(function(){var n,r=document.createElement("canvas");r.crossOrigin="Anonymous";var s=i.getSize();r.width=s[0]*e,r.height=s[1]*e;var a=r.getContext("2d");Array.prototype.forEach.call(i.getViewport().querySelectorAll(".ol-layer canvas, canvas.ol-layer"),(function(t){if(t.width>0){var i,n=t.parentNode.style.opacity||t.style.opacity;a.globalAlpha=""===n?1:Number(n);var r=t.style.transform;i=r?r.match(/^matrix\(([^\(]*)\)$/)[1].split(",").map(Number):[parseFloat(t.style.width)/t.width,0,0,parseFloat(t.style.height)/t.height,0,0],CanvasRenderingContext2D.prototype.setTransform.apply(a,i),t.parentNode.style.backgroundColor&&(a.fillStyle="blue",a.fillRect(0,0,t.width,t.height)),a.drawImage(t,0,0,t.width*e,t.height*e)}})),a.globalAlpha=1,a.setTransform(1,0,0,1,0,0);var o=document.createElement("a");o.href=r.toDataURL(),o.download="".concat(null!==(n=t.attrs.exportName)&&void 0!==n?n:"Map"," APWP-online.org.png"),o.click()})),i.renderSync()}(t),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-download fa-fw"})," Download PNG")))]:null)}};function kC(t){document.getElementById(t.state.id).innerHTML="";var e=function(t){t.state.projection=t.attrs.projection||m.findDefault("mapProjection"),NT.defs(t.state.projection.name,t.state.projection.params),jT(NT);var e=new tv({code:t.state.projection.name,extent:t.state.projection.extent,worldExtent:t.state.projection.worldextent});return e}(t);t.state.maplayers={layer_basemap:CC(t),layer_A95:MC(t),layer_path:AC(t),layer_pathlabels:OC(t),layer_graticule:PC(t)};var i=new sx({layers:[t.state.maplayers.layer_basemap,t.state.maplayers.layer_A95,t.state.maplayers.layer_path,t.state.maplayers.layer_pathlabels,t.state.maplayers.layer_graticule],target:t.state.id,controls:!0===t.attrs.controls?y_({attribution:!1}).extend([new g_({collapsible:!1})]):[new g_({collapsible:!0})],view:new rb({projection:e,extent:t.state.projection.extent,center:[0,0],zoom:1.5,enableRotation:!1})});t.state.map=i,function(t){function e(){t.state.map.updateSize()}new ResizeObserver(e).observe(t.state.map.getViewport())}(t)}function CC(t){return new iC({source:new TC({crossOrigin:"anonymous",url:t.state.projection.basemapsrc,projection:t.state.projection.name,attributions:t.state.projection.attributions})})}function MC(t){var e=new uE({fill:new GT({color:"#0652DD44"})});return new bk({id:"layer_A95",source:new Lk({projection:t.state.projection.name}),extent:t.state.projection.extent,style:e,updateWhileAnimating:!0,updateWhileInteracting:!0})}function AC(t){var e=new uE({stroke:new qT({color:"#000000",width:1}),image:new aE({radius:3,stroke:new qT({color:"#000000",width:2}),fill:new GT({color:"#FFF"})})});return new bk({id:"layer_path",source:new Lk({projection:t.state.projection.name}),extent:t.state.projection.extent,style:e,updateWhileAnimating:!0,updateWhileInteracting:!0})}function OC(t){var e=new uE({text:new fE({textAlign:"middle",font:'"Poppins"',text:"",fill:new GT({color:"#000"}),stroke:new qT({color:"#fff",width:3}),offsetX:0,offsetY:12})});return new bk({id:"layer_pathlabels",source:new Lk({projection:t.state.projection.name}),extent:t.state.projection.extent,declutter:!0,style:function(t,i,n,r,s){return e.getText().setText(t.get("label")),e.setZIndex(t.get("zIndex")),[e]},updateWhileAnimating:!0,updateWhileInteracting:!0})}function PC(t){return new jk({showLabels:!0,strokeStyle:new qT({color:"rgba(0, 0, 0, 0.2)"}),intervals:[30,10,5],extent:t.state.projection.extent})}function RC(t){void 0!==t.state.map&&(function(t){t.state.maplayers.layer_A95.getSource().clear(),t.state.maplayers.layer_path.getSource().clear(),t.state.maplayers.layer_pathlabels.getSource().clear()}(t),t.attrs.path&&IC(t.attrs.path,!0,t),t.attrs.poles&&IC(t.attrs.poles,!1,t),function(t){var e,i,n,r,s=t.state.prevPath!==t.attrs.path||t.state.prevPoles!==t.attrs.poles,a=(null!==(e=null===(i=t.attrs.poles)||void 0===i?void 0:i.length)&&void 0!==e?e:0)+(null!==(n=null===(r=t.attrs.path)||void 0===r?void 0:r.length)&&void 0!==n?n:0);s&&(t.state.prevPath=t.attrs.path,t.state.prevPoles=t.attrs.poles,t.state.mapboundsfitted=!1);if(0===a)return;!1===t.state.mapboundsfitted&&(t.state.map.getView().fit(t.state.maplayers.layer_path.getSource().getExtent(),{padding:[30,30,30,30],maxZoom:8}),t.state.mapboundsfitted=!0)}(t))}function IC(t,e,i){var n;t.forEach((function(t,r,s){var a,o,l=e?t.plon:t.slon,h=e?t.plat:t.slat,c=null!==(a=t.B95)&&void 0!==a?a:null!==(o=t.A95)&&void 0!==o?o:t.P95,u=parseFloat(t.age.toFixed(2)).toString()+"Ma";if(!isNaN(l)&&!isNaN(h)){var d=new By([l,h]).transform("EPSG:4326",i.state.projection.name).getFirstCoordinate();if(e){var f=function(t,e,i,n){i=i||32;const r=[];for(let s=0;s<i;++s)Lp(r,kv(t,e,2*Math.PI*s/i,n));return r.push(r[0],r[1]),new $y(r,"XY",[r.length])}(Hv(d,i.state.projection.name,"EPSG:4326"),111139*c,128);f.transform("EPSG:4326",i.state.projection.name);var p=new zT({geometry:f});i.state.maplayers.layer_A95.getSource().addFeature(p)}if(e&&void 0!==n){var g=new zT({geometry:new YT([n,d])});i.state.maplayers.layer_path.getSource().addFeature(g)}var m=new zT({geometry:new By(d)});i.state.maplayers.layer_path.getSource().addFeature(m);var v=0===r||r===s.length-1?1:0,y=new zT({geometry:new By(d),label:u,zIndex:v});i.state.maplayers.layer_pathlabels.getSource().addFeature(y),n=d}}))}function LC(t,e){var i;if(e=null!==(i=e)&&void 0!==i?i:"xlsx",t.attrs.path){var n="Path of "+t.attrs.exportName;g.general.downloadXlsx([{label:"age",value:"age"},{label:"min_age",value:"min_age"},{label:"max_age",value:"max_age"},{label:"center_age",value:"center_age"},{label:"plat",value:"plat"},{label:"plon",value:"plon"},{label:"P95",value:"P95"},{label:"N",value:"N"},{label:"elong",value:"elong"},{label:"mean_E",value:"mean_E"},{label:"mean_K",value:"mean_K"},{label:"mean_csd",value:"mean_csd"},{label:"slat",value:"slat"},{label:"slon",value:"slon"},{label:"name",value:"name"}],t.attrs.path,n,e)}else if(t.attrs.poles){var r="Poles of "+t.attrs.exportName;g.general.downloadXlsx([{label:"name",value:"name"},{label:"age",value:"age"},{label:"min_age",value:"min_age"},{label:"max_age",value:"max_age"},{label:"A95",value:"A95"},{label:"K",value:"K"},{label:"lithology",value:"lithology"},{label:"f",value:"f"},{label:"mdec",value:"mdec"},{label:"minc",value:"minc"},{label:"p_std",value:"p_std"},{label:"plat",value:"plat"},{label:"plon",value:"plon"},{label:"slat",value:"slat"},{label:"slon",value:"slon"},{label:"plateID",value:"plateID"}],t.attrs.poles,r,e)}else alert("Error, input data is not correct. Please contact info@apwp-online.org")}var DC={oninit:function(t){t.state.value=t.attrs.value,t.state.valid=!0},oncreate:function(t){t.attrs.autofocus&&t.dom.querySelector("input").focus(),t.attrs.autoselect&&t.dom.querySelector("input").select()},view:function(t){return r()("div",{class:"comp input input_text"+(t.state.saving?" saving":"")+(t.state.valid?"":" invalid")+(t.attrs.format?" formatted":"")+(t.attrs.disabled?" disabled":"")+(t.attrs.autowidth?" autowidth":"")},t.attrs.title?r()("div",{class:"title"},t.attrs.title):"",r()("input",{type:"text",oninput:function(e){var i;!function(t,e){t.state.value=e,t.attrs.onchange&&t.attrs.onchange(e);NC(t,e,!0)}(t,null==e||null===(i=e.target)||void 0===i?void 0:i.value),e.redraw=!0},onkeyup:function(t){13===(null==t?void 0:t.which)&&t.target.blur(),t.redraw=!1},onblur:function(e){var i;!function(t,e){t.attrs.onblur&&t.attrs.onblur(e);NC(t,e,!1)}(t,null==e||null===(i=e.target)||void 0===i?void 0:i.value)},tabindex:t.attrs.tabindex||"1",value:t.state.value,placeholder:t.attrs.placeholder}),void 0===t.attrs.format?"":r()("div",{class:"formatval"},t.attrs.format(t.state.value)),r()("div",{class:"saveui"},r()("i",{class:"saving far fa-spin fa-sync-alt"})," saving"))}};function NC(t,e,i){if(t.attrs.isvalid){var n=t.attrs.isvalid(e);t.state.valid!=n&&(t.state.valid=n,i&&r().redraw())}}var FC={oninit:function(t){t.state.isOpen={menu:!1,remove:!1,rename:!1,bigmap:!1},t.state.fileObjectURL=t.attrs.dataset.raw.file instanceof File?URL.createObjectURL(t.attrs.dataset.raw.file):t.attrs.dataset.raw.file,t.state.showMap=!0,t.state.newDatasetName=void 0,t.state.apwpData=!1},onremove:function(t){t.state.fileObjectURL.startsWith("blob:")&&URL.revokeObjectURL(t.state.fileObjectURL)},view:function(t){var e,i=t.attrs.dataset;if(void 0===i)return r()("div",{class:"comp dataset"},r()("div",{class:"card"},r()("div",{class:"info"},r()("h4",null,"Error..."),r()("div",null,r()("i",null,"Something probally went wrong with importing this dataset...")))));var n=i.calculations.reduce((function(t,e){return"apwp"===e.type&&"done"===e.status&&void 0!==e.results&&e.results.length>0&&(void 0===t||t.created<e.created)&&(t=e),t}),void 0);return r()("div",{class:"comp dataset ".concat(t.attrs.isactive?"isactive":""," ").concat(t.attrs.isref?"isref":"")},r()("div",{class:"card"},!1===t.state.showMap?null:!0===t.attrs.showapwp&&void 0===n?r()("div",{class:"noapwp"},r()("span",{class:"txt_error"},"No APWP calculated for this dataset."),r()("a",{href:"#!/apwptool"},"APWP Tool")):r()(EC,{poles:t.attrs.showapwp?n.results:i.data.poles,path:t.attrs.showapwp?n.results:void 0,projection:t.attrs.showapwp?m.find("mapProjection","EPSG:3575"):m.find("mapProjection","EPSG:3857"),width:"13.5rem",height:"15rem",controls:!1,exportName:i.name}),r()("div",{class:"info"},r()("h4",null,i.name),r()("div",null,r()("a",{href:t.state.fileObjectURL},i.raw.name)," ",r()("small",null,r()("i",null,"(",g.general.displayFileSize(i.raw.size),")"))),r()("div",null,i.data.length," poles"),r()("div",{style:"flex-grow: 1;"}),!1!==t.attrs.onActivate?t.attrs.isref&&t.attrs.isactive?r()("small",{style:"line-height: 1rem;",class:"txt_error"},r()("i",null,"Used as both reference and active set")):t.attrs.isref?[r()("small",{class:"txt_default_lesser",key:"0"},r()("i",null,"Used as reference")),r()("button",{class:"activate_button ".concat(t.attrs.disabled?"disabled":""),onclick:function(){t.attrs.onActivate(i)},key:"1"},"Use this set")]:t.attrs.isactive?r()("small",{class:"txt_default_lesser"},r()("i",null,"This set is active")):r()("button",{class:"activate_button ".concat(t.attrs.disabled?"disabled":""),onclick:function(){t.attrs.onActivate(i)}},"Use this set"):null)),r()("button",{class:"btn_icon menu_button ".concat(t.attrs.disabled?"disabled":""),onclick:function(){t.state.isOpen.menu=!t.state.isOpen.menu}},r()("i",{class:"fa-solid fa-bars fa-fw"})),r()(Af,{fillcontainer:!0,isOpen:t.state.isOpen.menu,onClose:function(){t.state.isOpen.menu=!1}},r()("div",{class:"menu"},r()("a",{href:"javascript:",onclick:function(e){e.redraw=!1,t.state.isOpen.menu=!1,t.state.showMap=!1,r().redraw.sync(),t.state.showMap=!0,r().redraw()}},r()("i",{class:"fa-solid fa-arrows-to-circle fa-fw"})," Recenter map"),r()("a",{onclick:function(){t.state.isOpen.bigmap=!0,t.state.isOpen.menu=!1,function(t){g.docstore.getFull("dataset",t.attrs.dataset.id).then((function(e){var i;t.state.apwpData=null===(i=e.calculations.filter((function(t){return"apwp"===t.type&&"done"===t.status})).sort((function(t,e){return e.created-t.created})))||void 0===i||null===(i=i[0])||void 0===i?void 0:i.results,r().redraw()}))}(t)},href:"javascript:"},r()("i",{class:"fa-solid fa-arrows-maximize fa-fw"})," Show fullscreen"),r()("a",{onclick:function(){t.state.isOpen.rename=!0,t.state.isOpen.menu=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-pencil fa-fw"})," Rename dataset"),r()("a",{href:t.state.fileObjectURL},r()("i",{class:"fa-solid fa-download fa-fw"}),"Download ",i.raw.name),r()("a",{onclick:function(){t.state.isOpen.remove=!0,t.state.isOpen.menu=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-trash-can fa-fw"})," Remove dataset"))),r()(dp,{isOpen:t.state.isOpen.rename,onAnswer:function(e){!function(t,e){if(t.state.isOpen.rename=!1,e){var i=Object.assign({},t.attrs.dataset);i.name=t.state.newDatasetName,g.docstore.set("dataset",i).then((function(e){t.attrs.onDatasetchanged(e)}))}t.state.newDatasetName=void 0}(t,e)}},r()("div",{key:void 0===t.state.newDatasetName},r()("h4",null,"Rename dataset"),r()(DC,{title:"Name:",value:null!==(e=t.state.newDatasetName)&&void 0!==e?e:i.name,onblur:function(e){t.state.newDatasetName=e}}))),r()(dp,{isOpen:t.state.isOpen.remove,onAnswer:function(e){!function(t,e){t.state.isOpen.remove=!1,e&&(t.attrs.dataset.calculations.forEach((function(t){g.docstore.remove("calculation",t)})),g.docstore.remove("dataset",t.attrs.dataset.id).then((function(){t.attrs.onDatasetchanged()})))}(t,e)}},r()("h4",null,"Are you sure?"),"Removing the dataset ",r()("i",null,i.name)," can not be undone."),r()(dp,{isLightbox:!0,autowidth:!0,topmargin:"6vh",isOpen:t.state.isOpen.bigmap,onAnswer:function(e){t.state.isOpen.bigmap=!1}},r()(EC,{poles:t.state.bigmapAPWP?void 0:i.data.poles,path:t.state.bigmapAPWP?t.state.apwpData:void 0,projection:t.state.bigmapAPWP?m.find("mapProjection","EPSG:3575"):m.find("mapProjection","EPSG:3857"),width:"80vw",height:"88vh",controls:!0,exportName:i.name}),r()("button",{style:"right: 3rem;",class:"btn_icon menu_button ".concat(t.state.apwpData?"":"disabled"),onclick:function(){t.state.bigmapAPWP=!t.state.bigmapAPWP}},!1===t.state.apwpData?"loading...":void 0===t.state.apwpData?"No custom APWP calculated":t.state.bigmapAPWP?r()("span",{key:"polesicon"},r()("i",{class:"fa-duotone fa-chart-scatter-3d fa-fw",style:"--fa-secondary-opacity: 0;"})," Show poles"):r()("span",{key:"apwpcion"},r()("i",{class:"fa-solid fa-bezier-curve fa-fw"})," Show APWP"))))}};var jC=i(3741),BC={insert:"head",singleton:!1};wf()(jC.Z,BC);jC.Z.locals;var zC=i(8840),WC=i.n(zC),GC={oninit:function(t){t.state.isOpen={export:!1},t.state.refLocRender=void 0},oncreate:function(t){!function(t){var e=WC().chart("dispgraphContent",{exporting:{buttons:{contextButton:{enabled:!1}},fallbackToExportServer:!1,url:""},chart:{type:"scatter",zoomType:"xy",animation:!1,style:{fontFamily:"Poppins"}},title:{text:"Paleolatitude difference",style:{fontSize:"1rem",fontWeight:"400"}},legend:{enabled:!1},tooltip:{shared:!1,useHTML:!0,formatter:function(){var t=this.point.options.context;return void 0!==t&&"\n                    <div>\n                        <div style='color:".concat(this.color,";'><b>").concat(t.input_pole.name,"</b></div>\n                        <div>Age: <b>").concat(t.input_pole.age.toFixed(1)," Ma</b> &pm; <small>").concat((t.input_pole.age-t.input_pole.min_age).toFixed(1)," Ma</small></div>\n                        <div>Diff: <b>").concat(t.L.L.toFixed(1),"°</b> &pm; <small>").concat(t.L.delta_L.toFixed(1),"°</small></div>\n                    </div>\n                ")}},xAxis:{title:{text:"Age (Ma)"},reversed:!0,endOnTick:!0,startOnTick:!0,min:0,floor:0,maxPadding:0,margin:0,crosshair:!0},yAxis:[{title:{text:"Paleolatitude difference (deg)"},crosshair:!0,labels:{formatter:function(){return this.value+"°"}}}],series:[]});t.state.graph=e}(t),UC(t)},view:function(t){return UC(t),r()("div",{class:"comp dispgraph"},r()("div",{id:"graphWrapper"},r()("div",{id:"dispgraphContent"},"Loading graph..")),r()("button",{class:"btn_icon export_button",onclick:function(){t.state.isOpen.export=!0}},r()("i",{class:"fa-solid fa-bars"})),r()(Af,{fillcontainer:!0,isOpen:t.state.isOpen.export,onClose:function(){t.state.isOpen.export=!1}},r()("div",{class:"menu"},r()("a",{onclick:function(){t.state.graph.fullscreen.open(),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-arrows-maximize fa-fw"})," Show fullscreen"),r()("div",{class:"spacer"}),r()("a",{onclick:function(){HC(t),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-download fa-fw"})," Download XLSX"),r()("a",{onclick:function(){HC(t,"csv"),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-download fa-fw"})," Download CSV"),r()("a",{onclick:function(){t.state.graph.exportChartLocal({type:"application/pdf",filename:"Paleolatitude difference APWP-online.org"}),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-download fa-fw"})," Download PDF"),r()("div",{class:"spacer"}),r()("a",{onclick:function(){t.state.graph.exportChartLocal({type:"image/png",filename:"Paleolatitude difference APWP-online.org"}),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-download fa-fw"})," Download PNG"),r()("a",{onclick:function(){t.state.graph.exportChartLocal({type:"image/jpeg",filename:"Paleolatitude difference APWP-online.org"}),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-download fa-fw"})," Download JPG"),r()("a",{onclick:function(){t.state.graph.exportChartLocal({type:"image/svg+xml",filename:"Paleolatitude difference APWP-online.org"}),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-download fa-fw"})," Download SVG"))))}};function UC(t){void 0!==t.state.graph&&void 0!==t.attrs.rpd&&([].concat(t.state.graph.series).forEach((function(t,e){t.remove(!1,!1,!1)})),t.state.refLocRender&&t.state.refLocRender.destroy(),t.state.refLocRender=t.state.graph.renderer.label(function(t){var e=t.reduce((function(t,e){return null===t||(void 0===t&&(t=[e.ref.lon,e.ref.lat]),e.ref.lon===t[0]&&e.ref.lat===t[1]||(t=null)),t}),void 0),i="Using sample as ref. loc.";null!==e&&(i="Using ref. loc.(".concat(parseFloat(e[0]).toFixed(2),",").concat(parseFloat(e[1]).toFixed(2),")"));return i}(t.attrs.rpd),80,23).add().css({color:"grey",fontWeight:200}),t.state.graph.addSeries({animation:!1,enableMouseTracking:!1,id:"dispErrorbarX",type:"line",name:"errorbars",lineWidth:.5,marker:{enabled:!0,symbol:"hline",lineColor:null,lineWidth:.5,states:{hover:{enabled:!1}}},states:{hover:{enabled:!1}},tooltip:{enabled:!1},color:"#000",data:t.attrs.rpd.map((function(t){return[{x:0===t.input_pole.max_age?null:t.input_pole.max_age,y:t.L.L,marker:{symbol:"vline",lineWidth:.5,lineColor:null}},{x:0===t.input_pole.max_age?null:t.input_pole.min_age,y:t.L.L,marker:{symbol:"vline",lineWidth:.5,lineColor:null}},{x:null,y:null},{x:t.input_pole.age,y:t.L.L+t.L.delta_L,marker:{symbol:"hline",lineWidth:.5,lineColor:null}},{x:t.input_pole.age,y:t.L.L-t.L.delta_L,marker:{symbol:"hline",lineWidth:.5,lineColor:null}},{x:null,y:null}]})).flat()}),t.state.graph.addSeries({animation:!1,id:"disp",type:"scatter",name:"dispData",marker:{enabled:!0,symbol:"circle"},color:"#0652DD",data:t.attrs.rpd.map((function(t){return{marker:{fillColor:t.L.L_sig?void 0:"white",lineWidth:t.L.L_sig?void 0:1,lineColor:"#0652DD",symbol:"circle"},x:t.input_pole.age,y:t.L.L,context:t}}))}))}function HC(t,e){var i;if(e=null!==(i=e)&&void 0!==i?i:"xlsx",Array.isArray(t.attrs.rpd)){g.general.downloadXlsx([{label:"name",value:["input_pole","name"]},{label:"age",value:["input_pole","age"]},{label:"min_age",value:["input_pole","min_age"]},{label:"max_age",value:["input_pole","max_age"]},{label:"N",value:["input_pole","N"]},{label:"R",value:["R","R"]},{label:"delta_R",value:["R","delta_R"]},{label:"R_sig",value:["R","R_sig"]},{label:"L",value:["L","L"]},{label:"delta_L",value:["L","delta_L"]},{label:"L_sig",value:["L","L_sig"]},{label:"A95",value:["input_pole","A95"]},{label:"B95",value:"B95"},{label:"plat",value:["input_pole","plat"]},{label:"plon",value:["input_pole","plon"]},{label:"ref_dec",value:["ref","dec"]},{label:"ref_inc",value:["ref","inc"]},{label:"ref_mean_N",value:["ref","mean_N"]},{label:"ref_mean_K",value:["ref","mean_K"]}],t.attrs.rpd,"Paleolatitude difference",e)}else alert("Error, something went wrong with exporting this data..")}var XC=i(5328),VC={insert:"head",singleton:!1};wf()(XC.Z,VC);XC.Z.locals;var YC={oninit:function(t){t.state.isOpen={export:!1},t.state.refLocRender=void 0},oncreate:function(t){!function(t){var e=WC().chart("rotgraphContent",{exporting:{buttons:{contextButton:{enabled:!1}},fallbackToExportServer:!1,url:""},chart:{type:"scatter",zoomType:"xy",animation:!1,style:{fontFamily:"Poppins"}},title:{text:"Relative rotation",style:{fontSize:"1rem",fontWeight:"400"}},legend:{enabled:!1},tooltip:{shared:!1,useHTML:!0,formatter:function(){var t=this.point.options.context;return void 0!==t&&"\n                    <div>\n                        <div style='color:".concat(this.color,";'><b>").concat(t.input_pole.name,"</b></div>\n                        <div>Age: <b>").concat(t.input_pole.age.toFixed(1)," Ma</b> &pm; <small>").concat((t.input_pole.age-t.input_pole.min_age).toFixed(1)," Ma</small></div>\n                        <div>Diff: <b>").concat(t.R.R.toFixed(1),"°</b> &pm; <small>").concat(t.R.delta_R.toFixed(1),"°</small></div>\n                    </div>\n                ")}},xAxis:{title:{text:"Age (Ma)"},reversed:!0,endOnTick:!0,min:0,maxPadding:0,margin:0,crosshair:!0},yAxis:[{title:{text:"Relative rotation (deg)"},crosshair:!0,labels:{formatter:function(){return this.value+"°"}}}],series:[]});t.state.graph=e}(t),KC(t)},view:function(t){return KC(t),r()("div",{class:"comp rotgraph"},r()("div",{id:"graphWrapper"},r()("div",{id:"rotgraphContent"},"Loading graph..")),r()("button",{class:"btn_icon export_button",onclick:function(){t.state.isOpen.export=!0}},r()("i",{class:"fa-solid fa-bars"})),r()(Af,{fillcontainer:!0,isOpen:t.state.isOpen.export,onClose:function(){t.state.isOpen.export=!1}},r()("div",{class:"menu"},r()("a",{onclick:function(){t.state.graph.fullscreen.open(),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-arrows-maximize fa-fw"})," Show fullscreen"),r()("div",{class:"spacer"}),r()("a",{onclick:function(){qC(t),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-download fa-fw"})," Download XLSX"),r()("a",{onclick:function(){qC(t,"csv"),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-download fa-fw"})," Download CSV"),r()("a",{onclick:function(){t.state.graph.exportChartLocal({type:"application/pdf",filename:"Relative rotation APWP-online.org"}),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-download fa-fw"})," Download PDF"),r()("div",{class:"spacer"}),r()("a",{onclick:function(){t.state.graph.exportChartLocal({type:"image/png",filename:"Relative rotation APWP-online.org"}),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-download fa-fw"})," Download PNG"),r()("a",{onclick:function(){t.state.graph.exportChartLocal({type:"image/jpeg",filename:"Relative rotation APWP-online.org"}),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-download fa-fw"})," Download JPG"),r()("a",{onclick:function(){t.state.graph.exportChartLocal({type:"image/svg+xml",filename:"Relative rotation APWP-online.org"}),t.state.isOpen.export=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-download fa-fw"})," Download SVG"))))}};function KC(t){void 0!==t.state.graph&&void 0!==t.attrs.rpd&&([].concat(t.state.graph.series).forEach((function(t,e){t.remove(!1,!1,!1)})),t.state.refLocRender&&t.state.refLocRender.destroy(),t.state.refLocRender=t.state.graph.renderer.label(function(t){var e=t.reduce((function(t,e){return null===t||(void 0===t&&(t=[e.ref.lon,e.ref.lat]),e.ref.lon===t[0]&&e.ref.lat===t[1]||(t=null)),t}),void 0),i="Using sample as ref. loc.";null!==e&&(i="Using ref. loc.(".concat(parseFloat(e[0]).toFixed(2),",").concat(parseFloat(e[1]).toFixed(2),")"));return i}(t.attrs.rpd),80,23).add().css({color:"grey",fontWeight:200}),t.state.graph.addSeries({animation:!1,enableMouseTracking:!1,id:"RotErrorbar",type:"line",name:"errorbars",lineWidth:.5,marker:{enabled:!0,symbol:"hline",lineColor:null,lineWidth:.5,states:{hover:{enabled:!1}}},states:{hover:{enabled:!1}},tooltip:{enabled:!1},color:"#000",data:t.attrs.rpd.map((function(t){return[{x:0===t.input_pole.max_age?null:t.input_pole.max_age,y:t.R.R,marker:{symbol:"vline",lineWidth:.5,lineColor:null}},{x:0===t.input_pole.max_age?null:t.input_pole.min_age,y:t.R.R,marker:{symbol:"vline",lineWidth:.5,lineColor:null}},{x:null,y:null},{x:t.input_pole.age,y:t.R.R+t.R.delta_R,marker:{symbol:"hline",lineWidth:.5,lineColor:null}},{x:t.input_pole.age,y:t.R.R-t.R.delta_R,marker:{symbol:"hline",lineWidth:.5,lineColor:null}},{x:null,y:null}]})).flat()}),t.state.graph.addSeries({animation:!1,id:"rot",type:"scatter",name:"rotData",marker:{enabled:!0,symbol:"circle"},color:"#0652DD",data:t.attrs.rpd.map((function(t){return{marker:{fillColor:t.R.R_sig?void 0:"white",lineWidth:t.R.R_sig?void 0:1,lineColor:"#0652DD",symbol:"circle"},x:t.input_pole.age,y:t.R.R,context:t}}))}))}function qC(t,e){var i;if(e=null!==(i=e)&&void 0!==i?i:"xlsx",Array.isArray(t.attrs.rpd)){g.general.downloadXlsx([{label:"name",value:["input_pole","name"]},{label:"age",value:["input_pole","age"]},{label:"min_age",value:["input_pole","min_age"]},{label:"max_age",value:["input_pole","max_age"]},{label:"N",value:["input_pole","N"]},{label:"R",value:["R","R"]},{label:"delta_R",value:["R","delta_R"]},{label:"R_sig",value:["R","R_sig"]},{label:"L",value:["L","L"]},{label:"delta_L",value:["L","delta_L"]},{label:"L_sig",value:["L","L_sig"]},{label:"A95",value:["input_pole","A95"]},{label:"B95",value:"B95"},{label:"plat",value:["input_pole","plat"]},{label:"plon",value:["input_pole","plon"]},{label:"ref_dec",value:["ref","dec"]},{label:"ref_inc",value:["ref","inc"]},{label:"ref_mean_N",value:["ref","mean_N"]},{label:"ref_mean_K",value:["ref","mean_K"]}],t.attrs.rpd,"Relative rotation",e)}else alert("Error, something went wrong with exporting this data..")}var ZC=i(7771),JC={insert:"head",singleton:!1};wf()(ZC.Z,JC);ZC.Z.locals;var $C={oninit:function(t){t.state.expanded=t.attrs.expanded||!1},view:function(t){var e=t.state.expanded?t.attrs.lessLabel||"Show less <i class='icon fa-solid fa-caret-up fa-fw'></i>":t.attrs.moreLabel||"Show more <i class='icon fa-solid fa-caret-down fa-fw'></i>",i=r()("button",{class:"comp showmore btn_narrow "+(t.state.expanded?"expanded":""),onclick:function(){t.state.expanded=!t.state.expanded}},r().trust(e));return t.state.expanded?r().fragment(t.children,i):t.attrs.preview?r().fragment(r()("div",{class:"showmore_preview"},r()("span",null,t.children)),i):i}};function QC(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,r,s,a,o=[],l=!0,h=!1;try{if(s=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=s.call(i)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(t){h=!0,r=t}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(h)throw r}}return o}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return tM(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return tM(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tM(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var eM={oninit:function(t){t.state.activeset=void 0,t.state.activecalc=void 0,t.state.datasets=[],iM(t),t.state.isOpen={datasetsBulk:!1,clearDocStore:!1,calcSettings:!1}},view:function(t){var e,i=void 0;"custom"===g.sessionStorage.getOption("RPD_ref_type")&&(i=t.state.datasets.find((function(t){return t.id===g.sessionStorage.getOption("RPD_customref")})));var n=t.state.caclbusy,s=function(t){var e=[];if(void 0===t||"done"!==t.status)return e;if(void 0===t.results[0].input_pole)return e;if("geopole"===t.options.ref_type)return e;var i=t.results.reduce((function(t,e){return e.ref.mean_N<e.input_pole.N&&t.push(e),t}),[]);if(i.length>0){var n=i.map((function(t){return t.input_pole.name})).join(", ");e.push("the reference pole is computed from a lower number of sites than the input paleopole (N_ref < N) for entries: ".concat(n))}var r=t.results.reduce((function(t,e){return e.ref.mean_K<10&&t.push(e),t}),[]);if(r.length>0){var s=r.map((function(t){return t.input_pole.name})).join(", ");e.push("the reference pole is computed from re-sampled sites with (K < 10) for entires: ".concat(s))}return e}(t.state.activecalc),a=t.state.datasets.filter((function(t){return t.isdemo||"DEMO - South west Japan"===t.name||"DEMO - North east Japan"===t.name})).length>1;return r()("div",{class:"page rpdtool"},r()(Wf,null),r()("div",{class:"section explainer content_width_narrow_left"},r()("h2",null,"RPD Tool"),"The relative paleomagnetic displacement (RPD) tool allows the determination of displacements using the comparison metric that was introduced by ",r()("a",{href:"https://doi.org/10.1029/2022JB023953",target:"_blank"},"Vaes et al. (2022)"),".",r()("br",null),r()("br",null),"Download:",r()("br",null),r()("a",{href:ip},"Example input file (XSLX, contains both Japan datasets)"),r()("br",null),r()("a",{href:np},"Example input file (CSV, North East Japan)"),r()("br",null),r()("br",null),r()("br",null),r()($C,null,r()("h4",null,"What"),"Central to this approach is the comparison between an observed paleopole and a reference pole in which the number of paleomagnetic sites used to compute the paleopole is taken into consideration.",r()("br",null),"See paper for more detail:  ",r()("a",{href:"https://doi.org/10.1029/2022JB023953",target:"_blank"},r()("img",{src:"https://zenodo.org/badge/DOI/10.1029/2022JB023953.svg",alt:"DOI",style:"vertical-align: text-bottom;"})),r()("br",null),r()("br",null),r()("h4",null,"How"),"To compute relative displacements, quantified as vertical-axis rotations and paleolatitudinal displacements, you can choose an input dataset and a reference.",r()("br",null),r()("small",{class:"txt_default_lesser"},"Please be patient when calculating the displacements using many iterations."),r()("br",null),r()("br",null),r()("b",null,"The input dataset")," can be a compilation of paleopoles or a custom APWP earlier computed with the APWP tool.",r()("br",null),r()("br",null),r()("b",null,"As a reference"),", the global APWP of ",r()("a",{href:"#!/referencedatabase"},"Vaes et al. (2023)")," can be used in the coordinates of a major plate, the geographic pole, or a custom dataset.",r()("br",null),r()("br",null),r()("br",null),r()("h4",null,"Manual"),"See ",r()("a",{href:Of},"the user manual")," for more information on how to use the tools and the underlying methodology.")),r()("div",{class:"section content_width_standard"},r()("div",{class:"flex",style:"align-items: baseline;"},r()("h4",null,"Load input files"),r()("div",{class:"headermenu"},r()("button",{class:"btn_narrow ".concat(t.state.caclbusy?"disabled":""),onclick:function(){t.state.isOpen.datasetsBulk=!0}},r()("i",{class:"fa-solid fa-bars"})),r()(Af,{fillcontainer:!0,isOpen:t.state.isOpen.datasetsBulk,onClose:function(){t.state.isOpen.datasetsBulk=!1}},r()("div",{class:"menu"},r()("a",{onclick:function(){g.docstore.getAll().then((function(t){var e=g.general.serialize(t);g.general.downloadFile("paleolatitude_docstore.txt",e)})),t.state.isOpen.datasetsBulk=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-file-export fa-fw"})," Export all datasets to a file (experimental)"),r()("a",{onclick:function(){t.state.isOpen.clearDocStore=!0,t.state.isOpen.datasetsBulk=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-trash-can fa-fw"})," Remove all datasets"))),r()(dp,{isOpen:t.state.isOpen.clearDocStore,onAnswer:function(e){e&&function(t){g.docstore.clear(),iM(t)}(t),t.state.isOpen.clearDocStore=!1}},r()("h4",null,"Are you sure?"),"Removing all locally stored data can not be undone! All uploaded datasets and computation results will be lost.")),r()("span",{class:"txt_default_lesser"},r()("i",{class:"fa-light fa-circle-question"})," data will be stored and processed locally on your own machine.")),r()("div",{class:"datasetgrid"},r()("div",{class:"flexcolumn"},r()(vp,{onnewfile:function(){iM(t)}}),a?r()("center",null,r()("span",{class:"txt_default_lesser"},"Demo data is loaded")):r()("button",{onclick:function(){!function(t){var e=v.demodata.map((function(e){return t.state.datasets.find((function(t){return t.name===e.name}))?Promise.resolve():g.docstore.set("dataset",e)}));Promise.all(e).then((function(){iM(t)}))}(t)}},"Load in demo data")),t.state.datasets.map((function(e){var s,a;return r()(FC,{key:e.id,dataset:e,isref:(null===(s=i)||void 0===s?void 0:s.id)===e.id,isactive:(null===(a=t.state.activeset)||void 0===a?void 0:a.id)===e.id,onActivate:function(e){t.state.activeset=e,iM(t)},onDatasetchanged:function(e){iM(t)},disabled:n})})))),r()("div",{class:"section content_width_standard"},r()("div",{class:"flex",style:"align-items: baseline;"},r()("h4",null,"Calculations"),r()("span",{class:"txt_default_lesser"},r()("i",{class:"fa-light fa-circle-question"})," calculations will run locally on your own machine.")),r()("div",{class:"flex"},r()("div",{class:"settings"},r()(hp,{title:"Input dataset",value:g.sessionStorage.getOption("RPD_datasource"),options:m.RPD_datasource,disabled:n,onblur:function(t){"apwp"===t&&g.sessionStorage.setOption("RPD_ref_loc_type","one_ref_loc"),g.sessionStorage.setOption("RPD_datasource",t)}}),r()("div",{class:"flexequal"},r()(DC,{title:"Number of iterations",value:g.sessionStorage.getOption("RPD_Nb"),disabled:n,onblur:function(t){g.sessionStorage.setOption("RPD_Nb",parseFloat(t))}}),r()(DC,{title:"Time window (Ma)",value:g.sessionStorage.getOption("RPD_ref_window"),disabled:n,onblur:function(t){g.sessionStorage.setOption("RPD_ref_window",parseFloat(t))}})),r()("div",{class:"titlebar"},"apwp"===g.sessionStorage.getOption("RPD_datasource")?r()("div",null,r()("div",{key:"only_one_ref_loc"},r()(hp,{title:"Reference location",value:g.sessionStorage.getOption("RPD_ref_loc_type"),options:m.RPD_ref_loc_type.filter((function(t){return"one_ref_loc"===t.value})),disabled:n,onblur:function(t){g.sessionStorage.setOption("RPD_ref_loc_type",t)}}))):r()("div",null,r()("div",{key:"all_options"},r()(hp,{title:"Reference location",value:g.sessionStorage.getOption("RPD_ref_loc_type"),options:m.RPD_ref_loc_type,disabled:n,onblur:function(t){g.sessionStorage.setOption("RPD_ref_loc_type",t)}}))),"one_ref_loc"!==g.sessionStorage.getOption("RPD_ref_loc_type")?"":r().fragment([r()(DC,{title:"Longitude",value:g.sessionStorage.getOption("RPD_ref_loc_lon"),disabled:n,onblur:function(t){g.sessionStorage.setOption("RPD_ref_loc_lon",parseFloat(t))}}),r()(DC,{title:"Latitude",value:g.sessionStorage.getOption("RPD_ref_loc_lat"),disabled:n,onblur:function(t){g.sessionStorage.setOption("RPD_ref_loc_lat",parseFloat(t))}})])),r()("div",{class:"flex"},r()(hp,{title:"Choose reference",value:g.sessionStorage.getOption("RPD_ref_type"),options:m.RPD_ref_type,disabled:n,onblur:function(t){g.sessionStorage.setOption("RPD_ref_type",t)}}),"gapwap"!==g.sessionStorage.getOption("RPD_ref_type")?"":r()(hp,{title:"Reference plate",autowidth:!0,value:g.sessionStorage.getOption("RPD_Euler_poles"),options:m.RPD_Euler_poles,disabled:n,onblur:function(t){g.sessionStorage.setOption("RPD_Euler_poles",t)}}),"custom"!==g.sessionStorage.getOption("RPD_ref_type")?"":r()(hp,{title:"Reference set",autowidth:!0,value:g.sessionStorage.getOption("RPD_customref")||"none",options:[{label:"- Choose your own reference set -",value:"none"}].concat(t.state.datasets.map((function(t){return{label:t.name,value:t.id}}))),disabled:n,onblur:function(t){g.sessionStorage.setOption("RPD_customref",t)}})),r()("div",{class:"filler",style:"grid-row: span 3;"}),void 0===t.state.activeset?r()("span",{style:"align-self: end;",class:"txt_default_lesser"},r()("i",{class:"fa-solid fa-arrow-up"})," First, add or select a dataset"):t.state.caclbusy?r()("span",{style:"align-self: end;",class:"txt_default_lesser"},r()("i",{class:"txt_primary fa-solid fa-circle fa-fade"})," Busy with calculation..."):r()("button",{style:"align-self: end;",onclick:function(){!function(t,e,i){if(void 0===e)return;t.state.caclbusy=!0,t.state.calcerror=!1;var n=e.calculations.reduce((function(t,e){return"apwp"===e.type&&"done"===e.status&&void 0!==e.results&&e.results.length>0&&(void 0===t||t.created<e.created)&&(t=e),t}),void 0),r="apwp"===g.sessionStorage.getOption("RPD_datasource")?null==n?void 0:n.results:e.data.poles,s={ref_type:void 0,ref_poles:void 0};Qf.run("parsePaleoPoles",{source:r}).then((function(t){var e,n=g.sessionStorage.getOption("RPD_ref_type");return Qf.run("getReferencePoles",{ref_type:n,ref_source:null==i||null===(e=i.data)||void 0===e?void 0:e.poles}).then((function(e){return s.ref_type=n,s.ref_poles=e,t}))})).then((function(t){var e=null;return"one_ref_loc"===g.sessionStorage.getOption("RPD_ref_loc_type")&&(e=[g.sessionStorage.getOption("RPD_ref_loc_lon"),g.sessionStorage.getOption("RPD_ref_loc_lat")]),g.docstore.set("calculation",{type:"rpd",options:{paleopoles:t,ref_type:s.ref_type,ref_poles:s.ref_poles,Nb:g.sessionStorage.getOption("RPD_Nb"),ref_window:g.sessionStorage.getOption("RPD_ref_window"),ref_loc:e,ref_loc_type:g.sessionStorage.getOption("RPD_ref_loc_type"),Euler_poles:g.sessionStorage.getOption("RPD_Euler_poles"),startTime:Date.now()}})})).then((function(t){return t.status="busy",g.docstore.set("calculation",t),e.calculations.push(t.id),g.docstore.set("dataset",e),Qf.run("calcRPD",t.options).then((function(e){return t.results=e,t}))})).then((function(t){return t.calculationtime=Date.now()-t.options.startTime,t.status="done",g.docstore.set("calculation",t)})).then((function(e){t.state.caclbusy=!1,iM(t)})).catch((function(i){if(t.state.caclbusy=!1,t.state.calcerror=!0,console.error(i),i instanceof Error){var n=70;e.error=i.message.slice(0,n),i.message.length>n&&(e.error+="... (see the error console: "+localStorage.getItem("consoleShortcut")+")")}else e.error=i;iM(t)}))}(t,t.state.activeset,i)}},"Calculate displacements"),t.state.calcerror?r()("span",{style:"align-self: end;"},r()("i",{class:"txt_error fa-solid fa-triangle-exclamation fa-fade"})," ",r()("span",{class:"txt_error"},"The previous calculation might have failed"),r()("br",null),r()("span",{class:"txt_default_lesser"},"see the error console for more information (",localStorage.getItem("consoleShortcut"),")")):null),r()("div",{class:"activeset"},void 0===t.state.activeset?r()("div",{class:"emptymsg txt_default_lesser",key:"emptymsg"},r()("i",{class:"fa-solid fa-arrow-up-long"})," Add or select a dataset"):[r()("div",{class:"set",key:t.state.activeset.id},void 0!==i?r()("h4",null,"Dataset"):null,r()(FC,{dataset:t.state.activeset,showapwp:"apwp"===g.sessionStorage.getOption("RPD_datasource"),isref:(null===(e=i)||void 0===e?void 0:e.id)===t.state.activeset.id,isactive:!0,onActivate:function(e){t.state.activeset=e,iM(t)},onDatasetchanged:function(e){iM(t)},disabled:n})),void 0!==i&&i.id!==t.state.activeset.id?r()("div",{class:"set",key:i.id},r()("h4",null,"Reference set"),r()(FC,{dataset:i,showapwp:!1,isref:!0,onActivate:function(e){t.state.activeset=e,iM(t)},onDatasetchanged:function(e){iM(t)},disabled:n})):r()("div",{key:"0"})]))),void 0!==t.state.activecalc?void 0===t.state.activecalc.results[0].input_pole?r()("div",{class:"section content_width_standard"},r()("h4",null,"Your previous calculation was stored with an old data model"),"Please re-calculate to update the data model."):[r()("div",{class:"section content_width_standard",key:"0"},r()("div",{class:"flex",style:"align-items: baseline;"},r()("h4",null,"Rotation and displacement"),r()("span",{class:"txt_default_lesser"},"calculated in ",g.general.displayElapsedTime(t.state.activecalc.calculationtime),", ",r()("a",{href:"javascript:",onclick:function(){t.state.isOpen.calcSettings=!0}},"with these settings"))),r()("br",null),s.length>0?r()("div",{class:"warnings"},s.map((function(t){return r()("div",{class:"warning"},r()("i",{class:"fa-solid fa-triangle-exclamation"})," WARNING: ",t)}))):null,r()("div",{class:"flexequal"},r()(YC,{rpd:t.state.activecalc.results}),r()(GC,{rpd:t.state.activecalc.results}))),r()(dp,{isAlert:!0,isOpen:t.state.isOpen.calcSettings,onAnswer:function(){t.state.isOpen.calcSettings=!1},key:"1"},r()("h4",null,"Calculation settings"),"Number of iterations: ",t.state.activecalc.options.Nb,r()("br",null),"Time window: ",t.state.activecalc.options.ref_window,"Ma",r()("br",null),"Reference location: ",m.findLabel("RPD_ref_loc_type",t.state.activecalc.options.ref_loc_type),r()("br",null),"Date: ",g.general.displayFullDate(t.state.activecalc.options.startTime))]:null)}};function iM(t){g.docstore.getAll("dataset").then((function(e){var i=e.find((function(e){var i;return(null===(i=t.state.activeset)||void 0===i?void 0:i.id)===e.id}));return g.docstore.getFull("dataset",null==i?void 0:i.id).then((function(t){return[e,t]}))})).then((function(e){var i=QC(e,2),n=i[0],s=i[1];t.state.activeset=s,t.state.activecalc=null==s?void 0:s.calculations.filter((function(t){return"rpd"===t.type&&"done"===t.status})).sort((function(t,e){return e.created-t.created}))[0],t.state.datasets=n.sort((function(t,e){return t.created-e.created})),r().redraw()}))}var nM=i(9948),rM={insert:"head",singleton:!1};wf()(nM.Z,rM);nM.Z.locals;function sM(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,r,s,a,o=[],l=!0,h=!1;try{if(s=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=s.call(i)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(t){h=!0,r=t}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(h)throw r}}return o}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return aM(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return aM(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function aM(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var oM={oninit:function(t){t.state.activeset=void 0,t.state.activecalc=void 0,t.state.datasets=[],lM(t),t.state.isOpen={datasetsBulk:!1,clearDocStore:!1,calcSettings:!1}},view:function(t){var e=t.state.caclbusy,i=t.state.datasets.filter((function(t){return t.isdemo||"DEMO - South west Japan"===t.name||"DEMO - North east Japan"===t.name})).length>1;return r()("div",{class:"page apwptool"},r()(Wf,null),r()("div",{class:"section explainer content_width_narrow_left"},r()("h2",null,"APWP Tool"),"This tool allows you to compute an APWP based on site-level paleomagnetic data using the approach of ",r()("a",{href:"#!/referencedatabase"},"Vaes et al. (2023)"),".",r()("br",null),r()("br",null),"Download:",r()("br",null),r()("a",{href:ip},"Example input file (XSLX, contains both Japan datasets)"),r()("br",null),r()("a",{href:np},"Example input file (CSV, North East Japan)"),r()("br",null),r()("br",null),r()("br",null),r()($C,null,r()("h4",null,"What"),"This tool can be used to construct an APWP for any plate or terrane regardless of the age of rocks from which the data are derived, as long as the input data are provided in the coordinate system of the same plate or terrane.",r()("br",null),r()("br",null),r()("h4",null,"How"),"To compute an APWP, you can set the size of the time window, the time step at which the reference poles of the APWP are computed and the age range. You can also set the number of iterations used for the com­putation of the path and the estimation of its 95% confidence region.",r()("br",null),r()("small",{class:"txt_default_lesser"},"Please be patient when calculating an APWP using many iterations."),r()("br",null),r()("br",null),r()("h4",null,"Manual"),"See ",r()("a",{href:Of},"the user manual")," for more information on how to use the tools and the underlying methodology.")),r()("div",{class:"section content_width_standard"},r()("div",{class:"flex",style:"align-items: baseline;"},r()("h4",null,"Load input files"),r()("div",{class:"headermenu"},r()("button",{class:"btn_narrow ".concat(t.state.caclbusy?"disabled":""),onclick:function(){t.state.isOpen.datasetsBulk=!0}},r()("i",{class:"fa-solid fa-bars"})),r()(Af,{fillcontainer:!0,isOpen:t.state.isOpen.datasetsBulk,onClose:function(){t.state.isOpen.datasetsBulk=!1}},r()("div",{class:"menu"},r()("a",{onclick:function(){g.docstore.getAll().then((function(t){var e=g.general.serialize(t);g.general.downloadFile("paleolatitude_docstore.txt",e)})),t.state.isOpen.datasetsBulk=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-file-export fa-fw"})," Export all datasets to a file (experimental)"),r()("a",{onclick:function(){t.state.isOpen.clearDocStore=!0,t.state.isOpen.datasetsBulk=!1},href:"javascript:"},r()("i",{class:"fa-solid fa-trash-can fa-fw"})," Remove all datasets"))),r()(dp,{isOpen:t.state.isOpen.clearDocStore,onAnswer:function(e){e&&function(t){g.docstore.clear(),lM(t)}(t),t.state.isOpen.clearDocStore=!1}},r()("h4",null,"Are you sure?"),"Removing all locally stored data can not be undone! All uploaded datasets and computation results will be lost.")),r()("span",{class:"txt_default_lesser"},r()("i",{class:"fa-light fa-circle-question"})," data will be stored and processed locally on your own machine.")),r()("div",{class:"datasetgrid"},r()("div",{class:"flexcolumn"},r()(vp,{onnewfile:function(){lM(t)}}),i?r()("center",null,r()("span",{class:"txt_default_lesser"},"Demo data is loaded")):r()("button",{onclick:function(){!function(t){var e=v.demodata.map((function(e){return t.state.datasets.find((function(t){return t.name===e.name}))?Promise.resolve():g.docstore.set("dataset",e)}));Promise.all(e).then((function(){lM(t)}))}(t)}},"Load in demo data")),t.state.datasets.map((function(i){var n;return r()(FC,{key:i.id,dataset:i,isactive:(null===(n=t.state.activeset)||void 0===n?void 0:n.id)===i.id,onActivate:function(e){t.state.activeset=e,lM(t)},onDatasetchanged:function(e){lM(t)},disabled:e})})))),r()("div",{class:"section content_width_standard"},r()("div",{class:"flex",style:"align-items: baseline;"},r()("h4",null,"Calculations"),r()("span",{class:"txt_default_lesser"},r()("i",{class:"fa-light fa-circle-question"})," calculations will run locally on your own machine.")),r()("div",{class:"flex"},r()("div",{class:"settings"},r()("div",{class:"flexequal"},r()(DC,{title:"Window length (Ma)",value:g.sessionStorage.getOption("APWP_window_length"),disabled:e,onblur:function(t){g.sessionStorage.setOption("APWP_window_length",parseFloat(t))}}),r()(DC,{title:"Time step (Ma)",value:g.sessionStorage.getOption("APWP_time_step"),disabled:e,onblur:function(t){g.sessionStorage.setOption("APWP_time_step",parseFloat(t))}})),r()("div",{class:"flexequal"},r()(DC,{title:"Minimum age (Ma)",value:g.sessionStorage.getOption("APWP_t_min"),disabled:e,onblur:function(t){g.sessionStorage.setOption("APWP_t_min",parseFloat(t))}}),r()(DC,{title:"Maximum age (Ma)",value:g.sessionStorage.getOption("APWP_t_max"),disabled:e,onblur:function(t){g.sessionStorage.setOption("APWP_t_max",parseFloat(t))}})),r()(DC,{title:"Number of iterations",value:g.sessionStorage.getOption("APWP_Nb"),disabled:e,onblur:function(t){g.sessionStorage.setOption("APWP_Nb",parseFloat(t))}}),r()("div",{class:"filler",style:"grid-row: span 3;"}),void 0===t.state.activeset?r()("span",{style:"align-self: end;",class:"txt_default_lesser"},r()("i",{class:"fa-solid fa-arrow-up"})," First, add or select a dataset"):t.state.caclbusy?r()("span",{style:"align-self: end;",class:"txt_default_lesser"},r()("i",{class:"txt_primary fa-solid fa-circle fa-fade"})," Busy with calculation..."):r()("button",{style:"align-self: end;",onclick:function(){!function(t,e){if(void 0===e)return;t.state.caclbusy=!0,t.state.calcerror=!1,Qf.run("parsePaleoPoles",{source:e.data.poles}).then((function(t){return g.docstore.set("calculation",{type:"apwp",options:{paleopoles:t,window_length:g.sessionStorage.getOption("APWP_window_length"),time_step:g.sessionStorage.getOption("APWP_time_step"),t_min:g.sessionStorage.getOption("APWP_t_min"),t_max:g.sessionStorage.getOption("APWP_t_max"),Nb:g.sessionStorage.getOption("APWP_Nb"),startTime:Date.now()}})})).then((function(t){return t.status="busy",g.docstore.set("calculation",t),e.calculations.push(t.id),g.docstore.set("dataset",e),Qf.run("calcAPWP",t.options).then((function(e){return t.results=e,t}))})).then((function(t){return t.calculationtime=Date.now()-t.options.startTime,t.status="done",g.docstore.set("calculation",t)})).then((function(e){t.state.caclbusy=!1,lM(t)})).catch((function(i){if(t.state.caclbusy=!1,t.state.calcerror=!0,console.error(i),i instanceof Error){var n=70;e.error=i.message.slice(0,n),i.message.length>n&&(e.error+="... (see the error console: "+localStorage.getItem("consoleShortcut")+")")}else e.error=i;lM(t)}))}(t,t.state.activeset)}},"Calculate APWP"),t.state.calcerror?r()("span",{style:"align-self: end;"},r()("i",{class:"txt_error fa-solid fa-triangle-exclamation fa-fade"})," ",r()("span",{class:"txt_error"},"The previous calculation might have failed"),r()("br",null),r()("span",{class:"txt_default_lesser"},"see the error console for more information (",localStorage.getItem("consoleShortcut"),")")):null),r()("div",{class:"activeset"},void 0===t.state.activeset?r()("div",{class:"emptymsg txt_default_lesser",key:"emptymsg"},r()("i",{class:"fa-solid fa-arrow-up-long"})," Add or select a dataset"):r()("div",{class:"set",key:t.state.activeset.id},r()(FC,{dataset:t.state.activeset,showapwp:!1,isactive:!0,onActivate:function(e){t.state.activeset=e,lM(t)},onDatasetchanged:function(e){lM(t)},disabled:e}))))),void 0!==t.state.activecalc?[r()("div",{class:"section content_width_standard",key:"0"},r()("div",{class:"flex",style:"align-items: baseline;"},r()("h4",null,"Calculated APWP"),r()("span",{class:"txt_default_lesser"},"calculated in ",g.general.displayElapsedTime(t.state.activecalc.calculationtime),", ",r()("a",{href:"javascript:",onclick:function(){t.state.isOpen.calcSettings=!0}},"with these settings"))),r()("br",null),r()(EC,{path:t.state.activecalc.results,projection:m.find("mapProjection","EPSG:3575"),width:"100%",height:"80vh",controls:!0,exportName:t.state.activeset.name})),r()(dp,{isAlert:!0,isOpen:t.state.isOpen.calcSettings,onAnswer:function(){t.state.isOpen.calcSettings=!1},key:"1"},r()("h4",null,"Calculation settings"),"Window length: ",t.state.activecalc.options.window_length,"Ma",r()("br",null),"Time step: ",t.state.activecalc.options.time_step,"Ma",r()("br",null),"Minimum age: ",t.state.activecalc.options.t_min,"Ma",r()("br",null),"Maximum age: ",t.state.activecalc.options.t_max,"Ma",r()("br",null),"Number of iterations: ",t.state.activecalc.options.Nb,r()("br",null),"Date: ",g.general.displayFullDate(t.state.activecalc.options.startTime))]:null)}};function lM(t){g.docstore.getAll("dataset").then((function(e){var i=e.find((function(e){var i;return(null===(i=t.state.activeset)||void 0===i?void 0:i.id)===e.id}));return g.docstore.getFull("dataset",null==i?void 0:i.id).then((function(t){return[e,t]}))})).then((function(e){var i=sM(e,2),n=i[0],s=i[1];t.state.activeset=s,t.state.activecalc=null==s?void 0:s.calculations.filter((function(t){return"apwp"===t.type&&"done"===t.status})).sort((function(t,e){return e.created-t.created}))[0],t.state.datasets=n.sort((function(t,e){return t.created-e.created})),r().redraw()}))}var hM=i(7843),cM={insert:"head",singleton:!1};wf()(hM.Z,cM);hM.Z.locals;var uM={oninit:function(t){t.state.form={name:"",institute:"",data:[],email:"",about:"",publication:""}},onremove:function(t){},view:function(t){return r()("div",{class:"page referencedatabase"},r()("div",{class:"section content_width_standard flexequal"},r()("div",null,r()("h2",null,"Reference Database"),"This portal hosts the reference database that underpins the global APWP for the last 320 Ma from Vaes et al. (2023).",r()("br",null),r()("br",null),"Below, the most recent version of the global APWP – in the coordinate frame of all major tectonic plates - can be accessed and downloaded, as well as the paleomagnetic database and the global plate circuit, which underlie the computation of the APWP. This portal provides a platform where future updates of the global APWP will be made available."),r()("div",{class:"GAPWP23"},r()("img",{src:"/dist/assets/images/global_APWP.png"}))),r()("div",{class:"section content_width_standard"},r()("h2",null,"Version history Global APWP"),r()("div",{class:"versions"},r()("div",{class:"txt_primary"},"Name"),r()("div",{class:"txt_primary mobile_hidden"},"Publication date"),r()("div",{class:"txt_primary mobile_hidden"},"Authors"),r()("div",{class:"txt_primary"},"DOI"),r()("div",{class:"txt_primary"},"Download model"),r()("div",null,"gAPWP23"),r()("div",{class:"mobile_hidden"},"22 september 2023"),r()("div",{class:"mobile_hidden"},"Bram Vaes et al."),r()("a",{href:"https://doi.org/10.1016/j.earscirev.2023.104547",target:"_blank"},r()("img",{src:"https://zenodo.org/badge/DOI/10.1016/j.earscirev.2023.104547.svg",alt:"DOI"})),r()("div",null,r()("a",{href:"/dist/assets/resources/Vaes_et_al_2023_global_APWP.zip"},"Download zip (367 kB)")))),r()("div",{class:"section content_width_standard"},r()("h2",null,"Contribute to the next global APWP"),r()("div",{class:"content_width_narrow_left"},"We encourage researchers to submit new, high-quality paleomagnetic data obtained from stable plate interiors – after publication in a peer-reviewed journal – that may be included in the database. We also welcome new age data that provides better constraints on the rock and/or magnetization age of the paleomagnetic data that is included in the database.",r()("br",null),r()("br",null),r()("h4",null,"How to submit your data"),"Send us an email on:",r()("br",null),r()("br",null),r()("center",null,r()("h2",null,r()("a",{href:"mailto:info@apwp-online.org"},"info@apwp-online.org"))),r()("br",null),r()("br",null),"Please provide:",r()("ul",null,r()("li",null,"The dataset, preferable in a format APWP-online.org accepts"),r()("li",null,"A description of the data"),r()("li",null,"A reference/link to publication"),r()("li",null,"Your affiliated institute")))))}},dM=i(4168),fM={insert:"head",singleton:!1};wf()(dM.Z,fM);dM.Z.locals;var pM={oninit:function(t){t.state.isOpen={clearDocStore:!1}},onremove:function(t){},view:function(t){return r()("div",{class:"page about"},r()("div",{class:"section explainer content_width_narrow_left"},r()("h2",null,"About APWP-online"),"User-friendly tools to compute apparent polar wander paths (APWPs) from site-level paleomagnetic data and to determine relative paleomagnetic displacements.",r()("br",null),r()("br",null),"For more information see our papers:",r()("br",null),r()("a",{href:"https://doi.org/10.55575/tektonika2024.2.1.44",target:"_blank"},r()("img",{src:"https://zenodo.org/badge/DOI/10.55575/tektonika2024.2.1.44.svg",alt:"DOI",style:"vertical-align: text-bottom;"})," about apwp-online.org. (2024)",r()("br",null)),r()("a",{href:"https://doi.org/10.1016/j.earscirev.2023.104547",target:"_blank"},r()("img",{src:"https://zenodo.org/badge/DOI/10.1016/j.earscirev.2023.104547.svg",alt:"DOI",style:"vertical-align: text-bottom;"})," about the global APWP (2023)",r()("br",null)),r()("a",{href:"https://doi.org/10.1029/2022JB023953",target:"_blank"},r()("img",{src:"https://zenodo.org/badge/DOI/10.1029/2022JB023953.svg",alt:"DOI",style:"vertical-align: text-bottom;"})," about the statistical methods. (2022)",r()("br",null))),r()("div",{class:"section content_width_standard flexequal"},r()("div",null,r()("h3",null,"How to cite"),"When using apwp-online.org for your research, please cite our work. The following citation is suggested:",r()("span",null,r()("blockquote",null,"Vaes, B., van Hinsbergen, D., & Paridaens, J. (2024). APWP-online.org: a Global Reference Database and Open-Source Tools for Calculating Apparent Polar Wander Paths and Relative Paleomagnetic Displacements. τeκτoniκa, 2(1), 173–188. https://doi.org/10.55575/tektonika2024.2.1.44")),r()("br",null),r()("br",null),r()("h3",null,"Code and Data"),r()("span",null,"If you use apwp-online.org and/or its source code for research purposes, we kindly ask you to cite our work. The code and data licenses are detailed below."),r()("br",null),r()("br",null),r()("h4",null,"Source code license"),r()("span",null,"All source code of apwp-online.org is available under the GNU General Public License v3. This license allows for free use and redistribution of the source code."),r()("br",null),r()("br",null),r()("b",null,"The source code of this webapplication:"),r()("a",{href:"https://github.com/oogie/apwp-online",class:"unobtrusive",target:"_blank"},r()("div",{class:"githubpromo flex"},r()("i",{class:"fa-brands fa-github fa-5x"}),r()("span",null,r()("a",{href:"https://github.com/oogie/apwp-online",target:"_blank"},"github.com/oogie/apwp-online"),r()("br",null),r()("small",{class:"txt_default_lesser"},"@oogie - Joren Paridaens")))),r()("br",null),r()("div",{class:"section"},r()("h3",null,"Locally stored data"),r()("span",null,"Imported datasets and computation results are stored locally in your browser. This data is not shared with any one other than you.",r()("br",null),r()("br",null),r()("button",{class:"btn",onclick:function(e){t.state.isOpen.clearDocStore=!0}},"Delete all locally stored data"),r()(dp,{isOpen:t.state.isOpen.clearDocStore,onAnswer:function(e){!function(t,e){e&&g.docstore.clear();t.state.isOpen.clearDocStore=!1,r().redraw()}(t,e)}},r()("h4",null,"Are you sure?"),"Removing all locally stored data can not be undone! All uploaded datasets and computation results will be lost."))),r()("div",{class:"section changelog"},r()("h3",null,"Changelog"),r()("div",{class:"versionheader"},r()("h4",null,"Version 1.2"),r()("span",null,"— May 2024")),r()("ul",null,r()("li",null,"Updated: the user manual"),r()("li",null,"Added: slat, slon and name columns to the xlsx/csv output of the APWP tool"),r()("li",null,"Added: the ability to use the output files of the APWP tool as input dataset"),r()("li",null,"Fixed: the demo data can no longer be loaded in multiple times"),r()("li",null,"Fixed: a python runtime error when the input columns lithology or plateID missing"),r()("li",null,"Fixed: various small textual errors throughout the website")),r()("div",{class:"versionheader"},r()("h4",null,"Version 1.1"),r()("span",null,"— Feb 2024")),r()("ul",null,r()("li",null,"Added: the user manual"),r()("li",null,"Added: the values ref_dec ref_inc ref_mean_N ref_mean_K to the output of the RDP tool"),r()("li",null,"Added: the RDP tool will give a warning when ",r()("code",null,"N_ref < N")," or ",r()("code",null,"K < 10")," for any pole"),r()("li",null,"Added: option to import and export with .csv files"),r()("li",null,"Added: better input validation and error messages"),r()("li",null,"Fixed: any setting where the input was ",r()("code",null,"0")," was set to the default (e.g. Minimum age became 5ma instead of 0ma)"),r()("li",null,"Fixed: the reference data of the plate 101 (North America) was only available up until 100ma, this is now up to 320ma"),r()("li",null,"Fixed: various small textual errors throughout the website")),r()("div",{class:"versionheader"},r()("h4",null,"Version 1.0"),r()("span",null,"— May 2023")),r()("ul",null,r()("li",null,"Beta release of version 1.0")))),r()("div",null,r()("h3",null,"GAPWaP-Database Steering Committee"),"A steering committee will once a year update the paleomagnetic database behind the global APWP that is running on this website. Once this is done, a new version of the APWP will be published on this site, and if significant changes occur, an accompanying peer-reviewed publication will follow.",r()("br",null),r()("br",null),"The members of the 2024 committee will be appointed soon and listed here.",r()("div",{class:"section"},r()("h3",null,"APWP-Online development team"),r()("br",null),r()("span",null,gM,mM,vM)))))}},gM=r()("div",{class:"teammember"},r()("h4",null,"Bram Vaes"),r()("img",{src:"/dist/assets/images/Vaes.jpg"}),r()("span",null,"Bram currently works as a postdoctoral researcher in the Coupled Earth Systems Group at the University of Milano-Bicocca, studying the interactions between tectonics and climate in the Cenozoic. Bram obtained his PhD in June 2023 at Utrecht University, during which he developed a new approach to using paleomagnetism for tectonic and paleogeographic applications. The main result of his project is a global apparent polar wander path that serves as a paleomagnetic reference frame for paleogeograpy, paleoclimate and tectonic studies.")),mM=r()("div",{class:"teammember"},r()("h4",null,"Douwe J.J. van Hinsbergen"),r()("img",{src:"/dist/assets/images/Hinsbergen.jpg"}),r()("span",null,"Douwe received his PhD degree in Geology from Utrecht University in 2004, subsequently worked at universities in the UK and Norway, and is currently Full Professor, Chair in Global Tectonics and Paleogeography in Utrecht. He specializes in plate and paleogeography reconstructions, especially of intensely deformed convergent margins, and has a taste for developing quantitative online tools for paleomagnetism, paleogeography, and mantle dynamics.")),vM=r()("div",{class:"teammember"},r()("h4",null,"Joren Paridaens"),r()("img",{src:"/dist/assets/images/Paridaens.jpg"}),r()("span",null,"Since 2015 Joren is working with various companies and academic institutions to develop large or specialised webapplications as a freelancer. With a wide range of experience in webdevelopment, design and project management he is always up for a conversations about your interesting problem."));var yM,bM,_M,xM,wM=i(8393),SM=i.n(wM),TM=i(4625),EM=i.n(TM),kM=i(7732),CM=i.n(kM),MM=new bf({projectId:497187,projectKey:"180e3dd16a3d2a17ad103a863d107b85",environment:"production"});function AM(t,e,i){"localhost"!==window.location.hostname&&(console.log("Notify airbrake"),void 0!==MM&&MM.notify({error:t,params:{source:e,lineno:i,siteversion:v.version}}))}window.onunhandledrejection=function(t){var e;console.log("ERROR (catched at 1)",t),AM(void 0!==t?null!==(e=t.reason)&&void 0!==e?e:t:"Unhandled promise rejection, no error event object")},console.error=function(t){console.log("ERROR (catched at 2)",t),AM(t)},window.addEventListener("error",(function(t){var e;console.log("ERROR (catched at 3)",null==t?void 0:t.message),AM(void 0!==t?null!==(e=t.message)&&void 0!==e?e:t:"Unhandled error, no error event object")})),window.onerror=function(t,e,i,n,r){return console.log("ERROR (catched at 4)",t),AM(t,e,i),!0},WC().SVGRenderer.prototype.symbols.hline=function(t,e,i,n,r){return["M",t,e+n/2,"H",t+i+r.lineWidth]},WC().SVGRenderer.prototype.symbols.vline=function(t,e,i,n,r){return["M",t+i/2,e,"V",e+n+r.lineWidth]},SM()(WC()),EM()(WC()),CM()(WC()),yM=navigator.userAgent,bM=yM.match(/edg/i)?"edge":yM.match(/chrome|chromium|crios/i)?"chrome":yM.match(/firefox|fxios/i)?"firefox":yM.match(/safari/i)?"safari":yM.match(/opr\//i)?"opera":"",_M=-1!==yM.search("Mac")?"mac":"notmac",xM=("mac"===_M?"Cmd + Opt + ":"Ctrl + Shift + ")+("firefox"===bM?"K":"safari"===bM?"C":"opera"===bM?"I":"J"),localStorage.setItem("browserName",bM),localStorage.setItem("systemName",_M),localStorage.setItem("consoleShortcut",xM),console.log(bM,_M,xM),function(){function t(t){window.scroll(0,0);var e=document.querySelector(":root");e.style.setProperty("--txt_primary","#0F583E"),e.style.setProperty("--elm_primary","#0F583E"),e.style.setProperty("--elm_secondary","#0F583E")}r().mount(document.getElementById("header"),Pf),r().mount(document.getElementById("footer"),Lf),r().route(document.getElementById("app"),"/",{"/":{onmatch:function(){return t(),Ff}},"/rpdtool":{onmatch:function(){return t(),eM}},"/apwptool":{onmatch:function(){return t(),oM}},"/referencedatabase":{onmatch:function(){return t(),uM}},"/about":{onmatch:function(){return t(),pM}}})}()},7424:(t,e,i)=>{t.exports={RBTree:i(2448),BinTree:i(9675)}},9675:(t,e,i)=>{var n=i(5301);function r(t){this.data=t,this.left=null,this.right=null}function s(t){this._root=null,this._comparator=t,this.size=0}r.prototype.get_child=function(t){return t?this.right:this.left},r.prototype.set_child=function(t,e){t?this.right=e:this.left=e},s.prototype=new n,s.prototype.insert=function(t){if(null===this._root)return this._root=new r(t),this.size++,!0;for(var e=0,i=null,n=this._root;;){if(null===n)return n=new r(t),i.set_child(e,n),ret=!0,this.size++,!0;if(0===this._comparator(n.data,t))return!1;e=this._comparator(n.data,t)<0,i=n,n=n.get_child(e)}},s.prototype.remove=function(t){if(null===this._root)return!1;var e=new r(void 0),i=e;i.right=this._root;for(var n=null,s=null,a=1;null!==i.get_child(a);){n=i,i=i.get_child(a);var o=this._comparator(t,i.data);a=o>0,0===o&&(s=i)}return null!==s&&(s.data=i.data,n.set_child(n.right===i,i.get_child(null===i.left)),this._root=e.right,this.size--,!0)},t.exports=s},2448:(t,e,i)=>{var n=i(5301);function r(t){this.data=t,this.left=null,this.right=null,this.red=!0}function s(t){this._root=null,this._comparator=t,this.size=0}function a(t){return null!==t&&t.red}function o(t,e){var i=t.get_child(!e);return t.set_child(!e,i.get_child(e)),i.set_child(e,t),t.red=!0,i.red=!1,i}function l(t,e){return t.set_child(!e,o(t.get_child(!e),!e)),o(t,e)}r.prototype.get_child=function(t){return t?this.right:this.left},r.prototype.set_child=function(t,e){t?this.right=e:this.left=e},s.prototype=new n,s.prototype.insert=function(t){var e=!1;if(null===this._root)this._root=new r(t),e=!0,this.size++;else{var i=new r(void 0),n=0,s=0,h=null,c=i,u=null,d=this._root;for(c.right=this._root;;){if(null===d?(d=new r(t),u.set_child(n,d),e=!0,this.size++):a(d.left)&&a(d.right)&&(d.red=!0,d.left.red=!1,d.right.red=!1),a(d)&&a(u)){var f=c.right===h;d===u.get_child(s)?c.set_child(f,o(h,!s)):c.set_child(f,l(h,!s))}var p=this._comparator(d.data,t);if(0===p)break;s=n,n=p<0,null!==h&&(c=h),h=u,u=d,d=d.get_child(n)}this._root=i.right}return this._root.red=!1,e},s.prototype.remove=function(t){if(null===this._root)return!1;var e=new r(void 0),i=e;i.right=this._root;for(var n=null,s=null,h=null,c=1;null!==i.get_child(c);){var u=c;s=n,n=i,i=i.get_child(c);var d=this._comparator(t,i.data);if(c=d>0,0===d&&(h=i),!a(i)&&!a(i.get_child(c)))if(a(i.get_child(!c))){var f=o(i,c);n.set_child(u,f),n=f}else if(!a(i.get_child(!c))){var p=n.get_child(!u);if(null!==p)if(a(p.get_child(!u))||a(p.get_child(u))){var g=s.right===n;a(p.get_child(u))?s.set_child(g,l(n,u)):a(p.get_child(!u))&&s.set_child(g,o(n,u));var m=s.get_child(g);m.red=!0,i.red=!0,m.left.red=!1,m.right.red=!1}else n.red=!1,p.red=!0,i.red=!0}}return null!==h&&(h.data=i.data,n.set_child(n.right===i,i.get_child(null===i.left)),this.size--),this._root=e.right,null!==this._root&&(this._root.red=!1),null!==h},t.exports=s},5301:t=>{function e(){}function i(t){this._tree=t,this._ancestors=[],this._cursor=null}e.prototype.clear=function(){this._root=null,this.size=0},e.prototype.find=function(t){for(var e=this._root;null!==e;){var i=this._comparator(t,e.data);if(0===i)return e.data;e=e.get_child(i>0)}return null},e.prototype.findIter=function(t){for(var e=this._root,i=this.iterator();null!==e;){var n=this._comparator(t,e.data);if(0===n)return i._cursor=e,i;i._ancestors.push(e),e=e.get_child(n>0)}return null},e.prototype.lowerBound=function(t){for(var e=this._root,i=this.iterator(),n=this._comparator;null!==e;){var r=n(t,e.data);if(0===r)return i._cursor=e,i;i._ancestors.push(e),e=e.get_child(r>0)}for(var s=i._ancestors.length-1;s>=0;--s)if(n(t,(e=i._ancestors[s]).data)<0)return i._cursor=e,i._ancestors.length=s,i;return i._ancestors.length=0,i},e.prototype.upperBound=function(t){for(var e=this.lowerBound(t),i=this._comparator;null!==e.data()&&0===i(e.data(),t);)e.next();return e},e.prototype.min=function(){var t=this._root;if(null===t)return null;for(;null!==t.left;)t=t.left;return t.data},e.prototype.max=function(){var t=this._root;if(null===t)return null;for(;null!==t.right;)t=t.right;return t.data},e.prototype.iterator=function(){return new i(this)},e.prototype.each=function(t){for(var e,i=this.iterator();null!==(e=i.next());)if(!1===t(e))return},e.prototype.reach=function(t){for(var e,i=this.iterator();null!==(e=i.prev());)if(!1===t(e))return},i.prototype.data=function(){return null!==this._cursor?this._cursor.data:null},i.prototype.next=function(){if(null===this._cursor){var t=this._tree._root;null!==t&&this._minNode(t)}else{var e;if(null===this._cursor.right)do{if(e=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.right===e);else this._ancestors.push(this._cursor),this._minNode(this._cursor.right)}return null!==this._cursor?this._cursor.data:null},i.prototype.prev=function(){if(null===this._cursor){var t=this._tree._root;null!==t&&this._maxNode(t)}else{var e;if(null===this._cursor.left)do{if(e=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.left===e);else this._ancestors.push(this._cursor),this._maxNode(this._cursor.left)}return null!==this._cursor?this._cursor.data:null},i.prototype._minNode=function(t){for(;null!==t.left;)this._ancestors.push(t),t=t.left;this._cursor=t},i.prototype._maxNode=function(t){for(;null!==t.right;)this._ancestors.push(t),t=t.right;this._cursor=t},t.exports=e},4098:function(t,e){var i="undefined"!=typeof self?self:this,n=function(){function t(){this.fetch=!1,this.DOMException=i.DOMException}return t.prototype=i,new t}();!function(t){!function(e){var i="URLSearchParams"in t,n="Symbol"in t&&"iterator"in Symbol,r="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),s="FormData"in t,a="ArrayBuffer"in t;if(a)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(t){return t&&o.indexOf(Object.prototype.toString.call(t))>-1};function h(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function c(t){return"string"!=typeof t&&(t=String(t)),t}function u(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return n&&(e[Symbol.iterator]=function(){return e}),e}function d(t){this.map={},t instanceof d?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function f(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(t){return new Promise((function(e,i){t.onload=function(){e(t.result)},t.onerror=function(){i(t.error)}}))}function g(t){var e=new FileReader,i=p(e);return e.readAsArrayBuffer(t),i}function m(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:r&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:s&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:i&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():a&&r&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=m(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(t)||l(t))?this._bodyArrayBuffer=m(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r&&(this.blob=function(){var t=f(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var t,e,i,n=f(this);if(n)return n;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,i=p(e),e.readAsText(t),i;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),i=new Array(e.length),n=0;n<e.length;n++)i[n]=String.fromCharCode(e[n]);return i.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(t,e){t=h(t),e=c(e);var i=this.map[t];this.map[t]=i?i+", "+e:e},d.prototype.delete=function(t){delete this.map[h(t)]},d.prototype.get=function(t){return t=h(t),this.has(t)?this.map[t]:null},d.prototype.has=function(t){return this.map.hasOwnProperty(h(t))},d.prototype.set=function(t,e){this.map[h(t)]=c(e)},d.prototype.forEach=function(t,e){for(var i in this.map)this.map.hasOwnProperty(i)&&t.call(e,this.map[i],i,this)},d.prototype.keys=function(){var t=[];return this.forEach((function(e,i){t.push(i)})),u(t)},d.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),u(t)},d.prototype.entries=function(){var t=[];return this.forEach((function(e,i){t.push([i,e])})),u(t)},n&&(d.prototype[Symbol.iterator]=d.prototype.entries);var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(t,e){var i,n,r=(e=e||{}).body;if(t instanceof b){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new d(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,r||null==t._bodyInit||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new d(e.headers)),this.method=(i=e.method||this.method||"GET",n=i.toUpperCase(),y.indexOf(n)>-1?n:i),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function _(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var i=t.split("="),n=i.shift().replace(/\+/g," "),r=i.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(r))}})),e}function x(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new d(e.headers),this.url=e.url||"",this._initBody(t)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},v.call(b.prototype),v.call(x.prototype),x.prototype.clone=function(){return new x(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},x.error=function(){var t=new x(null,{status:0,statusText:""});return t.type="error",t};var w=[301,302,303,307,308];x.redirect=function(t,e){if(-1===w.indexOf(e))throw new RangeError("Invalid status code");return new x(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(t,e){this.message=t,this.name=e;var i=Error(t);this.stack=i.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function S(t,i){return new Promise((function(n,s){var a=new b(t,i);if(a.signal&&a.signal.aborted)return s(new e.DOMException("Aborted","AbortError"));var o=new XMLHttpRequest;function l(){o.abort()}o.onload=function(){var t,e,i={status:o.status,statusText:o.statusText,headers:(t=o.getAllResponseHeaders()||"",e=new d,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var i=t.split(":"),n=i.shift().trim();if(n){var r=i.join(":").trim();e.append(n,r)}})),e)};i.url="responseURL"in o?o.responseURL:i.headers.get("X-Request-URL");var r="response"in o?o.response:o.responseText;n(new x(r,i))},o.onerror=function(){s(new TypeError("Network request failed"))},o.ontimeout=function(){s(new TypeError("Network request failed"))},o.onabort=function(){s(new e.DOMException("Aborted","AbortError"))},o.open(a.method,a.url,!0),"include"===a.credentials?o.withCredentials=!0:"omit"===a.credentials&&(o.withCredentials=!1),"responseType"in o&&r&&(o.responseType="blob"),a.headers.forEach((function(t,e){o.setRequestHeader(e,t)})),a.signal&&(a.signal.addEventListener("abort",l),o.onreadystatechange=function(){4===o.readyState&&a.signal.removeEventListener("abort",l)}),o.send(void 0===a._bodyInit?null:a._bodyInit)}))}S.polyfill=!0,t.fetch||(t.fetch=S,t.Headers=d,t.Request=b,t.Response=x),e.Headers=d,e.Request=b,e.Response=x,e.fetch=S,Object.defineProperty(e,"__esModule",{value:!0})}({})}(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var r=n;(e=r.fetch).default=r.fetch,e.fetch=r.fetch,e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response,t.exports=e},7991:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,':root {\n  --txt_primary: #293971;\n  --elm_primary: #293971;\n  --elm_secondary: #E63946;\n}\n.comp.dataset {\n  border-radius: 10px;\n  position: relative;\n}\n.comp.dataset.isactive .card {\n  background: var(--elm_primary);\n}\n.comp.dataset.isactive .card,\n.comp.dataset.isactive .card a,\n.comp.dataset.isactive .card h4 {\n  color: #fff;\n}\n.comp.dataset.isref:after {\n  border-radius: 10px;\n  content: "";\n  display: block;\n  height: 100%;\n  left: 0;\n  outline: 8px solid var(--elm_primary);\n  outline-offset: -7px;\n  pointer-events: none;\n  position: absolute;\n  top: 0;\n  width: 100%;\n}\n.comp.dataset.isactive.isref:after {\n  outline-color: #E63946;\n}\n.comp.dataset .card {\n  border-radius: 10px;\n  box-shadow: 2px 2px 6px #888;\n  display: flex;\n  flex-direction: row-reverse;\n}\n.comp.dataset .card .noapwp {\n  display: flex;\n  flex-direction: column;\n  height: 15rem;\n  justify-content: center;\n  padding-right: 1rem;\n  width: 100%;\n}\n.comp.dataset .card .ol-viewport,\n.comp.dataset .card .polarmap {\n  border-radius: 0 10px 10px 0;\n  left: 0.2px;\n}\n.comp.dataset .card .info {\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n  width: 100%;\n  word-break: break-word;\n}\n.comp.dataset .card .info > * {\n  line-height: 1em;\n}\n.comp.dataset .card .activate_button {\n  font-size: 0.8rem;\n}\n.comp.dataset .menu_button {\n  font-size: 0.8rem;\n  position: absolute;\n  right: 1rem;\n  top: 1rem;\n}\n.comp.dataset .positionaldialog {\n  position: absolute;\n  right: 1rem;\n  top: 3rem;\n}\n.comp.dataset .positionaldialog .menu {\n  flex-direction: column;\n  line-height: 2rem;\n  padding: 1rem;\n}\n.comp.dataset .positionaldialog .menu,\n.comp.dataset .positionaldialog a {\n  display: flex;\n}\n.comp.dataset .positionaldialog a {\n  align-items: center;\n  gap: 0.7ch;\n  justify-content: left;\n}\n',""]);const s=r},1493:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,"",""]);const s=r},3017:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,".comp.polarmap {\n  position: relative;\n}\n.comp.polarmap #polarmap {\n  height: 50rem;\n  width: 100%;\n}\n.comp.polarmap .locMarker {\n  pointer-events: none;\n}\n.comp.polarmap .locMarker .icon {\n  font-size: 0.6rem;\n}\n.comp.polarmap .export_button {\n  font-size: 0.8rem;\n  position: absolute;\n  right: 1rem;\n  top: 1rem;\n}\n.comp.polarmap .ol-attribution {\n  line-height: 1rem;\n}\n.comp.polarmap .ol-attribution a {\n  color: var(--ol-subtle-foreground-color) !important;\n}\n.comp.polarmap .positionaldialog {\n  position: absolute;\n  right: 1rem;\n  top: 3rem;\n}\n.comp.polarmap .positionaldialog .menu {\n  display: flex;\n  flex-direction: column;\n  line-height: 2rem;\n  padding: 1rem;\n}\n.comp.polarmap .positionaldialog .menu a {\n  align-items: center;\n  display: flex;\n  gap: 0.7ch;\n  justify-content: left;\n}\n.comp.polarmap .positionaldialog .menu .spacer {\n  height: 1rem;\n}\n",""]);const s=r},4168:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,".page.about .section {\n  gap: 80px;\n}\n.page.about .githubpromo {\n  align-items: center;\n  justify-content: center;\n  margin: 3rem 0;\n}\n.page.about .versionheader {\n  align-items: center;\n  display: flex;\n  gap: 1rem;\n}\n.page.about .versionheader + ul {\n  margin-bottom: 5rem;\n}\n.page.about .showmore {\n  margin: 0 auto;\n}\n.page.about .teammember {\n  margin-bottom: 5rem;\n  min-height: 12rem;\n  position: relative;\n}\n.page.about .teammember img {\n  float: right;\n  height: 11rem;\n  margin-left: 1rem;\n  -o-object-fit: cover;\n  object-fit: cover;\n  width: 8rem;\n}\n.page.about .changelog li,\n.page.about .changelog ul {\n  margin-top: 0;\n}\n",""]);const s=r},9948:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,":root {\n  --txt_primary: #293971;\n  --elm_primary: #293971;\n  --elm_secondary: #E63946;\n}\n.page.apwptool .showmore {\n  float: right;\n}\n.page.apwptool .datasetgrid {\n  display: grid;\n  gap: 2rem;\n  grid-template-columns: 1fr 1fr 1fr;\n}\n@media only screen and (max-width: 1000px) {\n  .page.apwptool .datasetgrid {\n    grid-template-columns: 1fr 1fr;\n  }\n}\n@media only screen and (max-width: 600px) {\n  .page.apwptool .datasetgrid {\n    grid-template-columns: 1fr;\n  }\n}\n.page.apwptool .headermenu {\n  margin: 0 1rem 0 -0.6rem;\n  position: relative;\n}\n.page.apwptool .headermenu > button {\n  font-size: 0.8rem;\n}\n.page.apwptool .headermenu > .positionaldialog {\n  font-size: 1rem;\n  min-width: 25rem;\n  position: absolute;\n}\n.page.apwptool .headermenu > .positionaldialog .menu {\n  flex-direction: column;\n  line-height: 2rem;\n  padding: 1rem;\n}\n.page.apwptool .headermenu > .positionaldialog .menu,\n.page.apwptool .headermenu > .positionaldialog a {\n  display: flex;\n}\n.page.apwptool .headermenu > .positionaldialog a {\n  align-items: center;\n  gap: 0.7ch;\n  justify-content: left;\n}\n.page.apwptool .headermenu > .positionaldialog .spacer {\n  height: 1rem;\n}\n.page.apwptool .settings {\n  display: grid;\n  gap: 1rem;\n  grid-template-columns: auto;\n  max-width: 420px;\n  width: 100%;\n}\n.page.apwptool .activeset {\n  align-items: center;\n  display: flex;\n  flex-grow: 1;\n  justify-content: center;\n}\n.page.apwptool .activeset .emptymsg {\n  color: #d3d3d3;\n  font-size: 1.5rem;\n}\n.page.apwptool .activeset .set {\n  display: flex;\n  justify-content: space-around;\n  width: 100%;\n}\n.page.apwptool .activeset .dataset {\n  width: 348px;\n}\n",""]);const s=r},6226:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,":root {\n  --txt_primary: #293971;\n  --elm_primary: #293971;\n  --elm_secondary: #E63946;\n}\n.page.footer {\n  background: #E5E5E5;\n  overflow-x: hidden;\n  padding: 4rem 4rem 6rem;\n  position: relative;\n}\n.page.footer .content {\n  display: flex;\n  gap: 1rem;\n  justify-content: space-between;\n}\n@media only screen and (max-width: 600px) {\n  .page.footer .content {\n    flex-direction: column;\n  }\n  .page.footer .content > div {\n    margin-bottom: 3rem;\n  }\n}\n.page.footer .content .logos {\n  align-items: center;\n  display: flex;\n  gap: 1rem;\n  padding-top: 1rem;\n}\n.page.footer .content .logos a {\n  display: block;\n}\n.page.footer .content .logos img {\n  max-height: 5rem;\n}\n.page.footer .siteinfo {\n  background: var(--elm_primary);\n  bottom: 0;\n  color: #fff;\n  left: 0;\n  padding: 0.3rem 0 0.4rem;\n  position: absolute;\n  text-align: center;\n  width: 100vw;\n}\n",""]);const s=r},9275:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,":root {\n  --txt_primary: #293971;\n  --elm_primary: #293971;\n  --elm_secondary: #E63946;\n}\n.page.header {\n  background: #FFFFFF;\n  border-bottom: 10px solid var(--elm_primary);\n  position: relative;\n  z-index: 100;\n}\n.page.header .menu {\n  align-items: center;\n  display: flex;\n  gap: 30px;\n  margin-bottom: 1.5rem;\n  margin-top: 2rem;\n  position: relative;\n}\n@media only screen and (max-width: 1000px) {\n  .page.header .menu {\n    margin-bottom: 0.4rem;\n    margin-top: 0.6rem;\n  }\n}\n.page.header .popup_box:hover .popup_content {\n  height: 0.5rem;\n  opacity: 1;\n}\n.page.header .popup_content {\n  display: block;\n  height: 0;\n  opacity: 0;\n  position: relative;\n  top: -0.5rem;\n  transition: height 0.2s, opacity 0.1s;\n}\n.page.header .positionaldialog {\n  position: absolute;\n  right: 0;\n  top: 2.7rem;\n  width: 15rem;\n}\n.page.header .positionaldialog .content {\n  padding: 1rem;\n}\n.page.header .positionaldialog a {\n  display: block;\n}\n@media only screen and (max-width: 600px) {\n  .page.header .positionaldialog {\n    font-size: 1.3em !important;\n    left: 0;\n    line-height: 2.4;\n    width: 100%;\n  }\n}\n",""]);const s=r},2886:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,":root {\n  --txt_primary: #293971;\n  --elm_primary: #293971;\n  --elm_secondary: #E63946;\n}\n.page.home {\n  position: relative;\n}\n.page.home .features {\n  gap: 2rem;\n  justify-content: space-between;\n}\n@media only screen and (max-width: 1000px) {\n  .page.home .features {\n    align-items: center;\n  }\n}\n.page.home .features .feature {\n  flex-basis: 0;\n  flex-grow: 1;\n  font-size: 0.9rem;\n  -webkit-hyphens: auto;\n  hyphens: auto;\n  line-height: 1.5rem;\n  max-width: 50ch;\n  padding: 3.5rem 2rem;\n  position: relative;\n  text-align: center;\n  top: 0;\n  transition: top 0.2s, box-shadow 0.15s;\n}\n.page.home .features .feature:hover {\n  box-shadow: 4px 6px 12px #00000030;\n  opacity: 1;\n  top: -1rem;\n}\n.page.home .features .feature > * {\n  text-align: left;\n}\n.page.home .features .feature > img,\n.page.home .features .feature > svg {\n  margin-bottom: 2.5rem;\n}\n.page.home .features .feature > img .fa-primary,\n.page.home .features .feature > svg .fa-primary {\n  color: var(--txt_primary);\n}\n",""]);const s=r},7843:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,":root {\n  --txt_primary: #293971;\n  --elm_primary: #293971;\n  --elm_secondary: #E63946;\n}\n.page.referencedatabase .GAPWP23 {\n  display: flex;\n  justify-content: center;\n}\n.page.referencedatabase .GAPWP23 img {\n  max-width: 420px;\n}\n.page.referencedatabase .versions {\n  display: grid;\n  gap: 0.2rem;\n  grid-template-columns: repeat(5, auto);\n  margin-top: 1rem;\n}\n@media only screen and (max-width: 1000px) {\n  .page.referencedatabase .versions {\n    grid-template-columns: repeat(3, auto);\n  }\n}\n.page.referencedatabase .form {\n  align-items: flex-start;\n  display: flex;\n  gap: 2rem;\n}\n.page.referencedatabase .form > * {\n  flex-basis: 0;\n  flex-grow: 1;\n}\n.page.referencedatabase .form .questions {\n  display: grid;\n  gap: 2rem;\n  grid-template-columns: auto;\n}\n.page.referencedatabase .form .data .datasets > * {\n  margin: 2rem auto;\n  width: 348px;\n}\n",""]);const s=r},8716:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,":root {\n  --txt_primary: #293971;\n  --elm_primary: #293971;\n  --elm_secondary: #E63946;\n}\n.page.rpdtool .showmore {\n  float: right;\n}\n.page.rpdtool .datasetgrid {\n  align-items: start;\n  display: grid;\n  gap: 2rem;\n  grid-template-columns: 1fr 1fr 1fr;\n}\n@media only screen and (max-width: 1000px) {\n  .page.rpdtool .datasetgrid {\n    grid-template-columns: 1fr 1fr;\n  }\n}\n@media only screen and (max-width: 600px) {\n  .page.rpdtool .datasetgrid {\n    grid-template-columns: 1fr;\n  }\n}\n.page.rpdtool .headermenu {\n  font-size: 0.8rem;\n  margin: 0 1rem 0 -0.6rem;\n  position: relative;\n}\n.page.rpdtool .headermenu > .positionaldialog {\n  font-size: 1rem;\n  min-width: 25rem;\n  position: absolute;\n}\n.page.rpdtool .headermenu > .positionaldialog .menu {\n  flex-direction: column;\n  line-height: 2rem;\n  padding: 1rem;\n}\n.page.rpdtool .headermenu > .positionaldialog .menu,\n.page.rpdtool .headermenu > .positionaldialog a {\n  display: flex;\n}\n.page.rpdtool .headermenu > .positionaldialog a {\n  align-items: center;\n  gap: 0.7ch;\n  justify-content: left;\n}\n.page.rpdtool .headermenu > .positionaldialog .spacer {\n  height: 1rem;\n}\n.page.rpdtool .export_button {\n  font-size: 0.8rem;\n  position: absolute;\n  right: 1rem;\n  top: 1rem;\n}\n.page.rpdtool .settings {\n  align-self: flex-start;\n  display: grid;\n  gap: 1rem;\n  grid-template-columns: auto;\n  max-width: 420px;\n  width: 100%;\n}\n.page.rpdtool .warnings .warning {\n  background: #ff830024;\n  color: #ff8300;\n  padding: 1rem;\n}\n.page.rpdtool .warnings .warning + .warning {\n  margin-top: 1rem;\n}\n.page.rpdtool .activeset {\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  justify-content: center;\n}\n.page.rpdtool .activeset .emptymsg {\n  font-size: 1.5rem;\n}\n.page.rpdtool .activeset .dataset {\n  width: 348px;\n}\n",""]);const s=r},3741:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,".comp.dispgraph {\n  position: relative;\n}\n.comp.dispgraph .positionaldialog {\n  position: absolute;\n  right: 1rem;\n  top: 3rem;\n}\n.comp.dispgraph .positionaldialog .menu {\n  display: flex;\n  flex-direction: column;\n  line-height: 2rem;\n  padding: 1rem;\n}\n.comp.dispgraph .positionaldialog .menu a {\n  align-items: center;\n  display: flex;\n  gap: 0.7ch;\n  justify-content: left;\n}\n.comp.dispgraph .positionaldialog .menu .spacer {\n  height: 1rem;\n}\n",""]);const s=r},5328:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,".comp.rotgraph {\n  position: relative;\n}\n.comp.rotgraph .positionaldialog {\n  position: absolute;\n  right: 1rem;\n  top: 3rem;\n}\n.comp.rotgraph .positionaldialog .menu {\n  display: flex;\n  flex-direction: column;\n  line-height: 2rem;\n  padding: 1rem;\n}\n.comp.rotgraph .positionaldialog .menu a {\n  align-items: center;\n  display: flex;\n  gap: 0.7ch;\n  justify-content: left;\n}\n.comp.rotgraph .positionaldialog .menu .spacer {\n  height: 1rem;\n}\n",""]);const s=r},4130:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,":root {\n  --txt_primary: #293971;\n  --elm_primary: #293971;\n  --elm_secondary: #E63946;\n}\n.comp.dialog {\n  border: 0 solid #000;\n  border-radius: 4px;\n  box-shadow: 0 0 0 100vmax rgba(0, 0, 0, 0.1);\n  display: block;\n  filter: drop-shadow(3px 3px 4px #00000090);\n  max-width: 420px;\n  opacity: 0;\n  padding: 0;\n  position: fixed;\n  transform: translateY(-3rem);\n  transition: visibility 0s 0.2s, opacity 0.2s, transform 0.2s;\n  visibility: hidden;\n  width: 95%;\n}\n.comp.dialog.autowidth {\n  max-width: 95%;\n  width: -moz-fit-content;\n  width: fit-content;\n}\n.comp.dialog[open]:not(.hide) {\n  opacity: 1;\n  transform: translateY(0);\n  transition: visibility 0s 0s, opacity 0.2s, transform 0.2s;\n  visibility: visible;\n}\n.comp.dialog > .content,\n.comp.dialog > .reactions {\n  padding: 1rem;\n}\n.comp.dialog > .reactions {\n  display: flex;\n  gap: 1rem;\n  justify-content: flex-end;\n}\n.comp.dialog.isLightbox > .reactions {\n  display: none;\n}\n.comp.dialog.isLightbox > .content {\n  padding: 0;\n}\n.comp.dialog::backdrop {\n  opacity: 0;\n}\n",""]);const s=r},5279:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,":root {\n  --txt_primary: #293971;\n  --elm_primary: #293971;\n  --elm_secondary: #E63946;\n}\n.input .title {\n  line-height: 1em;\n}\n.input .saveui {\n  font-size: 0.8em;\n  opacity: 0;\n  transition: opacity 0.15s 0s;\n}\n.input.saving .saveui {\n  opacity: 1;\n  transition: opacity 0s 0s;\n}\n.input.formatted.input_text .formatval {\n  bottom: 0.25rem;\n  font-size: 0.8rem;\n  left: 0.2rem;\n  line-height: 1rem;\n  pointer-events: none;\n  position: absolute;\n  transition: color 0.2s, bottom 0.2s;\n  z-index: 1;\n}\n.input.formatted.input_text:focus-within .formatval {\n  bottom: 0.6rem;\n  color: #8A8A8A;\n}\n.input.formatted.input_text input {\n  color: transparent;\n  transition: color 0.2s, margin-bottom 0.2s;\n}\n.input.formatted.input_text input:focus {\n  color: inherit;\n  margin-bottom: 1.7rem;\n}\n.input.invalid input,\n.input.invalid select {\n  background: #ffffff;\n  border-color: transparent;\n  outline: 2px solid #E63946;\n  outline-offset: -1px;\n}\n.input.disabled {\n  opacity: 0.6;\n  pointer-events: none;\n}\n.input.input_select,\n.input.input_text {\n  position: relative;\n}\n.input.input_select .saveui,\n.input.input_text .saveui {\n  bottom: 0;\n  color: #8A8A8A;\n  pointer-events: none;\n  position: absolute;\n  right: 5px;\n}\n.input.input_select input,\n.input.input_text input,\n.input.input_select select,\n.input.input_text select {\n  background: #fff;\n  border: 1px solid #202020;\n  border-radius: 3px;\n  color: #202020;\n  height: 1.7rem;\n  width: 100%;\n}\n.input.input_select.autowidth input,\n.input.input_text.autowidth input,\n.input.input_select.autowidth select,\n.input.input_text.autowidth select {\n  width: auto;\n}\n.input.input_select .saveui {\n  right: 18px;\n}\n.input.input_file {\n  height: 100%;\n  position: relative;\n}\n.input.input_file input {\n  cursor: pointer;\n  height: 100%;\n  left: 0;\n  margin: 0;\n  opacity: 0;\n  outline: none;\n  padding: 0;\n  position: absolute;\n  top: 0;\n  width: 100%;\n}\n.input.input_file .dropzoneui {\n  align-items: center;\n  border: 1px solid var(--elm_primary);\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  justify-content: center;\n  padding: 0.5rem 0.5rem 1.5rem;\n  text-align: center;\n  transition: all 0.14s;\n}\n.input.input_file .dropzoneui .icon {\n  color: var(--elm_primary);\n  margin: 1rem;\n  pointer-events: none;\n  transition: all 0.14s;\n}\n.input.input_file:hover .dropzoneui {\n  background: #8A8A8A;\n}\n.input.input_file:hover .dropzoneui .icon {\n  opacity: 0.8;\n}\n.input.input_file.draging .dropzoneui,\n.input.input_file:active .dropzoneui {\n  background: #717171;\n  border-color: #717171;\n}\n.input.input_file.draging .dropzoneui .icon,\n.input.input_file:active .dropzoneui .icon {\n  color: #575757;\n}\n",""]);const s=r},5189:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,':root {\n  --txt_primary: #293971;\n  --elm_primary: #293971;\n  --elm_secondary: #E63946;\n}\n.comp.positionaldialog {\n  align-self: flex-start;\n  flex-basis: 0;\n  height: 0;\n  position: relative;\n  width: 0;\n}\n.comp.positionaldialog.fill {\n  width: auto;\n}\n.comp.positionaldialog.fill .content {\n  width: 100%;\n}\n.comp.positionaldialog .content {\n  background: #FFFFFF;\n  border: 1px solid #8A8A8A;\n  border-radius: 3px;\n  box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.4);\n  color: #202020;\n  left: 0;\n  position: relative;\n  top: 0;\n  transition: transform 0.1s, opacity 0.1s;\n  width: auto;\n  z-index: 1010;\n}\n.comp.positionaldialog .content button {\n  white-space: nowrap;\n}\n.comp.positionaldialog:after {\n  background: #000;\n  bottom: 0;\n  content: "";\n  display: block;\n  left: 0;\n  opacity: 0;\n  position: fixed;\n  right: 0;\n  top: 0;\n  transition: opacity 0.2s;\n  z-index: -1;\n}\n.comp.positionaldialog.closed {\n  visibility: hidden;\n}\n.comp.positionaldialog.closed .content {\n  opacity: 0;\n  transform: translateY(-1rem);\n}\n.comp.positionaldialog.open:after {\n  opacity: 0.15;\n  z-index: 1000;\n}\n.comp.positionaldialog.open .content {\n  opacity: 1;\n}\n',""]);const s=r},6973:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,":root {\n  --txt_primary: #293971;\n  --elm_primary: #293971;\n  --elm_secondary: #E63946;\n}\n.comp.pyodideinfobox {\n  background: var(--elm_primary);\n  bottom: 1rem;\n  box-shadow: 2px 2px 4px #0006;\n  color: #FFFFFF;\n  font-size: 0.9rem;\n  min-width: 45ch;\n  padding: 1rem;\n  position: fixed;\n  right: 1rem;\n  transition: opacity 0.3s;\n  width: 30vw;\n  z-index: 200;\n}\n.comp.pyodideinfobox.hidden {\n  opacity: 0;\n}\n.comp.pyodideinfobox .close {\n  cursor: pointer;\n  margin: -1rem;\n  padding: 1rem;\n  position: absolute;\n  right: 2ch;\n  top: 1ch;\n}\n.comp.pyodideinfobox .spinner {\n  margin-right: 1ch;\n}\n.comp.pyodideinfobox .title {\n  font-weight: 700;\n}\n.comp.pyodideinfobox .content {\n  line-height: normal;\n}\n",""]);const s=r},7771:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,".comp.showmore .icon {\n  color: var(--elm_primary);\n}\n.showmore_preview {\n  background-image: linear-gradient(180deg, hsla(0, 0%, 100%, 0), #fff);\n  height: 10rem;\n  overflow: hidden;\n}\n.showmore_preview > * {\n  position: relative;\n  z-index: -1;\n}\n",""]);const s=r},3503:(t,e,i)=>{"use strict";i.d(e,{Z:()=>o});var n=i(3645),r=i.n(n),s=i(551),a=r()((function(t){return t[1]}));a.i(s.Z),a.push([t.id,":root {\n  --txt_primary: #293971;\n  --elm_primary: #293971;\n  --elm_secondary: #E63946;\n}\n* {\n  box-sizing: border-box;\n}\nbody {\n  margin: 0;\n}\nh1,\nh2,\nh3,\nh4 {\n  margin: 0;\n  padding: 0;\n  font-size: 1rem;\n  font-weight: bold;\n}\nbutton::-moz-focus-inner {\n  border: 0;\n}\ninput {\n  border: none;\n  background-image: none;\n  background-color: transparent;\n  -webkit-box-shadow: none;\n  -moz-box-shadow: none;\n  box-shadow: none;\n  outline: none;\n}\nbody,\nbutton,\nhtml {\n  -webkit-text-size-adjust: 14px;\n  -ms-text-size-adjust: 14px;\n  color: #202020;\n  font-family: Poppins, sans-serif;\n  font-size: 14px;\n  font-style: normal;\n  font-weight: 400;\n  line-height: 24px;\n  overflow-x: hidden;\n}\nbody {\n  -webkit-print-color-adjust: exact!important;\n  print-color-adjust: exact !important;\n}\nh1,\nh2,\nh3,\nh4 {\n  color: var(--txt_primary);\n}\nh1 {\n  font-family: Orelega One, sans-serif;\n  font-size: 35px;\n  font-weight: 400;\n  line-height: 35px;\n}\n@media only screen and (max-width: 1000px) {\n  h1 {\n    font-size: 21px;\n  }\n}\nh2 {\n  font-size: 24px;\n  font-weight: 300;\n  line-height: 40px;\n}\n@media only screen and (max-width: 1000px) {\n  h2 {\n    font-size: 21.6px;\n  }\n}\nh3 {\n  font-size: 16px;\n  font-weight: 400;\n}\nh3,\nh4 {\n  line-height: 30px;\n}\nh4 {\n  font-size: 13px;\n  font-weight: 700;\n  text-transform: uppercase;\n}\na {\n  color: var(--txt_primary);\n}\na:where(:visited) {\n  color: #202020;\n}\na.unobtrusive {\n  color: currentColor;\n  text-decoration: none;\n}\nli {\n  margin-top: 1rem;\n}\nol.compact li,\nul.compact li {\n  margin: 0;\n}\nblockquote {\n  border-left: 5px solid var(--elm_primary);\n  font-style: italic;\n  margin: 3rem 0;\n  padding: 0 0 0 3rem;\n}\nbutton {\n  background-color: #FFFFFF;\n  border: 1px solid var(--elm_primary);\n  border-radius: 3px;\n  box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.25);\n  color: #202020;\n  cursor: pointer;\n  display: inline-block;\n  font-size: 1.1em;\n  line-height: 1em;\n  padding: 0.6em 1.7em;\n  text-decoration: none;\n  text-decoration-line: none;\n  transition: opacity 0.2s, box-shadow 0.2s;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n}\nbutton:focus,\nbutton:hover {\n  box-shadow: 0 0 0 rgba(0, 0, 0, 0.25);\n  opacity: 0.8;\n}\nbutton:active {\n  opacity: 0.6;\n}\nbutton.disabled {\n  opacity: 0.6;\n  pointer-events: none;\n}\nbutton.btn_primary {\n  background-color: var(--elm_primary);\n  border-color: var(--elm_primary);\n  color: #FFFFFF;\n}\nbutton.btn_secondary {\n  background-color: var(--elm_secondary);\n  border-color: var(--elm_secondary);\n  color: #FFFFFF;\n}\nbutton.btn_icon {\n  padding: 0.6em;\n}\nbutton.btn_narrow {\n  padding: 0.4em 0.6em;\n}\n.noselect {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n}\n.flex,\n.flexcolumn,\n.flexequal,\n.titlebar {\n  display: flex;\n  gap: 1rem;\n}\n.flexequal > * {\n  flex-basis: 0;\n  flex-grow: 1;\n}\n.flexcolumn {\n  flex-direction: column;\n}\n.flexcolumn > * {\n  flex-shrink: 0;\n}\n.titlebar > :first-child {\n  flex-grow: 1;\n}\n@media only screen and (max-width: 1000px) {\n  .flex,\n  .flexequal {\n    flex-direction: column;\n    margin-left: auto;\n    margin-right: auto;\n    width: 100%;\n  }\n  .flex > *,\n  .flexequal > * {\n    flex-basis: auto!important;\n    flex-shrink: 0;\n  }\n}\n.mobile_only,\n.mobile_sm_only {\n  display: none;\n}\n@media only screen and (max-width: 1000px) {\n  .mobile_only {\n    display: inherit;\n  }\n}\n@media only screen and (max-width: 600px) {\n  .mobile_sm_only {\n    display: inherit;\n  }\n}\n@media only screen and (max-width: 1000px) {\n  .mobile_hidden {\n    display: none;\n  }\n}\n@media only screen and (max-width: 600px) {\n  .mobile_sm_hidden {\n    display: none;\n  }\n}\n.showonhover_target .showonhover_content {\n  display: none;\n}\n.showonhover_target:hover .showonhover_content {\n  display: block;\n}\n.txt_default {\n  color: #202020;\n}\n.txt_default_lesser,\n.txt_default_lesser a {\n  color: #8A8A8A;\n}\n.txt_primary {\n  color: var(--txt_primary);\n}\n.txt_primary_lesser,\n.txt_primary_lesser a {\n  color: #E5E5E5;\n}\n.txt_error,\n.txt_error a {\n  color: #E63946;\n}\n.elm_coming_soon {\n  align-items: center;\n  background-color: #E5E5E5;\n  color: #8A8A8A;\n  display: flex;\n  height: 1rem;\n  justify-content: center;\n}\n.content_width_narrow,\n.content_width_narrow_left,\n.content_width_narrow_right,\n.content_width_standard {\n  margin-left: auto;\n  margin-right: auto;\n  max-width: 1100px;\n  width: 95vw;\n}\n.content_width_narrow {\n  max-width: 500px;\n}\n.content_width_narrow_left {\n  padding-right: min(600px, calc(95vw - 500px));\n}\n.content_width_narrow_right {\n  padding-left: min(600px, calc(95vw - 500px));\n}\n.section {\n  margin-bottom: 10rem;\n  margin-top: 5rem;\n}\n.section + .section {\n  margin-bottom: 10rem;\n  margin-top: 10rem;\n}\n",""]);const o=a},9209:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,':host,:root{--ol-background-color:#fff;--ol-accent-background-color:#f5f5f5;--ol-subtle-background-color:hsla(0,0%,50%,.25);--ol-partial-background-color:hsla(0,0%,100%,.75);--ol-foreground-color:#333;--ol-subtle-foreground-color:#666;--ol-brand-color:#0af}.ol-box{background-color:var(--ol-partial-background-color);border:1.5px solid var(--ol-background-color);border-radius:2px;box-sizing:border-box}.ol-mouse-position{position:absolute;right:8px;top:8px}.ol-scale-line{background:var(--ol-partial-background-color);border-radius:4px;bottom:8px;left:8px;padding:2px;position:absolute}.ol-scale-line-inner{border:1px solid var(--ol-subtle-foreground-color);border-top:none;color:var(--ol-foreground-color);font-size:10px;margin:1px;text-align:center;transition:all .25s;will-change:contents,width}.ol-scale-bar{bottom:8px;left:8px;position:absolute}.ol-scale-bar-inner{display:flex}.ol-scale-step-marker{background-color:var(--ol-foreground-color);float:right;height:15px;width:1px;z-index:10}.ol-scale-step-text{bottom:-5px;font-size:10px;z-index:11}.ol-scale-step-text,.ol-scale-text{color:var(--ol-foreground-color);position:absolute;text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-text{bottom:25px;font-size:12px;text-align:center}.ol-scale-singlebar{border:1px solid var(--ol-foreground-color);box-sizing:border-box;height:10px;position:relative;z-index:9}.ol-scale-singlebar-even{background-color:var(--ol-subtle-foreground-color)}.ol-scale-singlebar-odd{background-color:var(--ol-background-color)}.ol-unsupported{display:none}.ol-unselectable,.ol-viewport{-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ol-viewport canvas{all:unset}.ol-viewport{touch-action:none}.ol-selectable{-webkit-touch-callout:default;-webkit-user-select:text;-moz-user-select:text;user-select:text}.ol-grabbing{cursor:grabbing}.ol-grab{cursor:move;cursor:grab}.ol-control{background-color:var(--ol-subtle-background-color);border-radius:4px;position:absolute}.ol-zoom{left:.5em;top:.5em}.ol-rotate{right:.5em;top:.5em;transition:opacity .25s linear,visibility 0s linear}.ol-rotate.ol-hidden{opacity:0;transition:opacity .25s linear,visibility 0s linear .25s;visibility:hidden}.ol-zoom-extent{left:.5em;top:4.643em}.ol-full-screen{right:.5em;top:.5em}.ol-control button{background-color:var(--ol-background-color);border:none;border-radius:2px;color:var(--ol-subtle-foreground-color);display:block;font-size:inherit;font-weight:700;height:1.375em;line-height:.4em;margin:1px;padding:0;text-align:center;text-decoration:none;width:1.375em}.ol-control button::-moz-focus-inner{border:none;padding:0}.ol-zoom-extent button{line-height:1.4em}.ol-compass{display:block;font-weight:400;will-change:transform}.ol-touch .ol-control button{font-size:1.5em}.ol-touch .ol-zoom-extent{top:5.5em}.ol-control button:focus,.ol-control button:hover{color:var(--ol-foreground-color);outline:1px solid var(--ol-subtle-foreground-color);text-decoration:none}.ol-zoom .ol-zoom-in{border-radius:2px 2px 0 0}.ol-zoom .ol-zoom-out{border-radius:0 0 2px 2px}.ol-attribution{align-items:center;bottom:.5em;display:flex;flex-flow:row-reverse;max-width:calc(100% - 1.3em);right:.5em;text-align:right}.ol-attribution a{color:var(--ol-subtle-foreground-color);text-decoration:none}.ol-attribution ul{color:var(--ol-foreground-color);font-size:12px;margin:0;padding:1px .5em;text-shadow:0 0 2px var(--ol-background-color)}.ol-attribution li{display:inline;list-style:none}.ol-attribution li:not(:last-child):after{content:" "}.ol-attribution img{max-height:2em;max-width:inherit;vertical-align:middle}.ol-attribution button{flex-shrink:0}.ol-attribution.ol-collapsed ul{display:none}.ol-attribution:not(.ol-collapsed){background:var(--ol-partial-background-color)}.ol-attribution.ol-uncollapsible{border-radius:4px 0 0;bottom:0;right:0}.ol-attribution.ol-uncollapsible img{margin-top:-.2em;max-height:1.6em}.ol-attribution.ol-uncollapsible button{display:none}.ol-zoomslider{height:200px;left:.5em;top:4.5em}.ol-zoomslider button{height:10px;position:relative}.ol-touch .ol-zoomslider{top:5.5em}.ol-overviewmap{bottom:.5em;left:.5em}.ol-overviewmap.ol-uncollapsible{border-radius:0 4px 0 0;bottom:0;left:0}.ol-overviewmap .ol-overviewmap-map,.ol-overviewmap button{display:block}.ol-overviewmap .ol-overviewmap-map{border:1px solid var(--ol-subtle-foreground-color);height:150px;width:150px}.ol-overviewmap:not(.ol-collapsed) button{bottom:0;left:0;position:absolute}.ol-overviewmap.ol-collapsed .ol-overviewmap-map,.ol-overviewmap.ol-uncollapsible button{display:none}.ol-overviewmap:not(.ol-collapsed){background:var(--ol-subtle-background-color)}.ol-overviewmap-box{border:1.5px dotted var(--ol-subtle-foreground-color)}.ol-overviewmap .ol-overviewmap-box:hover{cursor:move}',""]);const s=r},551:(t,e,i)=>{"use strict";i.d(e,{Z:()=>y});var n=i(3645),r=i.n(n),s=i(1667),a=i.n(s),o=i(6559),l=i(9514),h=i(5394),c=i(3322),u=i(3181),d=r()((function(t){return t[1]})),f=a()(o.Z),p=a()(l.Z),g=a()(h.Z),m=a()(c.Z),v=a()(u.Z);d.push([t.id,"@font-face {\r\n    font-family: 'Orelega One';\r\n    font-style: normal;\r\n    font-weight: 400;\r\n    font-display: swap;\r\n    src: url("+f+") format('woff2');\r\n}\r\n\r\n@font-face {\r\n    font-family: 'Poppins';\r\n    font-style: italic;\r\n    font-weight: 400;\r\n    font-display: swap;\r\n    src: url("+p+") format('woff2');\r\n}\r\n\r\n@font-face {\r\n    font-family: 'Poppins';\r\n    font-style: normal;\r\n    font-weight: 300;\r\n    font-display: swap;\r\n    src: url("+g+") format('woff2');\r\n}\r\n\r\n@font-face {\r\n    font-family: 'Poppins';\r\n    font-style: normal;\r\n    font-weight: 400;\r\n    font-display: swap;\r\n    src: url("+m+") format('woff2');\r\n}\r\n\r\n@font-face {\r\n    font-family: 'Poppins';\r\n    font-style: normal;\r\n    font-weight: 700;\r\n    font-display: swap;\r\n    src: url("+v+") format('woff2');\r\n}\r\n\r\n",""]);const y=d},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=t(e);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,n){"string"==typeof t&&(t=[[null,t,""]]);var r={};if(n)for(var s=0;s<this.length;s++){var a=this[s][0];null!=a&&(r[a]=!0)}for(var o=0;o<t.length;o++){var l=[].concat(t[o]);n&&r[l[0]]||(i&&(l[2]?l[2]="".concat(i," and ").concat(l[2]):l[2]=i),e.push(l))}},e}},1667:t=>{"use strict";t.exports=function(t,e){return e||(e={}),"string"!=typeof(t=t&&t.__esModule?t.default:t)?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t)}},9180:function(t,e,i){var n,r,s;!function(a,o){"use strict";r=[i(9829)],void 0===(s="function"==typeof(n=function(t){var e=/(^|@)\S+:\d+/,i=/^\s*at .*(\S+:\d+|\(native\))/m,n=/^(eval@)?(\[native code])?$/;return{parse:function(t){if(void 0!==t.stacktrace||void 0!==t["opera#sourceloc"])return this.parseOpera(t);if(t.stack&&t.stack.match(i))return this.parseV8OrIE(t);if(t.stack)return this.parseFFOrSafari(t);throw new Error("Cannot parse given Error object")},extractLocation:function(t){if(-1===t.indexOf(":"))return[t];var e=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(t.replace(/[()]/g,""));return[e[1],e[2]||void 0,e[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter((function(t){return!!t.match(i)}),this).map((function(e){e.indexOf("(eval ")>-1&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var i=e.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),n=i.match(/ (\(.+\)$)/);i=n?i.replace(n[0],""):i;var r=this.extractLocation(n?n[1]:i),s=n&&i||void 0,a=["eval","<anonymous>"].indexOf(r[0])>-1?void 0:r[0];return new t({functionName:s,fileName:a,lineNumber:r[1],columnNumber:r[2],source:e})}),this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter((function(t){return!t.match(n)}),this).map((function(e){if(e.indexOf(" > eval")>-1&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return new t({functionName:e});var i=/((.*".+"[^@]*)?[^@]*)(?:@)/,n=e.match(i),r=n&&n[1]?n[1]:void 0,s=this.extractLocation(e.replace(i,""));return new t({functionName:r,fileName:s[0],lineNumber:s[1],columnNumber:s[2],source:e})}),this)},parseOpera:function(t){return!t.stacktrace||t.message.indexOf("\n")>-1&&t.message.split("\n").length>t.stacktrace.split("\n").length?this.parseOpera9(t):t.stack?this.parseOpera11(t):this.parseOpera10(t)},parseOpera9:function(e){for(var i=/Line (\d+).*script (?:in )?(\S+)/i,n=e.message.split("\n"),r=[],s=2,a=n.length;s<a;s+=2){var o=i.exec(n[s]);o&&r.push(new t({fileName:o[2],lineNumber:o[1],source:n[s]}))}return r},parseOpera10:function(e){for(var i=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=e.stacktrace.split("\n"),r=[],s=0,a=n.length;s<a;s+=2){var o=i.exec(n[s]);o&&r.push(new t({functionName:o[3]||void 0,fileName:o[2],lineNumber:o[1],source:n[s]}))}return r},parseOpera11:function(i){return i.stack.split("\n").filter((function(t){return!!t.match(e)&&!t.match(/^Error created at/)}),this).map((function(e){var i,n=e.split("@"),r=this.extractLocation(n.pop()),s=n.shift()||"",a=s.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;s.match(/\(([^)]*)\)/)&&(i=s.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var o=void 0===i||"[arguments not available]"===i?void 0:i.split(",");return new t({functionName:a,args:o,fileName:r[0],lineNumber:r[1],columnNumber:r[2],source:e})}),this)}}})?n.apply(e,r):n)||(t.exports=s)}()},6559:(t,e,i)=>{"use strict";i.d(e,{Z:()=>n});const n="/dist/assets/fonts/OrelegaOneRegular.woff2"},3181:(t,e,i)=>{"use strict";i.d(e,{Z:()=>n});const n="/dist/assets/fonts/PoppinsBold.woff2"},5394:(t,e,i)=>{"use strict";i.d(e,{Z:()=>n});const n="/dist/assets/fonts/PoppinsLight.woff2"},3322:(t,e,i)=>{"use strict";i.d(e,{Z:()=>n});const n="/dist/assets/fonts/PoppinsRegular.woff2"},9514:(t,e,i)=>{"use strict";i.d(e,{Z:()=>n});const n="/dist/assets/fonts/PoppinsRegularItalic.woff2"},8840:function(t,e,i){var n,r,s;r="undefined"!=typeof window?window:this,s=function(t){function e(e,i,n,r){e.hasOwnProperty(i)||(e[i]=r.apply(null,n),"function"==typeof CustomEvent&&t.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:i,module:e[i]}})))}var i={};return e(i,"Core/Globals.js",[],(function(){var e;return function(e){e.SVG_NS="http://www.w3.org/2000/svg",e.product="Highcharts",e.version="10.3.3",e.win=void 0!==t?t:{},e.doc=e.win.document,e.svg=e.doc&&e.doc.createElementNS&&!!e.doc.createElementNS(e.SVG_NS,"svg").createSVGRect,e.userAgent=e.win.navigator&&e.win.navigator.userAgent||"",e.isChrome=-1!==e.userAgent.indexOf("Chrome"),e.isFirefox=-1!==e.userAgent.indexOf("Firefox"),e.isMS=/(edge|msie|trident)/i.test(e.userAgent)&&!e.win.opera,e.isSafari=!e.isChrome&&-1!==e.userAgent.indexOf("Safari"),e.isTouchDevice=/(Mobile|Android|Windows Phone)/.test(e.userAgent),e.isWebKit=-1!==e.userAgent.indexOf("AppleWebKit"),e.deg2rad=2*Math.PI/360,e.hasBidiBug=e.isFirefox&&4>parseInt(e.userAgent.split("Firefox/")[1],10),e.hasTouch=!!e.win.TouchEvent,e.marginNames=["plotTop","marginRight","marginBottom","plotLeft"],e.noop=function(){},e.supportsPassiveEvents=function(){var t=!1;if(!e.isMS){var i=Object.defineProperty({},"passive",{get:function(){t=!0}});e.win.addEventListener&&e.win.removeEventListener&&(e.win.addEventListener("testPassive",e.noop,i),e.win.removeEventListener("testPassive",e.noop,i))}return t}(),e.charts=[],e.dateFormats={},e.seriesTypes={},e.symbolSizes={},e.chartCount=0}(e||(e={})),e})),e(i,"Core/Utilities.js",[i["Core/Globals.js"]],(function(t){function e(i,n,r,s){var a=n?"Highcharts error":"Highcharts warning";32===i&&(i=a+": Deprecated member");var o=l(i),h=o?a+" #"+i+": www.highcharts.com/errors/"+i+"/":i.toString();if(void 0!==s){var c="";o&&(h+="?"),m(s,(function(t,e){c+="\n - ".concat(e,": ").concat(t),o&&(h+=encodeURI(e)+"="+encodeURI(t))})),h+=c}y(t,"displayError",{chart:r,code:i,message:h,params:s},(function(){if(n)throw Error(h);x.console&&-1===e.messages.indexOf(h)&&console.warn(h)})),e.messages.push(h)}function i(t,e){return parseInt(t,e||10)}function n(t){return"string"==typeof t}function r(t){return"[object Array]"===(t=Object.prototype.toString.call(t))||"[object Array Iterator]"===t}function s(t,e){return!(!t||"object"!=typeof t||e&&r(t))}function a(t){return s(t)&&"number"==typeof t.nodeType}function o(t){var e=t&&t.constructor;return!(!s(t,!0)||a(t)||!e||!e.name||"Object"===e.name)}function l(t){return"number"==typeof t&&!isNaN(t)&&1/0>t&&-1/0<t}function h(t){return null!=t}function c(t,e,i){var r,s=n(e)&&!h(i),a=function(e,i){h(e)?t.setAttribute(i,e):s?(r=t.getAttribute(i))||"class"!==i||(r=t.getAttribute(i+"Name")):t.removeAttribute(i)};return n(e)?a(i,e):m(e,a),r}function u(t,e){var i;for(i in t||(t={}),e)t[i]=e[i];return t}function d(){for(var t=arguments,e=t.length,i=0;i<e;i++){var n=t[i];if(null!=n)return n}}function f(e,i){t.isMS&&!t.svg&&i&&h(i.opacity)&&(i.filter="alpha(opacity=".concat(100*i.opacity,")")),u(e.style,i)}function p(t){return Math.pow(10,Math.floor(Math.log(t)/Math.LN10))}function g(t,e){return 1e14<t?t:parseFloat(t.toPrecision(e||14))}function m(t,e,i){for(var n in t)Object.hasOwnProperty.call(t,n)&&e.call(i||t[n],t[n],n,t)}function v(e,i,n){function r(i,n){var r=e.removeEventListener||t.removeEventListenerPolyfill;r&&r.call(e,i,n,!1)}function s(t){var n;if(e.nodeName){if(i){var s={};s[i]=!0}else s=t;m(s,(function(e,i){if(t[i])for(n=t[i].length;n--;)r(i,t[i][n].fn)}))}}var a="function"==typeof e&&e.prototype||e;if(Object.hasOwnProperty.call(a,"hcEvents")){var o=a.hcEvents;i?(a=o[i]||[],n?(o[i]=a.filter((function(t){return n!==t.fn})),r(i,n)):(s(o),o[i]=[])):(s(o),delete a.hcEvents)}}function y(e,i,n,r){if(n=n||{},_.createEvent&&(e.dispatchEvent||e.fireEvent&&e!==t)){var s=_.createEvent("Events");s.initEvent(i,!0,!0),n=u(s,n),e.dispatchEvent?e.dispatchEvent(n):e.fireEvent(i,n)}else if(e.hcEvents){n.target||u(n,{preventDefault:function(){n.defaultPrevented=!0},target:e,type:i}),s=[];for(var a=e,o=!1;a.hcEvents;)Object.hasOwnProperty.call(a,"hcEvents")&&a.hcEvents[i]&&(s.length&&(o=!0),s.unshift.apply(s,a.hcEvents[i])),a=Object.getPrototypeOf(a);o&&s.sort((function(t,e){return t.order-e.order})),s.forEach((function(t){!1===t.fn.call(e,n)&&n.preventDefault()}))}r&&!n.defaultPrevented&&r.call(e,n)}var b=t.charts,_=t.doc,x=t.win;(e||(e={})).messages=[],Math.easeInOutSine=function(t){return-.5*(Math.cos(Math.PI*t)-1)};var w=Array.prototype.find?function(t,e){return t.find(e)}:function(t,e){var i,n=t.length;for(i=0;i<n;i++)if(e(t[i],i))return t[i]};m({map:"map",each:"forEach",grep:"filter",reduce:"reduce",some:"some"},(function(i,n){t[n]=function(t){var r;return e(32,!1,void 0,((r={})["Highcharts.".concat(n)]="use Array.".concat(i),r)),Array.prototype[i].apply(t,[].slice.call(arguments,1))}}));var S,T=function(){var t=Math.random().toString(36).substring(2,9)+"-",e=0;return function(){return"highcharts-"+(S?"":t)+e++}}();return x.jQuery&&(x.jQuery.fn.highcharts=function(){var e=[].slice.call(arguments);if(this[0])return e[0]?(new(t[n(e[0])?e.shift():"Chart"])(this[0],e[0],e[1]),this):b[c(this[0],"data-highcharts-chart")]}),w={addEvent:function(e,i,n,r){void 0===r&&(r={});var s="function"==typeof e&&e.prototype||e;Object.hasOwnProperty.call(s,"hcEvents")||(s.hcEvents={}),s=s.hcEvents,t.Point&&e instanceof t.Point&&e.series&&e.series.chart&&(e.series.chart.runTrackerClick=!0);var a=e.addEventListener||t.addEventListenerPolyfill;return a&&a.call(e,i,n,!!t.supportsPassiveEvents&&{passive:void 0===r.passive?-1!==i.indexOf("touch"):r.passive,capture:!1}),s[i]||(s[i]=[]),s[i].push({fn:n,order:"number"==typeof r.order?r.order:1/0}),s[i].sort((function(t,e){return t.order-e.order})),function(){v(e,i,n)}},arrayMax:function(t){for(var e=t.length,i=t[0];e--;)t[e]>i&&(i=t[e]);return i},arrayMin:function(t){for(var e=t.length,i=t[0];e--;)t[e]<i&&(i=t[e]);return i},attr:c,clamp:function(t,e,i){return t>e?t<i?t:i:e},cleanRecursively:function t(e,i){var n={};return m(e,(function(r,a){s(e[a],!0)&&!e.nodeType&&i[a]?(r=t(e[a],i[a]),Object.keys(r).length&&(n[a]=r)):(s(e[a])||e[a]!==i[a]||a in e&&!(a in i))&&(n[a]=e[a])})),n},clearTimeout:function(t){h(t)&&clearTimeout(t)},correctFloat:g,createElement:function(t,e,i,n,r){return t=_.createElement(t),e&&u(t,e),r&&f(t,{padding:"0",border:"none",margin:"0"}),i&&f(t,i),n&&n.appendChild(t),t},css:f,defined:h,destroyObjectProperties:function(t,e){m(t,(function(i,n){i&&i!==e&&i.destroy&&i.destroy(),delete t[n]}))},discardElement:function(t){t&&t.parentElement&&t.parentElement.removeChild(t)},erase:function(t,e){for(var i=t.length;i--;)if(t[i]===e){t.splice(i,1);break}},error:e,extend:u,extendClass:function(t,e){var i=function(){};return u(i.prototype=new t,e),i},find:w,fireEvent:y,getMagnitude:p,getNestedProperty:function(t,e){for(t=t.split(".");t.length&&h(e);){var i=t.shift();if(void 0===i||"__proto__"===i)return;if(!h(e=e[i])||"function"==typeof e||"number"==typeof e.nodeType||e===x)return}return e},getStyle:function n(r,s,a){var o=t.getStyle||n;if("width"===s)return s=Math.min(r.offsetWidth,r.scrollWidth),(a=r.getBoundingClientRect&&r.getBoundingClientRect().width)<s&&a>=s-1&&(s=Math.floor(a)),Math.max(0,s-(o(r,"padding-left",!0)||0)-(o(r,"padding-right",!0)||0));if("height"===s)return Math.max(0,Math.min(r.offsetHeight,r.scrollHeight)-(o(r,"padding-top",!0)||0)-(o(r,"padding-bottom",!0)||0));if(x.getComputedStyle||e(27,!0),r=x.getComputedStyle(r,void 0)){var l=r.getPropertyValue(s);d(a,"opacity"!==s)&&(l=i(l))}return l},inArray:function(t,i,n){return e(32,!1,void 0,{"Highcharts.inArray":"use Array.indexOf"}),i.indexOf(t,n)},isArray:r,isClass:o,isDOMElement:a,isFunction:function(t){return"function"==typeof t},isNumber:l,isObject:s,isString:n,keys:function(t){return e(32,!1,void 0,{"Highcharts.keys":"use Object.keys"}),Object.keys(t)},merge:function(){var t,e=arguments,i={},n=function(t,e){return"object"!=typeof t&&(t={}),m(e,(function(i,r){"__proto__"!==r&&"constructor"!==r&&(!s(i,!0)||o(i)||a(i)?t[r]=e[r]:t[r]=n(t[r]||{},i))})),t};!0===e[0]&&(i=e[1],e=Array.prototype.slice.call(e,2));var r=e.length;for(t=0;t<r;t++)i=n(i,e[t]);return i},normalizeTickInterval:function(t,e,i,n,r){var s=t,a=t/(i=d(i,p(t)));for(e||(e=r?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],!1===n&&(1===i?e=e.filter((function(t){return 0==t%1})):.1>=i&&(e=[1/i]))),n=0;n<e.length&&(s=e[n],!(r&&s*i>=t||!r&&a<=(e[n]+(e[n+1]||e[n]))/2));n++);return g(s*i,-Math.round(Math.log(.001)/Math.LN10))},objectEach:m,offset:function(t){var e=_.documentElement;return{top:(t=t.parentElement||t.parentNode?t.getBoundingClientRect():{top:0,left:0,width:0,height:0}).top+(x.pageYOffset||e.scrollTop)-(e.clientTop||0),left:t.left+(x.pageXOffset||e.scrollLeft)-(e.clientLeft||0),width:t.width,height:t.height}},pad:function(t,e,i){return Array((e||2)+1-String(t).replace("-","").length).join(i||"0")+t},pick:d,pInt:i,relativeLength:function(t,e,i){return/%$/.test(t)?e*parseFloat(t)/100+(i||0):parseFloat(t)},removeEvent:v,splat:function(t){return r(t)?t:[t]},stableSort:function(t,e){var i,n,r=t.length;for(n=0;n<r;n++)t[n].safeI=n;for(t.sort((function(t,n){return 0===(i=e(t,n))?t.safeI-n.safeI:i})),n=0;n<r;n++)delete t[n].safeI},syncTimeout:function(t,e,i){return 0<e?setTimeout(t,e,i):(t.call(0,i),-1)},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},uniqueKey:T,useSerialIds:function(t){return S=d(t,S)},wrap:function(t,e,i){var n=t[e];t[e]=function(){var t=arguments,e=this;return i.apply(this,[function(){return n.apply(e,arguments.length?arguments:t)}].concat([].slice.call(arguments)))}}},w})),e(i,"Core/Chart/ChartDefaults.js",[],(function(){return{alignThresholds:!1,panning:{enabled:!1,type:"x"},styledMode:!1,borderRadius:0,colorCount:10,allowMutatingData:!0,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}},zoomBySingleTouch:!1,zooming:{singleTouch:!1,resetButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}}},width:null,height:null,borderColor:"#335cad",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"}})),e(i,"Core/Color/Color.js",[i["Core/Globals.js"],i["Core/Utilities.js"]],(function(t,e){var i=e.isNumber,n=e.merge,r=e.pInt;return e=function(){function e(i){this.rgba=[NaN,NaN,NaN,NaN],this.input=i;var n=t.Color;return n&&n!==e?new n(i):this instanceof e?void this.init(i):new e(i)}return e.parse=function(t){return t?new e(t):e.None},e.prototype.init=function(t){var i;if("object"==typeof t&&void 0!==t.stops)this.stops=t.stops.map((function(t){return new e(t[1])}));else if("string"==typeof t){if(this.input=t=e.names[t.toLowerCase()]||t,"#"===t.charAt(0)){var n=t.length,r=parseInt(t.substr(1),16);7===n?i=[(16711680&r)>>16,(65280&r)>>8,255&r,1]:4===n&&(i=[(3840&r)>>4|(3840&r)>>8,(240&r)>>4|240&r,(15&r)<<4|15&r,1])}if(!i)for(r=e.parsers.length;r--&&!i;){var s=e.parsers[r];(n=s.regex.exec(t))&&(i=s.parse(n))}}i&&(this.rgba=i)},e.prototype.get=function(t){var e=this.input,r=this.rgba;if("object"==typeof e&&void 0!==this.stops){var s=n(e);return s.stops=[].slice.call(s.stops),this.stops.forEach((function(e,i){s.stops[i]=[s.stops[i][0],e.get(t)]})),s}return r&&i(r[0])?"rgb"===t||!t&&1===r[3]?"rgb("+r[0]+","+r[1]+","+r[2]+")":"a"===t?"".concat(r[3]):"rgba("+r.join(",")+")":e},e.prototype.brighten=function(t){var e=this.rgba;if(this.stops)this.stops.forEach((function(e){e.brighten(t)}));else if(i(t)&&0!==t)for(var n=0;3>n;n++)e[n]+=r(255*t),0>e[n]&&(e[n]=0),255<e[n]&&(e[n]=255);return this},e.prototype.setOpacity=function(t){return this.rgba[3]=t,this},e.prototype.tweenTo=function(t,e){var n=this.rgba,r=t.rgba;return i(n[0])&&i(r[0])?((t=1!==r[3]||1!==n[3])?"rgba(":"rgb(")+Math.round(r[0]+(n[0]-r[0])*(1-e))+","+Math.round(r[1]+(n[1]-r[1])*(1-e))+","+Math.round(r[2]+(n[2]-r[2])*(1-e))+(t?","+(r[3]+(n[3]-r[3])*(1-e)):"")+")":t.input||"none"},e.names={white:"#ffffff",black:"#000000"},e.parsers=[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(t){return[r(t[1]),r(t[2]),r(t[3]),parseFloat(t[4],10)]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(t){return[r(t[1]),r(t[2]),r(t[3]),1]}}],e.None=new e(""),e}(),e})),e(i,"Core/Color/Palettes.js",[],(function(){return{colors:"#7cb5ec #434348 #90ed7d #f7a35c #8085e9 #f15c80 #e4d354 #2b908f #f45b5b #91e8e1".split(" ")}})),e(i,"Core/Time.js",[i["Core/Globals.js"],i["Core/Utilities.js"]],(function(t,e){var i=t.win,n=e.defined,r=e.error,s=e.extend,a=e.isObject,o=e.merge,l=e.objectEach,h=e.pad,c=e.pick,u=e.splat,d=e.timeUnits,f=t.isSafari&&i.Intl&&i.Intl.DateTimeFormat.prototype.formatRange,p=t.isSafari&&i.Intl&&!i.Intl.DateTimeFormat.prototype.formatRange;return e=function(){function e(t){this.options={},this.variableTimezone=this.useUTC=!1,this.Date=i.Date,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.update(t)}return e.prototype.get=function(t,e){if(this.variableTimezone||this.timezoneOffset){var i=e.getTime(),n=i-this.getTimezoneOffset(e);return e.setTime(n),t=e["getUTC"+t](),e.setTime(i),t}return this.useUTC?e["getUTC"+t]():e["get"+t]()},e.prototype.set=function(t,e,i){if(this.variableTimezone||this.timezoneOffset){if("Milliseconds"===t||"Seconds"===t||"Minutes"===t&&0==this.getTimezoneOffset(e)%36e5)return e["setUTC"+t](i);var n=this.getTimezoneOffset(e);return n=e.getTime()-n,e.setTime(n),e["setUTC"+t](i),t=this.getTimezoneOffset(e),n=e.getTime()+t,e.setTime(n)}return this.useUTC||f&&"FullYear"===t?e["setUTC"+t](i):e["set"+t](i)},e.prototype.update=function(t){void 0===t&&(t={});var e=c(t.useUTC,!0);this.options=t=o(!0,this.options,t),this.Date=t.Date||i.Date||Date,this.timezoneOffset=(this.useUTC=e)&&t.timezoneOffset||void 0,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.variableTimezone=e&&!(!t.getTimezoneOffset&&!t.timezone)},e.prototype.makeTime=function(t,e,i,n,r,s){if(this.useUTC){var a=this.Date.UTC.apply(0,arguments),o=this.getTimezoneOffset(a);a+=o;var l=this.getTimezoneOffset(a);o!==l?a+=l-o:o-36e5!==this.getTimezoneOffset(a-36e5)||p||(a-=36e5)}else a=new this.Date(t,e,c(i,1),c(n,0),c(r,0),c(s,0)).getTime();return a},e.prototype.timezoneOffsetFunction=function(){var t=this,e=this.options,n=e.getTimezoneOffset,s=e.moment||i.moment;if(!this.useUTC)return function(t){return 6e4*new Date(t.toString()).getTimezoneOffset()};if(e.timezone){if(s)return function(t){return 6e4*-s.tz(t,e.timezone).utcOffset()};r(25)}return this.useUTC&&n?function(t){return 6e4*n(t.valueOf())}:function(){return 6e4*(t.timezoneOffset||0)}},e.prototype.dateFormat=function(e,i,r){if(!n(i)||isNaN(i))return t.defaultOptions.lang&&t.defaultOptions.lang.invalidDate||"";e=c(e,"%Y-%m-%d %H:%M:%S");var a=this,o=new this.Date(i),u=this.get("Hours",o),d=this.get("Day",o),f=this.get("Date",o),p=this.get("Month",o),g=this.get("FullYear",o),m=t.defaultOptions.lang,v=m&&m.weekdays,y=m&&m.shortWeekdays;return o=s({a:y?y[d]:v[d].substr(0,3),A:v[d],d:h(f),e:h(f,2," "),w:d,b:m.shortMonths[p],B:m.months[p],m:h(p+1),o:p+1,y:g.toString().substr(2,2),Y:g,H:h(u),k:u,I:h(u%12||12),l:u%12||12,M:h(this.get("Minutes",o)),p:12>u?"AM":"PM",P:12>u?"am":"pm",S:h(o.getSeconds()),L:h(Math.floor(i%1e3),3)},t.dateFormats),l(o,(function(t,n){for(;-1!==e.indexOf("%"+n);)e=e.replace("%"+n,"function"==typeof t?t.call(a,i):t)})),r?e.substr(0,1).toUpperCase()+e.substr(1):e},e.prototype.resolveDTLFormat=function(t){return a(t,!0)?t:{main:(t=u(t))[0],from:t[1],to:t[2]}},e.prototype.getTimeTicks=function(t,e,i,r){var a,o=this,l=[],h={},u=new o.Date(e),f=t.unitRange,p=t.count||1;if(r=c(r,1),n(e)){if(o.set("Milliseconds",u,f>=d.second?0:p*Math.floor(o.get("Milliseconds",u)/p)),f>=d.second&&o.set("Seconds",u,f>=d.minute?0:p*Math.floor(o.get("Seconds",u)/p)),f>=d.minute&&o.set("Minutes",u,f>=d.hour?0:p*Math.floor(o.get("Minutes",u)/p)),f>=d.hour&&o.set("Hours",u,f>=d.day?0:p*Math.floor(o.get("Hours",u)/p)),f>=d.day&&o.set("Date",u,f>=d.month?1:Math.max(1,p*Math.floor(o.get("Date",u)/p))),f>=d.month){o.set("Month",u,f>=d.year?0:p*Math.floor(o.get("Month",u)/p));var g=o.get("FullYear",u)}f>=d.year&&o.set("FullYear",u,g-g%p),f===d.week&&(g=o.get("Day",u),o.set("Date",u,o.get("Date",u)-g+r+(g<r?-7:0))),g=o.get("FullYear",u),r=o.get("Month",u);var m=o.get("Date",u),v=o.get("Hours",u);for(e=u.getTime(),!o.variableTimezone&&o.useUTC||!n(i)||(a=i-e>4*d.month||o.getTimezoneOffset(e)!==o.getTimezoneOffset(i)),e=u.getTime(),u=1;e<i;)l.push(e),e=f===d.year?o.makeTime(g+u*p,0):f===d.month?o.makeTime(g,r+u*p):!a||f!==d.day&&f!==d.week?a&&f===d.hour&&1<p?o.makeTime(g,r,m,v+u*p):e+f*p:o.makeTime(g,r,m+u*p*(f===d.day?1:7)),u++;l.push(e),f<=d.hour&&1e4>l.length&&l.forEach((function(t){0==t%18e5&&"000000000"===o.dateFormat("%H%M%S%L",t)&&(h[t]="day")}))}return l.info=s(t,{higherRanks:h,totalRange:f*p}),l},e.prototype.getDateFormat=function(t,e,i,n){var r=this.dateFormat("%m-%d %H:%M:%S.%L",e),s={millisecond:15,second:12,minute:9,hour:6,day:3},a="millisecond";for(o in d){if(t===d.week&&+this.dateFormat("%w",e)===i&&"00:00:00.000"===r.substr(6)){var o="week";break}if(d[o]>t){o=a;break}if(s[o]&&r.substr(s[o])!=="01-01 00:00:00.000".substr(s[o]))break;"week"!==o&&(a=o)}return this.resolveDTLFormat(n[o]).main},e}(),e})),e(i,"Core/Defaults.js",[i["Core/Chart/ChartDefaults.js"],i["Core/Color/Color.js"],i["Core/Globals.js"],i["Core/Color/Palettes.js"],i["Core/Time.js"],i["Core/Utilities.js"]],(function(t,e,i,n,r,s){e=e.parse;var a=s.merge,o={colors:n.colors,symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:"January February March April May June July August September October November December".split(" "),shortMonths:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),decimalPoint:".",numericSymbols:"kMGTPE".split(""),resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{},time:{Date:void 0,getTimezoneOffset:void 0,timezone:void 0,timezoneOffset:0,useUTC:!0},chart:t,title:{text:"Chart title",align:"center",margin:15,widthAdjust:-44},subtitle:{text:"",align:"center",widthAdjust:-44},caption:{margin:15,text:"",align:"left",verticalAlign:"bottom"},plotOptions:{},labels:{style:{position:"absolute",color:"#333333"}},legend:{enabled:!0,align:"center",alignColumns:!0,className:"highcharts-no-tooltip",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{activeColor:"#003399",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",cursor:"pointer",fontSize:"12px",fontWeight:"bold",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#cccccc"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:i.svg,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerShape:"callout",hideDelay:500,padding:8,shape:"callout",shared:!1,snap:i.isTouchDevice?25:10,headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.y}</b><br/>',backgroundColor:e("#f7f7f7").setOpacity(.85).get(),borderWidth:1,shadow:!0,stickOnContact:!1,style:{color:"#333333",cursor:"default",fontSize:"12px",whiteSpace:"nowrap"},useHTML:!1},credits:{enabled:!0,href:"https://www.highcharts.com?credits",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"9px"},text:"Highcharts.com"}};o.chart.styledMode=!1;var l=new r(a(o.global,o.time));return t={defaultOptions:o,defaultTime:l,getOptions:function(){return o},setOptions:function(t){return a(!0,o,t),(t.time||t.global)&&(i.time?i.time.update(a(o.global,o.time,t.global,t.time)):i.time=l),o}}})),e(i,"Core/Animation/Fx.js",[i["Core/Color/Color.js"],i["Core/Globals.js"],i["Core/Utilities.js"]],(function(t,e,i){var n=t.parse,r=e.win,s=i.isNumber,a=i.objectEach;return function(){function t(t,e,i){this.pos=NaN,this.options=e,this.elem=t,this.prop=i}return t.prototype.dSetter=function(){var t=this.paths,e=t&&t[0];t=t&&t[1];var i=this.now||0,n=[];if(1!==i&&e&&t)if(e.length===t.length&&1>i)for(var r=0;r<t.length;r++){for(var a=e[r],o=t[r],l=[],h=0;h<o.length;h++){var c=a[h],u=o[h];s(c)&&s(u)&&("A"!==o[0]||4!==h&&5!==h)?l[h]=c+i*(u-c):l[h]=u}n.push(l)}else n=t;else n=this.toD||[];this.elem.attr("d",n,void 0,!0)},t.prototype.update=function(){var t=this.elem,e=this.prop,i=this.now,n=this.options.step;this[e+"Setter"]?this[e+"Setter"]():t.attr?t.element&&t.attr(e,i,null,!0):t.style[e]=i+this.unit,n&&n.call(t,i,this)},t.prototype.run=function(e,i,n){var s=this,a=s.options,o=function(t){return!o.stopped&&s.step(t)},l=r.requestAnimationFrame||function(t){setTimeout(t,13)},h=function(){for(var e=0;e<t.timers.length;e++)t.timers[e]()||t.timers.splice(e--,1);t.timers.length&&l(h)};e!==i||this.elem["forceAnimate:"+this.prop]?(this.startTime=+new Date,this.start=e,this.end=i,this.unit=n,this.now=this.start,this.pos=0,o.elem=this.elem,o.prop=this.prop,o()&&1===t.timers.push(o)&&l(h)):(delete a.curAnim[this.prop],a.complete&&0===Object.keys(a.curAnim).length&&a.complete.call(this.elem))},t.prototype.step=function(t){var e=+new Date,i=this.options,n=this.elem,r=i.complete,s=i.duration,o=i.curAnim;if(n.attr&&!n.element)t=!1;else if(t||e>=s+this.startTime){this.now=this.end,this.pos=1,this.update();var l=o[this.prop]=!0;a(o,(function(t){!0!==t&&(l=!1)})),l&&r&&r.call(n),t=!1}else this.pos=i.easing((e-this.startTime)/s),this.now=this.start+(this.end-this.start)*this.pos,this.update(),t=!0;return t},t.prototype.initPath=function(t,e,i){function n(t,e){for(;t.length<d;){var i=t[0],n=e[d-t.length];n&&"M"===i[0]&&(t[0]="C"===n[0]?["C",i[1],i[2],i[1],i[2],i[1],i[2]]:["L",i[1],i[2]]),t.unshift(i),l&&(i=t.pop(),t.push(t[t.length-1],i))}}function r(t,e){for(;t.length<d;)if("C"===(e=t[Math.floor(t.length/h)-1].slice())[0]&&(e[1]=e[5],e[2]=e[6]),l){var i=t[Math.floor(t.length/h)].slice();t.splice(t.length/2,0,e,i)}else t.push(e)}var a=t.startX,o=t.endX;i=i.slice();var l=t.isArea,h=l?2:1;if(!(e=e&&e.slice()))return[i,i];if(a&&o&&o.length){for(t=0;t<a.length;t++){if(a[t]===o[0]){var c=t;break}if(a[0]===o[o.length-a.length+t]){c=t;var u=!0;break}if(a[a.length-1]===o[o.length-a.length+t]){c=a.length-t;break}}void 0===c&&(e=[])}if(e.length&&s(c)){var d=i.length+c*h;u?(n(e,i),r(i,e)):(n(i,e),r(e,i))}return[e,i]},t.prototype.fillSetter=function(){t.prototype.strokeSetter.apply(this,arguments)},t.prototype.strokeSetter=function(){this.elem.attr(this.prop,n(this.start).tweenTo(n(this.end),this.pos),void 0,!0)},t.timers=[],t}()})),e(i,"Core/Animation/AnimationUtilities.js",[i["Core/Animation/Fx.js"],i["Core/Utilities.js"]],(function(t,e){function i(t){return l(t)?h({duration:500,defer:0},t):{duration:t?500:0,defer:0}}function n(e,i){for(var n=t.timers.length;n--;)t.timers[n].elem!==e||i&&i!==t.timers[n].prop||(t.timers[n].stopped=!0)}var r=e.defined,s=e.getStyle,a=e.isArray,o=e.isNumber,l=e.isObject,h=e.merge,c=e.objectEach,u=e.pick;return{animate:function(e,i,r){var u,d,f,p="";if(!l(r)){var g=arguments;r={duration:g[2],easing:g[3],complete:g[4]}}o(r.duration)||(r.duration=400),r.easing="function"==typeof r.easing?r.easing:Math[r.easing]||Math.easeInOutSine,r.curAnim=h(i),c(i,(function(o,l){n(e,l),f=new t(e,r,l),d=void 0,"d"===l&&a(i.d)?(f.paths=f.initPath(e,e.pathArray,i.d),f.toD=i.d,u=0,d=1):e.attr?u=e.attr(l):(u=parseFloat(s(e,l))||0,"opacity"!==l&&(p="px")),d||(d=o),"string"==typeof d&&d.match("px")&&(d=d.replace(/px/g,"")),f.run(u,d,p)}))},animObject:i,getDeferredAnimation:function(t,e,n){var s=i(e),a=0,o=0;return(n?[n]:t.series).forEach((function(t){t=i(t.options.animation),a=e&&r(e.defer)?s.defer:Math.max(a,t.duration+t.defer),o=Math.min(s.duration,t.duration)})),t.renderer.forExport&&(a=0),{defer:Math.max(0,a-o),duration:Math.min(a,o)}},setAnimation:function(t,e){e.renderer.globalAnimation=u(t,e.options.chart.animation,!0)},stop:n}})),e(i,"Core/Renderer/HTML/AST.js",[i["Core/Globals.js"],i["Core/Utilities.js"]],(function(t,e){var i=t.SVG_NS,n=e.attr,r=e.createElement,s=e.css,a=e.error,o=e.isFunction,l=e.isString,h=e.objectEach,c=e.splat,u=(e=t.win.trustedTypes)&&o(e.createPolicy)&&e.createPolicy("highcharts",{createHTML:function(t){return t}}),d=u?u.createHTML(""):"";try{var f=!!(new DOMParser).parseFromString(d,"text/html")}catch(t){f=!1}return o=function(){function e(t){this.nodes="string"==typeof t?this.parseMarkup(t):t}return e.filterUserAttributes=function(t){return h(t,(function(i,n){var r=!0;-1===e.allowedAttributes.indexOf(n)&&(r=!1),-1!==["background","dynsrc","href","lowsrc","src"].indexOf(n)&&(r=l(i)&&e.allowedReferences.some((function(t){return 0===i.indexOf(t)}))),r||(a(33,!1,void 0,{"Invalid attribute in config":"".concat(n)}),delete t[n]),l(i)&&t[n]&&(t[n]=i.replace(/</g,"&lt;"))})),t},e.parseStyle=function(t){return t.split(";").reduce((function(t,e){e=e.split(":").map((function(t){return t.trim()}));var i=e.shift();return i&&e.length&&(t[i.replace(/-([a-z])/g,(function(t){return t[1].toUpperCase()}))]=e.join(":")),t}),{})},e.setElementHTML=function(t,i){t.innerHTML=e.emptyHTML,i&&new e(i).addToDOM(t)},e.prototype.addToDOM=function(r){return function r(o,l){var u;return c(o).forEach((function(o){var c=o.tagName,d=o.textContent?t.doc.createTextNode(o.textContent):void 0,f=e.bypassHTMLFiltering;if(c)if("#text"===c)var p=d;else if(-1!==e.allowedTags.indexOf(c)||f){c=t.doc.createElementNS("svg"===c?i:l.namespaceURI||i,c);var g=o.attributes||{};h(o,(function(t,e){"tagName"!==e&&"attributes"!==e&&"children"!==e&&"style"!==e&&"textContent"!==e&&(g[e]=t)})),n(c,f?g:e.filterUserAttributes(g)),o.style&&s(c,o.style),d&&c.appendChild(d),r(o.children||[],c),p=c}else a(33,!1,void 0,{"Invalid tagName in config":c});p&&l.appendChild(p),u=p})),u}(this.nodes,r)},e.prototype.parseMarkup=function(t){var i=[];if(t=t.trim().replace(/ style=(["'])/g," data-style=$1"),f)t=(new DOMParser).parseFromString(u?u.createHTML(t):t,"text/html");else{var n=r("div");n.innerHTML=t,t={body:n}}var s=function(t,i){var n=t.nodeName.toLowerCase(),r={tagName:n};if("#text"===n&&(r.textContent=t.textContent||""),n=t.attributes){var a={};[].forEach.call(n,(function(t){"data-style"===t.name?r.style=e.parseStyle(t.value):a[t.name]=t.value})),r.attributes=a}if(t.childNodes.length){var o=[];[].forEach.call(t.childNodes,(function(t){s(t,o)})),o.length&&(r.children=o)}i.push(r)};return[].forEach.call(t.body.childNodes,(function(t){return s(t,i)})),i},e.allowedAttributes="aria-controls aria-describedby aria-expanded aria-haspopup aria-hidden aria-label aria-labelledby aria-live aria-pressed aria-readonly aria-roledescription aria-selected class clip-path color colspan cx cy d dx dy disabled fill height href id in markerHeight markerWidth offset opacity orient padding paddingLeft paddingRight patternUnits r refX refY role scope slope src startOffset stdDeviation stroke stroke-linecap stroke-width style tableValues result rowspan summary target tabindex text-align text-anchor textAnchor textLength title type valign width x x1 x2 xlink:href y y1 y2 zIndex".split(" "),e.allowedReferences="https:// http:// mailto: / ../ ./ #".split(" "),e.allowedTags="a abbr b br button caption circle clipPath code dd defs div dl dt em feComponentTransfer feFuncA feFuncB feFuncG feFuncR feGaussianBlur feOffset feMerge feMergeNode filter h1 h2 h3 h4 h5 h6 hr i img li linearGradient marker ol p path pattern pre rect small span stop strong style sub sup svg table text textPath thead title tbody tspan td th tr u ul #text".split(" "),e.emptyHTML=d,e.bypassHTMLFiltering=!1,e}(),o})),e(i,"Core/FormatUtilities.js",[i["Core/Defaults.js"],i["Core/Utilities.js"]],(function(t,e){function i(t,e,i,r){t=+t||0,e=+e;var s=n.lang,h=(t.toString().split(".")[1]||"").split("e")[0].length,c=t.toString().split("e"),u=e;if(-1===e)e=Math.min(h,20);else if(a(e)){if(e&&c[1]&&0>c[1]){var d=e+ +c[1];0<=d?(c[0]=(+c[0]).toExponential(d).split("e")[0],e=d):(c[0]=c[0].split(".")[0]||0,t=20>e?(c[0]*Math.pow(10,c[1])).toFixed(e):0,c[1]=0)}}else e=2;d=(Math.abs(c[1]?c[0]:t)+Math.pow(10,-Math.max(e,h)-1)).toFixed(e);var f=3<(h=String(l(d))).length?h.length%3:0;return i=o(i,s.decimalPoint),r=o(r,s.thousandsSep),t=(0>t?"-":"")+(f?h.substr(0,f)+r:""),t=0>+c[1]&&!u?"0":t+h.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+r),e&&(t+=i+d.slice(-e)),c[1]&&0!=+t&&(t+="e"+c[1]),t}var n=t.defaultOptions,r=t.defaultTime,s=e.getNestedProperty,a=e.isNumber,o=e.pick,l=e.pInt;return{dateFormat:function(t,e,i){return r.dateFormat(t,e,i)},format:function(t,e,a){var o="{",l=!1,h=/f$/,c=/\.([0-9])/,u=n.lang,d=a&&a.time||r;a=a&&a.numberFormatter||i;for(var f=[];t;){var p=t.indexOf(o);if(-1===p)break;var g=t.slice(0,p);if(l){if(g=g.split(":"),o=s(g.shift()||"",e),g.length&&"number"==typeof o)if(g=g.join(":"),h.test(g)){var m=parseInt((g.match(c)||["","-1"])[1],10);null!==o&&(o=a(o,m,u.decimalPoint,-1<g.indexOf(",")?u.thousandsSep:""))}else o=d.dateFormat(g,o);f.push(o)}else f.push(g);t=t.slice(p+1),o=(l=!l)?"}":"{"}return f.push(t),f.join("")},numberFormat:i}})),e(i,"Core/Renderer/RendererUtilities.js",[i["Core/Utilities.js"]],(function(t){var e,i=t.clamp,n=t.pick,r=t.stableSort;return function(t){t.distribute=function t(e,s,a){var o,l=e,h=l.reducedLen||s,c=function(t,e){return(e.rank||0)-(t.rank||0)},u=function(t,e){return t.target-e.target},d=!0,f=[],p=0;for(o=e.length;o--;)p+=e[o].size;if(p>h){for(r(e,c),p=o=0;p<=h;)p+=e[o].size,o++;f=e.splice(o-1,e.length)}for(r(e,u),e=e.map((function(t){return{size:t.size,targets:[t.target],align:n(t.align,.5)}}));d;){for(o=e.length;o--;)h=e[o],c=(Math.min.apply(0,h.targets)+Math.max.apply(0,h.targets))/2,h.pos=i(c-h.size*h.align,0,s-h.size);for(o=e.length,d=!1;o--;)0<o&&e[o-1].pos+e[o-1].size>e[o].pos&&(e[o-1].size+=e[o].size,e[o-1].targets=e[o-1].targets.concat(e[o].targets),e[o-1].align=.5,e[o-1].pos+e[o-1].size>s&&(e[o-1].pos=s-e[o-1].size),e.splice(o,1),d=!0)}return l.push.apply(l,f),o=0,e.some((function(e){var i=0;return(e.targets||[]).some((function(){return l[o].pos=e.pos+i,void 0!==a&&Math.abs(l[o].pos-l[o].target)>a?(l.slice(0,o+1).forEach((function(t){return delete t.pos})),l.reducedLen=(l.reducedLen||s)-.1*s,l.reducedLen>.1*s&&t(l,s,a),!0):(i+=l[o].size,o++,!1)}))})),r(l,u),l}}(e||(e={})),e})),e(i,"Core/Renderer/SVG/SVGElement.js",[i["Core/Animation/AnimationUtilities.js"],i["Core/Color/Color.js"],i["Core/Globals.js"],i["Core/Utilities.js"]],(function(t,e,i,n){var r=t.animate,s=t.animObject,a=t.stop,o=i.deg2rad,l=i.doc,h=i.svg,c=i.SVG_NS,u=i.win,d=n.addEvent,f=n.attr,p=n.createElement,g=n.css,m=n.defined,v=n.erase,y=n.extend,b=n.fireEvent,_=n.isArray,x=n.isFunction,w=n.isString,S=n.merge,T=n.objectEach,E=n.pick,k=n.pInt,C=n.syncTimeout,M=n.uniqueKey;return t=function(){function t(){this.element=void 0,this.onEvents={},this.opacity=1,this.renderer=void 0,this.SVG_NS=c,this.symbolCustomAttribs="x y width height r start end innerR anchorX anchorY rounded".split(" ")}return t.prototype._defaultGetter=function(t){return t=E(this[t+"Value"],this[t],this.element?this.element.getAttribute(t):null,0),/^[\-0-9\.]+$/.test(t)&&(t=parseFloat(t)),t},t.prototype._defaultSetter=function(t,e,i){i.setAttribute(e,t)},t.prototype.add=function(t){var e=this.renderer,i=this.element;if(t&&(this.parentGroup=t),void 0!==this.textStr&&"text"===this.element.nodeName&&e.buildText(this),this.added=!0,!t||t.handleZ||this.zIndex)var n=this.zIndexSetter();return n||(t?t.element:e.box).appendChild(i),this.onAdd&&this.onAdd(),this},t.prototype.addClass=function(t,e){var i=e?"":this.attr("class")||"";return t=(t||"").split(/ /g).reduce((function(t,e){return-1===i.indexOf(e)&&t.push(e),t}),i?[i]:[]).join(" "),t!==i&&this.attr("class",t),this},t.prototype.afterSetters=function(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)},t.prototype.align=function(t,e,i){var n,r,s,a={},o=this.renderer,l=o.alignedObjects;t?(this.alignOptions=t,this.alignByTranslate=e,(!i||w(i))&&(this.alignTo=n=i||"renderer",v(l,this),l.push(this),i=void 0)):(t=this.alignOptions,e=this.alignByTranslate,n=this.alignTo),i=E(i,o[n],"scrollablePlotBox"===n?o.plotBox:void 0,o),n=t.align;var h=t.verticalAlign;return o=(i.x||0)+(t.x||0),l=(i.y||0)+(t.y||0),"right"===n?r=1:"center"===n&&(r=2),r&&(o+=(i.width-(t.width||0))/r),a[e?"translateX":"x"]=Math.round(o),"bottom"===h?s=1:"middle"===h&&(s=2),s&&(l+=(i.height-(t.height||0))/s),a[e?"translateY":"y"]=Math.round(l),this[this.placed?"animate":"attr"](a),this.placed=!0,this.alignAttr=a,this},t.prototype.alignSetter=function(t){var e={left:"start",center:"middle",right:"end"};e[t]&&(this.alignValue=t,this.element.setAttribute("text-anchor",e[t]))},t.prototype.animate=function(t,e,i){var n=this,a=s(E(e,this.renderer.globalAnimation,!0));return e=a.defer,E(l.hidden,l.msHidden,l.webkitHidden,!1)&&(a.duration=0),0!==a.duration?(i&&(a.complete=i),C((function(){n.element&&r(n,t,a)}),e)):(this.attr(t,void 0,i||a.complete),T(t,(function(t,e){a.step&&a.step.call(this,t,{prop:e,pos:1,elem:this})}),this)),this},t.prototype.applyTextOutline=function(t){var e=this.element;-1!==t.indexOf("contrast")&&(t=t.replace(/contrast/g,this.renderer.getContrast(e.style.fill)));var n=t.split(" ");if(t=n[n.length-1],(n=n[0])&&"none"!==n&&i.svg){this.fakeTS=!0,n=n.replace(/(^[\d\.]+)(.*?)$/g,(function(t,e,i){return 2*Number(e)+i})),this.removeTextOutline();var r=l.createElementNS(c,"tspan");f(r,{class:"highcharts-text-outline",fill:t,stroke:t,"stroke-width":n,"stroke-linejoin":"round"}),t=e.querySelector("textPath")||e,[].forEach.call(t.childNodes,(function(t){var e=t.cloneNode(!0);e.removeAttribute&&["fill","stroke","stroke-width","stroke"].forEach((function(t){return e.removeAttribute(t)})),r.appendChild(e)}));var s=0;[].forEach.call(t.querySelectorAll("text tspan"),(function(t){s+=Number(t.getAttribute("dy"))})),(n=l.createElementNS(c,"tspan")).textContent="​",f(n,{x:Number(e.getAttribute("x")),dy:-s}),r.appendChild(n),t.insertBefore(r,t.firstChild)}},t.prototype.attr=function(t,e,i,n){var r,s,o,l=this.element,h=this.symbolCustomAttribs,c=this;if("string"==typeof t&&void 0!==e){var u=t;(t={})[u]=e}return"string"==typeof t?c=(this[t+"Getter"]||this._defaultGetter).call(this,t,l):(T(t,(function(e,i){s=!1,n||a(this,i),this.symbolName&&-1!==h.indexOf(i)&&(r||(this.symbolAttr(t),r=!0),s=!0),!this.rotation||"x"!==i&&"y"!==i||(this.doTransform=!0),s||((o=this[i+"Setter"]||this._defaultSetter).call(this,e,i,l),!this.styledMode&&this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(i)&&this.updateShadows(i,e,o))}),this),this.afterSetters()),i&&i.call(this),c},t.prototype.clip=function(t){return this.attr("clip-path",t?"url("+this.renderer.url+"#"+t.id+")":"none")},t.prototype.crisp=function(t,e){e=e||t.strokeWidth||0;var i=Math.round(e)%2/2;return t.x=Math.floor(t.x||this.x||0)+i,t.y=Math.floor(t.y||this.y||0)+i,t.width=Math.floor((t.width||this.width||0)-2*i),t.height=Math.floor((t.height||this.height||0)-2*i),m(t.strokeWidth)&&(t.strokeWidth=e),t},t.prototype.complexColor=function(t,i,n){var r,s,a,o,l,h,c,u,d,f,p,g=this.renderer,v=[];b(this.renderer,"complexColor",{args:arguments},(function(){if(t.radialGradient?s="radialGradient":t.linearGradient&&(s="linearGradient"),s){if(a=t[s],l=g.gradients,h=t.stops,d=n.radialReference,_(a)&&(t[s]=a={x1:a[0],y1:a[1],x2:a[2],y2:a[3],gradientUnits:"userSpaceOnUse"}),"radialGradient"===s&&d&&!m(a.gradientUnits)&&(o=a,a=S(a,g.getRadialAttr(d,o),{gradientUnits:"userSpaceOnUse"})),T(a,(function(t,e){"id"!==e&&v.push(e,t)})),T(h,(function(t){v.push(t)})),v=v.join(","),l[v])f=l[v].attr("id");else{a.id=f=M();var y=l[v]=g.createElement(s).attr(a).add(g.defs);y.radAttr=o,y.stops=[],h.forEach((function(t){0===t[1].indexOf("rgba")?(r=e.parse(t[1]),c=r.get("rgb"),u=r.get("a")):(c=t[1],u=1),t=g.createElement("stop").attr({offset:t[0],"stop-color":c,"stop-opacity":u}).add(y),y.stops.push(t)}))}p="url("+g.url+"#"+f+")",n.setAttribute(i,p),n.gradient=v,t.toString=function(){return p}}}))},t.prototype.css=function(t){var e=this.styles,i={},n=this.element,r=!e;if(t.color&&(t.fill=t.color),e&&T(t,(function(t,n){e&&e[n]!==t&&(i[n]=t,r=!0)})),r){if(e&&(t=y(e,i)),null===t.width||"auto"===t.width)delete this.textWidth;else if("text"===n.nodeName.toLowerCase()&&t.width)var s=this.textWidth=k(t.width);this.styles=t,s&&!h&&this.renderer.forExport&&delete t.width;var a=S(t);n.namespaceURI===this.SVG_NS&&["textOutline","textOverflow","width"].forEach((function(t){return a&&delete a[t]})),g(n,a),this.added&&("text"===this.element.nodeName&&this.renderer.buildText(this),t.textOutline&&this.applyTextOutline(t.textOutline))}return this},t.prototype.dashstyleSetter=function(t){var e=this["stroke-width"];if("inherit"===e&&(e=1),t=t&&t.toLowerCase()){var i=t.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(t=i.length;t--;)i[t]=""+k(i[t])*E(e,NaN);t=i.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",t)}},t.prototype.destroy=function(){var t=this,e=t.element||{},i=t.renderer,n=e.ownerSVGElement,r=i.isSVG&&"SPAN"===e.nodeName&&t.parentGroup||void 0;if(e.onclick=e.onmouseout=e.onmouseover=e.onmousemove=e.point=null,a(t),t.clipPath&&n){var s=t.clipPath;[].forEach.call(n.querySelectorAll("[clip-path],[CLIP-PATH]"),(function(t){-1<t.getAttribute("clip-path").indexOf(s.element.id)&&t.removeAttribute("clip-path")})),t.clipPath=s.destroy()}if(t.stops){for(n=0;n<t.stops.length;n++)t.stops[n].destroy();t.stops.length=0,t.stops=void 0}for(t.safeRemoveChild(e),i.styledMode||t.destroyShadows();r&&r.div&&0===r.div.childNodes.length;)e=r.parentGroup,t.safeRemoveChild(r.div),delete r.div,r=e;t.alignTo&&v(i.alignedObjects,t),T(t,(function(e,i){t[i]&&t[i].parentGroup===t&&t[i].destroy&&t[i].destroy(),delete t[i]}))},t.prototype.destroyShadows=function(){(this.shadows||[]).forEach((function(t){this.safeRemoveChild(t)}),this),this.shadows=void 0},t.prototype.dSetter=function(t,e,i){_(t)&&("string"==typeof t[0]&&(t=this.renderer.pathToSegments(t)),this.pathArray=t,t=t.reduce((function(t,e,i){return e&&e.join?(i?t+" ":"")+e.join(" "):(e||"").toString()}),"")),/(NaN| {2}|^$)/.test(t)&&(t="M 0 0"),this[e]!==t&&(i.setAttribute(e,t),this[e]=t)},t.prototype.fadeOut=function(t){var e=this;e.animate({opacity:0},{duration:E(t,150),complete:function(){e.hide()}})},t.prototype.fillSetter=function(t,e,i){"string"==typeof t?i.setAttribute(e,t):t&&this.complexColor(t,e,i)},t.prototype.getBBox=function(e,i){var n=this.alignValue,r=this.element,s=this.renderer,a=this.styles,l=this.textStr,h=s.cache,c=s.cacheKeys,u=r.namespaceURI===this.SVG_NS;i=E(i,this.rotation,0);var d,f=s.styledMode?r&&t.prototype.getStyle.call(r,"font-size"):a&&a.fontSize;if(m(l)){var p=l.toString();-1===p.indexOf("<")&&(p=p.replace(/[0-9]/g,"0")),p+=["",i,f,this.textWidth,n,a&&a.textOverflow,a&&a.fontWeight].join()}if(p&&!e&&(d=h[p]),!d){if(u||s.forExport){try{var v=this.fakeTS&&function(t){var e=r.querySelector(".highcharts-text-outline");e&&g(e,{display:t})};x(v)&&v("none"),d=r.getBBox?y({},r.getBBox()):{width:r.offsetWidth,height:r.offsetHeight,x:0,y:0},x(v)&&v("")}catch(t){}(!d||0>d.width)&&(d={x:0,y:0,width:0,height:0})}else d=this.htmlGetBBox();if(s.isSVG&&(s=d.width,e=d.height,u&&(d.height=e={"11px,17":14,"13px,20":16}[""+(f||"")+",".concat(Math.round(e))]||e),i)){u=Number(r.getAttribute("y")||0)-d.y,n={right:1,center:.5}[n||0]||0,a=i*o,f=(i-90)*o;var b=s*Math.cos(a);i=s*Math.sin(a),v=Math.cos(f),a=Math.sin(f),b=(v=(f=(s=d.x+n*(s-b)+u*v)+b)-e*v)-b,i=(e=(n=(u=d.y+u-n*i+u*a)+i)-e*a)-i,d.x=Math.min(s,f,v,b),d.y=Math.min(u,n,e,i),d.width=Math.max(s,f,v,b)-d.x,d.height=Math.max(u,n,e,i)-d.y}if(p&&(""===l||0<d.height)){for(;250<c.length;)delete h[c.shift()];h[p]||c.push(p),h[p]=d}}return d},t.prototype.getStyle=function(t){return u.getComputedStyle(this.element||this,"").getPropertyValue(t)},t.prototype.hasClass=function(t){return-1!==(""+this.attr("class")).split(" ").indexOf(t)},t.prototype.hide=function(){return this.attr({visibility:"hidden"})},t.prototype.htmlGetBBox=function(){return{height:0,width:0,x:0,y:0}},t.prototype.init=function(t,e){this.element="span"===e?p(e):l.createElementNS(this.SVG_NS,e),this.renderer=t,b(this,"afterInit")},t.prototype.on=function(t,e){var i=this.onEvents;return i[t]&&i[t](),i[t]=d(this.element,t,e),this},t.prototype.opacitySetter=function(t,e,i){this.opacity=t=Number(Number(t).toFixed(3)),i.setAttribute(e,t)},t.prototype.removeClass=function(t){return this.attr("class",(""+this.attr("class")).replace(w(t)?new RegExp("(^| )".concat(t,"( |$)")):t," ").replace(/ +/g," ").trim())},t.prototype.removeTextOutline=function(){var t=this.element.querySelector("tspan.highcharts-text-outline");t&&this.safeRemoveChild(t)},t.prototype.safeRemoveChild=function(t){var e=t.parentNode;e&&e.removeChild(t)},t.prototype.setRadialReference=function(t){var e=this.element.gradient&&this.renderer.gradients[this.element.gradient];return this.element.radialReference=t,e&&e.radAttr&&e.animate(this.renderer.getRadialAttr(t,e.radAttr)),this},t.prototype.setTextPath=function(t,e){var i=this;e=S(!0,{enabled:!0,attributes:{dy:-5,startOffset:"50%",textAnchor:"middle"}},e);var n=this.renderer.url,r=this.text||this,s=r.textPath,a=e.attributes,o=e.enabled;return t=t||s&&s.path,s&&s.undo(),t&&o?(e=d(r,"afterModifyTree",(function(e){if(t&&o){var s=t.attr("id");s||t.attr("id",s=M());var l={x:0,y:0};m(a.dx)&&(l.dx=a.dx,delete a.dx),m(a.dy)&&(l.dy=a.dy,delete a.dy),r.attr(l),i.attr({transform:""}),i.box&&(i.box=i.box.destroy()),l=e.nodes.slice(0),e.nodes.length=0,e.nodes[0]={tagName:"textPath",attributes:y(a,{"text-anchor":a.textAnchor,href:""+n+"#".concat(s)}),children:l}}})),r.textPath={path:t,undo:e}):(r.attr({dx:0,dy:0}),delete r.textPath),this.added&&(r.textCache="",this.renderer.buildText(r)),this},t.prototype.shadow=function(t,e,i){var n=[],r=this.element,s=this.oldShadowOptions,a=this.parentGroup,o=a&&90===a.rotation;a={color:"#000000",offsetX:o?-1:1,offsetY:o?-1:1,opacity:.15,width:3};var l,h=!1;if(!0===t?l=a:"object"==typeof t&&(l=y(a,t)),l&&(l&&s&&T(l,(function(t,e){t!==s[e]&&(h=!0)})),h&&this.destroyShadows(),this.oldShadowOptions=l),l){if(!this.shadows){a=l.opacity/l.width;var c=o?"translate(".concat(l.offsetY,", ").concat(l.offsetX,")"):"translate(".concat(l.offsetX,", ").concat(l.offsetY,")");for(o=1;o<=l.width;o++){var u=r.cloneNode(!1),d=2*l.width+1-2*o;f(u,{stroke:t.color||"#000000","stroke-opacity":a*o,"stroke-width":d,transform:c,fill:"none"}),u.setAttribute("class",(u.getAttribute("class")||"")+" highcharts-shadow"),i&&(f(u,"height",Math.max(f(u,"height")-d,0)),u.cutHeight=d),e?e.element.appendChild(u):r.parentNode&&r.parentNode.insertBefore(u,r),n.push(u)}this.shadows=n}}else this.destroyShadows();return this},t.prototype.show=function(t){return void 0===t&&(t=!0),this.attr({visibility:t?"inherit":"visible"})},t.prototype["stroke-widthSetter"]=function(t,e,i){this[e]=t,i.setAttribute(e,t)},t.prototype.strokeWidth=function(){if(!this.renderer.styledMode)return this["stroke-width"]||0;var t=this.getStyle("stroke-width"),e=0;if(t.indexOf("px")===t.length-2)e=k(t);else if(""!==t){var i=l.createElementNS(c,"rect");f(i,{width:t,"stroke-width":0}),this.element.parentNode.appendChild(i),e=i.getBBox().width,i.parentNode.removeChild(i)}return e},t.prototype.symbolAttr=function(t){var e=this;"x y r start end width height innerR anchorX anchorY clockwise".split(" ").forEach((function(i){e[i]=E(t[i],e[i])})),e.attr({d:e.renderer.symbols[e.symbolName](e.x,e.y,e.width,e.height,e)})},t.prototype.textSetter=function(t){t!==this.textStr&&(delete this.textPxLength,this.textStr=t,this.added&&this.renderer.buildText(this))},t.prototype.titleSetter=function(t){var e=this.element,i=e.getElementsByTagName("title")[0]||l.createElementNS(this.SVG_NS,"title");e.insertBefore?e.insertBefore(i,e.firstChild):e.appendChild(i),i.textContent=String(E(t,"")).replace(/<[^>]*>/g,"").replace(/&lt;/g,"<").replace(/&gt;/g,">")},t.prototype.toFront=function(){var t=this.element;return t.parentNode.appendChild(t),this},t.prototype.translate=function(t,e){return this.attr({translateX:t,translateY:e})},t.prototype.updateShadows=function(t,e,i){var n=this.shadows;if(n)for(var r=n.length;r--;)i.call(n[r],"height"===t?Math.max(e-(n[r].cutHeight||0),0):"d"===t?this.d:e,t,n[r])},t.prototype.updateTransform=function(){var t=this.element,e=this.matrix,i=this.rotation;i=void 0===i?0:i;var n=this.scaleX,r=this.scaleY,s=this.translateX,a=this.translateY;s=["translate("+(void 0===s?0:s)+","+(void 0===a?0:a)+")"],m(e)&&s.push("matrix("+e.join(",")+")"),i&&s.push("rotate("+i+" "+E(this.rotationOriginX,t.getAttribute("x"),0)+" "+E(this.rotationOriginY,t.getAttribute("y")||0)+")"),(m(n)||m(r))&&s.push("scale("+E(n,1)+" "+E(r,1)+")"),s.length&&!(this.text||this).textPath&&t.setAttribute("transform",s.join(" "))},t.prototype.visibilitySetter=function(t,e,i){"inherit"===t?i.removeAttribute(e):this[e]!==t&&i.setAttribute(e,t),this[e]=t},t.prototype.xGetter=function(t){return"circle"===this.element.nodeName&&("x"===t?t="cx":"y"===t&&(t="cy")),this._defaultGetter(t)},t.prototype.zIndexSetter=function(t,e){var i=this.renderer,n=this.parentGroup,r=(n||i).element||i.box,s=this.element;i=r===i.box;var a,o=!1,l=this.added;if(m(t)?(s.setAttribute("data-z-index",t),t=+t,this[e]===t&&(l=!1)):m(this[e])&&s.removeAttribute("data-z-index"),this[e]=t,l){for((t=this.zIndex)&&n&&(n.handleZ=!0),a=(e=r.childNodes).length-1;0<=a&&!o;a--){l=(n=e[a]).getAttribute("data-z-index");var h=!m(l);n!==s&&(0>t&&h&&!i&&!a?(r.insertBefore(s,e[a]),o=!0):(k(l)<=t||h&&(!m(t)||0<=t))&&(r.insertBefore(s,e[a+1]||null),o=!0))}o||(r.insertBefore(s,e[i?3:0]||null),o=!0)}return o},t}(),t.prototype.strokeSetter=t.prototype.fillSetter,t.prototype.yGetter=t.prototype.xGetter,t.prototype.matrixSetter=t.prototype.rotationOriginXSetter=t.prototype.rotationOriginYSetter=t.prototype.rotationSetter=t.prototype.scaleXSetter=t.prototype.scaleYSetter=t.prototype.translateXSetter=t.prototype.translateYSetter=t.prototype.verticalAlignSetter=function(t,e){this[e]=t,this.doTransform=!0},t})),e(i,"Core/Renderer/RendererRegistry.js",[i["Core/Globals.js"]],(function(t){var e;return function(e){var i;e.rendererTypes={},e.getRendererType=function(t){return void 0===t&&(t=i),e.rendererTypes[t]||e.rendererTypes[i]},e.registerRendererType=function(n,r,s){e.rendererTypes[n]=r,i&&!s||(i=n,t.Renderer=r)}}(e||(e={})),e})),e(i,"Core/Renderer/SVG/SVGLabel.js",[i["Core/Renderer/SVG/SVGElement.js"],i["Core/Utilities.js"]],(function(t,e){var i=this&&this.__extends||function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),n=e.defined,r=e.extend,s=e.isNumber,a=e.merge,o=e.pick,l=e.removeEvent;return function(e){function h(t,i,n,r,s,a,o,l,c,u){var d,f=e.call(this)||this;return f.paddingLeftSetter=f.paddingSetter,f.paddingRightSetter=f.paddingSetter,f.init(t,"g"),f.textStr=i,f.x=n,f.y=r,f.anchorX=a,f.anchorY=o,f.baseline=c,f.className=u,f.addClass("button"===u?"highcharts-no-tooltip":"highcharts-label"),u&&f.addClass("highcharts-"+u),f.text=t.text(void 0,0,0,l).attr({zIndex:1}),"string"==typeof s&&((d=/^url\((.*?)\)$/.test(s))||f.renderer.symbols[s])&&(f.symbolKey=s),f.bBox=h.emptyBBox,f.padding=3,f.baselineOffset=0,f.needsBox=t.styledMode||d,f.deferredAttr={},f.alignFactor=0,f}return i(h,e),h.prototype.alignSetter=function(t){(t={left:0,center:.5,right:1}[t])!==this.alignFactor&&(this.alignFactor=t,this.bBox&&s(this.xSetting)&&this.attr({x:this.xSetting}))},h.prototype.anchorXSetter=function(t,e){this.anchorX=t,this.boxAttr(e,Math.round(t)-this.getCrispAdjust()-this.xSetting)},h.prototype.anchorYSetter=function(t,e){this.anchorY=t,this.boxAttr(e,t-this.ySetting)},h.prototype.boxAttr=function(t,e){this.box?this.box.attr(t,e):this.deferredAttr[t]=e},h.prototype.css=function(e){if(e){var i={};e=a(e),h.textProps.forEach((function(t){void 0!==e[t]&&(i[t]=e[t],delete e[t])})),this.text.css(i),"fontSize"in i||"fontWeight"in i?this.updateTextPadding():("width"in i||"textOverflow"in i)&&this.updateBoxSize()}return t.prototype.css.call(this,e)},h.prototype.destroy=function(){l(this.element,"mouseenter"),l(this.element,"mouseleave"),this.text&&this.text.destroy(),this.box&&(this.box=this.box.destroy()),t.prototype.destroy.call(this)},h.prototype.fillSetter=function(t,e){t&&(this.needsBox=!0),this.fill=t,this.boxAttr(e,t)},h.prototype.getBBox=function(){this.textStr&&0===this.bBox.width&&0===this.bBox.height&&this.updateBoxSize();var t=this.padding,e=o(this.paddingLeft,t);return{width:this.width,height:this.height,x:this.bBox.x-e,y:this.bBox.y-t}},h.prototype.getCrispAdjust=function(){return this.renderer.styledMode&&this.box?this.box.strokeWidth()%2/2:(this["stroke-width"]?parseInt(this["stroke-width"],10):0)%2/2},h.prototype.heightSetter=function(t){this.heightSetting=t},h.prototype.onAdd=function(){this.text.add(this),this.attr({text:o(this.textStr,""),x:this.x||0,y:this.y||0}),this.box&&n(this.anchorX)&&this.attr({anchorX:this.anchorX,anchorY:this.anchorY})},h.prototype.paddingSetter=function(t,e){s(t)?t!==this[e]&&(this[e]=t,this.updateTextPadding()):this[e]=void 0},h.prototype.rSetter=function(t,e){this.boxAttr(e,t)},h.prototype.shadow=function(t){return t&&!this.renderer.styledMode&&(this.updateBoxSize(),this.box&&this.box.shadow(t)),this},h.prototype.strokeSetter=function(t,e){this.stroke=t,this.boxAttr(e,t)},h.prototype["stroke-widthSetter"]=function(t,e){t&&(this.needsBox=!0),this["stroke-width"]=t,this.boxAttr(e,t)},h.prototype["text-alignSetter"]=function(t){this.textAlign=t},h.prototype.textSetter=function(t){void 0!==t&&this.text.attr({text:t}),this.updateTextPadding()},h.prototype.updateBoxSize=function(){var t=this.text,e=t.element.style,i={},a=this.padding,o=this.bBox=s(this.widthSetting)&&s(this.heightSetting)&&!this.textAlign||!n(t.textStr)?h.emptyBBox:t.getBBox();this.width=this.getPaddedWidth(),this.height=(this.heightSetting||o.height||0)+2*a,e=this.renderer.fontMetrics(e&&e.fontSize,t),this.baselineOffset=a+Math.min((this.text.firstLineMetrics||e).b,o.height||1/0),this.heightSetting&&(this.baselineOffset+=(this.heightSetting-e.h)/2),this.needsBox&&!t.textPath&&(this.box||((t=this.box=this.symbolKey?this.renderer.symbol(this.symbolKey):this.renderer.rect()).addClass(("button"===this.className?"":"highcharts-label-box")+(this.className?" highcharts-"+this.className+"-box":"")),t.add(this)),t=this.getCrispAdjust(),i.x=t,i.y=(this.baseline?-this.baselineOffset:0)+t,i.width=Math.round(this.width),i.height=Math.round(this.height),this.box.attr(r(i,this.deferredAttr)),this.deferredAttr={})},h.prototype.updateTextPadding=function(){var t=this.text;if(!t.textPath){this.updateBoxSize();var e=this.baseline?0:this.baselineOffset,i=o(this.paddingLeft,this.padding);n(this.widthSetting)&&this.bBox&&("center"===this.textAlign||"right"===this.textAlign)&&(i+={center:.5,right:1}[this.textAlign]*(this.widthSetting-this.bBox.width)),i===t.x&&e===t.y||(t.attr("x",i),t.hasBoxWidthChanged&&(this.bBox=t.getBBox(!0)),void 0!==e&&t.attr("y",e)),t.x=i,t.y=e}},h.prototype.widthSetter=function(t){this.widthSetting=s(t)?t:void 0},h.prototype.getPaddedWidth=function(){var t=this.padding,e=o(this.paddingLeft,t);return t=o(this.paddingRight,t),(this.widthSetting||this.bBox.width||0)+e+t},h.prototype.xSetter=function(t){this.x=t,this.alignFactor&&(t-=this.alignFactor*this.getPaddedWidth(),this["forceAnimate:x"]=!0),this.xSetting=Math.round(t),this.attr("translateX",this.xSetting)},h.prototype.ySetter=function(t){this.ySetting=this.y=Math.round(t),this.attr("translateY",this.ySetting)},h.emptyBBox={width:0,height:0,x:0,y:0},h.textProps="color direction fontFamily fontSize fontStyle fontWeight lineHeight textAlign textDecoration textOutline textOverflow width".split(" "),h}(t)})),e(i,"Core/Renderer/SVG/Symbols.js",[i["Core/Utilities.js"]],(function(t){function e(t,e,i,n,s){var o=[];if(s){var l=s.start||0,h=a(s.r,i);i=a(s.r,n||i);var c=(s.end||0)-.001;n=s.innerR;var u=a(s.open,.001>Math.abs((s.end||0)-l-2*Math.PI)),d=Math.cos(l),f=Math.sin(l),p=Math.cos(c),g=Math.sin(c);l=a(s.longArc,.001>c-l-Math.PI?0:1),o.push(["M",t+h*d,e+i*f],["A",h,i,0,l,a(s.clockwise,1),t+h*p,e+i*g]),r(n)&&o.push(u?["M",t+n*p,e+n*g]:["L",t+n*p,e+n*g],["A",n,n,0,l,r(s.clockwise)?1-s.clockwise:0,t+n*d,e+n*f]),u||o.push(["Z"])}return o}function i(t,e,i,r,s){return s&&s.r?n(t,e,i,r,s):[["M",t,e],["L",t+i,e],["L",t+i,e+r],["L",t,e+r],["Z"]]}function n(t,e,i,n,r){return[["M",t+(r=r&&r.r||0),e],["L",t+i-r,e],["C",t+i,e,t+i,e,t+i,e+r],["L",t+i,e+n-r],["C",t+i,e+n,t+i,e+n,t+i-r,e+n],["L",t+r,e+n],["C",t,e+n,t,e+n,t,e+n-r],["L",t,e+r],["C",t,e,t,e,t+r,e]]}var r=t.defined,s=t.isNumber,a=t.pick;return{arc:e,callout:function(t,e,i,r,a){var o=Math.min(a&&a.r||0,i,r),l=o+6,h=a&&a.anchorX;a=a&&a.anchorY||0;var c=n(t,e,i,r,{r:o});return s(h)?(t+h>=i?a>e+l&&a<e+r-l?c.splice(3,1,["L",t+i,a-6],["L",t+i+6,a],["L",t+i,a+6],["L",t+i,e+r-o]):c.splice(3,1,["L",t+i,r/2],["L",h,a],["L",t+i,r/2],["L",t+i,e+r-o]):0>=t+h?a>e+l&&a<e+r-l?c.splice(7,1,["L",t,a+6],["L",t-6,a],["L",t,a-6],["L",t,e+o]):c.splice(7,1,["L",t,r/2],["L",h,a],["L",t,r/2],["L",t,e+o]):a&&a>r&&h>t+l&&h<t+i-l?c.splice(5,1,["L",h+6,e+r],["L",h,e+r+6],["L",h-6,e+r],["L",t+o,e+r]):a&&0>a&&h>t+l&&h<t+i-l&&c.splice(1,1,["L",h-6,e],["L",h,e-6],["L",h+6,e],["L",i-o,e]),c):c},circle:function(t,i,n,r){return e(t+n/2,i+r/2,n/2,r/2,{start:.5*Math.PI,end:2.5*Math.PI,open:!1})},diamond:function(t,e,i,n){return[["M",t+i/2,e],["L",t+i,e+n/2],["L",t+i/2,e+n],["L",t,e+n/2],["Z"]]},rect:i,roundedRect:n,square:i,triangle:function(t,e,i,n){return[["M",t+i/2,e],["L",t+i,e+n],["L",t,e+n],["Z"]]},"triangle-down":function(t,e,i,n){return[["M",t,e],["L",t+i,e],["L",t+i/2,e+n],["Z"]]}}})),e(i,"Core/Renderer/SVG/TextBuilder.js",[i["Core/Renderer/HTML/AST.js"],i["Core/Globals.js"],i["Core/Utilities.js"]],(function(t,e,i){var n=e.doc,r=e.SVG_NS,s=e.win,a=i.attr,o=i.extend,l=i.fireEvent,h=i.isString,c=i.objectEach,u=i.pick;return function(){function e(t){var e=t.styles;this.renderer=t.renderer,this.svgElement=t,this.width=t.textWidth,this.textLineHeight=e&&e.lineHeight,this.textOutline=e&&e.textOutline,this.ellipsis=!(!e||"ellipsis"!==e.textOverflow),this.noWrap=!(!e||"nowrap"!==e.whiteSpace),this.fontSize=e&&e.fontSize}return e.prototype.buildSVG=function(){var e=this.svgElement,i=e.element,r=e.renderer,s=u(e.textStr,"").toString(),a=-1!==s.indexOf("<"),o=i.childNodes;r=this.width&&!e.added&&r.box;var l=[s,this.ellipsis,this.noWrap,this.textLineHeight,this.textOutline,this.fontSize,this.width].join();if(l!==e.textCache){for(e.textCache=l,delete e.actualWidth,l=o.length;l--;)i.removeChild(o[l]);a||this.ellipsis||this.width||e.textPath||-1!==s.indexOf(" ")&&(!this.noWrap||/<br.*?>/g.test(s))?""!==s&&(r&&r.appendChild(i),s=new t(s),this.modifyTree(s.nodes),s.addToDOM(i),this.modifyDOM(),this.ellipsis&&-1!==(i.textContent||"").indexOf("…")&&e.attr("title",this.unescapeEntities(e.textStr||"",["&lt;","&gt;"])),r&&r.removeChild(i)):i.appendChild(n.createTextNode(this.unescapeEntities(s))),h(this.textOutline)&&e.applyTextOutline&&e.applyTextOutline(this.textOutline)}},e.prototype.modifyDOM=function(){var t,e=this,i=this.svgElement,o=a(i.element,"x");for(i.firstLineMetrics=void 0;(t=i.element.firstChild)&&/^[\s\u200B]*$/.test(t.textContent||" ");)i.element.removeChild(t);[].forEach.call(i.element.querySelectorAll("tspan.highcharts-br"),(function(t,n){t.nextSibling&&t.previousSibling&&(0===n&&1===t.previousSibling.nodeType&&(i.firstLineMetrics=i.renderer.fontMetrics(void 0,t.previousSibling)),a(t,{dy:e.getLineHeight(t.nextSibling),x:o}))}));var l=this.width||0;if(l){var h=function(t,s){var h=t.textContent||"",c=h.replace(/([^\^])-/g,"$1- ").split(" "),u=!e.noWrap&&(1<c.length||1<i.element.childNodes.length),d=e.getLineHeight(s),f=0,p=i.actualWidth;if(e.ellipsis)h&&e.truncate(t,h,void 0,0,Math.max(0,l-parseInt(e.fontSize||12,10)),(function(t,e){return t.substring(0,e)+"…"}));else if(u){for(h=[],u=[];s.firstChild&&s.firstChild!==t;)u.push(s.firstChild),s.removeChild(s.firstChild);for(;c.length;)c.length&&!e.noWrap&&0<f&&(h.push(t.textContent||""),t.textContent=c.join(" ").replace(/- /g,"-")),e.truncate(t,void 0,c,0===f&&p||0,l,(function(t,e){return c.slice(0,e).join(" ").replace(/- /g,"-")})),p=i.actualWidth,f++;u.forEach((function(e){s.insertBefore(e,t)})),h.forEach((function(e){s.insertBefore(n.createTextNode(e),t),(e=n.createElementNS(r,"tspan")).textContent="​",a(e,{dy:d,x:o}),s.insertBefore(e,t)}))}},c=function(t){[].slice.call(t.childNodes).forEach((function(e){e.nodeType===s.Node.TEXT_NODE?h(e,t):(-1!==e.className.baseVal.indexOf("highcharts-br")&&(i.actualWidth=0),c(e))}))};c(i.element)}},e.prototype.getLineHeight=function(t){var e;return t=t.nodeType===s.Node.TEXT_NODE?t.parentElement:t,this.renderer.styledMode||(e=t&&/(px|em)$/.test(t.style.fontSize)?t.style.fontSize:this.fontSize||this.renderer.style.fontSize||12),this.textLineHeight?parseInt(this.textLineHeight.toString(),10):this.renderer.fontMetrics(e,t||this.svgElement.element).h},e.prototype.modifyTree=function(t){var e=this,i=function(n,r){var s=n.attributes;s=void 0===s?{}:s;var a=n.children,l=n.style;l=void 0===l?{}:l;var h=n.tagName,c=e.renderer.styledMode;"b"===h||"strong"===h?c?s.class="highcharts-strong":l.fontWeight="bold":"i"!==h&&"em"!==h||(c?s.class="highcharts-emphasized":l.fontStyle="italic"),l&&l.color&&(l.fill=l.color),"br"===h?(s.class="highcharts-br",n.textContent="​",(r=t[r+1])&&r.textContent&&(r.textContent=r.textContent.replace(/^ +/gm,""))):"a"===h&&a&&a.some((function(t){return"#text"===t.tagName}))&&(n.children=[{children:a,tagName:"tspan"}]),"#text"!==h&&"a"!==h&&(n.tagName="tspan"),o(n,{attributes:s,style:l}),a&&a.filter((function(t){return"#text"!==t.tagName})).forEach(i)};t.forEach(i),l(this.svgElement,"afterModifyTree",{nodes:t})},e.prototype.truncate=function(t,e,i,n,r,s){var a,o=this.svgElement,l=o.renderer,h=o.rotation,c=[],u=i?1:0,d=(e||i||"").length,f=d,p=function(r,a){a=a||r;var h=t.parentNode;if(h&&void 0===c[a])if(h.getSubStringLength)try{c[a]=n+h.getSubStringLength(0,i?a+1:a)}catch(t){}else l.getSpanWidth&&(t.textContent=s(e||i,r),c[a]=n+l.getSpanWidth(o,t));return c[a]};o.rotation=0;var g=p(t.textContent.length);if(n+g>r){for(;u<=d;)f=Math.ceil((u+d)/2),i&&(a=s(i,f)),g=p(f,a&&a.length-1),u===d?u=d+1:g>r?d=f-1:u=f;0===d?t.textContent="":e&&d===e.length-1||(t.textContent=a||s(e||i,f))}i&&i.splice(0,f),o.actualWidth=g,o.rotation=h},e.prototype.unescapeEntities=function(t,e){return c(this.renderer.escapes,(function(i,n){e&&-1!==e.indexOf(i)||(t=t.toString().replace(new RegExp(i,"g"),n))})),t},e}()})),e(i,"Core/Renderer/SVG/SVGRenderer.js",[i["Core/Renderer/HTML/AST.js"],i["Core/Color/Color.js"],i["Core/Globals.js"],i["Core/Renderer/RendererRegistry.js"],i["Core/Renderer/SVG/SVGElement.js"],i["Core/Renderer/SVG/SVGLabel.js"],i["Core/Renderer/SVG/Symbols.js"],i["Core/Renderer/SVG/TextBuilder.js"],i["Core/Utilities.js"]],(function(t,e,i,n,r,s,a,o,l){var h,c=i.charts,u=i.deg2rad,d=i.doc,f=i.isFirefox,p=i.isMS,g=i.isWebKit,m=i.noop,v=i.SVG_NS,y=i.symbolSizes,b=i.win,_=l.addEvent,x=l.attr,w=l.createElement,S=l.css,T=l.defined,E=l.destroyObjectProperties,k=l.extend,C=l.isArray,M=l.isNumber,A=l.isObject,O=l.isString,P=l.merge,R=l.pick,I=l.pInt,L=l.uniqueKey;return i=function(){function i(t,e,i,n,r,s,a){this.width=this.url=this.style=this.isSVG=this.imgCount=this.height=this.gradients=this.globalAnimation=this.defs=this.chartIndex=this.cacheKeys=this.cache=this.boxWrapper=this.box=this.alignedObjects=void 0,this.init(t,e,i,n,r,s,a)}return i.prototype.init=function(t,e,i,n,r,s,a){var o,l=this.createElement("svg").attr({version:"1.1",class:"highcharts-root"}),h=l.element;a||l.css(this.getStyle(n)),t.appendChild(h),x(t,"dir","ltr"),-1===t.innerHTML.indexOf("xmlns")&&x(h,"xmlns",this.SVG_NS),this.isSVG=!0,this.box=h,this.boxWrapper=l,this.alignedObjects=[],this.url=this.getReferenceURL(),this.createElement("desc").add().element.appendChild(d.createTextNode("Created with Highcharts 10.3.3")),this.defs=this.createElement("defs").add(),this.allowHTML=s,this.forExport=r,this.styledMode=a,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.setSize(e,i,!1),f&&t.getBoundingClientRect&&((e=function(){S(t,{left:0,top:0}),o=t.getBoundingClientRect(),S(t,{left:Math.ceil(o.left)-o.left+"px",top:Math.ceil(o.top)-o.top+"px"})})(),this.unSubPixelFix=_(b,"resize",e))},i.prototype.definition=function(e){return new t([e]).addToDOM(this.defs.element)},i.prototype.getReferenceURL=function(){if((f||g)&&d.getElementsByTagName("base").length){if(!T(h)){var e=L();e=new t([{tagName:"svg",attributes:{width:8,height:8},children:[{tagName:"defs",children:[{tagName:"clipPath",attributes:{id:e},children:[{tagName:"rect",attributes:{width:4,height:4}}]}]},{tagName:"rect",attributes:{id:"hitme",width:8,height:8,"clip-path":"url(#".concat(e,")"),fill:"rgba(0,0,0,0.001)"}}]}]).addToDOM(d.body),S(e,{position:"fixed",top:0,left:0,zIndex:9e5});var i=d.elementFromPoint(6,6);h="hitme"===(i&&i.id),d.body.removeChild(e)}if(h)return b.location.href.split("#")[0].replace(/<[^>]*>/g,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20")}return""},i.prototype.getStyle=function(t){return this.style=k({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},t)},i.prototype.setStyle=function(t){this.boxWrapper.css(this.getStyle(t))},i.prototype.isHidden=function(){return!this.boxWrapper.getBBox().width},i.prototype.destroy=function(){var t=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),E(this.gradients||{}),this.gradients=null,t&&(this.defs=t.destroy()),this.unSubPixelFix&&this.unSubPixelFix(),this.alignedObjects=null},i.prototype.createElement=function(t){var e=new this.Element;return e.init(this,t),e},i.prototype.getRadialAttr=function(t,e){return{cx:t[0]-t[2]/2+(e.cx||0)*t[2],cy:t[1]-t[2]/2+(e.cy||0)*t[2],r:(e.r||0)*t[2]}},i.prototype.buildText=function(t){new o(t).buildSVG()},i.prototype.getContrast=function(t){return 1.05/(.05+(t=.2126*(t=e.parse(t).rgba.map((function(t){return.03928>=(t/=255)?t/12.92:Math.pow((t+.055)/1.055,2.4)})))[0]+.7152*t[1]+.0722*t[2]))>(t+.05)/.05?"#FFFFFF":"#000000"},i.prototype.button=function(e,i,n,r,s,a,o,l,h,c){void 0===s&&(s={});var u=this.label(e,i,n,h,void 0,void 0,c,void 0,"button"),d=this.styledMode;e=s.states||{};var f=0;delete(s=P(s)).states;var g=P({color:"#333333",cursor:"pointer",fontWeight:"normal"},s.style);delete s.style;var m=t.filterUserAttributes(s);if(u.attr(P({padding:8,r:2},m)),!d){m=P({fill:"#f7f7f7",stroke:"#cccccc","stroke-width":1},m);var v=(a=P(m,{fill:"#e6e6e6"},t.filterUserAttributes(a||e.hover||{}))).style;delete a.style;var y=(o=P(m,{fill:"#e6ebf5",style:{color:"#000000",fontWeight:"bold"}},t.filterUserAttributes(o||e.select||{}))).style;delete o.style;var b=(l=P(m,{style:{color:"#cccccc"}},t.filterUserAttributes(l||e.disabled||{}))).style;delete l.style}return _(u.element,p?"mouseover":"mouseenter",(function(){3!==f&&u.setState(1)})),_(u.element,p?"mouseout":"mouseleave",(function(){3!==f&&u.setState(f)})),u.setState=function(t){1!==t&&(u.state=f=t),u.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][t||0]),d||(u.attr([m,a,o,l][t||0]),A(t=[g,v,y,b][t||0])&&u.css(t))},d||(u.attr(m).css(k({cursor:"default"},g)),c&&u.text.css({pointerEvents:"none"})),u.on("touchstart",(function(t){return t.stopPropagation()})).on("click",(function(t){3!==f&&r.call(u,t)}))},i.prototype.crispLine=function(t,e,i){void 0===i&&(i="round");var n=t[0],r=t[1];return T(n[1])&&n[1]===r[1]&&(n[1]=r[1]=Math[i](n[1])-e%2/2),T(n[2])&&n[2]===r[2]&&(n[2]=r[2]=Math[i](n[2])+e%2/2),t},i.prototype.path=function(t){var e=this.styledMode?{}:{fill:"none"};return C(t)?e.d=t:A(t)&&k(e,t),this.createElement("path").attr(e)},i.prototype.circle=function(t,e,i){return t=A(t)?t:void 0===t?{}:{x:t,y:e,r:i},(e=this.createElement("circle")).xSetter=e.ySetter=function(t,e,i){i.setAttribute("c"+e,t)},e.attr(t)},i.prototype.arc=function(t,e,i,n,r,s){return A(t)?(e=(n=t).y,i=n.r,t=n.x):n={innerR:n,start:r,end:s},(t=this.symbol("arc",t,e,i,i,n)).r=i,t},i.prototype.rect=function(t,e,i,n,r,s){r=A(t)?t.r:r;var a=this.createElement("rect");return t=A(t)?t:void 0===t?{}:{x:t,y:e,width:Math.max(i,0),height:Math.max(n,0)},this.styledMode||(void 0!==s&&(t["stroke-width"]=s,t=a.crisp(t)),t.fill="none"),r&&(t.r=r),a.rSetter=function(t,e,i){a.r=t,x(i,{rx:t,ry:t})},a.rGetter=function(){return a.r||0},a.attr(t)},i.prototype.setSize=function(t,e,i){this.width=t,this.height=e,this.boxWrapper.animate({width:t,height:e},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:R(i,!0)?void 0:0}),this.alignElements()},i.prototype.g=function(t){var e=this.createElement("g");return t?e.attr({class:"highcharts-"+t}):e},i.prototype.image=function(t,e,i,n,r,s){var a={preserveAspectRatio:"none"},o=function(t,e){t.setAttributeNS?t.setAttributeNS("http://www.w3.org/1999/xlink","href",e):t.setAttribute("hc-svg-href",e)};M(e)&&(a.x=e),M(i)&&(a.y=i),M(n)&&(a.width=n),M(r)&&(a.height=r);var l=this.createElement("image").attr(a);return e=function(e){o(l.element,t),s.call(l,e)},s?(o(l.element,"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),i=new b.Image,_(i,"load",e),i.src=t,i.complete&&e({})):o(l.element,t),l},i.prototype.symbol=function(t,e,i,n,r,s){var a,o=this,l=/^url\((.*?)\)$/,h=l.test(t),u=!h&&(this.symbols[t]?t:"circle"),f=u&&this.symbols[u];if(f){"number"==typeof e&&(a=f.call(this.symbols,Math.round(e||0),Math.round(i||0),n||0,r||0,s));var p=this.path(a);o.styledMode||p.attr("fill","none"),k(p,{symbolName:u||void 0,x:e,y:i,width:n,height:r}),s&&k(p,s)}else if(h){var g=t.match(l)[1],m=p=this.image(g);m.imgwidth=R(y[g]&&y[g].width,s&&s.width),m.imgheight=R(y[g]&&y[g].height,s&&s.height);var v=function(t){return t.attr({width:t.width,height:t.height})};["width","height"].forEach((function(t){m[t+"Setter"]=function(t,e){this[e]=t,t=this.alignByTranslate;var i=this.element,n=this.width,r=this.height,a=this.imgwidth,o=this.imgheight,l=this["img"+e];if(T(l)){var h=1;s&&"within"===s.backgroundSize&&n&&r?(h=Math.min(n/a,r/o),l=Math.round(l*h),x(i,{width:Math.round(a*h),height:Math.round(o*h)})):i&&i.setAttribute(e,l),t||this.translate(((n||0)-l*h)/2,((r||0)-l*h)/2)}}})),T(e)&&m.attr({x:e,y:i}),m.isImg=!0,T(m.imgwidth)&&T(m.imgheight)?v(m):(m.attr({width:0,height:0}),w("img",{onload:function(){var t=c[o.chartIndex];0===this.width&&(S(this,{position:"absolute",top:"-999em"}),d.body.appendChild(this)),y[g]={width:this.width,height:this.height},m.imgwidth=this.width,m.imgheight=this.height,m.element&&v(m),this.parentNode&&this.parentNode.removeChild(this),o.imgCount--,o.imgCount||!t||t.hasLoaded||t.onload()},src:g}),this.imgCount++)}return p},i.prototype.clipRect=function(t,e,i,n){var r=L()+"-",s=this.createElement("clipPath").attr({id:r}).add(this.defs);return(t=this.rect(t,e,i,n,0).add(s)).id=r,t.clipPath=s,t.count=0,t},i.prototype.text=function(t,e,i,n){var r={};return!n||!this.allowHTML&&this.forExport?(r.x=Math.round(e||0),i&&(r.y=Math.round(i)),T(t)&&(r.text=t),t=this.createElement("text").attr(r),(!n||this.forExport&&!this.allowHTML)&&(t.xSetter=function(t,e,i){for(var n,r=i.getElementsByTagName("tspan"),s=i.getAttribute(e),a=0;a<r.length;a++)(n=r[a]).getAttribute(e)===s&&n.setAttribute(e,t);i.setAttribute(e,t)}),t):this.html(t,e,i)},i.prototype.fontMetrics=function(t,e){return t=!this.styledMode&&/px/.test(t)||!b.getComputedStyle?t||e&&e.style&&e.style.fontSize||this.style&&this.style.fontSize:e&&r.prototype.getStyle.call(e,"font-size"),{h:e=24>(t=/px/.test(t)?I(t):12)?t+3:Math.round(1.2*t),b:Math.round(.8*e),f:t}},i.prototype.rotCorr=function(t,e,i){var n=t;return e&&i&&(n=Math.max(n*Math.cos(e*u),4)),{x:-t/3*Math.sin(e*u),y:n}},i.prototype.pathToSegments=function(t){for(var e=[],i=[],n={A:8,C:7,H:2,L:3,M:3,Q:5,S:5,T:3,V:2},r=0;r<t.length;r++)O(i[0])&&M(t[r])&&i.length===n[i[0].toUpperCase()]&&t.splice(r,0,i[0].replace("M","L").replace("m","l")),"string"==typeof t[r]&&(i.length&&e.push(i.slice(0)),i.length=0),i.push(t[r]);return e.push(i.slice(0)),e},i.prototype.label=function(t,e,i,n,r,a,o,l,h){return new s(this,t,e,i,n,r,a,o,l,h)},i.prototype.alignElements=function(){this.alignedObjects.forEach((function(t){return t.align()}))},i}(),k(i.prototype,{Element:r,SVG_NS:v,escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},symbols:a,draw:m}),n.registerRendererType("svg",i,!0),i})),e(i,"Core/Renderer/HTML/HTMLElement.js",[i["Core/Globals.js"],i["Core/Renderer/SVG/SVGElement.js"],i["Core/Utilities.js"]],(function(t,e,i){var n=this&&this.__extends||function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=t.isFirefox,s=t.isMS,a=t.isWebKit,o=t.win,l=i.css,h=i.defined,c=i.extend,u=i.pick,d=i.pInt;return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.compose=function(t){if(-1===e.composedClasses.indexOf(t)){e.composedClasses.push(t);var i=e.prototype,n=t.prototype;n.getSpanCorrection=i.getSpanCorrection,n.htmlCss=i.htmlCss,n.htmlGetBBox=i.htmlGetBBox,n.htmlUpdateTransform=i.htmlUpdateTransform,n.setSpanRotation=i.setSpanRotation}return t},e.prototype.getSpanCorrection=function(t,e,i){this.xCorr=-t*i,this.yCorr=-e},e.prototype.htmlCss=function(t){var e="SPAN"===this.element.tagName&&t&&"width"in t,i=u(e&&t.width,void 0);if(e){delete t.width,this.textWidth=i;var n=!0}return t&&"ellipsis"===t.textOverflow&&(t.whiteSpace="nowrap",t.overflow="hidden"),this.styles=c(this.styles,t),l(this.element,t),n&&this.htmlUpdateTransform(),this},e.prototype.htmlGetBBox=function(){var t=this.element;return{x:t.offsetLeft,y:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight}},e.prototype.htmlUpdateTransform=function(){if(this.added){var t=this.renderer,e=this.element,i=this.translateX||0,n=this.translateY||0,r=this.x||0,s=this.y||0,a=this.textAlign||"left",o={left:0,center:.5,right:1}[a],c=this.styles;if(c=c&&c.whiteSpace,l(e,{marginLeft:i,marginTop:n}),!t.styledMode&&this.shadows&&this.shadows.forEach((function(t){l(t,{marginLeft:i+1,marginTop:n+1})})),this.inverted&&[].forEach.call(e.childNodes,(function(i){t.invertChild(i,e)})),"SPAN"===e.tagName){var u=this.rotation,f=this.textWidth&&d(this.textWidth),p=[u,a,e.innerHTML,this.textWidth,this.textAlign].join(),g=void 0;if(g=!1,f!==this.oldTextWidth){if(this.textPxLength)var m=this.textPxLength;else l(e,{width:"",whiteSpace:c||"nowrap"}),m=e.offsetWidth;(f>this.oldTextWidth||m>f)&&(/[ \-]/.test(e.textContent||e.innerText)||"ellipsis"===e.style.textOverflow)&&(l(e,{width:m>f||u?f+"px":"auto",display:"block",whiteSpace:c||"normal"}),this.oldTextWidth=f,g=!0)}this.hasBoxWidthChanged=g,p!==this.cTT&&(g=t.fontMetrics(e.style.fontSize,e).b,!h(u)||u===(this.oldRotation||0)&&a===this.oldAlign||this.setSpanRotation(u,o,g),this.getSpanCorrection(!h(u)&&this.textPxLength||e.offsetWidth,g,o,u,a)),l(e,{left:r+(this.xCorr||0)+"px",top:s+(this.yCorr||0)+"px"}),this.cTT=p,this.oldRotation=u,this.oldAlign=a}}else this.alignOnAdd=!0},e.prototype.setSpanRotation=function(t,e,i){var n={},h=s&&!/Edge/.test(o.navigator.userAgent)?"-ms-transform":a?"-webkit-transform":r?"MozTransform":o.opera?"-o-transform":void 0;h&&(n[h]=n.transform="rotate("+t+"deg)",n[h+(r?"Origin":"-origin")]=n.transformOrigin=100*e+"% "+i+"px",l(this.element,n))},e.composedClasses=[],e}(e)})),e(i,"Core/Renderer/HTML/HTMLRenderer.js",[i["Core/Renderer/HTML/AST.js"],i["Core/Renderer/SVG/SVGElement.js"],i["Core/Renderer/SVG/SVGRenderer.js"],i["Core/Utilities.js"]],(function(t,e,i,n){var r=this&&this.__extends||function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),s=n.attr,a=n.createElement,o=n.extend,l=n.pick;return function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return r(n,i),n.compose=function(t){return-1===n.composedClasses.indexOf(t)&&(n.composedClasses.push(t),t.prototype.html=n.prototype.html),t},n.prototype.html=function(i,n,r){var h=this.createElement("span"),c=h.element,u=h.renderer,d=u.isSVG,f=function(t,i){["opacity","visibility"].forEach((function(n){t[n+"Setter"]=function(r,s,a){var o=t.div?t.div.style:i;e.prototype[n+"Setter"].call(this,r,s,a),o&&(o[s]=r)}})),t.addedSetters=!0};return h.textSetter=function(e){e!==this.textStr&&(delete this.bBox,delete this.oldTextWidth,t.setElementHTML(this.element,l(e,"")),this.textStr=e,h.doTransform=!0)},d&&f(h,h.element.style),h.xSetter=h.ySetter=h.alignSetter=h.rotationSetter=function(t,e){"align"===e?h.alignValue=h.textAlign=t:h[e]=t,h.doTransform=!0},h.afterSetters=function(){this.doTransform&&(this.htmlUpdateTransform(),this.doTransform=!1)},h.attr({text:i,x:Math.round(n),y:Math.round(r)}).css({position:"absolute"}),u.styledMode||h.css({fontFamily:this.style.fontFamily,fontSize:this.style.fontSize}),c.style.whiteSpace="nowrap",h.css=h.htmlCss,d&&(h.add=function(t){var e=u.box.parentNode,i=[];if(this.parentGroup=t){var n=t.div;if(!n){for(;t;)i.push(t),t=t.parentGroup;i.reverse().forEach((function(t){function r(e,i){t[i]=e,"translateX"===i?u.left=e+"px":u.top=e+"px",t.doTransform=!0}var l=s(t.element,"class"),c=t.styles||{},u=(n=t.div=t.div||a("div",l?{className:l}:void 0,{position:"absolute",left:(t.translateX||0)+"px",top:(t.translateY||0)+"px",display:t.display,opacity:t.opacity,cursor:c.cursor,pointerEvents:c.pointerEvents,visibility:t.visibility},n||e)).style;o(t,{classSetter:function(t){return function(e){this.element.setAttribute("class",e),t.className=e}}(n),on:function(){return i[0].div&&h.on.apply({element:i[0].div,onEvents:t.onEvents},arguments),t},translateXSetter:r,translateYSetter:r}),t.addedSetters||f(t)}))}}else n=e;return n.appendChild(c),h.added=!0,h.alignOnAdd&&h.htmlUpdateTransform(),h}),h},n.composedClasses=[],n}(i)})),e(i,"Core/Axis/AxisDefaults.js",[],(function(){var t;return function(t){t.defaultXAxisOptions={alignTicks:!0,allowDecimals:void 0,panningEnabled:!0,zIndex:2,zoomEnabled:!0,dateTimeLabelFormats:{millisecond:{main:"%H:%M:%S.%L",range:!1},second:{main:"%H:%M:%S",range:!1},minute:{main:"%H:%M",range:!1},hour:{main:"%H:%M",range:!1},day:{main:"%e. %b"},week:{main:"%e. %b"},month:{main:"%b '%y"},year:{main:"%Y"}},endOnTick:!1,gridLineDashStyle:"Solid",gridZIndex:1,labels:{autoRotation:void 0,autoRotationLimit:80,distance:void 0,enabled:!0,indentation:10,overflow:"justify",padding:5,reserveSpace:void 0,rotation:void 0,staggerLines:0,step:0,useHTML:!1,x:0,zIndex:7,style:{color:"#666666",cursor:"default",fontSize:"11px"}},maxPadding:.01,minorGridLineDashStyle:"Solid",minorTickLength:2,minorTickPosition:"outside",minPadding:.01,offset:void 0,opposite:!1,reversed:void 0,reversedStacks:!1,showEmpty:!0,showFirstLabel:!0,showLastLabel:!0,startOfWeek:1,startOnTick:!1,tickLength:10,tickPixelInterval:100,tickmarkPlacement:"between",tickPosition:"outside",title:{align:"middle",rotation:0,useHTML:!1,x:0,y:0,style:{color:"#666666"}},type:"linear",uniqueNames:!0,visible:!0,minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#ccd6eb",lineWidth:1,gridLineColor:"#e6e6e6",gridLineWidth:void 0,tickColor:"#ccd6eb"},t.defaultYAxisOptions={reversedStacks:!0,endOnTick:!0,maxPadding:.05,minPadding:.05,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8},startOnTick:!0,title:{rotation:270,text:"Values"},stackLabels:{animation:{},allowOverlap:!1,enabled:!1,crop:!0,overflow:"justify",formatter:function(){return(0,this.axis.chart.numberFormatter)(this.total||0,-1)},style:{color:"#000000",fontSize:"11px",fontWeight:"bold",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0},t.defaultLeftAxisOptions={labels:{x:-15},title:{rotation:270}},t.defaultRightAxisOptions={labels:{x:15},title:{rotation:90}},t.defaultBottomAxisOptions={labels:{autoRotation:[-45],x:0},margin:15,title:{rotation:0}},t.defaultTopAxisOptions={labels:{autoRotation:[-45],x:0},margin:15,title:{rotation:0}}}(t||(t={})),t})),e(i,"Core/Foundation.js",[i["Core/Utilities.js"]],(function(t){var e,i=t.addEvent,n=t.isFunction,r=t.objectEach,s=t.removeEvent;return function(t){t.registerEventOptions=function(t,e){t.eventOptions=t.eventOptions||{},r(e.events,(function(e,r){t.eventOptions[r]!==e&&(t.eventOptions[r]&&(s(t,r,t.eventOptions[r]),delete t.eventOptions[r]),n(e)&&(t.eventOptions[r]=e,i(t,r,e)))}))}}(e||(e={})),e})),e(i,"Core/Axis/Tick.js",[i["Core/FormatUtilities.js"],i["Core/Globals.js"],i["Core/Utilities.js"]],(function(t,e,i){var n=e.deg2rad,r=i.clamp,s=i.correctFloat,a=i.defined,o=i.destroyObjectProperties,l=i.extend,h=i.fireEvent,c=i.isNumber,u=i.merge,d=i.objectEach,f=i.pick;return e=function(){function e(t,e,i,n,r){this.isNewLabel=this.isNew=!0,this.axis=t,this.pos=e,this.type=i||"",this.parameters=r||{},this.tickmarkOffset=this.parameters.tickmarkOffset,this.options=this.parameters.options,h(this,"init"),i||n||this.addLabel()}return e.prototype.addLabel=function(){var e=this,i=e.axis,n=i.options,r=i.chart,o=i.categories,u=i.logarithmic,d=i.names,p=e.pos,g=f(e.options&&e.options.labels,n.labels),m=i.tickPositions,v=p===m[0],y=p===m[m.length-1],b=(!g.step||1===g.step)&&1===i.tickInterval;m=m.info;var _,x=e.label;if(o=this.parameters.category||(o?f(o[p],d[p],p):p),u&&c(o)&&(o=s(u.lin2log(o))),i.dateTime)if(m)var w=r.time.resolveDTLFormat(n.dateTimeLabelFormats[!n.grid&&m.higherRanks[p]||m.unitName]),S=w.main;else c(o)&&(S=i.dateTime.getXDateFormat(o,n.dateTimeLabelFormats||{}));e.isFirst=v,e.isLast=y;var T={axis:i,chart:r,dateTimeLabelFormat:S,isFirst:v,isLast:y,pos:p,tick:e,tickPositionInfo:m,value:o};h(this,"labelFormat",T);var E=function(e){return g.formatter?g.formatter.call(e,e):g.format?(e.text=i.defaultLabelFormatter.call(e,e),t.format(g.format,e,r)):i.defaultLabelFormatter.call(e,e)};n=E.call(T,T);var k=w&&w.list;e.shortenLabel=k?function(){for(_=0;_<k.length;_++)if(l(T,{dateTimeLabelFormat:k[_]}),x.attr({text:E.call(T,T)}),x.getBBox().width<i.getSlotWidth(e)-2*g.padding)return;x.attr({text:""})}:void 0,b&&i._addedPlotLB&&e.moveLabel(n,g),a(x)||e.movedLabel?x&&x.textStr!==n&&!b&&(!x.textWidth||g.style.width||x.styles.width||x.css({width:null}),x.attr({text:n}),x.textPxLength=x.getBBox().width):(e.label=x=e.createLabel({x:0,y:0},n,g),e.rotation=0)},e.prototype.createLabel=function(t,e,i){var n=this.axis,r=n.chart;return(t=a(e)&&i.enabled?r.renderer.text(e,t.x,t.y,i.useHTML).add(n.labelGroup):null)&&(r.styledMode||t.css(u(i.style)),t.textPxLength=t.getBBox().width),t},e.prototype.destroy=function(){o(this,this.axis)},e.prototype.getPosition=function(t,e,i,n){var a=this.axis,o=a.chart,l=n&&o.oldChartHeight||o.chartHeight;return(t={x:t?s(a.translate(e+i,void 0,void 0,n)+a.transB):a.left+a.offset+(a.opposite?(n&&o.oldChartWidth||o.chartWidth)-a.right-a.left:0),y:t?l-a.bottom+a.offset-(a.opposite?a.height:0):s(l-a.translate(e+i,void 0,void 0,n)-a.transB)}).y=r(t.y,-1e5,1e5),h(this,"afterGetPosition",{pos:t}),t},e.prototype.getLabelPosition=function(t,e,i,r,s,o,l,c){var u=this.axis,d=u.transA,f=u.isLinked&&u.linkedParent?u.linkedParent.reversed:u.reversed,p=u.staggerLines,g=u.tickRotCorr||{x:0,y:0},m=r||u.reserveSpaceDefault?0:-u.labelOffset*("center"===u.labelAlign?.5:1),v={};return i=0===u.side?i.rotation?-8:-i.getBBox().height:2===u.side?g.y+8:Math.cos(i.rotation*n)*(g.y-i.getBBox(!1,0).height/2),a(s.y)&&(i=0===u.side&&u.horiz?s.y+i:s.y),t=t+s.x+m+g.x-(o&&r?o*d*(f?-1:1):0),e=e+i-(o&&!r?o*d*(f?1:-1):0),p&&(r=l/(c||1)%p,u.opposite&&(r=p-r-1),e+=u.labelOffset/p*r),v.x=t,v.y=Math.round(e),h(this,"afterGetLabelPosition",{pos:v,tickmarkOffset:o,index:l}),v},e.prototype.getLabelSize=function(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0},e.prototype.getMarkPath=function(t,e,i,n,r,s){return s.crispLine([["M",t,e],["L",t+(r?0:-i),e+(r?i:0)]],n)},e.prototype.handleOverflow=function(t){var e=this.axis,i=e.options.labels,r=t.x,s=e.chart.chartWidth,a=e.chart.spacing,o=f(e.labelLeft,Math.min(e.pos,a[3]));a=f(e.labelRight,Math.max(e.isRadial?0:e.pos+e.len,s-a[1]));var l,h=this.label,c=this.rotation,u={left:0,center:.5,right:1}[e.labelAlign||h.attr("align")],d=h.getBBox().width,p=e.getSlotWidth(this),g={},m=p,v=1;c||"justify"!==i.overflow?0>c&&r-u*d<o?l=Math.round(r/Math.cos(c*n)-o):0<c&&r+u*d>a&&(l=Math.round((s-r)/Math.cos(c*n))):(s=r+(1-u)*d,r-u*d<o?m=t.x+m*(1-u)-o:s>a&&(m=a-t.x+m*u,v=-1),(m=Math.min(p,m))<p&&"center"===e.labelAlign&&(t.x+=v*(p-m-u*(p-Math.min(d,m)))),(d>m||e.autoRotation&&(h.styles||{}).width)&&(l=m)),l&&(this.shortenLabel?this.shortenLabel():(g.width=Math.floor(l)+"px",(i.style||{}).textOverflow||(g.textOverflow="ellipsis"),h.css(g)))},e.prototype.moveLabel=function(t,e){var i=this,n=i.label,r=i.axis,s=r.reversed,a=!1;if(n&&n.textStr===t?(i.movedLabel=n,a=!0,delete i.label):d(r.ticks,(function(e){a||e.isNew||e===i||!e.label||e.label.textStr!==t||(i.movedLabel=e.label,a=!0,e.labelPos=i.movedLabel.xy,delete e.label)})),!a&&(i.labelPos||n)){var o=i.labelPos||n.xy;n=r.horiz?s?0:r.width+r.left:o.x,r=r.horiz?o.y:s?r.width+r.left:0,i.movedLabel=i.createLabel({x:n,y:r},t,e),i.movedLabel&&i.movedLabel.attr({opacity:0})}},e.prototype.render=function(t,e,i){var n=this.axis,r=n.horiz,s=this.pos,a=f(this.tickmarkOffset,n.tickmarkOffset);a=(s=this.getPosition(r,s,a,e)).x;var o=s.y;n=r&&a===n.pos+n.len||!r&&o===n.pos?-1:1,r=f(i,this.label&&this.label.newOpacity,1),i=f(i,1),this.isActive=!0,this.renderGridLine(e,i,n),this.renderMark(s,i,n),this.renderLabel(s,e,r,t),this.isNew=!1,h(this,"afterRender")},e.prototype.renderGridLine=function(t,e,i){var n=this.axis,r=n.options,s={},a=this.pos,o=this.type,l=f(this.tickmarkOffset,n.tickmarkOffset),h=n.chart.renderer,c=this.gridLine,u=r.gridLineWidth,d=r.gridLineColor,p=r.gridLineDashStyle;"minor"===this.type&&(u=r.minorGridLineWidth,d=r.minorGridLineColor,p=r.minorGridLineDashStyle),c||(n.chart.styledMode||(s.stroke=d,s["stroke-width"]=u||0,s.dashstyle=p),o||(s.zIndex=1),t&&(e=0),this.gridLine=c=h.path().attr(s).addClass("highcharts-"+(o?o+"-":"")+"grid-line").add(n.gridGroup)),c&&(i=n.getPlotLinePath({value:a+l,lineWidth:c.strokeWidth()*i,force:"pass",old:t,acrossPanes:!1}))&&c[t||this.isNew?"attr":"animate"]({d:i,opacity:e})},e.prototype.renderMark=function(t,e,i){var n=this.axis,r=n.options,s=n.chart.renderer,a=this.type,o=n.tickSize(a?a+"Tick":"tick"),l=t.x;t=t.y;var h=f(r["minor"!==a?"tickWidth":"minorTickWidth"],!a&&n.isXAxis?1:0);r=r["minor"!==a?"tickColor":"minorTickColor"];var c=this.mark,u=!c;o&&(n.opposite&&(o[0]=-o[0]),c||(this.mark=c=s.path().addClass("highcharts-"+(a?a+"-":"")+"tick").add(n.axisGroup),n.chart.styledMode||c.attr({stroke:r,"stroke-width":h})),c[u?"attr":"animate"]({d:this.getMarkPath(l,t,o[0],c.strokeWidth()*i,n.horiz,s),opacity:e}))},e.prototype.renderLabel=function(t,e,i,n){var r=this.axis,s=r.horiz,a=r.options,o=this.label,l=a.labels,h=l.step;r=f(this.tickmarkOffset,r.tickmarkOffset);var u=t.x;t=t.y;var d=!0;o&&c(u)&&(o.xy=t=this.getLabelPosition(u,t,o,s,l,r,n,h),this.isFirst&&!this.isLast&&!a.showFirstLabel||this.isLast&&!this.isFirst&&!a.showLastLabel?d=!1:!s||l.step||l.rotation||e||0===i||this.handleOverflow(t),h&&n%h&&(d=!1),d&&c(t.y)?(t.opacity=i,o[this.isNewLabel?"attr":"animate"](t).show(!0),this.isNewLabel=!1):(o.hide(),this.isNewLabel=!0))},e.prototype.replaceMovedLabel=function(){var t=this.label,e=this.axis,i=e.reversed;if(t&&!this.isNew){var n=e.horiz?i?e.left:e.width+e.left:t.xy.x;i=e.horiz?t.xy.y:i?e.width+e.top:e.top,t.animate({x:n,y:i,opacity:0},void 0,t.destroy),delete this.label}e.isDirty=!0,this.label=this.movedLabel,delete this.movedLabel},e}(),e})),e(i,"Core/Axis/Axis.js",[i["Core/Animation/AnimationUtilities.js"],i["Core/Axis/AxisDefaults.js"],i["Core/Color/Color.js"],i["Core/Defaults.js"],i["Core/Foundation.js"],i["Core/Globals.js"],i["Core/Axis/Tick.js"],i["Core/Utilities.js"]],(function(t,e,i,n,r,s,a,o){var l=t.animObject,h=n.defaultOptions,c=r.registerEventOptions,u=s.deg2rad,d=o.arrayMax,f=o.arrayMin,p=o.clamp,g=o.correctFloat,m=o.defined,v=o.destroyObjectProperties,y=o.erase,b=o.error,_=o.extend,x=o.fireEvent,w=o.isArray,S=o.isNumber,T=o.isString,E=o.merge,k=o.normalizeTickInterval,C=o.objectEach,M=o.pick,A=o.relativeLength,O=o.removeEvent,P=o.splat,R=o.syncTimeout,I=function(t,e){return k(e,void 0,void 0,M(t.options.allowDecimals,.5>e||void 0!==t.tickAmount),!!t.tickAmount)};return t=function(){function t(t,e){this.zoomEnabled=this.width=this.visible=this.userOptions=this.translationSlope=this.transB=this.transA=this.top=this.ticks=this.tickRotCorr=this.tickPositions=this.tickmarkOffset=this.tickInterval=this.tickAmount=this.side=this.series=this.right=this.positiveValuesOnly=this.pos=this.pointRangePadding=this.pointRange=this.plotLinesAndBandsGroups=this.plotLinesAndBands=this.paddedTicks=this.overlap=this.options=this.offset=this.names=this.minPixelPadding=this.minorTicks=this.minorTickInterval=this.min=this.maxLabelLength=this.max=this.len=this.left=this.labelFormatter=this.labelEdge=this.isLinked=this.height=this.hasVisibleSeries=this.hasNames=this.eventOptions=this.coll=this.closestPointRange=this.chart=this.bottom=this.alternateBands=void 0,this.init(t,e)}return t.prototype.init=function(t,e){var i=e.isX;this.chart=t,this.horiz=t.inverted&&!this.isZAxis?!i:i,this.isXAxis=i,this.coll=this.coll||(i?"xAxis":"yAxis"),x(this,"init",{userOptions:e}),this.opposite=M(e.opposite,this.opposite),this.side=M(e.side,this.side,this.horiz?this.opposite?0:2:this.opposite?1:3),this.setOptions(e);var n=this.options,r=n.labels,s=n.type;this.userOptions=e,this.minPixelPadding=0,this.reversed=M(n.reversed,this.reversed),this.visible=n.visible,this.zoomEnabled=n.zoomEnabled,this.hasNames="category"===s||!0===n.categories,this.categories=n.categories||(this.hasNames?[]:void 0),this.names||(this.names=[],this.names.keys={}),this.plotLinesAndBandsGroups={},this.positiveValuesOnly=!!this.logarithmic,this.isLinked=m(n.linkedTo),this.ticks={},this.labelEdge=[],this.minorTicks={},this.plotLinesAndBands=[],this.alternateBands={},this.len=0,this.minRange=this.userMinRange=n.minRange||n.maxZoom,this.range=n.range,this.offset=n.offset||0,this.min=this.max=null,e=M(n.crosshair,P(t.options.tooltip.crosshairs)[i?0:1]),this.crosshair=!0===e?{}:e,-1===t.axes.indexOf(this)&&(i?t.axes.splice(t.xAxis.length,0,this):t.axes.push(this),t[this.coll].push(this)),this.series=this.series||[],t.inverted&&!this.isZAxis&&i&&void 0===this.reversed&&(this.reversed=!0),this.labelRotation=S(r.rotation)?r.rotation:void 0,c(this,n),x(this,"afterInit")},t.prototype.setOptions=function(t){this.options=E(e.defaultXAxisOptions,"yAxis"===this.coll&&e.defaultYAxisOptions,[e.defaultTopAxisOptions,e.defaultRightAxisOptions,e.defaultBottomAxisOptions,e.defaultLeftAxisOptions][this.side],E(h[this.coll],t)),x(this,"afterSetOptions",{userOptions:t})},t.prototype.defaultLabelFormatter=function(t){var e=this.axis;t=this.chart.numberFormatter;var i=S(this.value)?this.value:NaN,n=e.chart.time,r=this.dateTimeLabelFormat,s=h.lang,a=s.numericSymbols;s=s.numericSymbolMagnitude||1e3;var o=e.logarithmic?Math.abs(i):e.tickInterval,l=a&&a.length;if(e.categories)var c="".concat(this.value);else if(r)c=n.dateFormat(r,i);else if(l&&1e3<=o)for(;l--&&void 0===c;)o>=(e=Math.pow(s,l+1))&&0==10*i%e&&null!==a[l]&&0!==i&&(c=t(i/e,-1)+a[l]);return void 0===c&&(c=1e4<=Math.abs(i)?t(i,-1):t(i,-1,void 0,"")),c},t.prototype.getSeriesExtremes=function(){var t,e=this,i=e.chart;x(this,"getSeriesExtremes",null,(function(){e.hasVisibleSeries=!1,e.dataMin=e.dataMax=e.threshold=null,e.softThreshold=!e.isXAxis,e.series.forEach((function(n){if(n.visible||!i.options.chart.ignoreHiddenSeries){var r=n.options,s=r.threshold;if(e.hasVisibleSeries=!0,e.positiveValuesOnly&&0>=s&&(s=null),e.isXAxis){if((r=n.xData).length){r=e.logarithmic?r.filter(e.validatePositiveValue):r;var a=(t=n.getXExtremes(r)).min,o=t.max;S(a)||a instanceof Date||(r=r.filter(S),a=(t=n.getXExtremes(r)).min,o=t.max),r.length&&(e.dataMin=Math.min(M(e.dataMin,a),a),e.dataMax=Math.max(M(e.dataMax,o),o))}}else n=n.applyExtremes(),S(n.dataMin)&&(a=n.dataMin,e.dataMin=Math.min(M(e.dataMin,a),a)),S(n.dataMax)&&(o=n.dataMax,e.dataMax=Math.max(M(e.dataMax,o),o)),m(s)&&(e.threshold=s),(!r.softThreshold||e.positiveValuesOnly)&&(e.softThreshold=!1)}}))})),x(this,"afterGetSeriesExtremes")},t.prototype.translate=function(t,e,i,n,r,s){var a=this.linkedParent||this,o=n&&a.old?a.old.min:a.min;if(!S(o))return NaN;var l=a.minPixelPadding;r=(a.isOrdinal||a.brokenAxis&&a.brokenAxis.hasBreaks||a.logarithmic&&r)&&a.lin2val;var h=1,c=0;return(n=n&&a.old?a.old.transA:a.transA)||(n=a.transA),i&&(h*=-1,c=a.len),a.reversed&&(c-=(h*=-1)*(a.sector||a.len)),e?(s=(t*h+c-l)/n+o,r&&(s=a.lin2val(s))):(r&&(t=a.val2lin(t)),t=h*(t-o)*n,s=(a.isRadial?t:g(t))+c+h*l+(S(s)?n*s:0)),s},t.prototype.toPixels=function(t,e){return this.translate(t,!1,!this.horiz,void 0,!0)+(e?0:this.pos)},t.prototype.toValue=function(t,e){return this.translate(t-(e?0:this.pos),!0,!this.horiz,void 0,!0)},t.prototype.getPlotLinePath=function(t){function e(t,e,i){return"pass"!==b&&(t<e||t>i)&&(b?t=p(t,e,i):a=!0),t}var i,n,r,s,a,o=this,l=o.chart,h=o.left,c=o.top,u=t.old,d=t.value,f=t.lineWidth,g=u&&l.oldChartHeight||l.chartHeight,m=u&&l.oldChartWidth||l.chartWidth,v=o.transB,y=t.translatedValue,b=t.force;return t={value:d,lineWidth:f,old:u,force:b,acrossPanes:t.acrossPanes,translatedValue:y},x(this,"getPlotLinePath",t,(function(t){y=M(y,o.translate(d,void 0,void 0,u)),y=p(y,-1e5,1e5),i=r=Math.round(y+v),n=s=Math.round(g-y-v),S(y)?o.horiz?(n=c,s=g-o.bottom,i=r=e(i,h,h+o.width)):(i=h,r=m-o.right,n=s=e(n,c,c+o.height)):(a=!0,b=!1),t.path=a&&!b?null:l.renderer.crispLine([["M",i,n],["L",r,s]],f||1)})),t.path},t.prototype.getLinearTickPositions=function(t,e,i){var n=g(Math.floor(e/t)*t);i=g(Math.ceil(i/t)*t);var r,s=[];if(g(n+t)===n&&(r=20),this.single)return[e];for(e=n;e<=i&&(s.push(e),(e=g(e+t,r))!==a);)var a=e;return s},t.prototype.getMinorTickInterval=function(){var t=this.options;return!0===t.minorTicks?M(t.minorTickInterval,"auto"):!1===t.minorTicks?null:t.minorTickInterval},t.prototype.getMinorTickPositions=function(){var t=this.options,e=this.tickPositions,i=this.minorTickInterval,n=this.pointRangePadding||0,r=this.min-n,s=(n=this.max+n)-r,a=[];if(s&&s/i<this.len/3){var o=this.logarithmic;if(o)this.paddedTicks.forEach((function(t,e,n){e&&a.push.apply(a,o.getLogTickPositions(i,n[e-1],n[e],!0))}));else if(this.dateTime&&"auto"===this.getMinorTickInterval())a=a.concat(this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(i),r,n,t.startOfWeek));else for(t=r+(e[0]-r)%i;t<=n&&t!==a[0];t+=i)a.push(t)}return 0!==a.length&&this.trimTicks(a),a},t.prototype.adjustForMinRange=function(){var t,e,i,n,r=this.options,s=this.logarithmic,a=this.min,o=this.max,l=0;if(this.isXAxis&&void 0===this.minRange&&!s&&(m(r.min)||m(r.max)||m(r.floor)||m(r.ceiling)?this.minRange=null:(this.series.forEach((function(r){if(i=r.xData,n=r.xIncrement?1:i.length-1,1<i.length)for(t=n;0<t;t--)e=i[t]-i[t-1],(!l||e<l)&&(l=e)})),this.minRange=Math.min(5*l,this.dataMax-this.dataMin))),o-a<this.minRange){var h=this.dataMax-this.dataMin>=this.minRange,c=this.minRange,u=(c-o+a)/2;u=[a-u,M(r.min,a-u)],h&&(u[2]=this.logarithmic?this.logarithmic.log2lin(this.dataMin):this.dataMin),o=[(a=d(u))+c,M(r.max,a+c)],h&&(o[2]=s?s.log2lin(this.dataMax):this.dataMax),(o=f(o))-a<c&&(u[0]=o-c,u[1]=M(r.min,o-c),a=d(u))}this.min=a,this.max=o},t.prototype.getClosest=function(){var t;return this.categories?t=1:this.series.forEach((function(e){var i=e.closestPointRange,n=e.visible||!e.chart.options.chart.ignoreHiddenSeries;!e.noSharedTooltip&&m(i)&&n&&(t=m(t)?Math.min(t,i):i)})),t},t.prototype.nameToX=function(t){var e=w(this.options.categories),i=e?this.categories:this.names,n=t.options.x;if(t.series.requireSorting=!1,m(n)||(n=this.options.uniqueNames&&i?e?i.indexOf(t.name):M(i.keys[t.name],-1):t.series.autoIncrement()),-1===n){if(!e&&i)var r=i.length}else r=n;return void 0!==r?(this.names[r]=t.name,this.names.keys[t.name]=r):t.x&&(r=t.x),r},t.prototype.updateNames=function(){var t=this,e=this.names;0<e.length&&(Object.keys(e.keys).forEach((function(t){delete e.keys[t]})),e.length=0,this.minRange=this.userMinRange,(this.series||[]).forEach((function(e){e.xIncrement=null,e.points&&!e.isDirtyData||(t.max=Math.max(t.max,e.xData.length-1),e.processData(),e.generatePoints()),e.data.forEach((function(i,n){if(i&&i.options&&void 0!==i.name){var r=t.nameToX(i);void 0!==r&&r!==i.x&&(i.x=r,e.xData[n]=r)}}))})))},t.prototype.setAxisTranslation=function(){var t=this,e=t.max-t.min,i=t.linkedParent,n=!!t.categories,r=t.isXAxis,s=t.axisPointRange||0,a=0,o=0,l=t.transA;if(r||n||s){var h=t.getClosest();i?(a=i.minPointOffset,o=i.pointRangePadding):t.series.forEach((function(e){var i=n?1:r?M(e.options.pointRange,h,0):t.axisPointRange||0,l=e.options.pointPlacement;s=Math.max(s,i),t.single&&!n||(e=e.is("xrange")?!r:r,a=Math.max(a,e&&T(l)?0:i/2),o=Math.max(o,e&&"on"===l?0:i))})),i=t.ordinal&&t.ordinal.slope&&h?t.ordinal.slope/h:1,t.minPointOffset=a*=i,t.pointRangePadding=o*=i,t.pointRange=Math.min(s,t.single&&n?1:e),r&&(t.closestPointRange=h)}t.translationSlope=t.transA=l=t.staticScale||t.len/(e+o||1),t.transB=t.horiz?t.left:t.bottom,t.minPixelPadding=l*a,x(this,"afterSetAxisTranslation")},t.prototype.minFromRange=function(){return this.max-this.range},t.prototype.setTickInterval=function(t){var e=this.chart,i=this.logarithmic,n=this.options,r=this.isXAxis,s=this.isLinked,a=n.tickPixelInterval,o=this.categories,l=this.softThreshold,h=n.maxPadding,c=n.minPadding,u=S(n.tickInterval)&&0<=n.tickInterval?n.tickInterval:void 0,d=S(this.threshold)?this.threshold:null;this.dateTime||o||s||this.getTickAmount();var f=M(this.userMin,n.min),p=M(this.userMax,n.max);if(s){this.linkedParent=e[this.coll][n.linkedTo];var v=this.linkedParent.getExtremes();this.min=M(v.min,v.dataMin),this.max=M(v.max,v.dataMax),n.type!==this.linkedParent.options.type&&b(11,1,e)}else{if(l&&m(d))if(this.dataMin>=d)v=d,c=0;else if(this.dataMax<=d){var y=d;h=0}this.min=M(f,v,this.dataMin),this.max=M(p,y,this.dataMax)}if(i&&(this.positiveValuesOnly&&!t&&0>=Math.min(this.min,M(this.dataMin,this.min))&&b(10,1,e),this.min=g(i.log2lin(this.min),16),this.max=g(i.log2lin(this.max),16)),this.range&&m(this.max)&&(this.userMin=this.min=f=Math.max(this.dataMin,this.minFromRange()),this.userMax=p=this.max,this.range=null),x(this,"foundExtremes"),this.beforePadding&&this.beforePadding(),this.adjustForMinRange(),!(o||this.axisPointRange||this.stacking&&this.stacking.usePercentage||s)&&m(this.min)&&m(this.max)&&(e=this.max-this.min)&&(!m(f)&&c&&(this.min-=e*c),!m(p)&&h&&(this.max+=e*h)),S(this.userMin)||(S(n.softMin)&&n.softMin<this.min&&(this.min=f=n.softMin),S(n.floor)&&(this.min=Math.max(this.min,n.floor))),S(this.userMax)||(S(n.softMax)&&n.softMax>this.max&&(this.max=p=n.softMax),S(n.ceiling)&&(this.max=Math.min(this.max,n.ceiling))),l&&m(this.dataMin)&&(d=d||0,!m(f)&&this.min<d&&this.dataMin>=d?this.min=this.options.minRange?Math.min(d,this.max-this.minRange):d:!m(p)&&this.max>d&&this.dataMax<=d&&(this.max=this.options.minRange?Math.max(d,this.min+this.minRange):d)),S(this.min)&&S(this.max)&&!this.chart.polar&&this.min>this.max&&(m(this.options.min)?this.max=this.min:m(this.options.max)&&(this.min=this.max)),this.tickInterval=this.min===this.max||void 0===this.min||void 0===this.max?1:s&&this.linkedParent&&!u&&a===this.linkedParent.options.tickPixelInterval?u=this.linkedParent.tickInterval:M(u,this.tickAmount?(this.max-this.min)/Math.max(this.tickAmount-1,1):void 0,o?1:(this.max-this.min)*a/Math.max(this.len,a)),r&&!t){var _=this.min!==(this.old&&this.old.min)||this.max!==(this.old&&this.old.max);this.series.forEach((function(t){t.forceCrop=t.forceCropping&&t.forceCropping(),t.processData(_)})),x(this,"postProcessData",{hasExtremesChanged:_})}this.setAxisTranslation(),x(this,"initialAxisTranslation"),this.pointRange&&!u&&(this.tickInterval=Math.max(this.pointRange,this.tickInterval)),t=M(n.minTickInterval,this.dateTime&&!this.series.some((function(t){return t.noSharedTooltip}))?this.closestPointRange:0),!u&&this.tickInterval<t&&(this.tickInterval=t),this.dateTime||this.logarithmic||u||(this.tickInterval=I(this,this.tickInterval)),this.tickAmount||(this.tickInterval=this.unsquish()),this.setTickPositions()},t.prototype.setTickPositions=function(){var t,e=this.options,i=e.tickPositions,n=e.tickPositioner,r=this.getMinorTickInterval(),s=this.hasVerticalPanning(),a="colorAxis"===this.coll,o=(a||!s)&&e.startOnTick;if(s=(a||!s)&&e.endOnTick,a=[],this.tickmarkOffset=this.categories&&"between"===e.tickmarkPlacement&&1===this.tickInterval?.5:0,this.minorTickInterval="auto"===r&&this.tickInterval?this.tickInterval/5:r,this.single=this.min===this.max&&m(this.min)&&!this.tickAmount&&(parseInt(this.min,10)===this.min||!1!==e.allowDecimals),i)a=i.slice();else if(S(this.min)&&S(this.max)){if(this.ordinal&&this.ordinal.positions||!((this.max-this.min)/this.tickInterval>Math.max(2*this.len,200)))if(this.dateTime)a=this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(this.tickInterval,e.units),this.min,this.max,e.startOfWeek,this.ordinal&&this.ordinal.positions,this.closestPointRange,!0);else if(this.logarithmic)a=this.logarithmic.getLogTickPositions(this.tickInterval,this.min,this.max);else for(r=e=this.tickInterval;r<=2*e&&(a=this.getLinearTickPositions(this.tickInterval,this.min,this.max),this.tickAmount&&a.length>this.tickAmount);)this.tickInterval=I(this,r*=1.1);else a=[this.min,this.max],b(19,!1,this.chart);a.length>this.len&&(a=[a[0],a[a.length-1]])[0]===a[1]&&(a.length=1),n&&(this.tickPositions=a,(t=n.apply(this,[this.min,this.max]))&&(a=t))}this.tickPositions=a,this.paddedTicks=a.slice(0),this.trimTicks(a,o,s),!this.isLinked&&S(this.min)&&S(this.max)&&(this.single&&2>a.length&&!this.categories&&!this.series.some((function(t){return t.is("heatmap")&&"between"===t.options.pointPlacement}))&&(this.min-=.5,this.max+=.5),i||t||this.adjustTickAmount()),x(this,"afterSetTickPositions")},t.prototype.trimTicks=function(t,e,i){var n=t[0],r=t[t.length-1],s=!this.isOrdinal&&this.minPointOffset||0;if(x(this,"trimTicks"),!this.isLinked){if(e&&-1/0!==n)this.min=n;else for(;this.min-s>t[0];)t.shift();if(i)this.max=r;else for(;this.max+s<t[t.length-1];)t.pop();0===t.length&&m(n)&&!this.options.tickPositions&&t.push((r+n)/2)}},t.prototype.alignToOthers=function(){var t,e=this,i=[this],n=e.options,r="yAxis"===this.coll&&this.chart.options.chart.alignThresholds,s=[];if(e.thresholdAlignment=void 0,(!1!==this.chart.options.chart.alignTicks&&n.alignTicks||r)&&!1!==n.startOnTick&&!1!==n.endOnTick&&!e.logarithmic){var a=function(t){var e=t.options;return[t.horiz?e.left:e.top,e.width,e.height,e.pane].join()},o=a(this);this.chart[this.coll].forEach((function(n){var r=n.series;r.length&&r.some((function(t){return t.visible}))&&n!==e&&a(n)===o&&(t=!0,i.push(n))}))}if(t&&r){i.forEach((function(t){t=t.getThresholdAlignment(e),S(t)&&s.push(t)}));var l=1<s.length?s.reduce((function(t,e){return t+e}),0)/s.length:void 0;i.forEach((function(t){t.thresholdAlignment=l}))}return t},t.prototype.getThresholdAlignment=function(t){if((!S(this.dataMin)||this!==t&&this.series.some((function(t){return t.isDirty||t.isDirtyData})))&&this.getSeriesExtremes(),S(this.threshold))return t=p((this.threshold-(this.dataMin||0))/((this.dataMax||0)-(this.dataMin||0)),0,1),this.options.reversed&&(t=1-t),t},t.prototype.getTickAmount=function(){var t=this.options,e=t.tickPixelInterval,i=t.tickAmount;!m(t.tickInterval)&&!i&&this.len<e&&!this.isRadial&&!this.logarithmic&&t.startOnTick&&t.endOnTick&&(i=2),!i&&this.alignToOthers()&&(i=Math.ceil(this.len/e)+1),4>i&&(this.finalTickAmt=i,i=5),this.tickAmount=i},t.prototype.adjustTickAmount=function(){var t=this,e=t.finalTickAmt,i=t.max,n=t.min,r=t.options,s=t.tickPositions,a=t.tickAmount,o=t.thresholdAlignment,l=s&&s.length,h=M(t.threshold,t.softThreshold?0:null),c=t.tickInterval;if(S(o)){var u=.5>o?Math.ceil(o*(a-1)):Math.floor(o*(a-1));r.reversed&&(u=a-1-u)}if(t.hasData()&&S(n)&&S(i)){if(o=function(){t.transA*=(l-1)/(a-1),t.min=r.startOnTick?s[0]:Math.min(n,s[0]),t.max=r.endOnTick?s[s.length-1]:Math.max(i,s[s.length-1])},S(u)&&S(t.threshold)){for(;s[u]!==h||s.length!==a||s[0]>n||s[s.length-1]<i;){for(s.length=0,s.push(t.threshold);s.length<a;)void 0===s[u]||s[u]>t.threshold?s.unshift(g(s[0]-c)):s.push(g(s[s.length-1]+c));if(c>8*t.tickInterval)break;c*=2}o()}else if(l<a){for(;s.length<a;)s.length%2||n===h?s.push(g(s[s.length-1]+c)):s.unshift(g(s[0]-c));o()}if(m(e)){for(c=h=s.length;c--;)(3===e&&1==c%2||2>=e&&0<c&&c<h-1)&&s.splice(c,1);t.finalTickAmt=void 0}}},t.prototype.setScale=function(){var t=!1,e=!1;this.series.forEach((function(i){t=t||i.isDirtyData||i.isDirty,e=e||i.xAxis&&i.xAxis.isDirty||!1})),this.setAxisSize();var i=this.len!==(this.old&&this.old.len);i||t||e||this.isLinked||this.forceRedraw||this.userMin!==(this.old&&this.old.userMin)||this.userMax!==(this.old&&this.old.userMax)||this.alignToOthers()?(this.stacking&&(this.stacking.resetStacks(),this.stacking.buildStacks()),this.forceRedraw=!1,this.getSeriesExtremes(),this.setTickInterval(),this.isDirty||(this.isDirty=i||this.min!==(this.old&&this.old.min)||this.max!==(this.old&&this.old.max))):this.stacking&&this.stacking.cleanStacks(),t&&this.panningState&&(this.panningState.isDirty=!0),x(this,"afterSetScale")},t.prototype.setExtremes=function(t,e,i,n,r){var s=this,a=s.chart;i=M(i,!0),s.series.forEach((function(t){delete t.kdTree})),r=_(r,{min:t,max:e}),x(s,"setExtremes",r,(function(){s.userMin=t,s.userMax=e,s.eventArgs=r,i&&a.redraw(n)}))},t.prototype.zoom=function(t,e){var i=this,n=this.dataMin,r=this.dataMax,s=this.options,a=Math.min(n,M(s.min,n)),o=Math.max(r,M(s.max,r));return x(this,"zoom",t={newMin:t,newMax:e},(function(t){var e=t.newMin,s=t.newMax;e===i.min&&s===i.max||(i.allowZoomOutside||(m(n)&&(e<a&&(e=a),e>o&&(e=o)),m(r)&&(s<a&&(s=a),s>o&&(s=o))),i.displayBtn=void 0!==e||void 0!==s,i.setExtremes(e,s,!1,void 0,{trigger:"zoom"})),t.zoomed=!0})),t.zoomed},t.prototype.setAxisSize=function(){var t=this.chart,e=this.options,i=e.offsets||[0,0,0,0],n=this.horiz,r=this.width=Math.round(A(M(e.width,t.plotWidth-i[3]+i[1]),t.plotWidth)),s=this.height=Math.round(A(M(e.height,t.plotHeight-i[0]+i[2]),t.plotHeight)),a=this.top=Math.round(A(M(e.top,t.plotTop+i[0]),t.plotHeight,t.plotTop));e=this.left=Math.round(A(M(e.left,t.plotLeft+i[3]),t.plotWidth,t.plotLeft)),this.bottom=t.chartHeight-s-a,this.right=t.chartWidth-r-e,this.len=Math.max(n?r:s,0),this.pos=n?e:a},t.prototype.getExtremes=function(){var t=this.logarithmic;return{min:t?g(t.lin2log(this.min)):this.min,max:t?g(t.lin2log(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},t.prototype.getThreshold=function(t){var e=this.logarithmic,i=e?e.lin2log(this.min):this.min;return e=e?e.lin2log(this.max):this.max,null===t||-1/0===t?t=i:1/0===t?t=e:i>t?t=i:e<t&&(t=e),this.translate(t,0,1,0,1)},t.prototype.autoLabelAlign=function(t){var e=(M(t,0)-90*this.side+720)%360;return x(this,"autoLabelAlign",t={align:"center"},(function(t){15<e&&165>e?t.align="right":195<e&&345>e&&(t.align="left")})),t.align},t.prototype.tickSize=function(t){var e=this.options,i=M(e["tick"===t?"tickWidth":"minorTickWidth"],"tick"===t&&this.isXAxis&&!this.categories?1:0),n=e["tick"===t?"tickLength":"minorTickLength"];if(i&&n){"inside"===e[t+"Position"]&&(n=-n);var r=[n,i]}return x(this,"afterTickSize",t={tickSize:r}),t.tickSize},t.prototype.labelMetrics=function(){var t=this.tickPositions&&this.tickPositions[0]||0;return this.chart.renderer.fontMetrics(this.options.labels.style.fontSize,this.ticks[t]&&this.ticks[t].label)},t.prototype.unsquish=function(){var t=this.options.labels,e=this.horiz,i=this.tickInterval,n=this.len/(((this.categories?1:0)+this.max-this.min)/i),r=t.rotation,s=this.labelMetrics(),a=Math.max(this.max-this.min,0),o=function(t){var e=t/(n||1);return(e=1<e?Math.ceil(e):1)*i>a&&1/0!==t&&1/0!==n&&a&&(e=Math.ceil(a/i)),g(e*i)},l=i,h=Number.MAX_VALUE;if(e){if(!t.staggerLines)if(S(r))var c=[r];else n<t.autoRotationLimit&&(c=t.autoRotation);if(c)for(var d=e=void 0,f=0,p=c;f<p.length;f++){var m=p[f];if((m===r||m&&-90<=m&&90>=m)&&(d=(e=o(Math.abs(s.h/Math.sin(u*m))))+Math.abs(m/360))<h){h=d;var v=m;l=e}}}else l=o(s.h);return this.autoRotation=c,this.labelRotation=M(v,S(r)?r:0),t.step?i:l},t.prototype.getSlotWidth=function(t){var e=this.chart,i=this.horiz,n=this.options.labels,r=Math.max(this.tickPositions.length-(this.categories?0:1),1),s=e.margin[3];if(t&&S(t.slotWidth))return t.slotWidth;if(i&&2>n.step)return n.rotation?0:(this.staggerLines||1)*this.len/r;if(!i){if(void 0!==(t=n.style.width))return parseInt(String(t),10);if(s)return s-e.spacing[3]}return.33*e.chartWidth},t.prototype.renderUnsquish=function(){var t=this.chart,e=t.renderer,i=this.tickPositions,n=this.ticks,r=this.options.labels,s=r.style,a=this.horiz,o=this.getSlotWidth(),l=Math.max(1,Math.round(o-2*r.padding)),h={},c=this.labelMetrics(),u=s.textOverflow,d=0;if(T(r.rotation)||(h.rotation=r.rotation||0),i.forEach((function(t){(t=n[t]).movedLabel&&t.replaceMovedLabel(),t&&t.label&&t.label.textPxLength>d&&(d=t.label.textPxLength)})),this.maxLabelLength=d,this.autoRotation)d>l&&d>c.h?h.rotation=this.labelRotation:this.labelRotation=0;else if(o){var f=l;if(!u){var p="clip";for(l=i.length;!a&&l--;){var g=i[l];(g=n[g].label)&&(g.styles&&"ellipsis"===g.styles.textOverflow?g.css({textOverflow:"clip"}):g.textPxLength>o&&g.css({width:o+"px"}),g.getBBox().height>this.len/i.length-(c.h-c.f)&&(g.specificTextOverflow="ellipsis"))}}}h.rotation&&(f=d>.5*t.chartHeight?.33*t.chartHeight:d,u||(p="ellipsis")),(this.labelAlign=r.align||this.autoLabelAlign(this.labelRotation))&&(h.align=this.labelAlign),i.forEach((function(t){var e=(t=n[t])&&t.label,i=s.width,r={};e&&(e.attr(h),t.shortenLabel?t.shortenLabel():f&&!i&&"nowrap"!==s.whiteSpace&&(f<e.textPxLength||"SPAN"===e.element.tagName)?(r.width=f+"px",u||(r.textOverflow=e.specificTextOverflow||p),e.css(r)):e.styles&&e.styles.width&&!r.width&&!i&&e.css({width:null}),delete e.specificTextOverflow,t.rotation=h.rotation)}),this),this.tickRotCorr=e.rotCorr(c.b,this.labelRotation||0,0!==this.side)},t.prototype.hasData=function(){return this.series.some((function(t){return t.hasData()}))||this.options.showEmpty&&m(this.min)&&m(this.max)},t.prototype.addTitle=function(t){var e,i=this.chart.renderer,n=this.horiz,r=this.opposite,s=this.options.title,a=this.chart.styledMode;this.axisTitle||((e=s.textAlign)||(e=(n?{low:"left",middle:"center",high:"right"}:{low:r?"right":"left",middle:"center",high:r?"left":"right"})[s.align]),this.axisTitle=i.text(s.text||"",0,0,s.useHTML).attr({zIndex:7,rotation:s.rotation,align:e}).addClass("highcharts-axis-title"),a||this.axisTitle.css(E(s.style)),this.axisTitle.add(this.axisGroup),this.axisTitle.isNew=!0),a||s.style.width||this.isRadial||this.axisTitle.css({width:this.len+"px"}),this.axisTitle[t?"show":"hide"](t)},t.prototype.generateTick=function(t){var e=this.ticks;e[t]?e[t].addLabel():e[t]=new a(this,t)},t.prototype.getOffset=function(){var t=this,e=this,i=e.chart,n=e.horiz,r=e.options,s=e.side,a=e.ticks,o=e.tickPositions,l=e.coll,h=e.axisParent,c=i.renderer,u=i.inverted&&!e.isZAxis?[1,0,3,2][s]:s,d=e.hasData(),f=r.title,p=r.labels,g=i.axisOffset;i=i.clipOffset;var v,y=[-1,1,1,-1][s],b=r.className,_=0,w=0,S=0;if(e.showAxis=v=d||r.showEmpty,e.staggerLines=e.horiz&&p.staggerLines||void 0,!e.axisGroup){var T=function(e,i,n){return c.g(e).attr({zIndex:n}).addClass("highcharts-".concat(l.toLowerCase()).concat(i," ")+(t.isRadial?"highcharts-radial-axis".concat(i," "):"")+(b||"")).add(h)};e.gridGroup=T("grid","-grid",r.gridZIndex),e.axisGroup=T("axis","",r.zIndex),e.labelGroup=T("axis-labels","-labels",p.zIndex)}if(d||e.isLinked?(o.forEach((function(t){e.generateTick(t)})),e.renderUnsquish(),e.reserveSpaceDefault=0===s||2===s||{1:"left",3:"right"}[s]===e.labelAlign,M(p.reserveSpace,"center"===e.labelAlign||null,e.reserveSpaceDefault)&&o.forEach((function(t){S=Math.max(a[t].getLabelSize(),S)})),e.staggerLines&&(S*=e.staggerLines),e.labelOffset=S*(e.opposite?-1:1)):C(a,(function(t,e){t.destroy(),delete a[e]})),f&&f.text&&!1!==f.enabled&&(e.addTitle(v),v&&!1!==f.reserveSpace)){e.titleOffset=_=e.axisTitle.getBBox()[n?"height":"width"];var E=f.offset;w=m(E)?0:M(f.margin,n?5:10)}e.renderLine(),e.offset=y*M(r.offset,g[s]?g[s]+(r.margin||0):0),e.tickRotCorr=e.tickRotCorr||{x:0,y:0},f=0===s?-e.labelMetrics().h:2===s?e.tickRotCorr.y:0,d=Math.abs(S)+w,S&&(d=d-f+y*(n?M(p.y,e.tickRotCorr.y+8*y):p.x)),e.axisTitleMargin=M(E,d),e.getMaxLabelDimensions&&(e.maxLabelDimensions=e.getMaxLabelDimensions(a,o)),"colorAxis"!==l&&(n=this.tickSize("tick"),g[s]=Math.max(g[s],(e.axisTitleMargin||0)+_+y*e.offset,d,o&&o.length&&n?n[0]+y*e.offset:0),r=!e.axisLine||r.offset?0:2*Math.floor(e.axisLine.strokeWidth()/2),i[u]=Math.max(i[u],r)),x(this,"afterGetOffset")},t.prototype.getLinePath=function(t){var e=this.chart,i=this.opposite,n=this.offset,r=this.horiz,s=this.left+(i?this.width:0)+n;return n=e.chartHeight-this.bottom-(i?this.height:0)+n,i&&(t*=-1),e.renderer.crispLine([["M",r?this.left:s,r?n:this.top],["L",r?e.chartWidth-this.right:s,r?n:e.chartHeight-this.bottom]],t)},t.prototype.renderLine=function(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.chart.styledMode||this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))},t.prototype.getTitlePosition=function(){var t=this.horiz,e=this.left,i=this.top,n=this.len,r=this.options.title,s=t?e:i,a=this.opposite,o=this.offset,l=r.x,h=r.y,c=this.axisTitle,u=this.chart.renderer.fontMetrics(r.style.fontSize,c);return c=c?Math.max(c.getBBox(!1,0).height-u.h-1,0):0,n={low:s+(t?0:n),middle:s+n/2,high:s+(t?n:0)}[r.align],e=(t?i+this.height:e)+(t?1:-1)*(a?-1:1)*(this.axisTitleMargin||0)+[-c,c,u.f,-c][this.side],t={x:t?n+l:e+(a?this.width:0)+o+l,y:t?e+h-(a?this.height:0)+o:n+h},x(this,"afterGetTitlePosition",{titlePosition:t}),t},t.prototype.renderMinorTick=function(t,e){var i=this.minorTicks;i[t]||(i[t]=new a(this,t,"minor")),e&&i[t].isNew&&i[t].render(null,!0),i[t].render(null,!1,1)},t.prototype.renderTick=function(t,e,i){var n=this.ticks;(!this.isLinked||t>=this.min&&t<=this.max||this.grid&&this.grid.isColumn)&&(n[t]||(n[t]=new a(this,t)),i&&n[t].isNew&&n[t].render(e,!0,-1),n[t].render(e))},t.prototype.render=function(){var t,e,i=this,n=i.chart,r=i.logarithmic,o=i.options,h=i.isLinked,c=i.tickPositions,u=i.axisTitle,d=i.ticks,f=i.minorTicks,p=i.alternateBands,g=o.stackLabels,m=o.alternateGridColor,v=i.tickmarkOffset,y=i.axisLine,b=i.showAxis,_=l(n.renderer.globalAnimation);if(i.labelEdge.length=0,i.overlap=!1,[d,f,p].forEach((function(t){C(t,(function(t){t.isActive=!1}))})),i.hasData()||h){var w=i.chart.hasRendered&&i.old&&S(i.old.min);i.minorTickInterval&&!i.categories&&i.getMinorTickPositions().forEach((function(t){i.renderMinorTick(t,w)})),c.length&&(c.forEach((function(t,e){i.renderTick(t,e,w)})),v&&(0===i.min||i.single)&&(d[-1]||(d[-1]=new a(i,-1,null,!0)),d[-1].render(-1))),m&&c.forEach((function(a,o){e=void 0!==c[o+1]?c[o+1]+v:i.max-v,0==o%2&&a<i.max&&e<=i.max+(n.polar?-v:v)&&(p[a]||(p[a]=new s.PlotLineOrBand(i)),t=a+v,p[a].options={from:r?r.lin2log(t):t,to:r?r.lin2log(e):e,color:m,className:"highcharts-alternate-grid"},p[a].render(),p[a].isActive=!0)})),i._addedPlotLB||(i._addedPlotLB=!0,(o.plotLines||[]).concat(o.plotBands||[]).forEach((function(t){i.addPlotBandOrLine(t)})))}[d,f,p].forEach((function(t){var e=[],i=_.duration;C(t,(function(t,i){t.isActive||(t.render(i,!1,0),t.isActive=!1,e.push(i))})),R((function(){for(var i=e.length;i--;)t[e[i]]&&!t[e[i]].isActive&&(t[e[i]].destroy(),delete t[e[i]])}),t!==p&&n.hasRendered&&i?i:0)})),y&&(y[y.isPlaced?"animate":"attr"]({d:this.getLinePath(y.strokeWidth())}),y.isPlaced=!0,y[b?"show":"hide"](b)),u&&b&&(o=i.getTitlePosition(),u[u.isNew?"attr":"animate"](o),u.isNew=!1),g&&g.enabled&&i.stacking&&i.stacking.renderStackTotals(),i.old={len:i.len,max:i.max,min:i.min,transA:i.transA,userMax:i.userMax,userMin:i.userMin},i.isDirty=!1,x(this,"afterRender")},t.prototype.redraw=function(){this.visible&&(this.render(),this.plotLinesAndBands.forEach((function(t){t.render()}))),this.series.forEach((function(t){t.isDirty=!0}))},t.prototype.getKeepProps=function(){return this.keepProps||t.keepProps},t.prototype.destroy=function(t){var e=this,i=e.plotLinesAndBands,n=this.eventOptions;if(x(this,"destroy",{keepEvents:t}),t||O(e),[e.ticks,e.minorTicks,e.alternateBands].forEach((function(t){v(t)})),i)for(t=i.length;t--;)i[t].destroy();for(var r in"axisLine axisTitle axisGroup gridGroup labelGroup cross scrollbar".split(" ").forEach((function(t){e[t]&&(e[t]=e[t].destroy())})),e.plotLinesAndBandsGroups)e.plotLinesAndBandsGroups[r]=e.plotLinesAndBandsGroups[r].destroy();C(e,(function(t,i){-1===e.getKeepProps().indexOf(i)&&delete e[i]})),this.eventOptions=n},t.prototype.drawCrosshair=function(t,e){var n,r=this.crosshair,s=M(r&&r.snap,!0),a=this.chart,o=this.cross;if(x(this,"drawCrosshair",{e:t,point:e}),t||(t=this.cross&&this.cross.e),r&&!1!==(m(e)||!s)){if(s?m(e)&&(n=M("colorAxis"!==this.coll?e.crosshairPos:null,this.isXAxis?e.plotX:this.len-e.plotY)):n=t&&(this.horiz?t.chartX-this.pos:this.len-t.chartY+this.pos),m(n)){var l={value:e&&(this.isXAxis?e.x:M(e.stackY,e.y)),translatedValue:n};a.polar&&_(l,{isCrosshair:!0,chartX:t&&t.chartX,chartY:t&&t.chartY,point:e}),l=this.getPlotLinePath(l)||null}if(!m(l))return void this.hideCrosshair();s=this.categories&&!this.isRadial,o||(this.cross=o=a.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(s?"category ":"thin ")+(r.className||"")).attr({zIndex:M(r.zIndex,2)}).add(),a.styledMode||(o.attr({stroke:r.color||(s?i.parse("#ccd6eb").setOpacity(.25).get():"#cccccc"),"stroke-width":M(r.width,1)}).css({"pointer-events":"none"}),r.dashStyle&&o.attr({dashstyle:r.dashStyle}))),o.show().attr({d:l}),s&&!r.width&&o.attr({"stroke-width":this.transA}),this.cross.e=t}else this.hideCrosshair();x(this,"afterDrawCrosshair",{e:t,point:e})},t.prototype.hideCrosshair=function(){this.cross&&this.cross.hide(),x(this,"afterHideCrosshair")},t.prototype.hasVerticalPanning=function(){var t=this.chart.options.chart.panning;return!!(t&&t.enabled&&/y/.test(t.type))},t.prototype.validatePositiveValue=function(t){return S(t)&&0<t},t.prototype.update=function(t,e){var i=this.chart;t=E(this.userOptions,t),this.destroy(!0),this.init(i,t),i.isDirtyBox=!0,M(e,!0)&&i.redraw()},t.prototype.remove=function(t){for(var e=this.chart,i=this.coll,n=this.series,r=n.length;r--;)n[r]&&n[r].remove(!1);y(e.axes,this),y(e[i],this),e[i].forEach((function(t,e){t.options.index=t.userOptions.index=e})),this.destroy(),e.isDirtyBox=!0,M(t,!0)&&e.redraw()},t.prototype.setTitle=function(t,e){this.update({title:t},e)},t.prototype.setCategories=function(t,e){this.update({categories:t},e)},t.defaultOptions=e.defaultXAxisOptions,t.keepProps="extKey hcEvents names series userMax userMin".split(" "),t}(),t})),e(i,"Core/Axis/DateTimeAxis.js",[i["Core/Utilities.js"]],(function(t){var e,i=t.addEvent,n=t.getMagnitude,r=t.normalizeTickInterval,s=t.timeUnits;return function(t){function e(){return this.chart.time.getTimeTicks.apply(this.chart.time,arguments)}function a(t){"datetime"!==t.userOptions.type?this.dateTime=void 0:this.dateTime||(this.dateTime=new l(this))}var o=[];t.compose=function(t){return-1===o.indexOf(t)&&(o.push(t),t.keepProps.push("dateTime"),t.prototype.getTimeTicks=e,i(t,"init",a)),t};var l=function(){function t(t){this.axis=t}return t.prototype.normalizeTimeTickInterval=function(t,e){var i=e||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]];e=i[i.length-1];var a,o=s[e[0]],l=e[1];for(a=0;a<i.length&&(e=i[a],o=s[e[0]],l=e[1],!(i[a+1]&&t<=(o*l[l.length-1]+s[i[a+1][0]])/2));a++);return o===s.year&&t<5*o&&(l=[1,2,5]),{unitRange:o,count:t=r(t/o,l,"year"===e[0]?Math.max(n(t/o),1):1),unitName:e[0]}},t.prototype.getXDateFormat=function(t,e){var i=this.axis,n=i.chart.time;return i.closestPointRange?n.getDateFormat(i.closestPointRange,t,i.options.startOfWeek,e)||n.resolveDTLFormat(e.year).main:n.resolveDTLFormat(e.day).main},t}();t.Additions=l}(e||(e={})),e})),e(i,"Core/Axis/LogarithmicAxis.js",[i["Core/Utilities.js"]],(function(t){var e,i=t.addEvent,n=t.normalizeTickInterval,r=t.pick;return function(t){function e(t){var e=this.logarithmic;"logarithmic"!==t.userOptions.type?this.logarithmic=void 0:e||(this.logarithmic=new o(this))}function s(){var t=this.logarithmic;t&&(this.lin2val=function(e){return t.lin2log(e)},this.val2lin=function(e){return t.log2lin(e)})}var a=[];t.compose=function(t){return-1===a.indexOf(t)&&(a.push(t),t.keepProps.push("logarithmic"),i(t,"init",e),i(t,"afterInit",s)),t};var o=function(){function t(t){this.axis=t}return t.prototype.getLogTickPositions=function(t,e,i,s){var a=this.axis,o=a.len,l=a.options,h=[];if(s||(this.minorAutoInterval=void 0),.5<=t)t=Math.round(t),h=a.getLinearTickPositions(t,e,i);else if(.08<=t){var c,u=Math.floor(e),d=l=void 0;for(o=.3<t?[1,2,4]:.15<t?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];u<i+1&&!d;u++){var f=o.length;for(c=0;c<f&&!d;c++){var p=this.log2lin(this.lin2log(u)*o[c]);p>e&&(!s||l<=i)&&void 0!==l&&h.push(l),l>i&&(d=!0),l=p}}}else e=this.lin2log(e),i=this.lin2log(i),t=s?a.getMinorTickInterval():l.tickInterval,t=r("auto"===t?null:t,this.minorAutoInterval,l.tickPixelInterval/(s?5:1)*(i-e)/((s?o/a.tickPositions.length:o)||1)),t=n(t),h=a.getLinearTickPositions(t,e,i).map(this.log2lin),s||(this.minorAutoInterval=t/5);return s||(a.tickInterval=t),h},t.prototype.lin2log=function(t){return Math.pow(10,t)},t.prototype.log2lin=function(t){return Math.log(t)/Math.LN10},t}();t.Additions=o}(e||(e={})),e})),e(i,"Core/Axis/PlotLineOrBand/PlotLineOrBandAxis.js",[i["Core/Utilities.js"]],(function(t){var e,i=t.erase,n=t.extend,r=t.isNumber;return function(t){var e,s=[];t.compose=function(t,i){return e||(e=t),-1===s.indexOf(i)&&(s.push(i),n(i.prototype,a.prototype)),i};var a=function(){function t(){}return t.prototype.getPlotBandPath=function(t,e,i){void 0===i&&(i=this.options);var n=this.getPlotLinePath({value:e,force:!0,acrossPanes:i.acrossPanes}),s=[],a=this.horiz;if(e=!r(this.min)||!r(this.max)||t<this.min&&e<this.min||t>this.max&&e>this.max,t=this.getPlotLinePath({value:t,force:!0,acrossPanes:i.acrossPanes}),i=1,t&&n){if(e){var o=t.toString()===n.toString();i=0}for(e=0;e<t.length;e+=2){var l=t[e],h=t[e+1],c=n[e],u=n[e+1];"M"!==l[0]&&"L"!==l[0]||"M"!==h[0]&&"L"!==h[0]||"M"!==c[0]&&"L"!==c[0]||"M"!==u[0]&&"L"!==u[0]||(a&&c[1]===l[1]?(c[1]+=i,u[1]+=i):a||c[2]!==l[2]||(c[2]+=i,u[2]+=i),s.push(["M",l[1],l[2]],["L",h[1],h[2]],["L",u[1],u[2]],["L",c[1],c[2]],["Z"])),s.isFlat=o}}return s},t.prototype.addPlotBand=function(t){return this.addPlotBandOrLine(t,"plotBands")},t.prototype.addPlotLine=function(t){return this.addPlotBandOrLine(t,"plotLines")},t.prototype.addPlotBandOrLine=function(t,i){var n=this,r=this.userOptions,s=new e(this,t);if(this.visible&&(s=s.render()),s){if(this._addedPlotLB||(this._addedPlotLB=!0,(r.plotLines||[]).concat(r.plotBands||[]).forEach((function(t){n.addPlotBandOrLine(t)}))),i){var a=r[i]||[];a.push(t),r[i]=a}this.plotLinesAndBands.push(s)}return s},t.prototype.removePlotBandOrLine=function(t){var e=this.plotLinesAndBands,n=this.options,r=this.userOptions;if(e){for(var s=e.length;s--;)e[s].id===t&&e[s].destroy();[n.plotLines||[],r.plotLines||[],n.plotBands||[],r.plotBands||[]].forEach((function(e){for(s=e.length;s--;)(e[s]||{}).id===t&&i(e,e[s])}))}},t.prototype.removePlotBand=function(t){this.removePlotBandOrLine(t)},t.prototype.removePlotLine=function(t){this.removePlotBandOrLine(t)},t}()}(e||(e={})),e})),e(i,"Core/Axis/PlotLineOrBand/PlotLineOrBand.js",[i["Core/Axis/PlotLineOrBand/PlotLineOrBandAxis.js"],i["Core/Utilities.js"]],(function(t,e){var i=e.arrayMax,n=e.arrayMin,r=e.defined,s=e.destroyObjectProperties,a=e.erase,o=e.fireEvent,l=e.merge,h=e.objectEach,c=e.pick;return e=function(){function e(t,e){this.axis=t,e&&(this.options=e,this.id=e.id)}return e.compose=function(i){return t.compose(e,i)},e.prototype.render=function(){o(this,"render");var t=this,e=t.axis,i=e.horiz,n=e.logarithmic,s=t.options,a=s.color,u=c(s.zIndex,0),d=s.events,f={},p=e.chart.renderer,g=s.label,m=t.label,v=s.to,y=s.from,b=s.value,_=t.svgElem,x=[],w=r(y)&&r(v);x=r(b);var S=!_,T={class:"highcharts-plot-"+(w?"band ":"line ")+(s.className||"")},E=w?"bands":"lines";if(n&&(y=n.log2lin(y),v=n.log2lin(v),b=n.log2lin(b)),e.chart.styledMode||(x?(T.stroke=a||"#999999",T["stroke-width"]=c(s.width,1),s.dashStyle&&(T.dashstyle=s.dashStyle)):w&&(T.fill=a||"#e6ebf5",s.borderWidth&&(T.stroke=s.borderColor,T["stroke-width"]=s.borderWidth))),f.zIndex=u,E+="-"+u,(n=e.plotLinesAndBandsGroups[E])||(e.plotLinesAndBandsGroups[E]=n=p.g("plot-"+E).attr(f).add()),S&&(t.svgElem=_=p.path().attr(T).add(n)),x)x=e.getPlotLinePath({value:b,lineWidth:_.strokeWidth(),acrossPanes:s.acrossPanes});else{if(!w)return;x=e.getPlotBandPath(y,v,s)}return!t.eventsAdded&&d&&(h(d,(function(e,i){_.on(i,(function(e){d[i].apply(t,[e])}))})),t.eventsAdded=!0),(S||!_.d)&&x&&x.length?_.attr({d:x}):_&&(x?(_.show(),_.animate({d:x})):_.d&&(_.hide(),m&&(t.label=m=m.destroy()))),g&&(r(g.text)||r(g.formatter))&&x&&x.length&&0<e.width&&0<e.height&&!x.isFlat?(g=l({align:i&&w&&"center",x:i?!w&&4:10,verticalAlign:!i&&w&&"middle",y:i?w?16:10:w?6:-4,rotation:i&&!w&&90},g),this.renderLabel(g,x,w,u)):m&&m.hide(),t},e.prototype.renderLabel=function(t,e,r,s){var a=this.axis,o=a.chart.renderer,h=this.label;h||(this.label=h=o.text(this.getLabelText(t),0,0,t.useHTML).attr({align:t.textAlign||t.align,rotation:t.rotation,class:"highcharts-plot-"+(r?"band":"line")+"-label "+(t.className||""),zIndex:s}).add(),a.chart.styledMode||h.css(l({textOverflow:"ellipsis"},t.style))),s=e.xBounds||[e[0][1],e[1][1],r?e[2][1]:e[0][1]],e=e.yBounds||[e[0][2],e[1][2],r?e[2][2]:e[0][2]],r=n(s),o=n(e),h.align(t,!1,{x:r,y:o,width:i(s)-r,height:i(e)-o}),h.alignValue&&"left"!==h.alignValue||(t=t.clip?a.width:a.chart.chartWidth,h.css({width:(90===h.rotation?a.height-(h.alignAttr.y-a.top):t-(h.alignAttr.x-a.left))+"px"})),h.show(!0)},e.prototype.getLabelText=function(t){return r(t.formatter)?t.formatter.call(this):t.text},e.prototype.destroy=function(){a(this.axis.plotLinesAndBands,this),delete this.axis,s(this)},e}(),e})),e(i,"Core/Tooltip.js",[i["Core/FormatUtilities.js"],i["Core/Globals.js"],i["Core/Renderer/RendererUtilities.js"],i["Core/Renderer/RendererRegistry.js"],i["Core/Utilities.js"]],(function(t,e,i,n,r){var s=t.format,a=e.doc,o=i.distribute,l=r.clamp,h=r.css,c=r.discardElement,u=r.extend,d=r.fireEvent,f=r.isArray,p=r.isNumber,g=r.isString,m=r.merge,v=r.pick,y=r.splat,b=r.syncTimeout;return t=function(){function t(t,e){this.allowShared=!0,this.container=void 0,this.crosshairs=[],this.distance=0,this.isHidden=!0,this.isSticky=!1,this.now={},this.options={},this.outside=!1,this.chart=t,this.init(t,e)}return t.prototype.applyFilter=function(){var t=this.chart;t.renderer.definition({tagName:"filter",attributes:{id:"drop-shadow-"+t.index,opacity:.5},children:[{tagName:"feGaussianBlur",attributes:{in:"SourceAlpha",stdDeviation:1}},{tagName:"feOffset",attributes:{dx:1,dy:1}},{tagName:"feComponentTransfer",children:[{tagName:"feFuncA",attributes:{type:"linear",slope:.3}}]},{tagName:"feMerge",children:[{tagName:"feMergeNode"},{tagName:"feMergeNode",attributes:{in:"SourceGraphic"}}]}]})},t.prototype.bodyFormatter=function(t){return t.map((function(t){var e=t.series.tooltipOptions;return(e[(t.point.formatPrefix||"point")+"Formatter"]||t.point.tooltipFormatter).call(t.point,e[(t.point.formatPrefix||"point")+"Format"]||"")}))},t.prototype.cleanSplit=function(t){this.chart.series.forEach((function(e){var i=e&&e.tt;i&&(!i.isActive||t?e.tt=i.destroy():i.isActive=!1)}))},t.prototype.defaultFormatter=function(t){var e=this.points||y(this),i=[t.tooltipFooterHeaderFormatter(e[0])];return(i=i.concat(t.bodyFormatter(e))).push(t.tooltipFooterHeaderFormatter(e[0],!0)),i},t.prototype.destroy=function(){this.label&&(this.label=this.label.destroy()),this.split&&this.tt&&(this.cleanSplit(!0),this.tt=this.tt.destroy()),this.renderer&&(this.renderer=this.renderer.destroy(),c(this.container)),r.clearTimeout(this.hideTimer),r.clearTimeout(this.tooltipTimeout)},t.prototype.getAnchor=function(t,e){var i=this.chart,n=i.pointer,r=i.inverted,s=i.plotTop;if(i=i.plotLeft,(t=y(t))[0].series&&t[0].series.yAxis&&!t[0].series.yAxis.options.reversedStacks&&(t=t.slice().reverse()),this.followPointer&&e)void 0===e.chartX&&(e=n.normalize(e)),t=[e.chartX-i,e.chartY-s];else if(t[0].tooltipPos)t=t[0].tooltipPos;else{var a=0,o=0;t.forEach((function(t){(t=t.pos(!0))&&(a+=t[0],o+=t[1])})),a/=t.length,o/=t.length,this.shared&&1<t.length&&e&&(r?a=e.chartX:o=e.chartY),t=[a-i,o-s]}return t.map(Math.round)},t.prototype.getClassName=function(t,e,i){var n=t.series,r=n.options;return[this.options.className,"highcharts-label",i&&"highcharts-tooltip-header",e?"highcharts-tooltip-box":"highcharts-tooltip",!i&&"highcharts-color-"+v(t.colorIndex,n.colorIndex),r&&r.className].filter(g).join(" ")},t.prototype.getLabel=function(){var t,i=this,r=this.chart.styledMode,s=this.options,a=this.split&&this.allowShared,o=s.style.pointerEvents||(this.shouldStickOnContact()?"auto":"none"),l=this.chart.renderer;if(i.label){var c=!i.label.hasClass("highcharts-label");(a&&!c||!a&&c)&&i.destroy()}if(!this.label){if(this.outside){c=this.chart.options.chart.style;var u=n.getRendererType();this.container=t=e.doc.createElement("div"),t.className="highcharts-tooltip-container",h(t,{position:"absolute",top:"1px",pointerEvents:o,zIndex:Math.max(this.options.style.zIndex||0,(c&&c.zIndex||0)+3)}),e.doc.body.appendChild(t),this.renderer=l=new u(t,0,0,c,void 0,void 0,l.styledMode)}if(a?this.label=l.g("tooltip"):(this.label=l.label("",0,0,s.shape,void 0,void 0,s.useHTML,void 0,"tooltip").attr({padding:s.padding,r:s.borderRadius}),r||this.label.attr({fill:s.backgroundColor,"stroke-width":s.borderWidth}).css(s.style).css({pointerEvents:o}).shadow(s.shadow)),r&&s.shadow&&(this.applyFilter(),this.label.attr({filter:"url(#drop-shadow-"+this.chart.index+")"})),i.outside&&!i.split){var d=this.label,f=d.xSetter,p=d.ySetter;d.xSetter=function(e){f.call(d,i.distance),t.style.left=e+"px"},d.ySetter=function(e){p.call(d,i.distance),t.style.top=e+"px"}}this.label.attr({zIndex:8}).add()}return this.label},t.prototype.getPosition=function(t,e,i){var n,r=this.chart,s=this.distance,o={},l=r.inverted&&i.h||0,h=this.outside,c=h?a.documentElement.clientWidth-2*s:r.chartWidth,u=h?Math.max(a.body.scrollHeight,a.documentElement.scrollHeight,a.body.offsetHeight,a.documentElement.offsetHeight,a.documentElement.clientHeight):r.chartHeight,d=r.pointer.getChartPosition(),f=function(n){var a="x"===n;return[n,a?c:u,a?t:e].concat(h?[a?t*d.scaleX:e*d.scaleY,a?d.left-s+(i.plotX+r.plotLeft)*d.scaleX:d.top-s+(i.plotY+r.plotTop)*d.scaleY,0,a?c:u]:[a?t:e,a?i.plotX+r.plotLeft:i.plotY+r.plotTop,a?r.plotLeft:r.plotTop,a?r.plotLeft+r.plotWidth:r.plotTop+r.plotHeight])},p=f("y"),g=f("x");f=!!i.negative,!r.polar&&r.hoverSeries&&r.hoverSeries.yAxis&&r.hoverSeries.yAxis.reversed&&(f=!f);var m=!this.followPointer&&v(i.ttBelow,!r.inverted===f),y=function(t,e,i,n,r,a,c){var u=h?"y"===t?s*d.scaleY:s*d.scaleX:s,f=(i-n)/2,p=n<r-s,g=r+s+n<e,v=r-u-i+f;if(r=r+u-f,m&&g)o[t]=r;else if(!m&&p)o[t]=v;else if(p)o[t]=Math.min(c-n,0>v-l?v:v-l);else{if(!g)return!1;o[t]=Math.max(a,r+l+i>e?r:r+l)}},b=function(t,e,i,n,r){var a;return r<s||r>e-s?a=!1:o[t]=r<i/2?1:r>e-n/2?e-n-2:r-i/2,a},_=function(t){var e=p;p=g,g=e,n=t},x=function(){!1!==y.apply(0,p)?!1!==b.apply(0,g)||n||(_(!0),x()):n?o.x=o.y=0:(_(!0),x())};return(r.inverted||1<this.len)&&_(),x(),o},t.prototype.hide=function(t){var e=this;r.clearTimeout(this.hideTimer),t=v(t,this.options.hideDelay),this.isHidden||(this.hideTimer=b((function(){e.getLabel().fadeOut(t?void 0:t),e.isHidden=!0}),t))},t.prototype.init=function(t,e){this.chart=t,this.options=e,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.split=e.split&&!t.inverted&&!t.polar,this.shared=e.shared||this.split,this.outside=v(e.outside,!(!t.scrollablePixelsX&&!t.scrollablePixelsY))},t.prototype.shouldStickOnContact=function(t){return!(this.followPointer||!this.options.stickOnContact||t&&!this.chart.pointer.inClass(t.target,"highcharts-tooltip"))},t.prototype.move=function(t,e,i,n){var s=this,a=s.now,o=!1!==s.options.animation&&!s.isHidden&&(1<Math.abs(t-a.x)||1<Math.abs(e-a.y)),l=s.followPointer||1<s.len;u(a,{x:o?(2*a.x+t)/3:t,y:o?(a.y+e)/2:e,anchorX:l?void 0:o?(2*a.anchorX+i)/3:i,anchorY:l?void 0:o?(a.anchorY+n)/2:n}),s.getLabel().attr(a),s.drawTracker(),o&&(r.clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout((function(){s&&s.move(t,e,i,n)}),32))},t.prototype.refresh=function(t,e){var i=this.chart,n=this.options,s=i.pointer,a=y(t),o=a[0],l=[],h=n.formatter||this.defaultFormatter,c=this.shared,u=i.styledMode,p={};if(n.enabled&&o.series){r.clearTimeout(this.hideTimer),this.allowShared=!(!f(t)&&t.series&&t.series.noSharedTooltip),this.followPointer=!this.split&&o.series.tooltipOptions.followPointer;var g=(t=this.getAnchor(t,e))[0],m=t[1];if(c&&this.allowShared?(s.applyInactiveState(a),a.forEach((function(t){t.setState("hover"),l.push(t.getLabelConfig())})),(p={x:o.category,y:o.y}).points=l):p=o.getLabelConfig(),this.len=l.length,h=h.call(p,this),c=o.series,this.distance=v(c.tooltipOptions.distance,16),!1===h)this.hide();else{if(this.split&&this.allowShared)this.renderSplit(h,a);else{var b=g,_=m;if(e&&s.isDirectTouch&&(b=e.chartX-i.plotLeft,_=e.chartY-i.plotTop),!i.polar&&!1!==c.options.clip&&!a.some((function(t){return s.isDirectTouch||t.series.shouldShowTooltip(b,_)})))return void this.hide();e=this.getLabel(),n.style.width&&!u||e.css({width:i.spacingBox.width+"px"}),e.attr({text:h&&h.join?h.join(""):h}),e.addClass(this.getClassName(o),!0),u||e.attr({stroke:n.borderColor||o.color||c.color||"#666666"}),this.updatePosition({plotX:g,plotY:m,negative:o.negative,ttBelow:o.ttBelow,h:t[2]||0})}this.isHidden&&this.label&&this.label.attr({opacity:1}).show(),this.isHidden=!1}d(this,"refresh")}},t.prototype.renderSplit=function(t,e){function i(t,e,i,r,s){return void 0===s&&(s=!0),i?(e=A?0:I,t=l(t-r/2,k.left,k.right-r-(n.outside?O:0))):(e-=P,t=l(t=s?t-r-S:t+S,s?t:k.left,k.right)),{x:t,y:e}}var n=this,r=n.chart,s=n.chart,h=s.chartWidth,c=s.chartHeight,d=s.plotHeight,f=s.plotLeft,p=s.plotTop,m=s.pointer,y=s.scrollablePixelsY;y=void 0===y?0:y;var b=s.scrollablePixelsX,_=s.scrollingContainer,x=(_=void 0===_?{scrollLeft:0,scrollTop:0}:_).scrollLeft;_=_.scrollTop;var w=s.styledMode,S=n.distance,T=n.options,E=n.options.positioner,k=n.outside&&"number"!=typeof b?a.documentElement.getBoundingClientRect():{left:x,right:x+h,top:_,bottom:_+c},C=n.getLabel(),M=this.renderer||r.renderer,A=!(!r.xAxis[0]||!r.xAxis[0].opposite),O=(r=m.getChartPosition()).left;r=r.top;var P=p+_,R=0,I=d-y;g(t)&&(t=[!1,t]),t=t.slice(0,e.length+1).reduce((function(t,r,s){if(!1!==r&&""!==r){var a=(s=e[s-1]||{isHeader:!0,plotX:e[0].plotX,plotY:d,series:{}}).isHeader,o=a?n:s.series;r=r.toString();var h=o.tt,c=s.isHeader,u=s.series;h||(h={padding:T.padding,r:T.borderRadius},w||(h.fill=T.backgroundColor,h["stroke-width"]=T.borderWidth),h=M.label("",0,0,T[c?"headerShape":"shape"],void 0,void 0,T.useHTML).addClass(n.getClassName(s,!0,c)).attr(h).add(C)),h.isActive=!0,h.attr({text:r}),w||h.css(T.style).shadow(T.shadow).attr({stroke:T.borderColor||s.color||u.color||"#333333"}),r=(c=(o=o.tt=h).getBBox()).width+o.strokeWidth(),a&&(R=c.height,I+=R,A&&(P-=R)),u=void 0===(u=s.plotX)?0:u,h=void 0===(h=s.plotY)?0:h;var g=s.series;if(s.isHeader){u=f+u;var m=p+d/2}else{var y=g.xAxis,b=g.yAxis;u=y.pos+l(u,-S,y.len+S),g.shouldShowTooltip(0,b.pos-p+h,{ignoreX:!0})&&(m=b.pos+h)}u=l(u,k.left-S,k.right+S),"number"==typeof m?(c=c.height+1,h=E?E.call(n,r,c,s):i(u,m,a,r),t.push({align:E?0:void 0,anchorX:u,anchorY:m,boxWidth:r,point:s,rank:v(h.rank,a?1:0),size:c,target:h.y,tt:o,x:h.x})):o.isActive=!1}return t}),[]),!E&&t.some((function(t){var e=(n.outside?O:0)+t.anchorX;return e<k.left&&e+t.boxWidth<k.right||e<O-k.left+t.boxWidth&&k.right-e>e}))&&(t=t.map((function(t){var e=i(t.anchorX,t.anchorY,t.point.isHeader,t.boxWidth,!1);return u(t,{target:e.y,x:e.x})}))),n.cleanSplit(),o(t,I);var L=O,D=O;t.forEach((function(t){var e=t.x,i=t.boxWidth;(t=t.isHeader)||(n.outside&&O+e<L&&(L=O+e),!t&&n.outside&&L+i>D&&(D=O+e))})),t.forEach((function(t){var e=t.x,i=t.anchorX,r=t.pos,s=t.point.isHeader;if(r={visibility:void 0===r?"hidden":"inherit",x:e,y:(r||0)+P,anchorX:i,anchorY:t.anchorY},n.outside&&e<i){var a=O-L;0<a&&(s||(r.x=e+a,r.anchorX=i+a),s&&(r.x=(D-L)/2,r.anchorX=i+a))}t.tt.attr(r)})),t=n.container,y=n.renderer,n.outside&&t&&y&&(s=C.getBBox(),y.setSize(s.width+s.x,s.height+s.y,!1),t.style.left=L+"px",t.style.top=r+"px")},t.prototype.drawTracker=function(){if(this.shouldStickOnContact()){var t=this.chart,e=this.label,i=this.shared?t.hoverPoints:t.hoverPoint;if(e&&i){var n={x:0,y:0,width:0,height:0};i=this.getAnchor(i);var r=e.getBBox();i[0]+=t.plotLeft-e.translateX,i[1]+=t.plotTop-e.translateY,n.x=Math.min(0,i[0]),n.y=Math.min(0,i[1]),n.width=0>i[0]?Math.max(Math.abs(i[0]),r.width-i[0]):Math.max(Math.abs(i[0]),r.width),n.height=0>i[1]?Math.max(Math.abs(i[1]),r.height-Math.abs(i[1])):Math.max(Math.abs(i[1]),r.height),this.tracker?this.tracker.attr(n):(this.tracker=e.renderer.rect(n).addClass("highcharts-tracker").add(e),t.styledMode||this.tracker.attr({fill:"rgba(0,0,0,0)"}))}}else this.tracker&&this.tracker.destroy()},t.prototype.styledModeFormat=function(t){return t.replace('style="font-size: 10px"','class="highcharts-header"').replace(/style="color:{(point|series)\.color}"/g,'class="highcharts-color-{$1.colorIndex} {series.options.className} {point.options.className}"')},t.prototype.tooltipFooterHeaderFormatter=function(t,e){var i=t.series,n=i.tooltipOptions,r=i.xAxis,a=r&&r.dateTime;r={isFooter:e,labelConfig:t};var o=n.xDateFormat,l=n[e?"footerFormat":"headerFormat"];return d(this,"headerFormatter",r,(function(e){a&&!o&&p(t.key)&&(o=a.getXDateFormat(t.key,n.dateTimeLabelFormats)),a&&o&&(t.point&&t.point.tooltipDateKeys||["key"]).forEach((function(t){l=l.replace("{point."+t+"}","{point."+t+":"+o+"}")})),i.chart.styledMode&&(l=this.styledModeFormat(l)),e.text=s(l,{point:t,series:i},this.chart)})),r.text},t.prototype.update=function(t){this.destroy(),m(!0,this.chart.options.tooltip.userOptions,t),this.init(this.chart,m(!0,this.options,t))},t.prototype.updatePosition=function(t){var e=this.chart,i=this.distance,n=this.options,r=e.pointer,s=this.getLabel(),a=r.getChartPosition();r=a.left;var o=a.top,l=a.scaleX;a=a.scaleY;var c=(n.positioner||this.getPosition).call(this,s.width,s.height,t),u=(t.plotX||0)+e.plotLeft;t=(t.plotY||0)+e.plotTop,this.outside&&(n.positioner&&(c.x+=r-i,c.y+=o-i),i=n.borderWidth+2*i,this.renderer.setSize(s.width+i,s.height+i,!1),1===l&&1===a||(h(this.container,{transform:"scale(".concat(l,", ").concat(a,")")}),u*=l,t*=a),u+=r-c.x,t+=o-c.y),this.move(Math.round(c.x),Math.round(c.y||0),u,t)},t}(),t})),e(i,"Core/Series/Point.js",[i["Core/Renderer/HTML/AST.js"],i["Core/Animation/AnimationUtilities.js"],i["Core/Defaults.js"],i["Core/FormatUtilities.js"],i["Core/Utilities.js"]],(function(t,e,i,n,r){var s=e.animObject,a=i.defaultOptions,o=n.format,l=r.addEvent,h=r.defined,c=r.erase,u=r.extend,d=r.fireEvent,f=r.getNestedProperty,p=r.isArray,g=r.isFunction,m=r.isNumber,v=r.isObject,y=r.merge,b=r.objectEach,_=r.pick,x=r.syncTimeout,w=r.removeEvent,S=r.uniqueKey;return e=function(){function e(){this.category=void 0,this.formatPrefix="point",this.id=void 0,this.isNull=!1,this.percentage=this.options=this.name=void 0,this.selected=!1,this.total=this.shapeArgs=this.series=void 0,this.visible=!0,this.x=void 0}return e.prototype.animateBeforeDestroy=function(){var t=this,e={x:t.startXPos,opacity:0},i=t.getGraphicalProps();i.singular.forEach((function(i){t[i]=t[i].animate("dataLabel"===i?{x:t[i].startXPos,y:t[i].startYPos,opacity:0}:e)})),i.plural.forEach((function(e){t[e].forEach((function(e){e.element&&e.animate(u({x:t.startXPos},e.startYPos?{x:e.startXPos,y:e.startYPos}:{}))}))}))},e.prototype.applyOptions=function(t,i){var n=this.series,r=n.options.pointValKey||n.pointValKey;return t=e.prototype.optionsToObject.call(this,t),u(this,t),this.options=this.options?u(this.options,t):t,t.group&&delete this.group,t.dataLabels&&delete this.dataLabels,r&&(this.y=e.prototype.getNestedProperty.call(this,r)),this.formatPrefix=(this.isNull=this.isValid&&!this.isValid())?"null":"point",this.selected&&(this.state="select"),"name"in this&&void 0===i&&n.xAxis&&n.xAxis.hasNames&&(this.x=n.xAxis.nameToX(this)),void 0===this.x&&n?this.x=void 0===i?n.autoIncrement():i:m(t.x)&&n.options.relativeXValue&&(this.x=n.autoIncrement(t.x)),this},e.prototype.destroy=function(){function t(){for(r in(e.graphic||e.graphics||e.dataLabel||e.dataLabels)&&(w(e),e.destroyElements()),e)e[r]=null}var e=this,i=e.series,n=i.chart;i=i.options.dataSorting;var r,a=n.hoverPoints,o=s(e.series.chart.renderer.globalAnimation);e.legendItem&&n.legend.destroyItem(e),a&&(e.setState(),c(a,e),a.length||(n.hoverPoints=null)),e===n.hoverPoint&&e.onMouseOut(),i&&i.enabled?(this.animateBeforeDestroy(),x(t,o.duration)):t(),n.pointCount--},e.prototype.destroyElements=function(t){var e=this;(t=e.getGraphicalProps(t)).singular.forEach((function(t){e[t]=e[t].destroy()})),t.plural.forEach((function(t){e[t].forEach((function(t){t&&t.element&&t.destroy()})),delete e[t]}))},e.prototype.firePointEvent=function(t,e,i){var n=this,r=this.series.options;(r.point.events[t]||n.options&&n.options.events&&n.options.events[t])&&n.importEvents(),"click"===t&&r.allowPointSelect&&(i=function(t){n.select&&n.select(null,t.ctrlKey||t.metaKey||t.shiftKey)}),d(n,t,e,i)},e.prototype.getClassName=function(){return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(void 0!==this.colorIndex?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+(this.zone&&this.zone.className?" "+this.zone.className.replace("highcharts-negative",""):"")},e.prototype.getGraphicalProps=function(t){var e,i=this,n=[],r={singular:[],plural:[]};for((t=t||{graphic:1,dataLabel:1}).graphic&&n.push("graphic","shadowGroup"),t.dataLabel&&n.push("dataLabel","dataLabelPath","dataLabelUpper","connector"),e=n.length;e--;){var s=n[e];i[s]&&r.singular.push(s)}return["graphic","dataLabel","connector"].forEach((function(e){var n=e+"s";t[e]&&i[n]&&r.plural.push(n)})),r},e.prototype.getLabelConfig=function(){return{x:this.category,y:this.y,color:this.color,colorIndex:this.colorIndex,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},e.prototype.getNestedProperty=function(t){if(t)return 0===t.indexOf("custom.")?f(t,this.options):this[t]},e.prototype.getZone=function(){var t=this.series,e=t.zones;t=t.zoneAxis||"y";var i,n=0;for(i=e[n];this[t]>=i.value;)i=e[++n];return this.nonZonedColor||(this.nonZonedColor=this.color),this.color=i&&i.color&&!this.options.color?i.color:this.nonZonedColor,i},e.prototype.hasNewShapeType=function(){return(this.graphic&&(this.graphic.symbolName||this.graphic.element.nodeName))!==this.shapeType},e.prototype.init=function(t,e,i){return this.series=t,this.applyOptions(e,i),this.id=h(this.id)?this.id:S(),this.resolveColor(),t.chart.pointCount++,d(this,"afterInit"),this},e.prototype.isValid=function(){return null!==this.x&&m(this.y)},e.prototype.optionsToObject=function(t){var i=this.series,n=i.options.keys,r=n||i.pointArrayMap||["y"],s=r.length,a={},o=0,l=0;if(m(t)||null===t)a[r[0]]=t;else if(p(t))for(!n&&t.length>s&&("string"==(i=typeof t[0])?a.name=t[0]:"number"===i&&(a.x=t[0]),o++);l<s;)n&&void 0===t[o]||(0<r[l].indexOf(".")?e.prototype.setNestedProperty(a,t[o],r[l]):a[r[l]]=t[o]),o++,l++;else"object"==typeof t&&(a=t,t.dataLabels&&(i._hasPointLabels=!0),t.marker&&(i._hasPointMarkers=!0));return a},e.prototype.pos=function(t,e){void 0===e&&(e=this.plotY);var i=this.plotX,n=this.series,r=n.chart,s=n.xAxis;n=n.yAxis;var a=0,o=0;if(m(i)&&m(e))return t&&(a=s?s.pos:r.plotLeft,o=n?n.pos:r.plotTop),r.inverted&&s&&n?[n.len-e+o,s.len-i+a]:[i+a,e+o]},e.prototype.resolveColor=function(){var t=this.series,e=t.chart.styledMode,i=t.chart.options.chart.colorCount;if(delete this.nonZonedColor,t.options.colorByPoint){if(!e){var n=(i=t.options.colors||t.chart.options.colors)[t.colorCounter];i=i.length}e=t.colorCounter,t.colorCounter++,t.colorCounter===i&&(t.colorCounter=0)}else e||(n=t.color),e=t.colorIndex;this.colorIndex=_(this.options.colorIndex,e),this.color=_(this.options.color,n)},e.prototype.setNestedProperty=function(t,e,i){return i.split(".").reduce((function(t,i,n,r){return t[i]=r.length-1===n?e:v(t[i],!0)?t[i]:{},t[i]}),t),t},e.prototype.shouldDraw=function(){return!this.isNull},e.prototype.tooltipFormatter=function(t){var e=this.series,i=e.tooltipOptions,n=_(i.valueDecimals,""),r=i.valuePrefix||"",s=i.valueSuffix||"";return e.chart.styledMode&&(t=e.chart.tooltip.styledModeFormat(t)),(e.pointArrayMap||["y"]).forEach((function(e){e="{point."+e,(r||s)&&(t=t.replace(RegExp(e+"}","g"),r+e+"}"+s)),t=t.replace(RegExp(e+"}","g"),e+":,."+n+"f}")})),o(t,{point:this,series:this.series},e.chart)},e.prototype.update=function(t,e,i,n){function r(){a.applyOptions(t);var n=l&&a.hasMockGraphic;n=null===a.y?!n:n,l&&n&&(a.graphic=l.destroy(),delete a.hasMockGraphic),v(t,!0)&&(l&&l.element&&t&&t.marker&&void 0!==t.marker.symbol&&(a.graphic=l.destroy()),t&&t.dataLabels&&a.dataLabel&&(a.dataLabel=a.dataLabel.destroy()),a.connector&&(a.connector=a.connector.destroy())),s=a.index,o.updateParallelArrays(a,s),c.data[s]=v(c.data[s],!0)||v(t,!0)?a.options:_(t,c.data[s]),o.isDirty=o.isDirtyData=!0,!o.fixedBox&&o.hasCartesianSeries&&(h.isDirtyBox=!0),"point"===c.legendType&&(h.isDirtyLegend=!0),e&&h.redraw(i)}var s,a=this,o=a.series,l=a.graphic,h=o.chart,c=o.options;e=_(e,!0),!1===n?r():a.firePointEvent("update",{options:t},r)},e.prototype.remove=function(t,e){this.series.removePoint(this.series.data.indexOf(this),t,e)},e.prototype.select=function(t,e){var i=this,n=i.series,r=n.chart;this.selectedStaging=t=_(t,!i.selected),i.firePointEvent(t?"select":"unselect",{accumulate:e},(function(){i.selected=i.options.selected=t,n.options.data[n.data.indexOf(i)]=i.options,i.setState(t&&"select"),e||r.getSelectedPoints().forEach((function(t){var e=t.series;t.selected&&t!==i&&(t.selected=t.options.selected=!1,e.options.data[e.data.indexOf(t)]=t.options,t.setState(r.hoverPoints&&e.options.inactiveOtherPoints?"inactive":""),t.firePointEvent("unselect"))}))})),delete this.selectedStaging},e.prototype.onMouseOver=function(t){var e=this.series.chart,i=e.pointer;t=t?i.normalize(t):i.getChartCoordinatesFromPoint(this,e.inverted),i.runPointActions(t,this)},e.prototype.onMouseOut=function(){var t=this.series.chart;this.firePointEvent("mouseOut"),this.series.options.inactiveOtherPoints||(t.hoverPoints||[]).forEach((function(t){t.setState()})),t.hoverPoints=t.hoverPoint=null},e.prototype.importEvents=function(){if(!this.hasImportedEvents){var t=this,e=y(t.series.options.point,t.options).events;t.events=e,b(e,(function(e,i){g(e)&&l(t,i,e)})),this.hasImportedEvents=!0}},e.prototype.setState=function(e,i){var n,r=this.series,s=this.state,o=r.options.states[e||"normal"]||{},l=a.plotOptions[r.type].marker&&r.options.marker,h=l&&!1===l.enabled,c=l&&l.states&&l.states[e||"normal"]||{},f=!1===c.enabled,p=this.marker||{},g=r.chart,v=l&&r.markerAttribs,y=r.halo,b=r.stateMarkerGraphic;if(!((e=e||"")===this.state&&!i||this.selected&&"select"!==e||!1===o.enabled||e&&(f||h&&!1===c.enabled)||e&&p.states&&p.states[e]&&!1===p.states[e].enabled)){if(this.state=e,v&&(n=r.markerAttribs(this,e)),this.graphic&&!this.hasMockGraphic){if(s&&this.graphic.removeClass("highcharts-point-"+s),e&&this.graphic.addClass("highcharts-point-"+e),!g.styledMode){s=r.pointAttribs(this,e);var x=_(g.options.chart.animation,o.animation),w=s.opacity;r.options.inactiveOtherPoints&&m(w)&&((this.dataLabels||[]).forEach((function(t){t&&!t.hasClass("highcharts-data-label-hidden")&&t.animate({opacity:w},x)})),this.connector&&this.connector.animate({opacity:w},x)),this.graphic.animate(s,x)}n&&this.graphic.animate(n,_(g.options.chart.animation,c.animation,l.animation)),b&&b.hide()}else e&&c&&(l=p.symbol||r.symbol,b&&b.currentSymbol!==l&&(b=b.destroy()),n&&(b?b[i?"animate":"attr"]({x:n.x,y:n.y}):l&&(r.stateMarkerGraphic=b=g.renderer.symbol(l,n.x,n.y,n.width,n.height).add(r.markerGroup),b.currentSymbol=l)),!g.styledMode&&b&&"inactive"!==this.state&&b.attr(r.pointAttribs(this,e))),b&&(b[e&&this.isInside?"show":"hide"](),b.element.point=this,b.addClass(this.getClassName(),!0));o=o.halo,n=(b=this.graphic||b)&&b.visibility||"inherit",o&&o.size&&b&&"hidden"!==n&&!this.isCluster?(y||(r.halo=y=g.renderer.path().add(b.parentGroup)),y.show()[i?"animate":"attr"]({d:this.haloPath(o.size)}),y.attr({class:"highcharts-halo highcharts-color-"+_(this.colorIndex,r.colorIndex)+(this.className?" "+this.className:""),visibility:n,zIndex:-1}),y.point=this,g.styledMode||y.attr(u({fill:this.color||r.color,"fill-opacity":o.opacity},t.filterUserAttributes(o.attributes||{})))):y&&y.point&&y.point.haloPath&&y.animate({d:y.point.haloPath(0)},null,y.hide),d(this,"afterSetState",{state:e})}},e.prototype.haloPath=function(t){var e=this.pos();return e?this.series.chart.renderer.symbols.circle(Math.floor(e[0])-t,e[1]-t,2*t,2*t):[]},e}(),e})),e(i,"Core/Pointer.js",[i["Core/Color/Color.js"],i["Core/Globals.js"],i["Core/Tooltip.js"],i["Core/Utilities.js"]],(function(t,e,i,n){var r=t.parse,s=e.charts,a=e.noop,o=n.addEvent,l=n.attr,h=n.css,c=n.defined,u=n.extend,d=n.find,f=n.fireEvent,p=n.isNumber,g=n.isObject,m=n.objectEach,v=n.offset,y=n.pick,b=n.splat;return t=function(){function t(t,e){this.lastValidTouch={},this.pinchDown=[],this.runChartClick=!1,this.eventsToUnbind=[],this.chart=t,this.hasDragged=!1,this.options=e,this.init(t,e)}return t.prototype.applyInactiveState=function(t){var e,i=[];(t||[]).forEach((function(t){e=t.series,i.push(e),e.linkedParent&&i.push(e.linkedParent),e.linkedSeries&&(i=i.concat(e.linkedSeries)),e.navigatorSeries&&i.push(e.navigatorSeries)})),this.chart.series.forEach((function(t){-1===i.indexOf(t)?t.setState("inactive",!0):t.options.inactiveOtherPoints&&t.setAllPointsToState("inactive")}))},t.prototype.destroy=function(){var i=this;this.eventsToUnbind.forEach((function(t){return t()})),this.eventsToUnbind=[],e.chartCount||(t.unbindDocumentMouseUp&&(t.unbindDocumentMouseUp=t.unbindDocumentMouseUp()),t.unbindDocumentTouchEnd&&(t.unbindDocumentTouchEnd=t.unbindDocumentTouchEnd())),clearInterval(i.tooltipTimeout),m(i,(function(t,e){i[e]=void 0}))},t.prototype.getSelectionMarkerAttrs=function(t,e){var i=this,n={args:{chartX:t,chartY:e},attrs:{},shapeType:"rect"};return f(this,"getSelectionMarkerAttrs",n,(function(n){var r=i.chart,s=i.mouseDownX;s=void 0===s?0:s;var a=i.mouseDownY;a=void 0===a?0:a;var o=i.zoomHor,l=i.zoomVert;(n=n.attrs).x=r.plotLeft,n.y=r.plotTop,n.width=o?1:r.plotWidth,n.height=l?1:r.plotHeight,o&&(r=t-s,n.width=Math.abs(r),n.x=(0<r?0:r)+s),l&&(r=e-a,n.height=Math.abs(r),n.y=(0<r?0:r)+a)})),n},t.prototype.drag=function(t){var e=this.chart,i=e.options.chart,n=e.plotLeft,s=e.plotTop,a=e.plotWidth,o=e.plotHeight,l=this.mouseDownX||0,h=this.mouseDownY||0,c=g(i.panning)?i.panning&&i.panning.enabled:i.panning,u=i.panKey&&t[i.panKey+"Key"],d=t.chartX,f=t.chartY,p=this.selectionMarker;p&&p.touch||(d<n?d=n:d>n+a&&(d=n+a),f<s?f=s:f>s+o&&(f=s+o),this.hasDragged=Math.sqrt(Math.pow(l-d,2)+Math.pow(h-f,2)),10<this.hasDragged&&(n=e.isInsidePlot(l-n,h-s,{visiblePlotOnly:!0}),d=(f=this.getSelectionMarkerAttrs(d,f)).shapeType,f=f.attrs,!e.hasCartesianSeries&&!e.mapView||!this.zoomX&&!this.zoomY||!n||u||p||(this.selectionMarker=p=e.renderer[d](),p.attr({class:"highcharts-selection-marker",zIndex:7}).add(),e.styledMode||p.attr({fill:i.selectionMarkerFill||r("#335cad").setOpacity(.25).get()})),p&&p.attr(f),n&&!p&&c&&e.pan(t,i.panning)))},t.prototype.dragStart=function(t){var e=this.chart;e.mouseIsDown=t.type,e.cancelClick=!1,e.mouseDownX=this.mouseDownX=t.chartX,e.mouseDownY=this.mouseDownY=t.chartY},t.prototype.getSelectionBox=function(t){var e={args:{marker:t},result:{}};return f(this,"getSelectionBox",e,(function(e){e.result={x:t.attr?+t.attr("x"):t.x,y:t.attr?+t.attr("y"):t.y,width:t.attr?t.attr("width"):t.width,height:t.attr?t.attr("height"):t.height}})),e.result},t.prototype.drop=function(t){var e=this,i=this.chart,n=this.hasPinched;if(this.selectionMarker){var r=this.getSelectionBox(this.selectionMarker),s=r.x,a=r.y,o=r.width,l=r.height,d={originalEvent:t,xAxis:[],yAxis:[],x:s,y:a,width:o,height:l},g=!!i.mapView;(this.hasDragged||n)&&(i.axes.forEach((function(i){if(i.zoomEnabled&&c(i.min)&&(n||e[{xAxis:"zoomX",yAxis:"zoomY"}[i.coll]])&&p(s)&&p(a)&&p(o)&&p(l)){var r=i.horiz,h="touchend"===t.type?i.minPixelPadding:0,u=i.toValue((r?s:a)+h);r=i.toValue((r?s+o:a+l)-h),d[i.coll].push({axis:i,min:Math.min(u,r),max:Math.max(u,r)}),g=!0}})),g&&f(i,"selection",d,(function(t){i.zoom(u(t,n?{animation:!1}:null))}))),p(i.index)&&(this.selectionMarker=this.selectionMarker.destroy()),n&&this.scaleGroups()}i&&p(i.index)&&(h(i.container,{cursor:i._cursor}),i.cancelClick=10<this.hasDragged,i.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])},t.prototype.findNearestKDPoint=function(t,e,i){var n;return t.forEach((function(t){var r=!(t.noSharedTooltip&&e)&&0>t.options.findNearestPointBy.indexOf("y");if(t=t.searchPoint(i,r),(r=g(t,!0)&&t.series)&&!(r=!g(n,!0))){r=n.distX-t.distX;var s=n.dist-t.dist,a=(t.series.group&&t.series.group.zIndex)-(n.series.group&&n.series.group.zIndex);r=0<(0!==r&&e?r:0!==s?s:0!==a?a:n.series.index>t.series.index?-1:1)}r&&(n=t)})),n},t.prototype.getChartCoordinatesFromPoint=function(t,e){var i=t.series,n=i.xAxis;i=i.yAxis;var r=t.shapeArgs;if(n&&i){var s=y(t.clientX,t.plotX),a=t.plotY||0;return t.isNode&&r&&p(r.x)&&p(r.y)&&(s=r.x,a=r.y),e?{chartX:i.len+i.pos-a,chartY:n.len+n.pos-s}:{chartX:s+n.pos,chartY:a+i.pos}}if(r&&r.x&&r.y)return{chartX:r.x,chartY:r.y}},t.prototype.getChartPosition=function(){if(this.chartPosition)return this.chartPosition;var t=this.chart.container,e=v(t);this.chartPosition={left:e.left,top:e.top,scaleX:1,scaleY:1};var i=t.offsetWidth;return t=t.offsetHeight,2<i&&2<t&&(this.chartPosition.scaleX=e.width/i,this.chartPosition.scaleY=e.height/t),this.chartPosition},t.prototype.getCoordinates=function(t){var e={xAxis:[],yAxis:[]};return this.chart.axes.forEach((function(i){e[i.isXAxis?"xAxis":"yAxis"].push({axis:i,value:i.toValue(t[i.horiz?"chartX":"chartY"])})})),e},t.prototype.getHoverData=function(t,e,i,n,r,s){var a=[];n=!(!n||!t);var o=function(t){return t.visible&&!(!r&&t.directTouch)&&y(t.options.enableMouseTracking,!0)},l={chartX:s?s.chartX:void 0,chartY:s?s.chartY:void 0,shared:r};f(this,"beforeGetHoverData",l);var h=e&&!e.stickyTracking?[e]:i.filter((function(t){return t.stickyTracking&&(l.filter||o)(t)})),c=n||!s?t:this.findNearestKDPoint(h,r,s);return e=c&&c.series,c&&(r&&!e.noSharedTooltip?(h=i.filter((function(t){return l.filter?l.filter(t):o(t)&&!t.noSharedTooltip})),h.forEach((function(t){var e=d(t.points,(function(t){return t.x===c.x&&!t.isNull}));g(e)&&(t.boosted&&t.boost&&(e=t.boost.getPoint(e)),a.push(e))}))):a.push(c)),f(this,"afterGetHoverData",l={hoverPoint:c}),{hoverPoint:l.hoverPoint,hoverSeries:e,hoverPoints:a}},t.prototype.getPointFromEvent=function(t){t=t.target;for(var e;t&&!e;)e=t.point,t=t.parentNode;return e},t.prototype.onTrackerMouseOut=function(t){t=t.relatedTarget||t.toElement;var e=this.chart.hoverSeries;this.isDirectTouch=!1,!e||!t||e.stickyTracking||this.inClass(t,"highcharts-tooltip")||this.inClass(t,"highcharts-series-"+e.index)&&this.inClass(t,"highcharts-tracker")||e.onMouseOut()},t.prototype.inClass=function(t,e){for(var i;t;){if(i=l(t,"class")){if(-1!==i.indexOf(e))return!0;if(-1!==i.indexOf("highcharts-container"))return!1}t=t.parentElement}},t.prototype.init=function(t,e){this.options=e,this.chart=t,this.runChartClick=!(!e.chart.events||!e.chart.events.click),this.pinchDown=[],this.lastValidTouch={},i&&(t.tooltip=new i(t,e.tooltip)),this.setDOMEvents()},t.prototype.normalize=function(t,e){var i=t.touches,n=i?i.length?i.item(0):y(i.changedTouches,t.changedTouches)[0]:t;return e||(e=this.getChartPosition()),i=n.pageX-e.left,n=n.pageY-e.top,i/=e.scaleX,n/=e.scaleY,u(t,{chartX:Math.round(i),chartY:Math.round(n)})},t.prototype.onContainerClick=function(t){var e=this.chart,i=e.hoverPoint;t=this.normalize(t);var n=e.plotLeft,r=e.plotTop;e.cancelClick||(i&&this.inClass(t.target,"highcharts-tracker")?(f(i.series,"click",u(t,{point:i})),e.hoverPoint&&i.firePointEvent("click",t)):(u(t,this.getCoordinates(t)),e.isInsidePlot(t.chartX-n,t.chartY-r,{visiblePlotOnly:!0})&&f(e,"click",t)))},t.prototype.onContainerMouseDown=function(t){var i=1==(1&(t.buttons||t.button));t=this.normalize(t),e.isFirefox&&0!==t.button&&this.onContainerMouseMove(t),(void 0===t.button||i)&&(this.zoomOption(t),i&&t.preventDefault&&t.preventDefault(),this.dragStart(t))},t.prototype.onContainerMouseLeave=function(e){var i=s[y(t.hoverChartIndex,-1)],n=this.chart.tooltip;e=this.normalize(e),i&&(e.relatedTarget||e.toElement)&&(i.pointer.reset(),i.pointer.chartPosition=void 0),n&&!n.isHidden&&this.reset()},t.prototype.onContainerMouseEnter=function(t){delete this.chartPosition},t.prototype.onContainerMouseMove=function(t){var e=this.chart,i=e.tooltip;t=this.normalize(t),this.setHoverChartIndex(),t.preventDefault||(t.returnValue=!1),("mousedown"===e.mouseIsDown||this.touchSelect(t))&&this.drag(t),e.openMenu||!this.inClass(t.target,"highcharts-tracker")&&!e.isInsidePlot(t.chartX-e.plotLeft,t.chartY-e.plotTop,{visiblePlotOnly:!0})||i&&i.shouldStickOnContact(t)||(this.inClass(t.target,"highcharts-no-tooltip")?this.reset(!1,0):this.runPointActions(t))},t.prototype.onDocumentTouchEnd=function(e){var i=s[y(t.hoverChartIndex,-1)];i&&i.pointer.drop(e)},t.prototype.onContainerTouchMove=function(t){this.touchSelect(t)?this.onContainerMouseMove(t):this.touch(t)},t.prototype.onContainerTouchStart=function(t){this.touchSelect(t)?this.onContainerMouseDown(t):(this.zoomOption(t),this.touch(t,!0))},t.prototype.onDocumentMouseMove=function(t){var e=this.chart,i=e.tooltip,n=this.chartPosition;t=this.normalize(t,n),!n||e.isInsidePlot(t.chartX-e.plotLeft,t.chartY-e.plotTop,{visiblePlotOnly:!0})||i&&i.shouldStickOnContact(t)||this.inClass(t.target,"highcharts-tracker")||this.reset()},t.prototype.onDocumentMouseUp=function(e){var i=s[y(t.hoverChartIndex,-1)];i&&i.pointer.drop(e)},t.prototype.pinch=function(t){var e=this,i=e.chart,n=e.pinchDown,r=t.touches||[],s=r.length,o=e.lastValidTouch,l=e.hasZoom,h={},c=1===s&&(e.inClass(t.target,"highcharts-tracker")&&i.runTrackerClick||e.runChartClick),d={},p=e.chart.tooltip;p=1===s&&y(p&&p.options.followTouchMove,!0);var g=e.selectionMarker;1<s?e.initiated=!0:p&&(e.initiated=!1),l&&e.initiated&&!c&&!1!==t.cancelable&&t.preventDefault(),[].map.call(r,(function(t){return e.normalize(t)})),"touchstart"===t.type?([].forEach.call(r,(function(t,e){n[e]={chartX:t.chartX,chartY:t.chartY}})),o.x=[n[0].chartX,n[1]&&n[1].chartX],o.y=[n[0].chartY,n[1]&&n[1].chartY],i.axes.forEach((function(t){if(t.zoomEnabled){var e=i.bounds[t.horiz?"h":"v"],n=t.minPixelPadding,r=t.toPixels(Math.min(y(t.options.min,t.dataMin),t.dataMin)),s=t.toPixels(Math.max(y(t.options.max,t.dataMax),t.dataMax)),a=Math.max(r,s);e.min=Math.min(t.pos,Math.min(r,s)-n),e.max=Math.max(t.pos+t.len,a+n)}})),e.res=!0):p?this.runPointActions(e.normalize(t)):n.length&&(f(i,"touchpan",{originalEvent:t},(function(){g||(e.selectionMarker=g=u({destroy:a,touch:!0},i.plotBox)),e.pinchTranslate(n,r,h,g,d,o),e.hasPinched=l,e.scaleGroups(h,d)})),e.res&&(e.res=!1,this.reset(!1,0)))},t.prototype.pinchTranslate=function(t,e,i,n,r,s){this.zoomHor&&this.pinchTranslateDirection(!0,t,e,i,n,r,s),this.zoomVert&&this.pinchTranslateDirection(!1,t,e,i,n,r,s)},t.prototype.pinchTranslateDirection=function(t,e,i,n,r,s,a,o){var l=this.chart,h=t?"x":"y",c=t?"X":"Y",u="chart"+c,d=t?"width":"height",f=l["plot"+(t?"Left":"Top")],p=l.inverted,g=l.bounds[t?"h":"v"],m=1===e.length,v=e[0][u],y=!m&&e[1][u];e=function(){"number"==typeof S&&20<Math.abs(v-y)&&(x=o||Math.abs(w-S)/Math.abs(v-y)),_=(f-w)/x+v,b=l["plot"+(t?"Width":"Height")]/x};var b,_,x=o||1,w=i[0][u],S=!m&&i[1][u];if(e(),(i=_)<g.min){i=g.min;var T=!0}else i+b>g.max&&(i=g.max-b,T=!0);T?(w-=.8*(w-a[h][0]),"number"==typeof S&&(S-=.8*(S-a[h][1])),e()):a[h]=[w,S],p||(s[h]=_-f,s[d]=b),s=p?1/x:x,r[d]=b,r[h]=i,n[p?t?"scaleY":"scaleX":"scale"+c]=x,n["translate"+c]=s*f+(w-s*v)},t.prototype.reset=function(t,e){var i=this.chart,n=i.hoverSeries,r=i.hoverPoint,s=i.hoverPoints,a=i.tooltip,o=a&&a.shared?s:r;t&&o&&b(o).forEach((function(e){e.series.isCartesian&&void 0===e.plotX&&(t=!1)})),t?a&&o&&b(o).length&&(a.refresh(o),a.shared&&s?s.forEach((function(t){t.setState(t.state,!0),t.series.isCartesian&&(t.series.xAxis.crosshair&&t.series.xAxis.drawCrosshair(null,t),t.series.yAxis.crosshair&&t.series.yAxis.drawCrosshair(null,t))})):r&&(r.setState(r.state,!0),i.axes.forEach((function(t){t.crosshair&&r.series[t.coll]===t&&t.drawCrosshair(null,r)})))):(r&&r.onMouseOut(),s&&s.forEach((function(t){t.setState()})),n&&n.onMouseOut(),a&&a.hide(e),this.unDocMouseMove&&(this.unDocMouseMove=this.unDocMouseMove()),i.axes.forEach((function(t){t.hideCrosshair()})),this.hoverX=i.hoverPoints=i.hoverPoint=null)},t.prototype.runPointActions=function(e,i,n){var r=this.chart,a=r.tooltip&&r.tooltip.options.enabled?r.tooltip:void 0,l=!!a&&a.shared,h=i||r.hoverPoint,c=h&&h.series||r.hoverSeries;i=this.getHoverData(h,c,r.series,(!e||"touchmove"!==e.type)&&(!!i||c&&c.directTouch&&this.isDirectTouch),l,e),h=i.hoverPoint,c=i.hoverSeries;var u=i.hoverPoints;i=c&&c.tooltipOptions.followPointer&&!c.tooltipOptions.split;var f=l&&c&&!c.noSharedTooltip;if(h&&(n||h!==r.hoverPoint||a&&a.isHidden)){if((r.hoverPoints||[]).forEach((function(t){-1===u.indexOf(t)&&t.setState()})),r.hoverSeries!==c&&c.onMouseOver(),this.applyInactiveState(u),(u||[]).forEach((function(t){t.setState("hover")})),r.hoverPoint&&r.hoverPoint.firePointEvent("mouseOut"),!h.series)return;r.hoverPoints=u,r.hoverPoint=h,h.firePointEvent("mouseOver",void 0,(function(){a&&h&&a.refresh(f?u:h,e)}))}else i&&a&&!a.isHidden&&(n=a.getAnchor([{}],e),r.isInsidePlot(n[0],n[1],{visiblePlotOnly:!0})&&a.updatePosition({plotX:n[0],plotY:n[1]}));this.unDocMouseMove||(this.unDocMouseMove=o(r.container.ownerDocument,"mousemove",(function(e){var i=s[t.hoverChartIndex];i&&i.pointer.onDocumentMouseMove(e)})),this.eventsToUnbind.push(this.unDocMouseMove)),r.axes.forEach((function(t){var i,n=y((t.crosshair||{}).snap,!0);n&&((i=r.hoverPoint)&&i.series[t.coll]===t||(i=d(u,(function(e){return e.series&&e.series[t.coll]===t})))),i||!n?t.drawCrosshair(e,i):t.hideCrosshair()}))},t.prototype.scaleGroups=function(t,e){var i=this.chart;i.series.forEach((function(n){var r=t||n.getPlotBox();n.group&&(n.xAxis&&n.xAxis.zoomEnabled||i.mapView)&&(n.group.attr(r),n.markerGroup&&(n.markerGroup.attr(r),n.markerGroup.clip(e?i.clipRect:null)),n.dataLabelsGroup&&n.dataLabelsGroup.attr(r))})),i.clipRect.attr(e||i.clipBox)},t.prototype.setDOMEvents=function(){var i=this,n=this.chart.container,r=n.ownerDocument;n.onmousedown=this.onContainerMouseDown.bind(this),n.onmousemove=this.onContainerMouseMove.bind(this),n.onclick=this.onContainerClick.bind(this),this.eventsToUnbind.push(o(n,"mouseenter",this.onContainerMouseEnter.bind(this))),this.eventsToUnbind.push(o(n,"mouseleave",this.onContainerMouseLeave.bind(this))),t.unbindDocumentMouseUp||(t.unbindDocumentMouseUp=o(r,"mouseup",this.onDocumentMouseUp.bind(this)));for(var s=this.chart.renderTo.parentElement;s&&"BODY"!==s.tagName;)this.eventsToUnbind.push(o(s,"scroll",(function(){delete i.chartPosition}))),s=s.parentElement;e.hasTouch&&(this.eventsToUnbind.push(o(n,"touchstart",this.onContainerTouchStart.bind(this),{passive:!1})),this.eventsToUnbind.push(o(n,"touchmove",this.onContainerTouchMove.bind(this),{passive:!1})),t.unbindDocumentTouchEnd||(t.unbindDocumentTouchEnd=o(r,"touchend",this.onDocumentTouchEnd.bind(this),{passive:!1})))},t.prototype.setHoverChartIndex=function(){var i=this.chart,n=e.charts[y(t.hoverChartIndex,-1)];n&&n!==i&&n.pointer.onContainerMouseLeave({relatedTarget:i.container}),n&&n.mouseIsDown||(t.hoverChartIndex=i.index)},t.prototype.touch=function(t,e){var i=this.chart;if(this.setHoverChartIndex(),1===t.touches.length)if(t=this.normalize(t),i.isInsidePlot(t.chartX-i.plotLeft,t.chartY-i.plotTop,{visiblePlotOnly:!0})&&!i.openMenu){if(e&&this.runPointActions(t),"touchmove"===t.type)var n=!!(e=this.pinchDown)[0]&&4<=Math.sqrt(Math.pow(e[0].chartX-t.chartX,2)+Math.pow(e[0].chartY-t.chartY,2));y(n,!0)&&this.pinch(t)}else e&&this.reset();else 2===t.touches.length&&this.pinch(t)},t.prototype.touchSelect=function(t){return!(!this.chart.options.chart.zooming.singleTouch||!t.touches||1!==t.touches.length)},t.prototype.zoomOption=function(t){var e=this.chart,i=e.options.chart;e=e.inverted;var n=i.zooming.type||"";/touch/.test(t.type)&&(n=y(i.zooming.pinchType,n)),this.zoomX=t=/x/.test(n),this.zoomY=i=/y/.test(n),this.zoomHor=t&&!e||i&&e,this.zoomVert=i&&!e||t&&e,this.hasZoom=t||i},t}(),t})),e(i,"Core/MSPointer.js",[i["Core/Globals.js"],i["Core/Pointer.js"],i["Core/Utilities.js"]],(function(t,e,i){function n(){var t=[];return t.item=function(t){return this[t]},d(g,(function(e){t.push({pageX:e.pageX,pageY:e.pageY,target:e.target})})),t}function r(t,i,r,s){var o=a[e.hoverChartIndex||NaN];"touch"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_TOUCH||!o||(o=o.pointer,s(t),o[i]({type:r,target:t.currentTarget,preventDefault:l,touches:n()}))}var s=this&&this.__extends||function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=t.charts,o=t.doc,l=t.noop,h=t.win,c=i.addEvent,u=i.css,d=i.objectEach,f=i.pick,p=i.removeEvent,g={},m=!!h.PointerEvent;return function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),i.isRequired=function(){return!(t.hasTouch||!h.PointerEvent&&!h.MSPointerEvent)},i.prototype.batchMSEvents=function(t){t(this.chart.container,m?"pointerdown":"MSPointerDown",this.onContainerPointerDown),t(this.chart.container,m?"pointermove":"MSPointerMove",this.onContainerPointerMove),t(o,m?"pointerup":"MSPointerUp",this.onDocumentPointerUp)},i.prototype.destroy=function(){this.batchMSEvents(p),e.prototype.destroy.call(this)},i.prototype.init=function(t,i){e.prototype.init.call(this,t,i),this.hasZoom&&u(t.container,{"-ms-touch-action":"none","touch-action":"none"})},i.prototype.onContainerPointerDown=function(t){r(t,"onContainerTouchStart","touchstart",(function(t){g[t.pointerId]={pageX:t.pageX,pageY:t.pageY,target:t.currentTarget}}))},i.prototype.onContainerPointerMove=function(t){r(t,"onContainerTouchMove","touchmove",(function(t){g[t.pointerId]={pageX:t.pageX,pageY:t.pageY},g[t.pointerId].target||(g[t.pointerId].target=t.currentTarget)}))},i.prototype.onDocumentPointerUp=function(t){r(t,"onDocumentTouchEnd","touchend",(function(t){delete g[t.pointerId]}))},i.prototype.setDOMEvents=function(){var t=this.chart.tooltip;e.prototype.setDOMEvents.call(this),(this.hasZoom||f(t&&t.options.followTouchMove,!0))&&this.batchMSEvents(c)},i}(e)})),e(i,"Core/Legend/Legend.js",[i["Core/Animation/AnimationUtilities.js"],i["Core/FormatUtilities.js"],i["Core/Globals.js"],i["Core/Series/Point.js"],i["Core/Renderer/RendererUtilities.js"],i["Core/Utilities.js"]],(function(t,e,i,n,r,s){var a=t.animObject,o=t.setAnimation,l=e.format,h=i.marginNames,c=r.distribute,u=s.addEvent,d=s.createElement,f=s.css,p=s.defined,g=s.discardElement,m=s.find,v=s.fireEvent,y=s.isNumber,b=s.merge,_=s.pick,x=s.relativeLength,w=s.stableSort,S=s.syncTimeout;return t=function(){function t(t,e){this.allItems=[],this.contentGroup=this.box=void 0,this.display=!1,this.group=void 0,this.offsetWidth=this.maxLegendWidth=this.maxItemWidth=this.legendWidth=this.legendHeight=this.lastLineHeight=this.lastItemY=this.itemY=this.itemX=this.itemMarginTop=this.itemMarginBottom=this.itemHeight=this.initialItemY=0,this.options=void 0,this.padding=0,this.pages=[],this.proximate=!1,this.scrollGroup=void 0,this.widthOption=this.totalItemWidth=this.titleHeight=this.symbolWidth=this.symbolHeight=0,this.chart=t,this.init(t,e)}return t.prototype.init=function(t,e){this.chart=t,this.setOptions(e),e.enabled&&(this.render(),u(this.chart,"endResize",(function(){this.legend.positionCheckboxes()})),this.proximate?this.unchartrender=u(this.chart,"render",(function(){this.legend.proximatePositions(),this.legend.positionItems()})):this.unchartrender&&this.unchartrender())},t.prototype.setOptions=function(t){var e=_(t.padding,8);this.options=t,this.chart.styledMode||(this.itemStyle=t.itemStyle,this.itemHiddenStyle=b(this.itemStyle,t.itemHiddenStyle)),this.itemMarginTop=t.itemMarginTop||0,this.itemMarginBottom=t.itemMarginBottom||0,this.padding=e,this.initialItemY=e-5,this.symbolWidth=_(t.symbolWidth,16),this.pages=[],this.proximate="proximate"===t.layout&&!this.chart.inverted,this.baseline=void 0},t.prototype.update=function(t,e){var i=this.chart;this.setOptions(b(!0,this.options,t)),this.destroy(),i.isDirtyLegend=i.isDirtyBox=!0,_(e,!0)&&i.redraw(),v(this,"afterUpdate")},t.prototype.colorizeItem=function(t,e){var i=t.legendItem||{},n=i.group,r=i.label,s=i.line;if(i=i.symbol,n&&n[e?"removeClass":"addClass"]("highcharts-legend-item-hidden"),!this.chart.styledMode){var a=this.options;n=this.itemHiddenStyle.color,a=e?a.itemStyle.color:n;var o=e&&t.color||n,l=t.options&&t.options.marker,h={fill:o};r&&r.css({fill:a,color:a}),s&&s.attr({stroke:o}),i&&(l&&i.isMarker&&(h=t.pointAttribs(),e||(h.stroke=h.fill=n)),i.attr(h))}v(this,"afterColorizeItem",{item:t,visible:e})},t.prototype.positionItems=function(){this.allItems.forEach(this.positionItem,this),this.chart.isResizing||this.positionCheckboxes()},t.prototype.positionItem=function(t){var e=this,i=t.legendItem||{},n=i.group,r=i.x;r=void 0===r?0:r,i=void 0===(i=i.y)?0:i;var s=this.options,a=s.symbolPadding,o=!s.rtl;s=t.checkbox,n&&n.element&&(a={translateX:o?r:this.legendWidth-r-2*a-4,translateY:i},n[p(n.translateY)?"animate":"attr"](a,void 0,(function(){v(e,"afterPositionItem",{item:t})}))),s&&(s.x=r,s.y=i)},t.prototype.destroyItem=function(t){for(var e=t.checkbox,i=t.legendItem||{},n=0,r=["group","label","line","symbol"];n<r.length;n++){var s=r[n];i[s]&&(i[s]=i[s].destroy())}e&&g(e),t.legendItem=void 0},t.prototype.destroy=function(){for(var t=0,e=this.getAllItems();t<e.length;t++)this.destroyItem(e[t]);for(t=0,e="clipRect up down pager nav box title group".split(" ");t<e.length;t++){var i=e[t];this[i]&&(this[i]=this[i].destroy())}this.display=null},t.prototype.positionCheckboxes=function(){var t=this.group&&this.group.alignAttr,e=this.clipHeight||this.legendHeight,i=this.titleHeight;if(t){var n=t.translateY;this.allItems.forEach((function(r){var s=r.checkbox;if(s){var a=n+i+s.y+(this.scrollOffset||0)+3;f(s,{left:t.translateX+r.checkboxOffset+s.x-20+"px",top:a+"px",display:this.proximate||a>n-6&&a<n+e-6?"":"none"})}}),this)}},t.prototype.renderTitle=function(){var t=this.options,e=this.padding,i=t.title,n=0;i.text&&(this.title||(this.title=this.chart.renderer.label(i.text,e-3,e-4,void 0,void 0,void 0,t.useHTML,void 0,"legend-title").attr({zIndex:1}),this.chart.styledMode||this.title.css(i.style),this.title.add(this.group)),i.width||this.title.css({width:this.maxLegendWidth+"px"}),n=(t=this.title.getBBox()).height,this.offsetWidth=t.width,this.contentGroup.attr({translateY:n})),this.titleHeight=n},t.prototype.setText=function(t){var e=this.options;t.legendItem.label.attr({text:e.labelFormat?l(e.labelFormat,t,this.chart):e.labelFormatter.call(t)})},t.prototype.renderItem=function(t){var e=t.legendItem=t.legendItem||{},i=this.chart,n=i.renderer,r=this.options,s=this.symbolWidth,a=r.symbolPadding||0,o=this.itemStyle,l=this.itemHiddenStyle,h="horizontal"===r.layout?_(r.itemDistance,20):0,c=!r.rtl,u=!t.series,d=!u&&t.series.drawLegendSymbol?t.series:t,f=d.options,p=this.createCheckboxForItem&&f&&f.showCheckbox,g=r.useHTML,m=t.options.className,v=e.label;f=s+a+h+(p?20:0),v||(e.group=n.g("legend-item").addClass("highcharts-"+d.type+"-series highcharts-color-"+t.colorIndex+(m?" "+m:"")+(u?" highcharts-series-"+t.index:"")).attr({zIndex:1}).add(this.scrollGroup),e.label=v=n.text("",c?s+a:-a,this.baseline||0,g),i.styledMode||v.css(b(t.visible?o:l)),v.attr({align:c?"left":"right",zIndex:2}).add(e.group),this.baseline||(this.fontMetrics=n.fontMetrics(i.styledMode?12:o.fontSize,v),this.baseline=this.fontMetrics.f+3+this.itemMarginTop,v.attr("y",this.baseline),this.symbolHeight=r.symbolHeight||this.fontMetrics.f,r.squareSymbol&&(this.symbolWidth=_(r.symbolWidth,Math.max(this.symbolHeight,16)),f=this.symbolWidth+a+h+(p?20:0),c&&v.attr("x",this.symbolWidth+a))),d.drawLegendSymbol(this,t),this.setItemEvents&&this.setItemEvents(t,v,g)),p&&!t.checkbox&&this.createCheckboxForItem&&this.createCheckboxForItem(t),this.colorizeItem(t,t.visible),!i.styledMode&&o.width||v.css({width:(r.itemWidth||this.widthOption||i.spacingBox.width)-f+"px"}),this.setText(t),i=v.getBBox(),n=this.fontMetrics&&this.fontMetrics.h||0,t.itemWidth=t.checkboxOffset=r.itemWidth||e.labelWidth||i.width+f,this.maxItemWidth=Math.max(this.maxItemWidth,t.itemWidth),this.totalItemWidth+=t.itemWidth,this.itemHeight=t.itemHeight=Math.round(e.labelHeight||(i.height>1.5*n?i.height:n))},t.prototype.layoutItem=function(t){var e=this.options,i=this.padding,n="horizontal"===e.layout,r=t.itemHeight,s=this.itemMarginBottom,a=this.itemMarginTop,o=n?_(e.itemDistance,20):0,l=this.maxLegendWidth;e=e.alignColumns&&this.totalItemWidth>l?this.maxItemWidth:t.itemWidth;var h=t.legendItem||{};n&&this.itemX-i+e>l&&(this.itemX=i,this.lastLineHeight&&(this.itemY+=a+this.lastLineHeight+s),this.lastLineHeight=0),this.lastItemY=a+this.itemY+s,this.lastLineHeight=Math.max(r,this.lastLineHeight),h.x=this.itemX,h.y=this.itemY,n?this.itemX+=e:(this.itemY+=a+r+s,this.lastLineHeight=r),this.offsetWidth=this.widthOption||Math.max((n?this.itemX-i-(t.checkbox?0:o):e)+i,this.offsetWidth)},t.prototype.getAllItems=function(){var t=[];return this.chart.series.forEach((function(e){var i=e&&e.options;e&&_(i.showInLegend,!p(i.linkedTo)&&void 0,!0)&&(t=t.concat((e.legendItem||{}).labels||("point"===i.legendType?e.data:e)))})),v(this,"afterGetAllItems",{allItems:t}),t},t.prototype.getAlignment=function(){var t=this.options;return this.proximate?t.align.charAt(0)+"tv":t.floating?"":t.align.charAt(0)+t.verticalAlign.charAt(0)+t.layout.charAt(0)},t.prototype.adjustMargins=function(t,e){var i=this.chart,n=this.options,r=this.getAlignment();r&&[/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/].forEach((function(s,a){s.test(r)&&!p(t[a])&&(i[h[a]]=Math.max(i[h[a]],i.legend[(a+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][a]*n[a%2?"x":"y"]+_(n.margin,12)+e[a]+(i.titleOffset[a]||0)))}))},t.prototype.proximatePositions=function(){var t=this.chart,e=[],i="left"===this.options.align;this.allItems.forEach((function(n){var r,s=i;if(n.yAxis){n.xAxis.options.reversed&&(s=!s),n.points&&(r=m(s?n.points:n.points.slice(0).reverse(),(function(t){return y(t.plotY)}))),s=this.itemMarginTop+n.legendItem.label.getBBox().height+this.itemMarginBottom;var a=n.yAxis.top-t.plotTop;n.visible?(r=r?r.plotY:n.yAxis.height,r+=a-.3*s):r=a+n.yAxis.height,e.push({target:r,size:s,item:n})}}),this);for(var n,r=0,s=c(e,t.plotHeight);r<s.length;r++){var a=s[r];n=a.item.legendItem||{},y(a.pos)&&(n.y=t.plotTop-t.spacing[0]+a.pos)}},t.prototype.render=function(){var t=this.chart,e=t.renderer,i=this.options,n=this.padding,r=this.getAllItems(),s=this.group,a=this.box;this.itemX=n,this.itemY=this.initialItemY,this.lastItemY=this.offsetWidth=0,this.widthOption=x(i.width,t.spacingBox.width-n);var o=t.spacingBox.width-2*n-i.x;-1<["rm","lm"].indexOf(this.getAlignment().substring(0,2))&&(o/=2),this.maxLegendWidth=this.widthOption||o,s||(this.group=s=e.g("legend").addClass(i.className||"").attr({zIndex:7}).add(),this.contentGroup=e.g().attr({zIndex:1}).add(s),this.scrollGroup=e.g().add(this.contentGroup)),this.renderTitle(),w(r,(function(t,e){return(t.options&&t.options.legendIndex||0)-(e.options&&e.options.legendIndex||0)})),i.reversed&&r.reverse(),this.allItems=r,this.display=o=!!r.length,this.itemHeight=this.totalItemWidth=this.maxItemWidth=this.lastLineHeight=0,r.forEach(this.renderItem,this),r.forEach(this.layoutItem,this),r=(this.widthOption||this.offsetWidth)+n;var l=this.lastItemY+this.lastLineHeight+this.titleHeight;l=this.handleOverflow(l),l+=n,a||(this.box=a=e.rect().addClass("highcharts-legend-box").attr({r:i.borderRadius}).add(s)),t.styledMode||a.attr({stroke:i.borderColor,"stroke-width":i.borderWidth||0,fill:i.backgroundColor||"none"}).shadow(i.shadow),0<r&&0<l&&a[a.placed?"animate":"attr"](a.crisp.call({},{x:0,y:0,width:r,height:l},a.strokeWidth())),s[o?"show":"hide"](),t.styledMode&&"none"===s.getStyle("display")&&(r=l=0),this.legendWidth=r,this.legendHeight=l,o&&this.align(),this.proximate||this.positionItems(),v(this,"afterRender")},t.prototype.align=function(t){void 0===t&&(t=this.chart.spacingBox);var e=this.chart,i=this.options,n=t.y;/(lth|ct|rth)/.test(this.getAlignment())&&0<e.titleOffset[0]?n+=e.titleOffset[0]:/(lbh|cb|rbh)/.test(this.getAlignment())&&0<e.titleOffset[2]&&(n-=e.titleOffset[2]),n!==t.y&&(t=b(t,{y:n})),e.hasRendered||(this.group.placed=!1),this.group.align(b(i,{width:this.legendWidth,height:this.legendHeight,verticalAlign:this.proximate?"top":i.verticalAlign}),!0,t)},t.prototype.handleOverflow=function(t){var e,i,n,r=this,s=this.chart,a=s.renderer,o=this.options,l=o.y,h="top"===o.verticalAlign,c=this.padding,u=o.maxHeight,d=o.navigation,f=_(d.animation,!0),p=d.arrowSize||12,g=this.pages,m=this.allItems,v=function(t){"number"==typeof t?x.attr({height:t}):x&&(r.clipRect=x.destroy(),r.contentGroup.clip()),r.contentGroup.div&&(r.contentGroup.div.style.clip=t?"rect("+c+"px,9999px,"+(c+t)+"px,0)":"auto")},y=function(t){return r[t]=a.circle(0,0,1.3*p).translate(p/2,p/2).add(b),s.styledMode||r[t].attr("fill","rgba(0,0,0,0.0001)"),r[t]};l=s.spacingBox.height+(h?-l:l)-c;var b=this.nav,x=this.clipRect;return"horizontal"!==o.layout||"middle"===o.verticalAlign||o.floating||(l/=2),u&&(l=Math.min(l,u)),g.length=0,t&&0<l&&t>l&&!1!==d.enabled?(this.clipHeight=e=Math.max(l-20-this.titleHeight-c,0),this.currentPage=_(this.currentPage,1),this.fullHeight=t,m.forEach((function(t,r){t=(n=t.legendItem||{}).y||0;var s=Math.round(n.label.getBBox().height),a=g.length;(!a||t-g[a-1]>e&&(i||t)!==g[a-1])&&(g.push(i||t),a++),n.pageIx=a-1,i&&((m[r-1].legendItem||{}).pageIx=a-1),r===m.length-1&&t+s-g[a-1]>e&&s<=e&&(g.push(t),n.pageIx=a),t!==i&&(i=t)})),x||(x=r.clipRect=a.clipRect(0,c,9999,0),r.contentGroup.clip(x)),v(e),b||(this.nav=b=a.g().attr({zIndex:1}).add(this.group),this.up=a.symbol("triangle",0,0,p,p).add(b),y("upTracker").on("click",(function(){r.scroll(-1,f)})),this.pager=a.text("",15,10).addClass("highcharts-legend-navigation"),!s.styledMode&&d.style&&this.pager.css(d.style),this.pager.add(b),this.down=a.symbol("triangle-down",0,0,p,p).add(b),y("downTracker").on("click",(function(){r.scroll(1,f)}))),r.scroll(0),t=l):b&&(v(),this.nav=b.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),t},t.prototype.scroll=function(t,e){var i=this,n=this.chart,r=this.pages,s=r.length,l=this.clipHeight,h=this.options.navigation,c=this.pager,u=this.padding,d=this.currentPage+t;d>s&&(d=s),0<d&&(void 0!==e&&o(e,n),this.nav.attr({translateX:u,translateY:l+this.padding+7+this.titleHeight,visibility:"inherit"}),[this.up,this.upTracker].forEach((function(t){t.attr({class:1===d?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})})),c.attr({text:d+"/"+s}),[this.down,this.downTracker].forEach((function(t){t.attr({x:18+this.pager.getBBox().width,class:d===s?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})}),this),n.styledMode||(this.up.attr({fill:1===d?h.inactiveColor:h.activeColor}),this.upTracker.css({cursor:1===d?"default":"pointer"}),this.down.attr({fill:d===s?h.inactiveColor:h.activeColor}),this.downTracker.css({cursor:d===s?"default":"pointer"})),this.scrollOffset=-r[d-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=d,this.positionCheckboxes(),t=a(_(e,n.renderer.globalAnimation,!0)),S((function(){v(i,"afterScroll",{currentPage:d})}),t.duration))},t.prototype.setItemEvents=function(t,e,i){var r=this,s=t.legendItem||{},a=r.chart.renderer.boxWrapper,o=t instanceof n,l="highcharts-legend-"+(o?"point":"series")+"-active",h=r.chart.styledMode,c=function(e){r.allItems.forEach((function(i){t!==i&&[i].concat(i.linkedSeries||[]).forEach((function(t){t.setState(e,!o)}))}))},u=0;for(i=i?[e,s.symbol]:[s.group];u<i.length;u++)(s=i[u])&&s.on("mouseover",(function(){t.visible&&c("inactive"),t.setState("hover"),t.visible&&a.addClass(l),h||e.css(r.options.itemHoverStyle)})).on("mouseout",(function(){r.chart.styledMode||e.css(b(t.visible?r.itemStyle:r.itemHiddenStyle)),c(""),a.removeClass(l),t.setState()})).on("click",(function(e){var i=function(){t.setVisible&&t.setVisible(),c(t.visible?"inactive":"")};a.removeClass(l),e={browserEvent:e},t.firePointEvent?t.firePointEvent("legendItemClick",e,i):v(t,"legendItemClick",e,i)}))},t.prototype.createCheckboxForItem=function(t){t.checkbox=d("input",{type:"checkbox",className:"highcharts-legend-checkbox",checked:t.selected,defaultChecked:t.selected},this.options.itemCheckboxStyle,this.chart.container),u(t.checkbox,"click",(function(e){v(t.series||t,"checkboxClick",{checked:e.target.checked,item:t},(function(){t.select()}))}))},t}(),t})),e(i,"Core/Series/SeriesRegistry.js",[i["Core/Globals.js"],i["Core/Defaults.js"],i["Core/Series/Point.js"],i["Core/Utilities.js"]],(function(t,e,i,n){var r,s=e.defaultOptions,a=n.extendClass,o=n.merge;return function(e){function n(t,n){var r=s.plotOptions||{},a=n.defaultOptions,o=n.prototype;o.type=t,o.pointClass||(o.pointClass=i),a&&(r[t]=a),e.seriesTypes[t]=n}e.seriesTypes=t.seriesTypes,e.registerSeriesType=n,e.seriesType=function(t,r,l,h,c){var u=s.plotOptions||{};return r=r||"",u[t]=o(u[r],l),n(t,a(e.seriesTypes[r]||function(){},h)),e.seriesTypes[t].prototype.type=t,c&&(e.seriesTypes[t].prototype.pointClass=a(i,c)),e.seriesTypes[t]}}(r||(r={})),r})),e(i,"Core/Chart/Chart.js",[i["Core/Animation/AnimationUtilities.js"],i["Core/Axis/Axis.js"],i["Core/Defaults.js"],i["Core/FormatUtilities.js"],i["Core/Foundation.js"],i["Core/Globals.js"],i["Core/Legend/Legend.js"],i["Core/MSPointer.js"],i["Core/Pointer.js"],i["Core/Renderer/RendererRegistry.js"],i["Core/Series/SeriesRegistry.js"],i["Core/Renderer/SVG/SVGRenderer.js"],i["Core/Time.js"],i["Core/Utilities.js"],i["Core/Renderer/HTML/AST.js"]],(function(t,e,i,n,r,s,a,o,l,h,c,u,d,f,p){var g=t.animate,m=t.animObject,v=t.setAnimation,y=i.defaultOptions,b=i.defaultTime,_=n.numberFormat,x=r.registerEventOptions,w=s.charts,S=s.doc,T=s.marginNames,E=s.svg,k=s.win,C=c.seriesTypes,M=f.addEvent,A=f.attr,O=f.cleanRecursively,P=f.createElement,R=f.css,I=f.defined,L=f.discardElement,D=f.erase,N=f.error,F=f.extend,j=f.find,B=f.fireEvent,z=f.getStyle,W=f.isArray,G=f.isNumber,U=f.isObject,H=f.isString,X=f.merge,V=f.objectEach,Y=f.pick,K=f.pInt,q=f.relativeLength,Z=f.removeEvent,J=f.splat,$=f.syncTimeout,Q=f.uniqueKey;return t=function(){function t(t,e,i){this.series=this.renderTo=this.renderer=this.pointer=this.pointCount=this.plotWidth=this.plotTop=this.plotLeft=this.plotHeight=this.plotBox=this.options=this.numberFormatter=this.margin=this.legend=this.labelCollectors=this.isResizing=this.index=this.eventOptions=this.container=this.colorCounter=this.clipBox=this.chartWidth=this.chartHeight=this.bounds=this.axisOffset=this.axes=void 0,this.sharedClips={},this.yAxis=this.xAxis=this.userOptions=this.titleOffset=this.time=this.symbolCounter=this.spacingBox=this.spacing=void 0,this.getArgs(t,e,i)}return t.chart=function(e,i,n){return new t(e,i,n)},t.prototype.getArgs=function(t,e,i){H(t)||t.nodeName?(this.renderTo=t,this.init(e,i)):this.init(t,e)},t.prototype.init=function(t,e){var i=t.plotOptions||{};B(this,"init",{args:arguments},(function(){var n=X(y,t),r=n.chart;V(n.plotOptions,(function(t,e){U(t)&&(t.tooltip=i[e]&&X(i[e].tooltip)||void 0)})),n.tooltip.userOptions=t.chart&&t.chart.forExport&&t.tooltip.userOptions||t.tooltip,this.userOptions=t,this.margin=[],this.spacing=[],this.bounds={h:{},v:{}},this.labelCollectors=[],this.callback=e,this.isResizing=0;var a=r.zooming=r.zooming||{};t.chart&&!t.chart.zooming&&(a.resetButton=r.resetZoomButton),a.key=Y(a.key,r.zoomKey),a.pinchType=Y(a.pinchType,r.pinchType),a.singleTouch=Y(a.singleTouch,r.zoomBySingleTouch),a.type=Y(a.type,r.zoomType),this.options=n,this.axes=[],this.series=[],this.time=t.time&&Object.keys(t.time).length?new d(t.time):s.time,this.numberFormatter=r.numberFormatter||_,this.styledMode=r.styledMode,this.hasCartesianSeries=r.showAxes,this.index=w.length,w.push(this),s.chartCount++,x(this,r),this.xAxis=[],this.yAxis=[],this.pointCount=this.colorCounter=this.symbolCounter=0,B(this,"afterInit"),this.firstRender()}))},t.prototype.initSeries=function(t){var e=this.options.chart;e=t.type||e.type||e.defaultSeriesType;var i=C[e];return i||N(17,!0,this,{missingModuleFor:e}),"function"==typeof(e=new i).init&&e.init(this,t),e},t.prototype.setSeriesData=function(){this.getSeriesOrderByLinks().forEach((function(t){t.points||t.data||!t.enabledDataSorting||t.setData(t.options.data,!1)}))},t.prototype.getSeriesOrderByLinks=function(){return this.series.concat().sort((function(t,e){return t.linkedSeries.length||e.linkedSeries.length?e.linkedSeries.length-t.linkedSeries.length:0}))},t.prototype.orderSeries=function(t){var e=this.series;t=t||0;for(var i=e.length;t<i;++t)e[t]&&(e[t].index=t,e[t].name=e[t].getName())},t.prototype.isInsidePlot=function(t,e,i){void 0===i&&(i={});var n=this.inverted,r=this.plotBox,s=this.plotLeft,a=this.plotTop,o=this.scrollablePlotBox,l=0,h=0;i.visiblePlotOnly&&this.scrollingContainer&&(l=(h=this.scrollingContainer).scrollLeft,h=h.scrollTop);var c=i.series;if(r=i.visiblePlotOnly&&o||r,t={x:o=i.inverted?e:t,y:e=i.inverted?t:e,isInsidePlot:!0,options:i},!i.ignoreX){var u=c&&(n&&!this.polar?c.yAxis:c.xAxis)||{pos:s,len:1/0};(o=i.paneCoordinates?u.pos+o:s+o)>=Math.max(l+s,u.pos)&&o<=Math.min(l+s+r.width,u.pos+u.len)||(t.isInsidePlot=!1)}return!i.ignoreY&&t.isInsidePlot&&(n=i.axis&&!i.axis.isXAxis&&i.axis||c&&(n?c.xAxis:c.yAxis)||{pos:a,len:1/0},(i=i.paneCoordinates?n.pos+e:a+e)>=Math.max(h+a,n.pos)&&i<=Math.min(h+a+r.height,n.pos+n.len)||(t.isInsidePlot=!1)),B(this,"afterIsInsidePlot",t),t.isInsidePlot},t.prototype.redraw=function(t){B(this,"beforeRedraw");var e=this.hasCartesianSeries?this.axes:this.colorAxis||[],i=this.series,n=this.pointer,r=this.legend,s=this.userOptions.legend,a=this.renderer,o=a.isHidden(),l=[],h=this.isDirtyBox,c=this.isDirtyLegend;for(this.setResponsive&&this.setResponsive(!1),v(!!this.hasRendered&&t,this),o&&this.temporaryDisplay(),this.layOutTitles(),t=i.length;t--;){var u=i[t];if(u.options.stacking||u.options.centerInCategory){var d=!0;if(u.isDirty){var f=!0;break}}}if(f)for(t=i.length;t--;)(u=i[t]).options.stacking&&(u.isDirty=!0);i.forEach((function(t){t.isDirty&&("point"===t.options.legendType?("function"==typeof t.updateTotals&&t.updateTotals(),c=!0):s&&(s.labelFormatter||s.labelFormat)&&(c=!0)),t.isDirtyData&&B(t,"updatedData")})),c&&r&&r.options.enabled&&(r.render(),this.isDirtyLegend=!1),d&&this.getStacks(),e.forEach((function(t){t.updateNames(),t.setScale()})),this.getMargins(),e.forEach((function(t){t.isDirty&&(h=!0)})),e.forEach((function(t){var e=t.min+","+t.max;t.extKey!==e&&(t.extKey=e,l.push((function(){B(t,"afterSetExtremes",F(t.eventArgs,t.getExtremes())),delete t.eventArgs}))),(h||d)&&t.redraw()})),h&&this.drawChartBox(),B(this,"predraw"),i.forEach((function(t){(h||t.isDirty)&&t.visible&&t.redraw(),t.isDirtyData=!1})),n&&n.reset(!0),a.draw(),B(this,"redraw"),B(this,"render"),o&&this.temporaryDisplay(!0),l.forEach((function(t){t.call()}))},t.prototype.get=function(t){function e(e){return e.id===t||e.options&&e.options.id===t}for(var i=this.series,n=j(this.axes,e)||j(this.series,e),r=0;!n&&r<i.length;r++)n=j(i[r].points||[],e);return n},t.prototype.getAxes=function(){var t=this,i=this.options,n=i.xAxis=J(i.xAxis||{});i=i.yAxis=J(i.yAxis||{}),B(this,"getAxes"),n.forEach((function(t,e){t.index=e,t.isX=!0})),i.forEach((function(t,e){t.index=e})),n.concat(i).forEach((function(i){new e(t,i)})),B(this,"afterGetAxes")},t.prototype.getSelectedPoints=function(){return this.series.reduce((function(t,e){return e.getPointsCollection().forEach((function(e){Y(e.selectedStaging,e.selected)&&t.push(e)})),t}),[])},t.prototype.getSelectedSeries=function(){return this.series.filter((function(t){return t.selected}))},t.prototype.setTitle=function(t,e,i){this.applyDescription("title",t),this.applyDescription("subtitle",e),this.applyDescription("caption",void 0),this.layOutTitles(i)},t.prototype.applyDescription=function(t,e){var i=this,n="title"===t?{color:"#333333",fontSize:this.options.isStock?"16px":"18px"}:{color:"#666666"};n=this.options[t]=X(!this.styledMode&&{style:n},this.options[t],e);var r=this[t];r&&e&&(this[t]=r=r.destroy()),n&&!r&&((r=this.renderer.text(n.text,0,0,n.useHTML).attr({align:n.align,class:"highcharts-"+t,zIndex:n.zIndex||4}).add()).update=function(e){i[{title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"}[t]](e)},this.styledMode||r.css(n.style),this[t]=r)},t.prototype.layOutTitles=function(t){var e=[0,0,0],i=this.renderer,n=this.spacingBox;["title","subtitle","caption"].forEach((function(t){var r,s=this[t],a=this.options[t],o=a.verticalAlign||"top";if(t="title"===t?"top"===o?-3:0:"top"===o?e[0]+2:0,s){this.styledMode||(r=a.style&&a.style.fontSize),r=i.fontMetrics(r,s).b,s.css({width:(a.width||n.width+(a.widthAdjust||0))+"px"});var l=Math.round(s.getBBox(a.useHTML).height);s.align(F({y:"bottom"===o?r:t+r,height:l},a),!1,"spacingBox"),a.floating||("top"===o?e[0]=Math.ceil(e[0]+l):"bottom"===o&&(e[2]=Math.ceil(e[2]+l)))}}),this),e[0]&&"top"===(this.options.title.verticalAlign||"top")&&(e[0]+=this.options.title.margin),e[2]&&"bottom"===this.options.caption.verticalAlign&&(e[2]+=this.options.caption.margin);var r=!this.titleOffset||this.titleOffset.join(",")!==e.join(",");this.titleOffset=e,B(this,"afterLayOutTitles"),!this.isDirtyBox&&r&&(this.isDirtyBox=this.isDirtyLegend=r,this.hasRendered&&Y(t,!0)&&this.isDirtyBox&&this.redraw())},t.prototype.getChartSize=function(){var t=this.options.chart,e=t.width;t=t.height;var i=this.renderTo;I(e)||(this.containerWidth=z(i,"width")),I(t)||(this.containerHeight=z(i,"height")),this.chartWidth=Math.max(0,e||this.containerWidth||600),this.chartHeight=Math.max(0,q(t,this.chartWidth)||(1<this.containerHeight?this.containerHeight:400))},t.prototype.temporaryDisplay=function(t){var e=this.renderTo;if(t)for(;e&&e.style;)e.hcOrigStyle&&(R(e,e.hcOrigStyle),delete e.hcOrigStyle),e.hcOrigDetached&&(S.body.removeChild(e),e.hcOrigDetached=!1),e=e.parentNode;else for(;e&&e.style&&(S.body.contains(e)||e.parentNode||(e.hcOrigDetached=!0,S.body.appendChild(e)),("none"===z(e,"display",!1)||e.hcOricDetached)&&(e.hcOrigStyle={display:e.style.display,height:e.style.height,overflow:e.style.overflow},t={display:"block",overflow:"hidden"},e!==this.renderTo&&(t.height=0),R(e,t),e.offsetWidth||e.style.setProperty("display","block","important")),(e=e.parentNode)!==S.body););},t.prototype.setClassName=function(t){this.container.className="highcharts-container "+(t||"")},t.prototype.getContainer=function(){var t,e=this.options,i=e.chart,n=Q(),r=this.renderTo;r||(this.renderTo=r=i.renderTo),H(r)&&(this.renderTo=r=S.getElementById(r)),r||N(13,!0,this);var s=K(A(r,"data-highcharts-chart"));G(s)&&w[s]&&w[s].hasRendered&&w[s].destroy(),A(r,"data-highcharts-chart",this.index),r.innerHTML=p.emptyHTML,i.skipClone||r.offsetWidth||this.temporaryDisplay(),this.getChartSize(),s=this.chartWidth;var a=this.chartHeight;if(R(r,{overflow:"hidden"}),this.styledMode||(t=F({position:"relative",overflow:"hidden",width:s+"px",height:a+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)",userSelect:"none","touch-action":"manipulation",outline:"none"},i.style||{})),this.container=n=P("div",{id:n},t,r),this._cursor=n.style.cursor,this.renderer=new(i.renderer||!E?h.getRendererType(i.renderer):u)(n,s,a,void 0,i.forExport,e.exporting&&e.exporting.allowHTML,this.styledMode),v(void 0,this),this.setClassName(i.className),this.styledMode)for(var o in e.defs)this.renderer.definition(e.defs[o]);else this.renderer.setStyle(i.style);this.renderer.chartIndex=this.index,B(this,"afterGetContainer")},t.prototype.getMargins=function(t){var e=this.spacing,i=this.margin,n=this.titleOffset;this.resetMargins(),n[0]&&!I(i[0])&&(this.plotTop=Math.max(this.plotTop,n[0]+e[0])),n[2]&&!I(i[2])&&(this.marginBottom=Math.max(this.marginBottom,n[2]+e[2])),this.legend&&this.legend.display&&this.legend.adjustMargins(i,e),B(this,"getMargins"),t||this.getAxisMargins()},t.prototype.getAxisMargins=function(){var t=this,e=t.axisOffset=[0,0,0,0],i=t.colorAxis,n=t.margin,r=function(t){t.forEach((function(t){t.visible&&t.getOffset()}))};t.hasCartesianSeries?r(t.axes):i&&i.length&&r(i),T.forEach((function(i,r){I(n[r])||(t[i]+=e[r])})),t.setChartSize()},t.prototype.reflow=function(t){var e=this,i=e.options.chart,n=e.renderTo,r=I(i.width)&&I(i.height),s=i.width||z(n,"width");i=i.height||z(n,"height"),n=t?t.target:k,delete e.pointer.chartPosition,r||e.isPrinting||!s||!i||n!==k&&n!==S||(s===e.containerWidth&&i===e.containerHeight||(f.clearTimeout(e.reflowTimeout),e.reflowTimeout=$((function(){e.container&&e.setSize(void 0,void 0,!1)}),t?100:0)),e.containerWidth=s,e.containerHeight=i)},t.prototype.setReflow=function(t){var e=this;!1===t||this.unbindReflow?!1===t&&this.unbindReflow&&(this.unbindReflow=this.unbindReflow()):(this.unbindReflow=M(k,"resize",(function(t){e.options&&e.reflow(t)})),M(this,"destroy",this.unbindReflow))},t.prototype.setSize=function(t,e,i){var n=this,r=n.renderer;n.isResizing+=1,v(i,n),i=r.globalAnimation,n.oldChartHeight=n.chartHeight,n.oldChartWidth=n.chartWidth,void 0!==t&&(n.options.chart.width=t),void 0!==e&&(n.options.chart.height=e),n.getChartSize(),n.styledMode||(i?g:R)(n.container,{width:n.chartWidth+"px",height:n.chartHeight+"px"},i),n.setChartSize(!0),r.setSize(n.chartWidth,n.chartHeight,i),n.axes.forEach((function(t){t.isDirty=!0,t.setScale()})),n.isDirtyLegend=!0,n.isDirtyBox=!0,n.layOutTitles(),n.getMargins(),n.redraw(i),n.oldChartHeight=null,B(n,"resize"),$((function(){n&&B(n,"endResize",null,(function(){--n.isResizing}))}),m(i).duration)},t.prototype.setChartSize=function(t){var e,i,n,r,s=this.inverted,a=this.renderer,o=this.chartWidth,l=this.chartHeight,h=this.options.chart,c=this.spacing,u=this.clipOffset;this.plotLeft=e=Math.round(this.plotLeft),this.plotTop=i=Math.round(this.plotTop),this.plotWidth=n=Math.max(0,Math.round(o-e-this.marginRight)),this.plotHeight=r=Math.max(0,Math.round(l-i-this.marginBottom)),this.plotSizeX=s?r:n,this.plotSizeY=s?n:r,this.plotBorderWidth=h.plotBorderWidth||0,this.spacingBox=a.spacingBox={x:c[3],y:c[0],width:o-c[3]-c[1],height:l-c[0]-c[2]},this.plotBox=a.plotBox={x:e,y:i,width:n,height:r},s=2*Math.floor(this.plotBorderWidth/2),o=Math.ceil(Math.max(s,u[3])/2),l=Math.ceil(Math.max(s,u[0])/2),this.clipBox={x:o,y:l,width:Math.floor(this.plotSizeX-Math.max(s,u[1])/2-o),height:Math.max(0,Math.floor(this.plotSizeY-Math.max(s,u[2])/2-l))},t||(this.axes.forEach((function(t){t.setAxisSize(),t.setAxisTranslation()})),a.alignElements()),B(this,"afterSetChartSize",{skipAxes:t})},t.prototype.resetMargins=function(){B(this,"resetMargins");var t=this,e=t.options.chart;["margin","spacing"].forEach((function(i){var n=e[i],r=U(n)?n:[n,n,n,n];["Top","Right","Bottom","Left"].forEach((function(n,s){t[i][s]=Y(e[i+n],r[s])}))})),T.forEach((function(e,i){t[e]=Y(t.margin[i],t.spacing[i])})),t.axisOffset=[0,0,0,0],t.clipOffset=[0,0,0,0]},t.prototype.drawChartBox=function(){var t,e=this.options.chart,i=this.renderer,n=this.chartWidth,r=this.chartHeight,s=this.styledMode,a=this.plotBGImage,o=e.backgroundColor,l=e.plotBackgroundColor,h=e.plotBackgroundImage,c=this.plotLeft,u=this.plotTop,d=this.plotWidth,f=this.plotHeight,p=this.plotBox,g=this.clipRect,m=this.clipBox,v=this.chartBackground,y=this.plotBackground,b=this.plotBorder,_="animate";if(v||(this.chartBackground=v=i.rect().addClass("highcharts-background").add(),_="attr"),s)var x=t=v.strokeWidth();else t=(x=e.borderWidth||0)+(e.shadow?8:0),o={fill:o||"none"},(x||v["stroke-width"])&&(o.stroke=e.borderColor,o["stroke-width"]=x),v.attr(o).shadow(e.shadow);v[_]({x:t/2,y:t/2,width:n-t-x%2,height:r-t-x%2,r:e.borderRadius}),_="animate",y||(_="attr",this.plotBackground=y=i.rect().addClass("highcharts-plot-background").add()),y[_](p),s||(y.attr({fill:l||"none"}).shadow(e.plotShadow),h&&(a?(h!==a.attr("href")&&a.attr("href",h),a.animate(p)):this.plotBGImage=i.image(h,c,u,d,f).add())),g?g.animate({width:m.width,height:m.height}):this.clipRect=i.clipRect(m),_="animate",b||(_="attr",this.plotBorder=b=i.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),s||b.attr({stroke:e.plotBorderColor,"stroke-width":e.plotBorderWidth||0,fill:"none"}),b[_](b.crisp({x:c,y:u,width:d,height:f},-b.strokeWidth())),this.isDirtyBox=!1,B(this,"afterDrawChartBox")},t.prototype.propFromSeries=function(){var t,e,i,n=this,r=n.options.chart,s=n.options.series;["inverted","angular","polar"].forEach((function(a){for(e=C[r.type||r.defaultSeriesType],i=r[a]||e&&e.prototype[a],t=s&&s.length;!i&&t--;)(e=C[s[t].type])&&e.prototype[a]&&(i=!0);n[a]=i}))},t.prototype.linkSeries=function(){var t=this,e=t.series;e.forEach((function(t){t.linkedSeries.length=0})),e.forEach((function(e){var i=e.options.linkedTo;H(i)&&(i=":previous"===i?t.series[e.index-1]:t.get(i))&&i.linkedParent!==e&&(i.linkedSeries.push(e),e.linkedParent=i,i.enabledDataSorting&&e.setDataSortingOptions(),e.visible=Y(e.options.visible,i.options.visible,e.visible))})),B(this,"afterLinkSeries")},t.prototype.renderSeries=function(){this.series.forEach((function(t){t.translate(),t.render()}))},t.prototype.renderLabels=function(){var t=this,e=t.options.labels;e.items&&e.items.forEach((function(i){var n=F(e.style,i.style),r=K(n.left)+t.plotLeft,s=K(n.top)+t.plotTop+12;delete n.left,delete n.top,t.renderer.text(i.html,r,s).attr({zIndex:2}).css(n).add()}))},t.prototype.render=function(){var t=this.axes,e=this.colorAxis,i=this.renderer,n=this.options,r=function(t){t.forEach((function(t){t.visible&&t.render()}))},s=0;this.setTitle(),this.legend=new a(this,n.legend),this.getStacks&&this.getStacks(),this.getMargins(!0),this.setChartSize(),n=this.plotWidth,t.some((function(t){if(t.horiz&&t.visible&&t.options.labels.enabled&&t.series.length)return s=21,!0}));var o=this.plotHeight=Math.max(this.plotHeight-s,0);t.forEach((function(t){t.setScale()})),this.getAxisMargins();var l=1.1<n/this.plotWidth,h=1.05<o/this.plotHeight;(l||h)&&(t.forEach((function(t){(t.horiz&&l||!t.horiz&&h)&&t.setTickInterval(!0)})),this.getMargins()),this.drawChartBox(),this.hasCartesianSeries?r(t):e&&e.length&&r(e),this.seriesGroup||(this.seriesGroup=i.g("series-group").attr({zIndex:3}).add()),this.renderSeries(),this.renderLabels(),this.addCredits(),this.setResponsive&&this.setResponsive(),this.hasRendered=!0},t.prototype.addCredits=function(t){var e=this,i=X(!0,this.options.credits,t);i.enabled&&!this.credits&&(this.credits=this.renderer.text(i.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",(function(){i.href&&(k.location.href=i.href)})).attr({align:i.position.align,zIndex:8}),e.styledMode||this.credits.css(i.style),this.credits.add().align(i.position),this.credits.update=function(t){e.credits=e.credits.destroy(),e.addCredits(t)})},t.prototype.destroy=function(){var t,e=this,i=e.axes,n=e.series,r=e.container,a=r&&r.parentNode;for(B(e,"destroy"),e.renderer.forExport?D(w,e):w[e.index]=void 0,s.chartCount--,e.renderTo.removeAttribute("data-highcharts-chart"),Z(e),t=i.length;t--;)i[t]=i[t].destroy();for(this.scroller&&this.scroller.destroy&&this.scroller.destroy(),t=n.length;t--;)n[t]=n[t].destroy();"title subtitle chartBackground plotBackground plotBGImage plotBorder seriesGroup clipRect credits pointer rangeSelector legend resetZoomButton tooltip renderer".split(" ").forEach((function(t){var i=e[t];i&&i.destroy&&(e[t]=i.destroy())})),r&&(r.innerHTML=p.emptyHTML,Z(r),a&&L(r)),V(e,(function(t,i){delete e[i]}))},t.prototype.firstRender=function(){var t=this,e=t.options;t.isReadyToRender&&!t.isReadyToRender()||(t.getContainer(),t.resetMargins(),t.setChartSize(),t.propFromSeries(),t.getAxes(),(W(e.series)?e.series:[]).forEach((function(e){t.initSeries(e)})),t.linkSeries(),t.setSeriesData(),B(t,"beforeRender"),l&&(o.isRequired()?t.pointer=new o(t,e):t.pointer=new l(t,e)),t.render(),t.pointer.getChartPosition(),t.renderer.imgCount||t.hasLoaded||t.onload(),t.temporaryDisplay(!0))},t.prototype.onload=function(){this.callbacks.concat([this.callback]).forEach((function(t){t&&void 0!==this.index&&t.apply(this,[this])}),this),B(this,"load"),B(this,"render"),I(this.index)&&this.setReflow(this.options.chart.reflow),this.warnIfA11yModuleNotLoaded(),this.hasLoaded=!0},t.prototype.warnIfA11yModuleNotLoaded=function(){var t=this.options,e=this.title;t&&!this.accessibility&&(this.renderer.boxWrapper.attr({role:"img","aria-label":(e&&e.element.textContent||"").replace(/</g,"&lt;")}),t.accessibility&&!1===t.accessibility.enabled||N('Highcharts warning: Consider including the "accessibility.js" module to make your chart more usable for people with disabilities. Set the "accessibility.enabled" option to false to remove this warning. See https://www.highcharts.com/docs/accessibility/accessibility-module.',!1,this))},t.prototype.addSeries=function(t,e,i){var n,r=this;return t&&(e=Y(e,!0),B(r,"addSeries",{options:t},(function(){n=r.initSeries(t),r.isDirtyLegend=!0,r.linkSeries(),n.enabledDataSorting&&n.setData(t.data,!1),B(r,"afterAddSeries",{series:n}),e&&r.redraw(i)}))),n},t.prototype.addAxis=function(t,e,i,n){return this.createAxis(e?"xAxis":"yAxis",{axis:t,redraw:i,animation:n})},t.prototype.addColorAxis=function(t,e,i){return this.createAxis("colorAxis",{axis:t,redraw:e,animation:i})},t.prototype.createAxis=function(t,i){return t=new e(this,X(i.axis,{index:this[t].length,isX:"xAxis"===t})),Y(i.redraw,!0)&&this.redraw(i.animation),t},t.prototype.showLoading=function(t){var e=this,i=e.options,n=i.loading,r=function(){s&&R(s,{left:e.plotLeft+"px",top:e.plotTop+"px",width:e.plotWidth+"px",height:e.plotHeight+"px"})},s=e.loadingDiv,a=e.loadingSpan;s||(e.loadingDiv=s=P("div",{className:"highcharts-loading highcharts-loading-hidden"},null,e.container)),a||(e.loadingSpan=a=P("span",{className:"highcharts-loading-inner"},null,s),M(e,"redraw",r)),s.className="highcharts-loading",p.setElementHTML(a,Y(t,i.lang.loading,"")),e.styledMode||(R(s,F(n.style,{zIndex:10})),R(a,n.labelStyle),e.loadingShown||(R(s,{opacity:0,display:""}),g(s,{opacity:n.style.opacity||.5},{duration:n.showDuration||0}))),e.loadingShown=!0,r()},t.prototype.hideLoading=function(){var t=this.options,e=this.loadingDiv;e&&(e.className="highcharts-loading highcharts-loading-hidden",this.styledMode||g(e,{opacity:0},{duration:t.loading.hideDuration||100,complete:function(){R(e,{display:"none"})}})),this.loadingShown=!1},t.prototype.update=function(t,e,i,n){var r,s,a=this,o={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"},l=t.isResponsiveOptions,h=[];B(a,"update",{options:t}),l||a.setResponsive(!1,!0),t=O(t,a.options),a.userOptions=X(a.userOptions,t);var c=t.chart;if(c){if(X(!0,a.options.chart,c),"className"in c&&a.setClassName(c.className),"reflow"in c&&a.setReflow(c.reflow),"inverted"in c||"polar"in c||"type"in c){a.propFromSeries();var u=!0}"alignTicks"in c&&(u=!0),"events"in c&&x(this,c),V(c,(function(t,e){-1!==a.propsRequireUpdateSeries.indexOf("chart."+e)&&(r=!0),-1!==a.propsRequireDirtyBox.indexOf(e)&&(a.isDirtyBox=!0),-1!==a.propsRequireReflow.indexOf(e)&&(l?a.isDirtyBox=!0:s=!0)})),!a.styledMode&&c.style&&a.renderer.setStyle(a.options.chart.style||{})}!a.styledMode&&t.colors&&(this.options.colors=t.colors),t.time&&(this.time===b&&(this.time=new d(t.time)),X(!0,a.options.time,t.time)),V(t,(function(e,i){a[i]&&"function"==typeof a[i].update?a[i].update(e,!1):"function"==typeof a[o[i]]?a[o[i]](e):"colors"!==i&&-1===a.collectionsWithUpdate.indexOf(i)&&X(!0,a.options[i],t[i]),"chart"!==i&&-1!==a.propsRequireUpdateSeries.indexOf(i)&&(r=!0)})),this.collectionsWithUpdate.forEach((function(e){if(t[e]){var n=[];a[e].forEach((function(t,e){t.options.isInternal||n.push(Y(t.options.index,e))})),J(t[e]).forEach((function(t,r){var s,o=I(t.id);o&&(s=a.get(t.id)),!s&&a[e]&&(s=a[e][n?n[r]:r])&&o&&I(s.options.id)&&(s=void 0),s&&s.coll===e&&(s.update(t,!1),i&&(s.touched=!0)),!s&&i&&a.collectionsWithInit[e]&&(a.collectionsWithInit[e][0].apply(a,[t].concat(a.collectionsWithInit[e][1]||[]).concat([!1])).touched=!0)})),i&&a[e].forEach((function(t){t.touched||t.options.isInternal?delete t.touched:h.push(t)}))}})),h.forEach((function(t){t.chart&&t.remove&&t.remove(!1)})),u&&a.axes.forEach((function(t){t.update({},!1)})),r&&a.getSeriesOrderByLinks().forEach((function(t){t.chart&&t.update({},!1)}),this),u=c&&c.width,c=c&&(H(c.height)?q(c.height,u||a.chartWidth):c.height),s||G(u)&&u!==a.chartWidth||G(c)&&c!==a.chartHeight?a.setSize(u,c,n):Y(e,!0)&&a.redraw(n),B(a,"afterUpdate",{options:t,redraw:e,animation:n})},t.prototype.setSubtitle=function(t,e){this.applyDescription("subtitle",t),this.layOutTitles(e)},t.prototype.setCaption=function(t,e){this.applyDescription("caption",t),this.layOutTitles(e)},t.prototype.showResetZoom=function(){function t(){e.zoomOut()}var e=this,i=y.lang,n=e.options.chart.zooming.resetButton,r=n.theme,s="chart"===n.relativeTo||"spacingBox"===n.relativeTo?null:"scrollablePlotBox";B(this,"beforeShowResetZoom",null,(function(){e.resetZoomButton=e.renderer.button(i.resetZoom,null,null,t,r).attr({align:n.position.align,title:i.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(n.position,!1,s)})),B(this,"afterShowResetZoom")},t.prototype.zoomOut=function(){B(this,"selection",{resetSelection:!0},this.zoom)},t.prototype.zoom=function(t){var e,i=this,n=i.pointer,r=!1;!t||t.resetSelection?(i.axes.forEach((function(t){e=t.zoom()})),n.initiated=!1):t.xAxis.concat(t.yAxis).forEach((function(t){var s=t.axis;(n[s.isXAxis?"zoomX":"zoomY"]&&I(n.mouseDownX)&&I(n.mouseDownY)&&i.isInsidePlot(n.mouseDownX-i.plotLeft,n.mouseDownY-i.plotTop,{axis:s})||!I(i.inverted?n.mouseDownX:n.mouseDownY))&&(e=s.zoom(t.min,t.max),s.displayBtn&&(r=!0))}));var s=i.resetZoomButton;r&&!s?i.showResetZoom():!r&&U(s)&&(i.resetZoomButton=s.destroy()),e&&i.redraw(Y(i.options.chart.animation,t&&t.animation,100>i.pointCount))},t.prototype.pan=function(t,e){var i=this,n=i.hoverPoints;e="object"==typeof e?e:{enabled:e,type:"x"};var r=i.options.chart;r&&r.panning&&(r.panning=e);var s,a=e.type;B(this,"pan",{originalEvent:t},(function(){n&&n.forEach((function(t){t.setState()}));var e=i.xAxis;"xy"===a?e=e.concat(i.yAxis):"y"===a&&(e=i.yAxis);var r={};e.forEach((function(e){if(e.options.panningEnabled&&!e.options.isInternal){var n=e.horiz,o=t[n?"chartX":"chartY"],l=i[n=n?"mouseDownX":"mouseDownY"],h=e.minPointOffset||0,c=e.reversed&&!i.inverted||!e.reversed&&i.inverted?-1:1,u=e.getExtremes(),d=e.toValue(l-o,!0)+h*c,f=e.toValue(l+e.len-o,!0)-(h*c||e.isXAxis&&e.pointRangePadding||0),p=f<d;c=e.hasVerticalPanning(),l=p?f:d,d=p?d:f;var g=e.panningState;!c||e.isXAxis||g&&!g.isDirty||e.series.forEach((function(t){var e=t.getProcessedData(!0);e=t.getExtremes(e.yData,!0),g||(g={startMin:Number.MAX_VALUE,startMax:-Number.MAX_VALUE}),G(e.dataMin)&&G(e.dataMax)&&(g.startMin=Math.min(Y(t.options.threshold,1/0),e.dataMin,g.startMin),g.startMax=Math.max(Y(t.options.threshold,-1/0),e.dataMax,g.startMax))})),c=Math.min(Y(g&&g.startMin,u.dataMin),h?u.min:e.toValue(e.toPixels(u.min)-e.minPixelPadding)),f=Math.max(Y(g&&g.startMax,u.dataMax),h?u.max:e.toValue(e.toPixels(u.max)+e.minPixelPadding)),e.panningState=g,e.isOrdinal||(0<(h=c-l)&&(d+=h,l=c),0<(h=d-f)&&(d=f,l-=h),e.series.length&&l!==u.min&&d!==u.max&&l>=c&&d<=f&&(e.setExtremes(l,d,!1,!1,{trigger:"pan"}),!i.resetZoomButton&&l!==c&&d!==f&&a.match("y")&&(i.showResetZoom(),e.displayBtn=!1),s=!0),r[n]=o)}})),V(r,(function(t,e){i[e]=t})),s&&i.redraw(!1),R(i.container,{cursor:"move"})}))},t}(),F(t.prototype,{callbacks:[],collectionsWithInit:{xAxis:[t.prototype.addAxis,[!0]],yAxis:[t.prototype.addAxis,[!1]],series:[t.prototype.addSeries]},collectionsWithUpdate:["xAxis","yAxis","series"],propsRequireDirtyBox:"backgroundColor borderColor borderWidth borderRadius plotBackgroundColor plotBackgroundImage plotBorderColor plotBorderWidth plotShadow shadow".split(" "),propsRequireReflow:"margin marginTop marginRight marginBottom marginLeft spacing spacingTop spacingRight spacingBottom spacingLeft".split(" "),propsRequireUpdateSeries:"chart.inverted chart.polar chart.ignoreHiddenSeries chart.type colors plotOptions time tooltip".split(" ")}),t})),e(i,"Core/Legend/LegendSymbol.js",[i["Core/Utilities.js"]],(function(t){var e,i=t.extend,n=t.merge,r=t.pick;return function(t){t.drawLineMarker=function(t){var e=this.legendItem=this.legendItem||{},s=this.options,a=t.symbolWidth,o=t.symbolHeight,l=o/2,h=this.chart.renderer,c=e.group;t=t.baseline-Math.round(.3*t.fontMetrics.b);var u={},d=s.marker,f=0;this.chart.styledMode||(u={"stroke-width":Math.min(s.lineWidth||0,24)},s.dashStyle?u.dashstyle=s.dashStyle:"square"!==s.linecap&&(u["stroke-linecap"]="round")),e.line=h.path().addClass("highcharts-graph").attr(u).add(c),u["stroke-linecap"]&&(f=Math.min(e.line.strokeWidth(),a)/2),e.line.attr({d:[["M",f,t],["L",a-f,t]]}),d&&!1!==d.enabled&&a&&(s=Math.min(r(d.radius,l),l),0===this.symbol.indexOf("url")&&(d=n(d,{width:o,height:o}),s=0),e.symbol=e=h.symbol(this.symbol,a/2-s,t-s,2*s,2*s,i({context:"legend"},d)).addClass("highcharts-point").add(c),e.isMarker=!0)},t.drawRectangle=function(t,e){e=e.legendItem||{};var i=t.symbolHeight,n=t.options.squareSymbol;e.symbol=this.chart.renderer.rect(n?(t.symbolWidth-i)/2:0,t.baseline-i+1,n?i:t.symbolWidth,i,r(t.options.symbolRadius,i/2)).addClass("highcharts-point").attr({zIndex:3}).add(e.group)}}(e||(e={})),e})),e(i,"Core/Series/SeriesDefaults.js",[],(function(){return{lineWidth:2,allowPointSelect:!1,crisp:!0,showCheckbox:!1,animation:{duration:1e3},events:{},marker:{enabledThreshold:2,lineColor:"#ffffff",lineWidth:0,radius:4,states:{normal:{animation:!0},hover:{animation:{duration:50},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{animation:{},align:"center",borderWidth:0,defer:!0,formatter:function(){var t=this.series.chart.numberFormatter;return"number"!=typeof this.y?"":t(this.y,-1)},padding:5,style:{fontSize:"11px",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0},cropThreshold:300,opacity:1,pointRange:0,softThreshold:!0,states:{normal:{animation:!0},hover:{animation:{duration:50},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{animation:{duration:0}},inactive:{animation:{duration:50},opacity:.2}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"}})),e(i,"Core/Series/Series.js",[i["Core/Animation/AnimationUtilities.js"],i["Core/Defaults.js"],i["Core/Foundation.js"],i["Core/Globals.js"],i["Core/Legend/LegendSymbol.js"],i["Core/Series/Point.js"],i["Core/Series/SeriesDefaults.js"],i["Core/Series/SeriesRegistry.js"],i["Core/Renderer/SVG/SVGElement.js"],i["Core/Utilities.js"]],(function(t,e,i,n,r,s,a,o,l,h){var c=t.animObject,u=t.setAnimation,d=e.defaultOptions,f=i.registerEventOptions,p=n.hasTouch,g=n.svg,m=n.win,v=o.seriesTypes,y=h.arrayMax,b=h.arrayMin,_=h.clamp,x=h.cleanRecursively,w=h.correctFloat,S=h.defined,T=h.erase,E=h.error,k=h.extend,C=h.find,M=h.fireEvent,A=h.getNestedProperty,O=h.isArray,P=h.isNumber,R=h.isString,I=h.merge,L=h.objectEach,D=h.pick,N=h.removeEvent,F=h.splat,j=h.syncTimeout;return t=function(){function t(){this.zones=this.yAxis=this.xAxis=this.userOptions=this.tooltipOptions=this.processedYData=this.processedXData=this.points=this.options=this.linkedSeries=this.index=this.eventsToUnbind=this.eventOptions=this.data=this.chart=this._i=void 0}return t.prototype.init=function(t,e){M(this,"init",{options:e});var i=this,n=t.series;this.eventsToUnbind=[],i.chart=t,i.options=i.setOptions(e),e=i.options,i.linkedSeries=[],i.bindAxes(),k(i,{name:e.name,state:"",visible:!1!==e.visible,selected:!0===e.selected}),f(this,e);var r,s=e.events;(s&&s.click||e.point&&e.point.events&&e.point.events.click||e.allowPointSelect)&&(t.runTrackerClick=!0),i.getColor(),i.getSymbol(),i.parallelArrays.forEach((function(t){i[t+"Data"]||(i[t+"Data"]=[])})),i.isCartesian&&(t.hasCartesianSeries=!0),n.length&&(r=n[n.length-1]),i._i=D(r&&r._i,-1)+1,i.opacity=i.options.opacity,t.orderSeries(this.insert(n)),e.dataSorting&&e.dataSorting.enabled?i.setDataSortingOptions():i.points||i.data||i.setData(e.data,!1),M(this,"afterInit")},t.prototype.is=function(t){return v[t]&&this instanceof v[t]},t.prototype.insert=function(t){var e,i=this.options.index;if(P(i)){for(e=t.length;e--;)if(i>=D(t[e].options.index,t[e]._i)){t.splice(e+1,0,this);break}-1===e&&t.unshift(this),e+=1}else t.push(this);return D(e,t.length-1)},t.prototype.bindAxes=function(){var t,e=this,i=e.options,n=e.chart;M(this,"bindAxes",null,(function(){(e.axisTypes||[]).forEach((function(r){var s=0;n[r].forEach((function(n){t=n.options,(i[r]===s&&!t.isInternal||void 0!==i[r]&&i[r]===t.id||void 0===i[r]&&0===t.index)&&(e.insert(n.series),e[r]=n,n.isDirty=!0),t.isInternal||s++})),e[r]||e.optionalAxis===r||E(18,!0,n)}))})),M(this,"afterBindAxes")},t.prototype.updateParallelArrays=function(t,e){var i=t.series,n=arguments,r=P(e)?function(n){var r="y"===n&&i.toYData?i.toYData(t):t[n];i[n+"Data"][e]=r}:function(t){Array.prototype[e].apply(i[t+"Data"],Array.prototype.slice.call(n,2))};i.parallelArrays.forEach(r)},t.prototype.hasData=function(){return this.visible&&void 0!==this.dataMax&&void 0!==this.dataMin||this.visible&&this.yData&&0<this.yData.length},t.prototype.autoIncrement=function(t){var e,i=this.options,n=i.pointIntervalUnit,r=i.relativeXValue,s=this.chart.time,a=this.xIncrement;return a=D(a,i.pointStart,0),this.pointInterval=e=D(this.pointInterval,i.pointInterval,1),r&&P(t)&&(e*=t),n&&(i=new s.Date(a),"day"===n?s.set("Date",i,s.get("Date",i)+e):"month"===n?s.set("Month",i,s.get("Month",i)+e):"year"===n&&s.set("FullYear",i,s.get("FullYear",i)+e),e=i.getTime()-a),r&&P(t)?a+e:(this.xIncrement=a+e,a)},t.prototype.setDataSortingOptions=function(){var t=this.options;k(this,{requireSorting:!1,sorted:!1,enabledDataSorting:!0,allowDG:!1}),S(t.pointRange)||(t.pointRange=1)},t.prototype.setOptions=function(t){var e=this.chart,i=e.options,n=i.plotOptions,r=e.userOptions||{};t=I(t),e=e.styledMode;var s={plotOptions:n,userOptions:t};M(this,"setOptions",s);var a=s.plotOptions[this.type],o=r.plotOptions||{};return this.userOptions=s.userOptions,r=I(a,n.series,r.plotOptions&&r.plotOptions[this.type],t),this.tooltipOptions=I(d.tooltip,d.plotOptions.series&&d.plotOptions.series.tooltip,d.plotOptions[this.type].tooltip,i.tooltip.userOptions,n.series&&n.series.tooltip,n[this.type].tooltip,t.tooltip),this.stickyTracking=D(t.stickyTracking,o[this.type]&&o[this.type].stickyTracking,o.series&&o.series.stickyTracking,!(!this.tooltipOptions.shared||this.noSharedTooltip)||r.stickyTracking),null===a.marker&&delete r.marker,this.zoneAxis=r.zoneAxis,n=this.zones=(r.zones||[]).slice(),!r.negativeColor&&!r.negativeFillColor||r.zones||(i={value:r[this.zoneAxis+"Threshold"]||r.threshold||0,className:"highcharts-negative"},e||(i.color=r.negativeColor,i.fillColor=r.negativeFillColor),n.push(i)),n.length&&S(n[n.length-1].value)&&n.push(e?{}:{color:this.color,fillColor:this.fillColor}),M(this,"afterSetOptions",{options:r}),r},t.prototype.getName=function(){return D(this.options.name,"Series "+(this.index+1))},t.prototype.getCyclic=function(t,e,i){var n=this.chart,r=this.userOptions,s=t+"Index",a=t+"Counter",o=i?i.length:D(n.options.chart[t+"Count"],n[t+"Count"]);if(!e){var l=D(r[s],r["_"+s]);S(l)||(n.series.length||(n[a]=0),r["_"+s]=l=n[a]%o,n[a]+=1),i&&(e=i[l])}void 0!==l&&(this[s]=l),this[t]=e},t.prototype.getColor=function(){this.chart.styledMode?this.getCyclic("color"):this.options.colorByPoint?this.color="#cccccc":this.getCyclic("color",this.options.color||d.plotOptions[this.type].color,this.chart.options.colors)},t.prototype.getPointsCollection=function(){return(this.hasGroupedData?this.points:this.data)||[]},t.prototype.getSymbol=function(){this.getCyclic("symbol",this.options.marker.symbol,this.chart.options.symbols)},t.prototype.findPointIndex=function(t,e){var i,n,r=t.id,a=t.x,o=this.points,l=this.options.dataSorting;if(r)(l=this.chart.get(r))instanceof s&&(i=l);else if((this.linkedParent||this.enabledDataSorting||this.options.relativeXValue)&&(i=function(e){return!e.touched&&e.index===t.index},l&&l.matchByName?i=function(e){return!e.touched&&e.name===t.name}:this.options.relativeXValue&&(i=function(e){return!e.touched&&e.options.x===t.x}),!(i=C(o,i))))return;if(i){var h=i&&i.index;void 0!==h&&(n=!0)}return void 0===h&&P(a)&&(h=this.xData.indexOf(a,e)),-1!==h&&void 0!==h&&this.cropped&&(h=h>=this.cropStart?h-this.cropStart:h),!n&&P(h)&&o[h]&&o[h].touched&&(h=void 0),h},t.prototype.updateData=function(t,e){var i,n,r,s=this.options,a=s.dataSorting,o=this.points,l=[],h=this.requireSorting,c=t.length===o.length,u=!0;if(this.xIncrement=null,t.forEach((function(t,e){var n=S(t)&&this.pointClass.prototype.optionsToObject.call({series:this},t)||{},u=n.x;n.id||P(u)?(-1===(n=this.findPointIndex(n,r))||void 0===n?l.push(t):o[n]&&t!==s.data[n]?(o[n].update(t,!1,null,!1),o[n].touched=!0,h&&(r=n+1)):o[n]&&(o[n].touched=!0),(!c||e!==n||a&&a.enabled||this.hasDerivedData)&&(i=!0)):l.push(t)}),this),i)for(t=o.length;t--;)(n=o[t])&&!n.touched&&n.remove&&n.remove(!1,e);else!c||a&&a.enabled?u=!1:(t.forEach((function(t,e){t!==o[e].y&&o[e].update&&o[e].update(t,!1,null,!1)})),l.length=0);return o.forEach((function(t){t&&(t.touched=!1)})),!!u&&(l.forEach((function(t){this.addPoint(t,!1,null,null,!1)}),this),null===this.xIncrement&&this.xData&&this.xData.length&&(this.xIncrement=y(this.xData),this.autoIncrement()),!0)},t.prototype.setData=function(t,e,i,n){void 0===e&&(e=!0);var r=this,s=r.points,a=s&&s.length||0,o=r.options,l=r.chart,h=o.dataSorting,c=r.xAxis,u=o.turboThreshold,d=this.xData,f=this.yData,p=r.pointArrayMap;p=p&&p.length;var g,m=o.keys,v=0,y=1,b=null;if(!l.options.chart.allowMutatingData){o.data&&delete r.options.data,r.userOptions.data&&delete r.userOptions.data;var _=I(!0,t)}if(_=(t=_||t||[]).length,h&&h.enabled&&(t=this.sortData(t)),l.options.chart.allowMutatingData&&!1!==n&&_&&a&&!r.cropped&&!r.hasGroupedData&&r.visible&&!r.boosted&&(g=this.updateData(t,i)),!g){if(r.xIncrement=null,r.colorCounter=0,this.parallelArrays.forEach((function(t){r[t+"Data"].length=0})),u&&_>u)if(b=r.getFirstValidPoint(t),P(b))for(i=0;i<_;i++)d[i]=this.autoIncrement(),f[i]=t[i];else if(O(b))if(p)if(b.length===p)for(i=0;i<_;i++)d[i]=this.autoIncrement(),f[i]=t[i];else for(i=0;i<_;i++)n=t[i],d[i]=n[0],f[i]=n.slice(1,p+1);else if(m&&(v=0<=(v=m.indexOf("x"))?v:0,y=0<=(y=m.indexOf("y"))?y:1),1===b.length&&(y=0),v===y)for(i=0;i<_;i++)d[i]=this.autoIncrement(),f[i]=t[i][y];else for(i=0;i<_;i++)n=t[i],d[i]=n[v],f[i]=n[y];else E(12,!1,l);else for(i=0;i<_;i++)void 0!==t[i]&&(n={series:r},r.pointClass.prototype.applyOptions.apply(n,[t[i]]),r.updateParallelArrays(n,i));for(f&&R(f[0])&&E(14,!0,l),r.data=[],r.options.data=r.userOptions.data=t,i=a;i--;)s[i]&&s[i].destroy&&s[i].destroy();c&&(c.minRange=c.userMinRange),r.isDirty=l.isDirtyBox=!0,r.isDirtyData=!!s,i=!1}"point"===o.legendType&&(this.processData(),this.generatePoints()),e&&l.redraw(i)},t.prototype.sortData=function(t){var e=this,i=e.options.dataSorting.sortKey||"y",n=function(t,e){return S(e)&&t.pointClass.prototype.optionsToObject.call({series:t},e)||{}};return t.forEach((function(i,r){t[r]=n(e,i),t[r].index=r}),this),t.concat().sort((function(t,e){return t=A(i,t),(e=A(i,e))<t?-1:e>t?1:0})).forEach((function(t,e){t.x=e}),this),e.linkedSeries&&e.linkedSeries.forEach((function(e){var i=e.options,r=i.data;i.dataSorting&&i.dataSorting.enabled||!r||(r.forEach((function(i,s){r[s]=n(e,i),t[s]&&(r[s].x=t[s].x,r[s].index=s)})),e.setData(r,!1))})),t},t.prototype.getProcessedData=function(t){var e=this.xAxis,i=this.options,n=i.cropThreshold,r=t||this.getExtremesFromAll||i.getExtremesFromAll,s=this.isCartesian;t=e&&e.val2lin,i=!(!e||!e.logarithmic);var a=0,o=this.xData,l=this.yData,h=this.requireSorting,c=!1,u=o.length;if(e){var d=(c=e.getExtremes()).min,f=c.max;c=!(!e.categories||e.names.length)}if(s&&this.sorted&&!r&&(!n||u>n||this.forceCrop))if(o[u-1]<d||o[0]>f)o=[],l=[];else if(this.yData&&(o[0]<d||o[u-1]>f)){var p=this.cropData(this.xData,this.yData,d,f);o=p.xData,l=p.yData,a=p.start,p=!0}for(n=o.length||1;--n;)if(0<(e=i?t(o[n])-t(o[n-1]):o[n]-o[n-1])&&(void 0===g||e<g))var g=e;else 0>e&&h&&!c&&(E(15,!1,this.chart),h=!1);return{xData:o,yData:l,cropped:p,cropStart:a,closestPointRange:g}},t.prototype.processData=function(t){var e=this.xAxis;if(this.isCartesian&&!this.isDirty&&!e.isDirty&&!this.yAxis.isDirty&&!t)return!1;t=this.getProcessedData(),this.cropped=t.cropped,this.cropStart=t.cropStart,this.processedXData=t.xData,this.processedYData=t.yData,this.closestPointRange=this.basePointRange=t.closestPointRange,M(this,"afterProcessData")},t.prototype.cropData=function(t,e,i,n,r){var s,a=t.length,o=0,l=a;for(r=D(r,this.cropShoulder),s=0;s<a;s++)if(t[s]>=i){o=Math.max(0,s-r);break}for(i=s;i<a;i++)if(t[i]>n){l=i+r;break}return{xData:t.slice(o,l),yData:e.slice(o,l),start:o,end:l}},t.prototype.generatePoints=function(){var t=this.options,e=this.processedData||t.data,i=this.processedXData,n=this.processedYData,r=this.pointClass,s=i.length,a=this.cropStart||0,o=this.hasGroupedData,l=t.keys,h=[];t=t.dataGrouping&&t.dataGrouping.groupAll?a:0;var c,u,d=this.data;if(!d&&!o){var f=[];f.length=e.length,d=this.data=f}for(l&&o&&(this.options.keys=!1),u=0;u<s;u++){if(f=a+u,o){var p=(new r).init(this,[i[u]].concat(F(n[u])));p.dataGroup=this.groupMap[t+u],p.dataGroup.options&&(p.options=p.dataGroup.options,k(p,p.dataGroup.options),delete p.dataLabels)}else(p=d[f])||void 0===e[f]||(d[f]=p=(new r).init(this,e[f],i[u]));p&&(p.index=o?t+u:f,h[u]=p)}if(this.options.keys=l,d&&(s!==(c=d.length)||o))for(u=0;u<c;u++)u!==a||o||(u+=s),d[u]&&(d[u].destroyElements(),d[u].plotX=void 0);this.data=d,this.points=h,M(this,"afterGeneratePoints")},t.prototype.getXExtremes=function(t){return{min:b(t),max:y(t)}},t.prototype.getExtremes=function(t,e){var i=this.xAxis,n=this.yAxis,r=this.processedXData||this.xData,s=[],a=this.requireSorting?this.cropShoulder:0;n=!!n&&n.positiveValuesOnly;var o,l=0,h=0,c=0,u=(t=t||this.stackedYData||this.processedYData||[]).length;if(i){var d=i.getExtremes();l=d.min,h=d.max}for(o=0;o<u;o++){var f=r[o];d=t[o];var p=(P(d)||O(d))&&(d.length||0<d||!n);if(f=e||this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||!i||(r[o+a]||f)>=l&&(r[o-a]||f)<=h,p&&f)if(p=d.length)for(;p--;)P(d[p])&&(s[c++]=d[p]);else s[c++]=d}return t={activeYData:s,dataMin:b(s),dataMax:y(s)},M(this,"afterGetExtremes",{dataExtremes:t}),t},t.prototype.applyExtremes=function(){var t=this.getExtremes();return this.dataMin=t.dataMin,this.dataMax=t.dataMax,t},t.prototype.getFirstValidPoint=function(t){for(var e=t.length,i=0,n=null;null===n&&i<e;)n=t[i],i++;return n},t.prototype.translate=function(){this.processedXData||this.processData(),this.generatePoints();var t,e,i=this.options,n=i.stacking,r=this.xAxis,s=r.categories,a=this.enabledDataSorting,o=this.yAxis,l=this.points,h=l.length,c=this.pointPlacementToXValue(),u=!!c,d=i.threshold,f=i.startFromThreshold?d:0,p=this.zoneAxis||"y",g=Number.MAX_VALUE;for(t=0;t<h;t++){var m=l[t],v=m.x,y=void 0,b=void 0,x=m.y,T=m.low,E=n&&o.stacking&&o.stacking.stacks[(this.negStacks&&x<(f?0:d)?"-":"")+this.stackKey];if((o.positiveValuesOnly&&!o.validatePositiveValue(x)||r.positiveValuesOnly&&!r.validatePositiveValue(v))&&(m.isNull=!0),m.plotX=e=w(_(r.translate(v,0,0,0,1,c,"flags"===this.type),-1e5,1e5)),n&&this.visible&&E&&E[v]){var k=this.getStackIndicator(k,v,this.index);!m.isNull&&k.key&&(b=(y=E[v]).points[k.key]),y&&O(b)&&(T=b[0],x=b[1],T===f&&k.key===E[v].base&&(T=D(P(d)?d:o.min)),o.positiveValuesOnly&&S(T)&&0>=T&&(T=void 0),m.total=m.stackTotal=D(y.total),m.percentage=S(m.y)&&y.total?m.y/y.total*100:void 0,m.stackY=x,this.irregularWidths||y.setOffset(this.pointXOffset||0,this.barW||0,void 0,void 0,void 0,this.xAxis))}if(m.yBottom=S(T)?_(o.translate(T,0,1,0,1),-1e5,1e5):void 0,this.dataModify&&(x=this.dataModify.modifyValue(x,t)),m.plotY=void 0,P(x)&&void 0!==(y=o.translate(x,!1,!0,!1,!0))&&(m.plotY=_(y,-1e5,1e5)),m.isInside=this.isPointInside(m),m.clientX=u?w(r.translate(v,0,0,0,1,c)):e,m.negative=m[p]<(i[p+"Threshold"]||d||0),m.category=D(s&&s[m.x],m.x),!m.isNull&&!1!==m.visible){void 0!==C&&(g=Math.min(g,Math.abs(e-C)));var C=e}m.zone=this.zones.length?m.getZone():void 0,!m.graphic&&this.group&&a&&(m.isNew=!0)}this.closestPointRangePx=g,M(this,"afterTranslate")},t.prototype.getValidPoints=function(t,e,i){var n=this.chart;return(t||this.points||[]).filter((function(t){return!(e&&!n.isInsidePlot(t.plotX,t.plotY,{inverted:n.inverted}))&&!1!==t.visible&&(i||!t.isNull)}))},t.prototype.getClipBox=function(){var t=this.chart,e=this.xAxis,i=this.yAxis,n=I(t.clipBox);return e&&e.len!==t.plotSizeX&&(n.width=e.len),i&&i.len!==t.plotSizeY&&(n.height=i.len),n},t.prototype.getSharedClipKey=function(){return this.sharedClipKey=(this.options.xAxis||0)+","+(this.options.yAxis||0)},t.prototype.setClip=function(){var t=this.chart,e=this.group,i=this.markerGroup,n=t.sharedClips;t=t.renderer;var r=this.getClipBox(),s=this.getSharedClipKey(),a=n[s];a?a.animate(r):n[s]=a=t.clipRect(r),e&&e.clip(!1===this.options.clip?void 0:a),i&&i.clip()},t.prototype.animate=function(t){var e=this.chart,i=this.group,n=this.markerGroup,r=e.inverted,s=c(this.options.animation),a=[this.getSharedClipKey(),s.duration,s.easing,s.defer].join(),o=e.sharedClips[a],l=e.sharedClips[a+"m"];if(t&&i)s=this.getClipBox(),o?o.attr("height",s.height):(s.width=0,r&&(s.x=e.plotHeight),o=e.renderer.clipRect(s),e.sharedClips[a]=o,l=e.renderer.clipRect({x:-99,y:-99,width:r?e.plotWidth+199:99,height:r?99:e.plotHeight+199}),e.sharedClips[a+"m"]=l),i.clip(o),n&&n.clip(l);else if(o&&!o.hasClass("highcharts-animating")){e=this.getClipBox();var h=s.step;n&&n.element.childNodes.length&&(s.step=function(t,e){h&&h.apply(e,arguments),"width"===e.prop&&l&&l.element&&l.attr(r?"height":"width",t+99)}),o.addClass("highcharts-animating").animate(e,s)}},t.prototype.afterAnimate=function(){var t=this;this.setClip(),L(this.chart.sharedClips,(function(e,i,n){e&&!t.chart.container.querySelector('[clip-path="url(#'.concat(e.id,')"]'))&&(e.destroy(),delete n[i])})),this.finishedAnimating=!0,M(this,"afterAnimate")},t.prototype.drawPoints=function(t){void 0===t&&(t=this.points);var e,i,n=this.chart,r=n.styledMode,s=this.colorAxis,a=this.options.marker,o=this[this.specialGroup||"markerGroup"],l=this.xAxis,h=D(a.enabled,!(l&&!l.isRadial)||null,this.closestPointRangePx>=a.enabledThreshold*a.radius);if(!1!==a.enabled||this._hasPointMarkers)for(e=0;e<t.length;e++){var c=t[e],u=(i=c.graphic)?"animate":"attr",d=c.marker||{},f=!!c.marker;if((h&&void 0===d.enabled||d.enabled)&&!c.isNull&&!1!==c.visible){var p=D(d.symbol,this.symbol,"rect"),g=this.markerAttribs(c,c.selected&&"select");this.enabledDataSorting&&(c.startXPos=l.reversed?-(g.width||0):l.width);var m=!1!==c.isInside;!i&&m&&(0<(g.width||0)||c.hasImage)&&(c.graphic=i=n.renderer.symbol(p,g.x,g.y,g.width,g.height,f?d:a).add(o),this.enabledDataSorting&&n.hasRendered&&(i.attr({x:c.startXPos}),u="animate")),i&&"animate"===u&&i[m?"show":"hide"](m).animate(g),i&&(d=this.pointAttribs(c,r||!c.selected?void 0:"select"),r?s&&i.css({fill:d.fill}):i[u](d)),i&&i.addClass(c.getClassName(),!0)}else i&&(c.graphic=i.destroy())}},t.prototype.markerAttribs=function(t,e){var i=this.options,n=i.marker,r=t.marker||{},s=r.symbol||n.symbol,a={},o=D(r.radius,n&&n.radius);return e&&(n=n.states[e],e=r.states&&r.states[e],o=D(e&&e.radius,n&&n.radius,o&&o+(n&&n.radiusPlus||0))),t.hasImage=s&&0===s.indexOf("url"),t.hasImage&&(o=0),t=t.pos(),P(o)&&t&&(a.x=t[0]-o,a.y=t[1]-o,i.crisp&&(a.x=Math.floor(a.x))),o&&(a.width=a.height=2*o),a},t.prototype.pointAttribs=function(t,e){var i=this.options.marker,n=t&&t.options,r=n&&n.marker||{},s=n&&n.color,a=t&&t.color,o=t&&t.zone&&t.zone.color,l=this.color;return t=D(r.lineWidth,i.lineWidth),n=1,l=s||o||a||l,s=r.fillColor||i.fillColor||l,a=r.lineColor||i.lineColor||l,e=e||"normal",i=i.states[e]||{},e=r.states&&r.states[e]||{},t=D(e.lineWidth,i.lineWidth,t+D(e.lineWidthPlus,i.lineWidthPlus,0)),s=e.fillColor||i.fillColor||s,{stroke:a=e.lineColor||i.lineColor||a,"stroke-width":t,fill:s,opacity:n=D(e.opacity,i.opacity,n)}},t.prototype.destroy=function(t){var e,i,n,r=this,s=r.chart,a=/AppleWebKit\/533/.test(m.navigator.userAgent),o=r.data||[];for(M(r,"destroy",{keepEventsForUpdate:t}),this.removeEvents(t),(r.axisTypes||[]).forEach((function(t){(n=r[t])&&n.series&&(T(n.series,r),n.isDirty=n.forceRedraw=!0)})),r.legendItem&&r.chart.legend.destroyItem(r),e=o.length;e--;)(i=o[e])&&i.destroy&&i.destroy();r.clips&&r.clips.forEach((function(t){return t.destroy()})),h.clearTimeout(r.animationTimeout),L(r,(function(t,e){t instanceof l&&!t.survive&&t[a&&"group"===e?"hide":"destroy"]()})),s.hoverSeries===r&&(s.hoverSeries=void 0),T(s.series,r),s.orderSeries(),L(r,(function(e,i){t&&"hcEvents"===i||delete r[i]}))},t.prototype.applyZones=function(){var t,e,i,n,r,s,a,o,l=this,h=this.chart,c=h.renderer,u=this.zones,d=this.clips||[],f=this.graph,p=this.area,g=Math.max(h.plotWidth,h.plotHeight),m=this[(this.zoneAxis||"y")+"Axis"],v=h.inverted,y=!1;if(u.length&&(f||p)&&m&&void 0!==m.min){var b=m.reversed,x=m.horiz;f&&!this.showLine&&f.hide(),p&&p.hide();var w=m.getExtremes();u.forEach((function(u,S){t=b?x?h.plotWidth:0:x?0:m.toPixels(w.min)||0,t=_(D(e,t),0,g),e=_(Math.round(m.toPixels(D(u.value,w.max),!0)||0),0,g),y&&(t=e=m.toPixels(w.max)),n=Math.abs(t-e),r=Math.min(t,e),s=Math.max(t,e),m.isXAxis?(i={x:v?s:r,y:0,width:n,height:g},x||(i.x=h.plotHeight-i.x)):(i={x:0,y:v?s:r,width:g,height:n},x&&(i.y=h.plotWidth-i.y)),v&&c.isVML&&(i=m.isXAxis?{x:0,y:b?r:s,height:i.width,width:h.chartWidth}:{x:i.y-h.plotLeft-h.spacingBox.x,y:0,width:i.height,height:h.chartHeight}),d[S]?d[S].animate(i):d[S]=c.clipRect(i),a=l["zone-area-"+S],o=l["zone-graph-"+S],f&&o&&o.clip(d[S]),p&&a&&a.clip(d[S]),y=u.value>w.max,l.resetZones&&0===e&&(e=void 0)})),this.clips=d}else l.visible&&(f&&f.show(),p&&p.show())},t.prototype.plotGroup=function(t,e,i,n,r){var s=this[t],a=!s;return i={visibility:i,zIndex:n||.1},void 0===this.opacity||this.chart.styledMode||"inactive"===this.state||(i.opacity=this.opacity),a&&(this[t]=s=this.chart.renderer.g().add(r)),s.addClass("highcharts-"+e+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(S(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(s.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0),s.attr(i)[a?"attr":"animate"](this.getPlotBox(e)),s},t.prototype.getPlotBox=function(t){var e=this.xAxis,i=this.yAxis,n=this.chart;return t=n.inverted&&!n.polar&&e&&!1!==this.invertible&&"series"===t,n.inverted&&(e=i,i=this.xAxis),{translateX:e?e.left:n.plotLeft,translateY:i?i.top:n.plotTop,rotation:t?90:0,rotationOriginX:t?(e.len-i.len)/2:0,rotationOriginY:t?(e.len+i.len)/2:0,scaleX:t?-1:1,scaleY:1}},t.prototype.removeEvents=function(t){t||N(this),this.eventsToUnbind.length&&(this.eventsToUnbind.forEach((function(t){t()})),this.eventsToUnbind.length=0)},t.prototype.render=function(){var t=this,e=t.chart,i=t.options,n=c(i.animation),r=t.visible?"inherit":"hidden",s=i.zIndex,a=t.hasRendered,o=e.seriesGroup;e=!t.finishedAnimating&&e.renderer.isSVG?n.duration:0,M(this,"render"),t.plotGroup("group","series",r,s,o),t.markerGroup=t.plotGroup("markerGroup","markers",r,s,o),!1!==i.clip&&t.setClip(),t.animate&&e&&t.animate(!0),t.drawGraph&&(t.drawGraph(),t.applyZones()),t.visible&&t.drawPoints(),t.drawDataLabels&&t.drawDataLabels(),t.redrawPoints&&t.redrawPoints(),t.drawTracker&&!1!==t.options.enableMouseTracking&&t.drawTracker(),t.animate&&e&&t.animate(),a||(e&&n.defer&&(e+=n.defer),t.animationTimeout=j((function(){t.afterAnimate()}),e||0)),t.isDirty=!1,t.hasRendered=!0,M(t,"afterRender")},t.prototype.redraw=function(){var t=this.isDirty||this.isDirtyData;this.translate(),this.render(),t&&delete this.kdTree},t.prototype.searchPoint=function(t,e){var i=this.xAxis,n=this.yAxis,r=this.chart.inverted;return this.searchKDTree({clientX:r?i.len-t.chartY+i.pos:t.chartX-i.pos,plotY:r?n.len-t.chartX+n.pos:t.chartY-n.pos},e,t)},t.prototype.buildKDTree=function(t){function e(t,n,r){var s=t&&t.length;if(s){var a=i.kdAxisArray[n%r];return t.sort((function(t,e){return t[a]-e[a]})),{point:t[s=Math.floor(s/2)],left:e(t.slice(0,s),n+1,r),right:e(t.slice(s+1),n+1,r)}}}this.buildingKdTree=!0;var i=this,n=-1<i.options.findNearestPointBy.indexOf("y")?2:1;delete i.kdTree,j((function(){i.kdTree=e(i.getValidPoints(null,!i.directTouch),n,n),i.buildingKdTree=!1}),i.options.kdNow||t&&"touchstart"===t.type?0:1)},t.prototype.searchKDTree=function(t,e,i){var n=this,r=this.kdAxisArray[0],s=this.kdAxisArray[1],a=e?"distX":"dist";if(e=-1<n.options.findNearestPointBy.indexOf("y")?2:1,this.kdTree||this.buildingKdTree||this.buildKDTree(i),this.kdTree)return function t(e,i,o,l){var h=i.point,c=n.kdAxisArray[o%l],u=h,d=S(e[r])&&S(h[r])?Math.pow(e[r]-h[r],2):null,f=S(e[s])&&S(h[s])?Math.pow(e[s]-h[s],2):null;return f=(d||0)+(f||0),h.dist=S(f)?Math.sqrt(f):Number.MAX_VALUE,h.distX=S(d)?Math.sqrt(d):Number.MAX_VALUE,d=0>(c=e[c]-h[c])?"right":"left",i[f=0>c?"left":"right"]&&(u=(f=t(e,i[f],o+1,l))[a]<u[a]?f:h),i[d]&&Math.sqrt(c*c)<u[a]&&(u=(e=t(e,i[d],o+1,l))[a]<u[a]?e:u),u}(t,this.kdTree,e,e)},t.prototype.pointPlacementToXValue=function(){var t=this.options,e=t.pointRange,i=this.xAxis;return"between"===(t=t.pointPlacement)&&(t=i.reversed?-.5:.5),P(t)?t*(e||i.pointRange):0},t.prototype.isPointInside=function(t){var e=this.chart,i=this.xAxis,n=this.yAxis;return void 0!==t.plotY&&void 0!==t.plotX&&0<=t.plotY&&t.plotY<=(n?n.len:e.plotHeight)&&0<=t.plotX&&t.plotX<=(i?i.len:e.plotWidth)},t.prototype.drawTracker=function(){var t=this,e=t.options,i=e.trackByArea,n=[].concat(i?t.areaPath:t.graphPath),r=t.chart,s=r.pointer,a=r.renderer,o=r.options.tooltip.snap,l=t.tracker,h=function(e){r.hoverSeries!==t&&t.onMouseOver()},c="rgba(192,192,192,"+(g?1e-4:.002)+")";l?l.attr({d:n}):t.graph&&(t.tracker=a.path(n).attr({visibility:t.visible?"inherit":"hidden",zIndex:2}).addClass(i?"highcharts-tracker-area":"highcharts-tracker-line").add(t.group),r.styledMode||t.tracker.attr({"stroke-linecap":"round","stroke-linejoin":"round",stroke:c,fill:i?c:"none","stroke-width":t.graph.strokeWidth()+(i?0:2*o)}),[t.tracker,t.markerGroup,t.dataLabelsGroup].forEach((function(t){t&&(t.addClass("highcharts-tracker").on("mouseover",h).on("mouseout",(function(t){s.onTrackerMouseOut(t)})),e.cursor&&!r.styledMode&&t.css({cursor:e.cursor}),p)&&t.on("touchstart",h)}))),M(this,"afterDrawTracker")},t.prototype.addPoint=function(t,e,i,n,r){var s=this.options,a=this.data,o=this.chart,l=this.xAxis;l=l&&l.hasNames&&l.names;var h,c=s.data,u=this.xData;e=D(e,!0);var d={series:this};this.pointClass.prototype.applyOptions.apply(d,[t]);var f=d.x,p=u.length;if(this.requireSorting&&f<u[p-1])for(h=!0;p&&u[p-1]>f;)p--;this.updateParallelArrays(d,"splice",p,0,0),this.updateParallelArrays(d,p),l&&d.name&&(l[f]=d.name),c.splice(p,0,t),(h||this.processedData)&&(this.data.splice(p,0,null),this.processData()),"point"===s.legendType&&this.generatePoints(),i&&(a[0]&&a[0].remove?a[0].remove(!1):(a.shift(),this.updateParallelArrays(d,"shift"),c.shift())),!1!==r&&M(this,"addPoint",{point:d}),this.isDirtyData=this.isDirty=!0,e&&o.redraw(n)},t.prototype.removePoint=function(t,e,i){var n=this,r=n.data,s=r[t],a=n.points,o=n.chart,l=function(){a&&a.length===r.length&&a.splice(t,1),r.splice(t,1),n.options.data.splice(t,1),n.updateParallelArrays(s||{series:n},"splice",t,1),s&&s.destroy(),n.isDirty=!0,n.isDirtyData=!0,e&&o.redraw()};u(i,o),e=D(e,!0),s?s.firePointEvent("remove",null,l):l()},t.prototype.remove=function(t,e,i,n){function r(){s.destroy(n),a.isDirtyLegend=a.isDirtyBox=!0,a.linkSeries(),D(t,!0)&&a.redraw(e)}var s=this,a=s.chart;!1!==i?M(s,"remove",null,r):r()},t.prototype.update=function(t,e){t=x(t,this.userOptions),M(this,"update",{options:t});var i=this,n=i.chart,r=i.userOptions,s=i.initialType||i.type,a=n.options.plotOptions,o=v[s].prototype,l=i.finishedAnimating&&{animation:!1},h={},c=["eventOptions","navigatorSeries","baseSeries"],u=t.type||r.type||n.options.chart.type,d=!(this.hasDerivedData||u&&u!==this.type||void 0!==t.pointStart||void 0!==t.pointInterval||void 0!==t.relativeXValue||t.joinBy||t.mapData||i.hasOptionChanged("dataGrouping")||i.hasOptionChanged("pointStart")||i.hasOptionChanged("pointInterval")||i.hasOptionChanged("pointIntervalUnit")||i.hasOptionChanged("keys"));if(u=u||s,d&&(c.push("data","isDirtyData","points","processedData","processedXData","processedYData","xIncrement","cropped","_hasPointMarkers","_hasPointLabels","clips","nodes","layout","level","mapMap","mapData","minY","maxY","minX","maxX"),!1!==t.visible&&c.push("area","graph"),i.parallelArrays.forEach((function(t){c.push(t+"Data")})),t.data&&(t.dataSorting&&k(i.options.dataSorting,t.dataSorting),this.setData(t.data,!1))),t=I(r,l,{index:void 0===r.index?i.index:r.index,pointStart:D(a&&a.series&&a.series.pointStart,r.pointStart,i.xData[0])},!d&&{data:i.options.data},t),d&&t.data&&(t.data=i.options.data),(c=["group","markerGroup","dataLabelsGroup","transformGroup","shadowGroup"].concat(c)).forEach((function(t){c[t]=i[t],delete i[t]})),a=!1,v[u]){if(a=u!==i.type,i.remove(!1,!1,!1,!0),a)if(Object.setPrototypeOf)Object.setPrototypeOf(i,v[u].prototype);else{for(f in l=Object.hasOwnProperty.call(i,"hcEvents")&&i.hcEvents,o)i[f]=void 0;k(i,v[u].prototype),l?i.hcEvents=l:delete i.hcEvents}}else E(17,!0,n,{missingModuleFor:u});if(c.forEach((function(t){i[t]=c[t]})),i.init(n,t),d&&this.points){if(!1===(t=i.options).visible)h.graphic=1,h.dataLabel=1;else if(!i._hasPointLabels){o=t.marker;var f=t.dataLabels;r=r.marker||{},!o||!1!==o.enabled&&r.symbol===o.symbol&&r.height===o.height&&r.width===o.width||(h.graphic=1),f&&!1===f.enabled&&(h.dataLabel=1)}for(r=0,o=this.points;r<o.length;r++)(f=o[r])&&f.series&&(f.resolveColor(),Object.keys(h).length&&f.destroyElements(h),!1===t.showInLegend&&f.legendItem&&n.legend.destroyItem(f))}i.initialType=s,n.linkSeries(),a&&i.linkedSeries.length&&(i.isDirtyData=!0),M(this,"afterUpdate"),D(e,!0)&&n.redraw(!!d&&void 0)},t.prototype.setName=function(t){this.name=this.options.name=this.userOptions.name=t,this.chart.isDirtyLegend=!0},t.prototype.hasOptionChanged=function(t){var e=this.options[t],i=this.chart.options.plotOptions,n=this.userOptions[t];return n?e!==n:e!==D(i&&i[this.type]&&i[this.type][t],i&&i.series&&i.series[t],e)},t.prototype.onMouseOver=function(){var t=this.chart,e=t.hoverSeries;t.pointer.setHoverChartIndex(),e&&e!==this&&e.onMouseOut(),this.options.events.mouseOver&&M(this,"mouseOver"),this.setState("hover"),t.hoverSeries=this},t.prototype.onMouseOut=function(){var t=this.options,e=this.chart,i=e.tooltip,n=e.hoverPoint;e.hoverSeries=null,n&&n.onMouseOut(),this&&t.events.mouseOut&&M(this,"mouseOut"),!i||this.stickyTracking||i.shared&&!this.noSharedTooltip||i.hide(),e.series.forEach((function(t){t.setState("",!0)}))},t.prototype.setState=function(t,e){var i=this,n=i.options,r=i.graph,s=n.inactiveOtherPoints,a=n.states,o=D(a[t||"normal"]&&a[t||"normal"].animation,i.chart.options.chart.animation),l=n.lineWidth,h=0,c=n.opacity;if(t=t||"",i.state!==t&&([i.group,i.markerGroup,i.dataLabelsGroup].forEach((function(e){e&&(i.state&&e.removeClass("highcharts-series-"+i.state),t&&e.addClass("highcharts-series-"+t))})),i.state=t,!i.chart.styledMode)){if(a[t]&&!1===a[t].enabled)return;if(t&&(l=a[t].lineWidth||l+(a[t].lineWidthPlus||0),c=D(a[t].opacity,c)),r&&!r.dashstyle&&P(l))for(n={"stroke-width":l},r.animate(n,o);i["zone-graph-"+h];)i["zone-graph-"+h].animate(n,o),h+=1;s||[i.group,i.markerGroup,i.dataLabelsGroup,i.labelBySeries].forEach((function(t){t&&t.animate({opacity:c},o)}))}e&&s&&i.points&&i.setAllPointsToState(t||void 0)},t.prototype.setAllPointsToState=function(t){this.points.forEach((function(e){e.setState&&e.setState(t)}))},t.prototype.setVisible=function(t,e){var i=this,n=i.chart,r=n.options.chart.ignoreHiddenSeries,s=i.visible,a=(i.visible=t=i.options.visible=i.userOptions.visible=void 0===t?!s:t)?"show":"hide";["group","dataLabelsGroup","markerGroup","tracker","tt"].forEach((function(t){i[t]&&i[t][a]()})),n.hoverSeries!==i&&(n.hoverPoint&&n.hoverPoint.series)!==i||i.onMouseOut(),i.legendItem&&n.legend.colorizeItem(i,t),i.isDirty=!0,i.options.stacking&&n.series.forEach((function(t){t.options.stacking&&t.visible&&(t.isDirty=!0)})),i.linkedSeries.forEach((function(e){e.setVisible(t,!1)})),r&&(n.isDirtyBox=!0),M(i,a),!1!==e&&n.redraw()},t.prototype.show=function(){this.setVisible(!0)},t.prototype.hide=function(){this.setVisible(!1)},t.prototype.select=function(t){this.selected=t=this.options.selected=void 0===t?!this.selected:t,this.checkbox&&(this.checkbox.checked=t),M(this,t?"select":"unselect")},t.prototype.shouldShowTooltip=function(t,e,i){return void 0===i&&(i={}),i.series=this,i.visiblePlotOnly=!0,this.chart.isInsidePlot(t,e,i)},t.defaultOptions=a,t.types=o.seriesTypes,t.registerType=o.registerSeriesType,t}(),k(t.prototype,{axisTypes:["xAxis","yAxis"],coll:"series",colorCounter:0,cropShoulder:1,directTouch:!1,drawLegendSymbol:r.drawLineMarker,isCartesian:!0,kdAxisArray:["clientX","plotY"],parallelArrays:["x","y"],pointClass:s,requireSorting:!0,sorted:!0}),o.series=t,t})),e(i,"Extensions/ScrollablePlotArea.js",[i["Core/Animation/AnimationUtilities.js"],i["Core/Axis/Axis.js"],i["Core/Chart/Chart.js"],i["Core/Series/Series.js"],i["Core/Renderer/RendererRegistry.js"],i["Core/Utilities.js"]],(function(t,e,i,n,r,s){var a=t.stop,o=s.addEvent,l=s.createElement,h=s.defined,c=s.merge,u=s.pick;o(i,"afterSetChartSize",(function(t){var i=this.options.chart.scrollablePlotArea,n=i&&i.minWidth;if(i=i&&i.minHeight,!this.renderer.forExport){if(n){if(this.scrollablePixelsX=n=Math.max(0,n-this.chartWidth)){this.scrollablePlotBox=this.renderer.scrollablePlotBox=c(this.plotBox),this.plotBox.width=this.plotWidth+=n,this.inverted?this.clipBox.height+=n:this.clipBox.width+=n;var r={1:{name:"right",value:n}}}}else i&&(this.scrollablePixelsY=n=Math.max(0,i-this.chartHeight),h(n)&&(this.scrollablePlotBox=this.renderer.scrollablePlotBox=c(this.plotBox),this.plotBox.height=this.plotHeight+=n,this.inverted?this.clipBox.width+=n:this.clipBox.height+=n,r={2:{name:"bottom",value:n}}));r&&!t.skipAxes&&this.axes.forEach((function(t){r[t.side]?t.getPlotLinePath=function(){var i=r[t.side].name,n=this[i];this[i]=n-r[t.side].value;var s=e.prototype.getPlotLinePath.apply(this,arguments);return this[i]=n,s}:(t.setAxisSize(),t.setAxisTranslation())}))}})),o(i,"render",(function(){this.scrollablePixelsX||this.scrollablePixelsY?(this.setUpScrolling&&this.setUpScrolling(),this.applyFixed()):this.fixedDiv&&this.applyFixed()})),i.prototype.setUpScrolling=function(){var t,e=this,i={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};this.scrollablePixelsX&&(i.overflowX="auto"),this.scrollablePixelsY&&(i.overflowY="auto"),this.scrollingParent=l("div",{className:"highcharts-scrolling-parent"},{position:"relative"},this.renderTo),this.scrollingContainer=l("div",{className:"highcharts-scrolling"},i,this.scrollingParent),o(this.scrollingContainer,"scroll",(function(){e.pointer&&(delete e.pointer.chartPosition,e.hoverPoint&&(t=e.hoverPoint),e.pointer.runPointActions(void 0,t,!0))})),this.innerContainer=l("div",{className:"highcharts-inner-container"},null,this.scrollingContainer),this.innerContainer.appendChild(this.container),this.setUpScrolling=null},i.prototype.moveFixedElements=function(){var t,e=this.container,i=this.fixedRenderer,n=".highcharts-breadcrumbs-group .highcharts-contextbutton .highcharts-credits .highcharts-legend .highcharts-legend-checkbox .highcharts-navigator-series .highcharts-navigator-xaxis .highcharts-navigator-yaxis .highcharts-navigator .highcharts-reset-zoom .highcharts-drillup-button .highcharts-scrollbar .highcharts-subtitle .highcharts-title".split(" ");this.scrollablePixelsX&&!this.inverted?t=".highcharts-yaxis":this.scrollablePixelsX&&this.inverted||this.scrollablePixelsY&&!this.inverted?t=".highcharts-xaxis":this.scrollablePixelsY&&this.inverted&&(t=".highcharts-yaxis"),t&&n.push(t+":not(.highcharts-radial-axis)",t+"-labels:not(.highcharts-radial-axis-labels)"),n.forEach((function(t){[].forEach.call(e.querySelectorAll(t),(function(t){(t.namespaceURI===i.SVG_NS?i.box:i.box.parentNode).appendChild(t),t.style.pointerEvents="auto"}))}))},i.prototype.applyFixed=function(){var t=!this.fixedDiv,e=this.options.chart,i=e.scrollablePlotArea,n=r.getRendererType();t?(this.fixedDiv=l("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:(e.style&&e.style.zIndex||0)+2,top:0},null,!0),this.scrollingContainer&&this.scrollingContainer.parentNode.insertBefore(this.fixedDiv,this.scrollingContainer),this.renderTo.style.overflow="visible",this.fixedRenderer=e=new n(this.fixedDiv,this.chartWidth,this.chartHeight,this.options.chart.style),this.scrollableMask=e.path().attr({fill:this.options.chart.backgroundColor||"#fff","fill-opacity":u(i.opacity,.85),zIndex:-1}).addClass("highcharts-scrollable-mask").add(),o(this,"afterShowResetZoom",this.moveFixedElements),o(this,"afterApplyDrilldown",this.moveFixedElements),o(this,"afterLayOutTitles",this.moveFixedElements)):this.fixedRenderer.setSize(this.chartWidth,this.chartHeight),(this.scrollableDirty||t)&&(this.scrollableDirty=!1,this.moveFixedElements()),e=this.chartWidth+(this.scrollablePixelsX||0),n=this.chartHeight+(this.scrollablePixelsY||0),a(this.container),this.container.style.width=e+"px",this.container.style.height=n+"px",this.renderer.boxWrapper.attr({width:e,height:n,viewBox:[0,0,e,n].join(" ")}),this.chartBackground.attr({width:e,height:n}),this.scrollingContainer.style.height=this.chartHeight+"px",t&&(i.scrollPositionX&&(this.scrollingContainer.scrollLeft=this.scrollablePixelsX*i.scrollPositionX),i.scrollPositionY&&(this.scrollingContainer.scrollTop=this.scrollablePixelsY*i.scrollPositionY)),n=this.axisOffset,t=this.plotTop-n[0]-1,i=this.plotLeft-n[3]-1,e=this.plotTop+this.plotHeight+n[2]+1,n=this.plotLeft+this.plotWidth+n[1]+1;var s=this.plotLeft+this.plotWidth-(this.scrollablePixelsX||0),h=this.plotTop+this.plotHeight-(this.scrollablePixelsY||0);t=this.scrollablePixelsX?[["M",0,t],["L",this.plotLeft-1,t],["L",this.plotLeft-1,e],["L",0,e],["Z"],["M",s,t],["L",this.chartWidth,t],["L",this.chartWidth,e],["L",s,e],["Z"]]:this.scrollablePixelsY?[["M",i,0],["L",i,this.plotTop-1],["L",n,this.plotTop-1],["L",n,0],["Z"],["M",i,h],["L",i,this.chartHeight],["L",n,this.chartHeight],["L",n,h],["Z"]]:[["M",0,0]],"adjustHeight"!==this.redrawTrigger&&this.scrollableMask.attr({d:t})},o(e,"afterInit",(function(){this.chart.scrollableDirty=!0})),o(n,"show",(function(){this.chart.scrollableDirty=!0}))})),e(i,"Core/Axis/Stacking/StackItem.js",[i["Core/FormatUtilities.js"],i["Core/Series/SeriesRegistry.js"],i["Core/Utilities.js"]],(function(t,e,i){var n=t.format,r=e.series,s=i.destroyObjectProperties,a=i.pick,o=i.isNumber;return t=function(){function t(t,e,i,n,r){var s=t.chart.inverted,a=t.reversed;this.axis=t,t=this.isNegative=!!i!=!!a,this.options=e=e||{},this.x=n,this.cumulative=this.total=null,this.points={},this.hasValidPoints=!1,this.stack=r,this.rightCliff=this.leftCliff=0,this.alignOptions={align:e.align||(s?t?"left":"right":"center"),verticalAlign:e.verticalAlign||(s?"middle":t?"bottom":"top"),y:e.y,x:e.x},this.textAlign=e.textAlign||(s?t?"right":"left":"center")}return t.prototype.destroy=function(){s(this,this.axis)},t.prototype.render=function(t){var e=this.axis.chart,i=this.options,r=i.format;r=r?n(r,this,e):i.formatter.call(this),this.label?this.label.attr({text:r,visibility:"hidden"}):(this.label=e.renderer.label(r,null,void 0,i.shape,void 0,void 0,i.useHTML,!1,"stack-labels"),r={r:i.borderRadius||0,text:r,padding:a(i.padding,5),visibility:"hidden"},e.styledMode||(r.fill=i.backgroundColor,r.stroke=i.borderColor,r["stroke-width"]=i.borderWidth,this.label.css(i.style||{})),this.label.attr(r),this.label.added||this.label.add(t)),this.label.labelrank=e.plotSizeY},t.prototype.setOffset=function(t,e,i,n,s,l){var h=this.alignOptions,c=this.axis,u=this.label,d=this.options,f=this.textAlign,p=c.chart;t=this.getStackBox({xOffset:t,width:e,boxBottom:i,boxTop:n,defaultX:s,xAxis:l}),s=h.verticalAlign,u&&t&&(e=u.getBBox(),i=u.padding,n="justify"===a(d.overflow,"justify"),h.x=d.x||0,h.y=d.y||0,f=(s=this.adjustStackPosition({labelBox:e,verticalAlign:s,textAlign:f})).x,s=s.y,t.x-=f,t.y-=s,u.align(h,!1,t),(f=p.isInsidePlot(u.alignAttr.x+h.x+f,u.alignAttr.y+h.y+s))||(n=!1),n&&r.prototype.justifyDataLabel.call(c,u,h,u.alignAttr,e,t),u.attr({x:u.alignAttr.x,y:u.alignAttr.y,rotation:d.rotation,rotationOriginX:e.width/2,rotationOriginY:e.height/2}),a(!n&&d.crop,!0)&&(f=o(u.x)&&o(u.y)&&p.isInsidePlot(u.x-i+u.width,u.y)&&p.isInsidePlot(u.x+i,u.y)),u[f?"show":"hide"]())},t.prototype.adjustStackPosition=function(t){var e=t.labelBox,i={bottom:0,middle:1,top:2,right:1,center:0,left:-1};return{x:e.width/2+e.width/2*i[t.textAlign],y:e.height/2*i[t.verticalAlign]}},t.prototype.getStackBox=function(t){var e=this.axis,i=e.chart,n=t.boxTop,r=t.defaultX,s=t.xOffset,o=t.width,l=t.boxBottom;return n=e.stacking.usePercentage?100:a(n,this.total,0),n=e.toPixels(n),t=a(r,(t.xAxis||i.xAxis[0]).toPixels(this.x))+s,e=e.toPixels(l||0),e=Math.abs(n-e),l=this.isNegative,i.inverted?{x:(l?n:n-e)-i.plotLeft,y:t-i.plotTop,width:e,height:o}:{x:t-i.plotLeft,y:(l?n-e:n)-i.plotTop,width:o,height:e}},t}(),t})),e(i,"Core/Axis/Stacking/StackingAxis.js",[i["Core/Animation/AnimationUtilities.js"],i["Core/Axis/Axis.js"],i["Core/Series/SeriesRegistry.js"],i["Core/Axis/Stacking/StackItem.js"],i["Core/Utilities.js"]],(function(t,e,i,n,r){function s(){var t=this,e=t.inverted;t.yAxis.forEach((function(t){t.stacking&&t.stacking.stacks&&t.hasVisibleSeries&&(t.stacking.oldStacks=t.stacking.stacks)})),t.series.forEach((function(i){var n=i.xAxis&&i.xAxis.options||{};!i.options.stacking||!0!==i.visible&&!1!==t.options.chart.ignoreHiddenSeries||(i.stackKey=[i.type,T(i.options.stack,""),e?n.top:n.left,e?n.height:n.width].join())}))}function a(){var t=this.stacking;if(t){var e=t.stacks;S(e,(function(t,i){b(t),e[i]=null})),t&&t.stackTotalGroup&&t.stackTotalGroup.destroy()}}function o(){"yAxis"!==this.coll||this.stacking||(this.stacking=new E(this))}function l(t,e,i,n){return!y(t)||t.x!==e||n&&t.stackKey!==n?t={x:e,index:0,key:n,stackKey:n}:t.index++,t.key=[i,e,t.index].join(),t}function h(){var t,e=this,i=e.stackKey,n=e.yAxis.stacking.stacks,r=e.processedXData,s=e[e.options.stacking+"Stacker"];s&&[i,"-"+i].forEach((function(i){for(var a,o,l=r.length;l--;)a=r[l],t=e.getStackIndicator(t,a,e.index,i),(o=(a=n[i]&&n[i][a])&&a.points[t.key])&&s.call(e,o,a,l)}))}function c(t,e,i){e=e.total?100/e.total:0,t[0]=v(t[0]*e),t[1]=v(t[1]*e),this.stackedYData[i]=t[1]}function u(){var t=this.yAxis.stacking;this.options.centerInCategory&&(this.is("column")||this.is("columnrange"))&&!this.options.stacking&&1<this.chart.series.length?g.setStackedPoints.call(this,"group"):t&&S(t.stacks,(function(e,i){"group"===i.slice(-5)&&(S(e,(function(t){return t.destroy()})),delete t.stacks[i])}))}function d(t){var e=this.chart,i=t||this.options.stacking;if(i&&(!0===this.visible||!1===e.options.chart.ignoreHiddenSeries)){var r=this.processedXData,s=this.processedYData,a=[],o=s.length,l=this.options,h=l.threshold,c=T(l.startFromThreshold&&h,0);l=l.stack;var u,d,f="-"+(t=t?""+this.type+",".concat(i):this.stackKey),p=this.negStacks,g=(e="group"===i?e.yAxis[0]:this.yAxis).stacking.stacks,m=e.stacking.oldStacks;for(e.stacking.stacksTouched+=1,d=0;d<o;d++){var b=r[d],_=s[d],w=this.getStackIndicator(w,b,this.index),S=w.key,E=(u=p&&_<(c?0:h))?f:t;g[E]||(g[E]={}),g[E][b]||(m[E]&&m[E][b]?(g[E][b]=m[E][b],g[E][b].total=null):g[E][b]=new n(e,e.options.stackLabels,!!u,b,l)),E=g[E][b],null!==_?(E.points[S]=E.points[this.index]=[T(E.cumulative,c)],y(E.cumulative)||(E.base=S),E.touched=e.stacking.stacksTouched,0<w.index&&!1===this.singleStacks&&(E.points[S][0]=E.points[this.index+","+b+",0"][0])):E.points[S]=E.points[this.index]=null,"percent"===i?(u=u?t:f,p&&g[u]&&g[u][b]?(u=g[u][b],E.total=u.total=Math.max(u.total,E.total)+Math.abs(_)||0):E.total=v(E.total+(Math.abs(_)||0))):"group"===i?(x(_)&&(_=_[0]),null!==_&&(E.total=(E.total||0)+1)):E.total=v(E.total+(_||0)),E.cumulative="group"===i?(E.total||1)-1:T(E.cumulative,c)+(_||0),null!==_&&(E.points[S].push(E.cumulative),a[d]=E.cumulative,E.hasValidPoints=!0)}"percent"===i&&(e.stacking.usePercentage=!0),"group"!==i&&(this.stackedYData=a),e.stacking.oldStacks={}}}var f,p=t.getDeferredAnimation,g=i.series.prototype,m=r.addEvent,v=r.correctFloat,y=r.defined,b=r.destroyObjectProperties,_=r.fireEvent,x=r.isArray,w=r.isNumber,S=r.objectEach,T=r.pick,E=function(){function t(t){this.oldStacks={},this.stacks={},this.stacksTouched=0,this.axis=t}return t.prototype.buildStacks=function(){var t,e=this.axis,i=e.series,n=e.options.reversedStacks,r=i.length;for(this.usePercentage=!1,t=r;t--;){var s=i[n?t:r-t-1];s.setStackedPoints(),s.setGroupedPoints()}for(t=0;t<r;t++)i[t].modifyStacks();_(e,"afterBuildStacks")},t.prototype.cleanStacks=function(){if(this.oldStacks)var t=this.stacks=this.oldStacks;S(t,(function(t){S(t,(function(t){t.cumulative=t.total}))}))},t.prototype.resetStacks=function(){var t=this;S(this.stacks,(function(e){S(e,(function(i,n){w(i.touched)&&i.touched<t.stacksTouched?(i.destroy(),delete e[n]):(i.total=null,i.cumulative=null)}))}))},t.prototype.renderStackTotals=function(){var t=this.axis,e=t.chart,i=e.renderer,n=this.stacks;t=p(e,t.options.stackLabels&&t.options.stackLabels.animation||!1);var r=this.stackTotalGroup=this.stackTotalGroup||i.g("stack-labels").attr({zIndex:6,opacity:0}).add();r.translate(e.plotLeft,e.plotTop),S(n,(function(t){S(t,(function(t){t.render(r)}))})),r.animate({opacity:1},t)},t}();return function(t){var e=[];t.compose=function(t,i,n){-1===e.indexOf(t)&&(e.push(t),m(t,"init",o),m(t,"destroy",a)),-1===e.indexOf(i)&&(e.push(i),i.prototype.getStacks=s),-1===e.indexOf(n)&&(e.push(n),(t=n.prototype).getStackIndicator=l,t.modifyStacks=h,t.percentStacker=c,t.setGroupedPoints=u,t.setStackedPoints=d)}}(f||(f={})),f})),e(i,"Series/Line/LineSeries.js",[i["Core/Series/Series.js"],i["Core/Series/SeriesRegistry.js"],i["Core/Utilities.js"]],(function(t,e,i){var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=i.defined,s=i.merge;return i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=void 0,t.options=void 0,t.points=void 0,t}return n(i,e),i.prototype.drawGraph=function(){var t=this,e=this.options,i=(this.gappedPath||this.getGraphPath).call(this),n=this.chart.styledMode,r=[["graph","highcharts-graph"]];n||r[0].push(e.lineColor||this.color||"#cccccc",e.dashStyle),(r=t.getZonesGraphs(r)).forEach((function(r,s){var a=r[0],o=t[a],l=o?"animate":"attr";o?(o.endX=t.preventGraphAnimation?null:i.xMap,o.animate({d:i})):i.length&&(t[a]=o=t.chart.renderer.path(i).addClass(r[1]).attr({zIndex:1}).add(t.group)),o&&!n&&(a={stroke:r[2],"stroke-width":e.lineWidth||0,fill:t.fillGraph&&t.color||"none"},r[3]?a.dashstyle=r[3]:"square"!==e.linecap&&(a["stroke-linecap"]=a["stroke-linejoin"]="round"),o[l](a).shadow(2>s&&e.shadow)),o&&(o.startX=i.xMap,o.isArea=i.isArea)}))},i.prototype.getGraphPath=function(t,e,i){var n,s=this,a=s.options,o=[],l=[],h=a.step,c=(t=t||s.points).reversed;return c&&t.reverse(),(h={right:1,center:2}[h]||h&&3)&&c&&(h=4-h),(t=this.getValidPoints(t,!1,!(a.connectNulls&&!e&&!i))).forEach((function(c,u){var d=c.plotX,f=c.plotY,p=t[u-1];(c.leftCliff||p&&p.rightCliff)&&!i&&(n=!0),c.isNull&&!r(e)&&0<u?n=!a.connectNulls:c.isNull&&!e?n=!0:(0===u||n?u=[["M",c.plotX,c.plotY]]:s.getPointSpline?u=[s.getPointSpline(t,c,u)]:h?(u=1===h?[["L",p.plotX,f]]:2===h?[["L",(p.plotX+d)/2,p.plotY],["L",(p.plotX+d)/2,f]]:[["L",d,p.plotY]]).push(["L",d,f]):u=[["L",d,f]],l.push(c.x),h&&(l.push(c.x),2===h&&l.push(c.x)),o.push.apply(o,u),n=!1)})),o.xMap=l,s.graphPath=o},i.prototype.getZonesGraphs=function(t){return this.zones.forEach((function(e,i){i=["zone-graph-"+i,"highcharts-graph highcharts-zone-graph-"+i+" "+(e.className||"")],this.chart.styledMode||i.push(e.color||this.color,e.dashStyle||this.options.dashStyle),t.push(i)}),this),t},i.defaultOptions=s(t.defaultOptions,{}),i}(t),e.registerSeriesType("line",i),i})),e(i,"Series/Area/AreaSeries.js",[i["Core/Color/Color.js"],i["Core/Legend/LegendSymbol.js"],i["Core/Series/SeriesRegistry.js"],i["Core/Utilities.js"]],(function(t,e,i,n){var r=this&&this.__extends||function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),s=t.parse,a=i.seriesTypes.line;t=n.extend;var o=n.merge,l=n.objectEach,h=n.pick;return n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=void 0,e.options=void 0,e.points=void 0,e}return r(e,t),e.prototype.drawGraph=function(){this.areaPath=[],t.prototype.drawGraph.apply(this);var e=this,i=this.areaPath,n=this.options,r=[["area","highcharts-area",this.color,n.fillColor]];this.zones.forEach((function(t,i){r.push(["zone-area-"+i,"highcharts-area highcharts-zone-area-"+i+" "+t.className,t.color||e.color,t.fillColor||n.fillColor])})),r.forEach((function(t){var r=t[0],a={},o=e[r],l=o?"animate":"attr";o?(o.endX=e.preventGraphAnimation?null:i.xMap,o.animate({d:i})):(a.zIndex=0,(o=e[r]=e.chart.renderer.path(i).addClass(t[1]).add(e.group)).isArea=!0),e.chart.styledMode||(a.fill=h(t[3],s(t[2]).setOpacity(h(n.fillOpacity,.75)).get())),o[l](a),o.startX=i.xMap,o.shiftUnit=n.step?2:1}))},e.prototype.getGraphPath=function(t){var e=a.prototype.getGraphPath,i=this.options,n=i.stacking,r=this.yAxis,s=[],o=[],l=this.index,c=r.stacking.stacks[this.stackKey],u=i.threshold,d=Math.round(r.getThreshold(i.threshold));i=h(i.connectNulls,"percent"===n);var f=function(e,i,a){var h=t[e];e=n&&c[h.x].points[l];var f=h[a+"Null"]||0;if(a=h[a+"Cliff"]||0,h=!0,a||f){var p=(f?e[0]:e[1])+a,g=e[0]+a;h=!!f}else!n&&t[i]&&t[i].isNull&&(p=g=u);void 0!==p&&(o.push({plotX:v,plotY:null===p?d:r.getThreshold(p),isNull:h,isCliff:!0}),s.push({plotX:v,plotY:null===g?d:r.getThreshold(g),doCurve:!1}))};t=t||this.points,n&&(t=this.getStackPoints(t));for(var p=0,g=t.length;p<g;++p){n||(t[p].leftCliff=t[p].rightCliff=t[p].leftNull=t[p].rightNull=void 0);var m=t[p].isNull,v=h(t[p].rectPlotX,t[p].plotX),y=n?h(t[p].yBottom,d):d;m&&!i||(i||f(p,p-1,"left"),m&&!n&&i||(o.push(t[p]),s.push({x:p,plotX:v,plotY:y})),i||f(p,p+1,"right"))}return f=e.call(this,o,!0,!0),s.reversed=!0,(y=(m=e.call(this,s,!0,!0))[0])&&"M"===y[0]&&(m[0]=["L",y[1],y[2]]),(m=f.concat(m)).length&&m.push(["Z"]),e=e.call(this,o,!1,i),m.xMap=f.xMap,this.areaPath=m,e},e.prototype.getStackPoints=function(t){var e=this,i=[],n=[],r=this.xAxis,s=this.yAxis,a=s.stacking.stacks[this.stackKey],o={},c=s.series,u=c.length,d=s.options.reversedStacks?1:-1,f=c.indexOf(e);if(t=t||this.points,this.options.stacking){for(var p=0;p<t.length;p++)t[p].leftNull=t[p].rightNull=void 0,o[t[p].x]=t[p];l(a,(function(t,e){null!==t.total&&n.push(e)})),n.sort((function(t,e){return t-e}));var g=c.map((function(t){return t.visible}));n.forEach((function(t,l){var p,m,v=0;if(o[t]&&!o[t].isNull)i.push(o[t]),[-1,1].forEach((function(i){var r=1===i?"rightNull":"leftNull",s=a[n[l+i]],h=0;if(s)for(var v=f;0<=v&&v<u;){var y=c[v].index;(p=s.points[y])||(y===e.index?o[t][r]=!0:g[v]&&(m=a[t].points[y])&&(h-=m[1]-m[0])),v+=d}o[t][1===i?"rightCliff":"leftCliff"]=h}));else{for(var y=f;0<=y&&y<u;){if(p=a[t].points[c[y].index]){v=p[1];break}y+=d}v=h(v,0),v=s.translate(v,0,1,0,1),i.push({isNull:!0,plotX:r.translate(t,0,0,0,1),x:t,plotY:v,yBottom:v})}}))}return i},e.defaultOptions=o(a.defaultOptions,{threshold:0}),e}(a),t(n.prototype,{singleStacks:!1,drawLegendSymbol:e.drawRectangle}),i.registerSeriesType("area",n),n})),e(i,"Series/Spline/SplineSeries.js",[i["Core/Series/SeriesRegistry.js"],i["Core/Utilities.js"]],(function(t,e){var i=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),n=t.seriesTypes.line,r=e.merge,s=e.pick;return e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=void 0,e.options=void 0,e.points=void 0,e}return i(e,t),e.prototype.getPointSpline=function(t,e,i){var n=e.plotX||0,r=e.plotY||0,a=t[i-1];if(i=t[i+1],a&&!a.isNull&&!1!==a.doCurve&&!e.isCliff&&i&&!i.isNull&&!1!==i.doCurve&&!e.isCliff){t=a.plotY||0;var o=i.plotX||0;i=i.plotY||0;var l=0,h=(1.5*n+(a.plotX||0))/2.5,c=(1.5*r+t)/2.5,u=(1.5*r+i)/2.5;(o=(1.5*n+o)/2.5)!==h&&(l=(u-c)*(o-n)/(o-h)+r-u),u+=l,(c+=l)>t&&c>r?u=2*r-(c=Math.max(t,r)):c<t&&c<r&&(u=2*r-(c=Math.min(t,r))),u>i&&u>r?c=2*r-(u=Math.max(i,r)):u<i&&u<r&&(c=2*r-(u=Math.min(i,r))),e.rightContX=o,e.rightContY=u}return e=["C",s(a.rightContX,a.plotX,0),s(a.rightContY,a.plotY,0),s(h,n,0),s(c,r,0),n,r],a.rightContX=a.rightContY=void 0,e},e.defaultOptions=r(n.defaultOptions),e}(n),t.registerSeriesType("spline",e),e})),e(i,"Series/AreaSpline/AreaSplineSeries.js",[i["Series/Spline/SplineSeries.js"],i["Core/Legend/LegendSymbol.js"],i["Core/Series/SeriesRegistry.js"],i["Core/Utilities.js"]],(function(t,e,i,n){var r=this&&this.__extends||function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),s=i.seriesTypes,a=s.area;s=s.area.prototype;var o=n.extend,l=n.merge;return n=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=void 0,t.points=void 0,t.options=void 0,t}return r(i,e),i.defaultOptions=l(t.defaultOptions,a.defaultOptions),i}(t),o(n.prototype,{getGraphPath:s.getGraphPath,getStackPoints:s.getStackPoints,drawGraph:s.drawGraph,drawLegendSymbol:e.drawRectangle}),i.registerSeriesType("areaspline",n),n})),e(i,"Series/Column/ColumnSeriesDefaults.js",[],(function(){return{borderRadius:0,centerInCategory:!1,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:void 0,verticalAlign:void 0,y:void 0},startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"}})),e(i,"Series/Column/ColumnSeries.js",[i["Core/Animation/AnimationUtilities.js"],i["Core/Color/Color.js"],i["Series/Column/ColumnSeriesDefaults.js"],i["Core/Globals.js"],i["Core/Legend/LegendSymbol.js"],i["Core/Series/Series.js"],i["Core/Series/SeriesRegistry.js"],i["Core/Utilities.js"]],(function(t,e,i,n,r,s,a,o){var l=this&&this.__extends||function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),h=t.animObject,c=e.parse,u=n.hasTouch;t=n.noop;var d=o.clamp,f=o.defined,p=o.extend,g=o.fireEvent,m=o.isArray,v=o.isNumber,y=o.merge,b=o.pick,_=o.objectEach;return o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.borderWidth=void 0,e.data=void 0,e.group=void 0,e.options=void 0,e.points=void 0,e}return l(e,t),e.prototype.animate=function(t){var e=this,i=this.yAxis,n=e.options,r=this.chart.inverted,s={},a=r?"translateX":"translateY";if(t)s.scaleY=.001,t=d(i.toPixels(n.threshold),i.pos,i.pos+i.len),r?s.translateX=t-i.len:s.translateY=t,e.clipBox&&e.setClip(),e.group.attr(s);else{var o=Number(e.group.attr(a));e.group.animate({scaleY:1},p(h(e.options.animation),{step:function(t,n){e.group&&(s[a]=o+n.pos*(i.pos-o),e.group.attr(s))}}))}},e.prototype.init=function(e,i){t.prototype.init.apply(this,arguments);var n=this;(e=n.chart).hasRendered&&e.series.forEach((function(t){t.type===n.type&&(t.isDirty=!0)}))},e.prototype.getColumnMetrics=function(){var t=this,e=t.options,i=t.xAxis,n=t.yAxis,r=i.options.reversedStacks;r=i.reversed&&!r||!i.reversed&&r;var s,a={},o=0;!1===e.grouping?o=1:t.chart.series.forEach((function(e){var i=e.yAxis,r=e.options;if(e.type===t.type&&(e.visible||!t.chart.options.chart.ignoreHiddenSeries)&&n.len===i.len&&n.pos===i.pos){if(r.stacking&&"group"!==r.stacking){s=e.stackKey,void 0===a[s]&&(a[s]=o++);var l=a[s]}else!1!==r.grouping&&(l=o++);e.columnIndex=l}}));var l=Math.min(Math.abs(i.transA)*(i.ordinal&&i.ordinal.slope||e.pointRange||i.closestPointRange||i.tickInterval||1),i.len),h=l*e.groupPadding,c=(l-2*h)/(o||1);return e=Math.min(e.maxPointWidth||i.len,b(e.pointWidth,c*(1-2*e.pointPadding))),t.columnMetrics={width:e,offset:(c-e)/2+(h+((t.columnIndex||0)+(r?1:0))*c-l/2)*(r?-1:1),paddedWidth:c,columnCount:o},t.columnMetrics},e.prototype.crispCol=function(t,e,i,n){var r=this.chart,s=this.borderWidth,a=-(s%2?.5:0);return s=s%2?.5:1,r.inverted&&r.renderer.isVML&&(s+=1),this.options.crisp&&(i=Math.round(t+i)+a,i-=t=Math.round(t)+a),n=Math.round(e+n)+s,a=.5>=Math.abs(e)&&.5<n,n-=e=Math.round(e)+s,a&&n&&(--e,n+=1),{x:t,y:e,width:i,height:n}},e.prototype.adjustForMissingColumns=function(t,e,i,n){var r=this,s=this.options.stacking;if(!i.isNull&&1<n.columnCount){var a=this.yAxis.options.reversedStacks,o=0,l=a?0:-n.columnCount;_(this.yAxis.stacking&&this.yAxis.stacking.stacks,(function(t){if("number"==typeof i.x){var e=t[i.x.toString()];e&&(t=e.points[r.index],s?(t&&(o=l),e.hasValidPoints&&(a?l++:l--)):m(t)&&(t=Object.keys(e.points).filter((function(t){return!t.match(",")&&e.points[t]&&1<e.points[t].length})).map(parseFloat).sort((function(t,e){return e-t})),o=t.indexOf(r.index),l=t.length))}})),t=(i.plotX||0)+((l-1)*n.paddedWidth+e)/2-e-o*n.paddedWidth}return t},e.prototype.translate=function(){var t=this,e=t.chart,i=t.options,n=t.dense=2>t.closestPointRange*t.xAxis.transA;n=t.borderWidth=b(i.borderWidth,n?0:1);var r=t.xAxis,a=t.yAxis,o=i.threshold,l=t.translatedThreshold=a.getThreshold(o),h=b(i.minPointLength,5),c=t.getColumnMetrics(),u=c.width,p=t.pointXOffset=c.offset,g=t.dataMin,m=t.dataMax,y=t.barW=Math.max(u,1+2*n);e.inverted&&(l-=.5),i.pointPadding&&(y=Math.ceil(y)),s.prototype.translate.apply(t),t.points.forEach((function(n){var s=b(n.yBottom,l),_=999+Math.abs(s),x=n.plotX||0;_=d(n.plotY,-_,a.len+_);var w=Math.min(_,s),S=Math.max(_,s)-w,T=u,E=x+p,k=y;h&&Math.abs(S)<h&&(S=h,x=!a.reversed&&!n.negative||a.reversed&&n.negative,v(o)&&v(m)&&n.y===o&&m<=o&&(a.min||0)<o&&(g!==m||(a.max||0)<=o)&&(x=!x),w=Math.abs(w-l)>h?s-h:l-(x?h:0)),f(n.options.pointWidth)&&(T=k=Math.ceil(n.options.pointWidth),E-=Math.round((T-u)/2)),i.centerInCategory&&(E=t.adjustForMissingColumns(E,T,n,c)),n.barX=E,n.pointWidth=T,n.tooltipPos=e.inverted?[d(a.len+a.pos-e.plotLeft-_,a.pos-e.plotLeft,a.len+a.pos-e.plotLeft),r.len+r.pos-e.plotTop-E-k/2,S]:[r.left-e.plotLeft+E+k/2,d(_+a.pos-e.plotTop,a.pos-e.plotTop,a.len+a.pos-e.plotTop),S],n.shapeType=t.pointClass.prototype.shapeType||"rect",n.shapeArgs=t.crispCol.apply(t,n.isNull?[E,l,k,0]:[E,w,k,S])}))},e.prototype.drawGraph=function(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")},e.prototype.pointAttribs=function(t,e){var i=this.options,n=this.pointAttrToOptions||{},r=n.stroke||"borderColor",s=n["stroke-width"]||"borderWidth",a=t&&t.color||this.color,o=t&&t[r]||i[r]||a;n=t&&t.options.dashStyle||i.dashStyle;var l=t&&t[s]||i[s]||this[s]||0,h=b(t&&t.opacity,i.opacity,1);if(t&&this.zones.length){var u=t.getZone();a=t.options.color||u&&(u.color||t.nonZonedColor)||this.color,u&&(o=u.borderColor||o,n=u.dashStyle||n,l=u.borderWidth||l)}return e&&t&&(e=(t=y(i.states[e],t.options.states&&t.options.states[e]||{})).brightness,a=t.color||void 0!==e&&c(a).brighten(t.brightness).get()||a,o=t[r]||o,l=t[s]||l,n=t.dashStyle||n,h=b(t.opacity,h)),r={fill:a,stroke:o,"stroke-width":l,opacity:h},n&&(r.dashstyle=n),r},e.prototype.drawPoints=function(t){void 0===t&&(t=this.points);var e,i=this,n=this.chart,r=i.options,s=n.renderer,a=r.animationLimit||250;t.forEach((function(t){var o=t.graphic,l=!!o,h=o&&n.pointCount<a?"animate":"attr";v(t.plotY)&&null!==t.y?(e=t.shapeArgs,o&&t.hasNewShapeType()&&(o=o.destroy()),i.enabledDataSorting&&(t.startXPos=i.xAxis.reversed?-(e&&e.width||0):i.xAxis.width),o||(t.graphic=o=s[t.shapeType](e).add(t.group||i.group))&&i.enabledDataSorting&&n.hasRendered&&n.pointCount<a&&(o.attr({x:t.startXPos}),l=!0,h="animate"),o&&l&&o[h](y(e)),r.borderRadius&&o[h]({r:r.borderRadius}),n.styledMode||o[h](i.pointAttribs(t,t.selected&&"select")).shadow(!1!==t.allowShadow&&r.shadow,null,r.stacking&&!r.borderRadius),o&&(o.addClass(t.getClassName(),!0),o.attr({visibility:t.visible?"inherit":"hidden"}))):o&&(t.graphic=o.destroy())}))},e.prototype.drawTracker=function(t){void 0===t&&(t=this.points);var e,i=this,n=i.chart,r=n.pointer,s=function(t){var e=r.getPointFromEvent(t);void 0!==e&&(r.isDirectTouch=!0,e.onMouseOver(t))};t.forEach((function(t){e=m(t.dataLabels)?t.dataLabels:t.dataLabel?[t.dataLabel]:[],t.graphic&&(t.graphic.element.point=t),e.forEach((function(e){e.div?e.div.point=t:e.element.point=t}))})),i._hasTracking||(i.trackerGroups.forEach((function(t){i[t]&&(i[t].addClass("highcharts-tracker").on("mouseover",s).on("mouseout",(function(t){r.onTrackerMouseOut(t)})),u&&i[t].on("touchstart",s),!n.styledMode&&i.options.cursor&&i[t].css({cursor:i.options.cursor}))})),i._hasTracking=!0),g(this,"afterDrawTracker")},e.prototype.remove=function(){var t=this,e=t.chart;e.hasRendered&&e.series.forEach((function(e){e.type===t.type&&(e.isDirty=!0)})),s.prototype.remove.apply(t,arguments)},e.defaultOptions=y(s.defaultOptions,i),e}(s),p(o.prototype,{cropShoulder:0,directTouch:!0,drawLegendSymbol:r.drawRectangle,getSymbol:t,negStacks:!0,trackerGroups:["group","dataLabelsGroup"]}),a.registerSeriesType("column",o),o})),e(i,"Core/Series/DataLabel.js",[i["Core/Animation/AnimationUtilities.js"],i["Core/FormatUtilities.js"],i["Core/Utilities.js"]],(function(t,e,i){var n,r=t.getDeferredAnimation,s=e.format,a=i.defined,o=i.extend,l=i.fireEvent,h=i.isArray,c=i.isString,u=i.merge,d=i.objectEach,f=i.pick,p=i.splat;return function(t){function e(t,e,i,n,r){var s=this,l=this.chart,h=this.isCartesian&&l.inverted,c=this.enabledDataSorting,u=t.plotX,d=t.plotY,p=i.rotation,g=i.align,m=a(u)&&a(d)&&l.isInsidePlot(u,Math.round(d),{inverted:h,paneCoordinates:!0,series:s});d=function(i){c&&s.xAxis&&!v&&s.setDataLabelStartPos(t,e,r,m,i)};var v="justify"===f(i.overflow,c?"none":"justify");if(u=this.visible&&!1!==t.visible&&a(u)&&(t.series.forceDL||c&&!v||m||f(i.inside,!!this.options.stacking)&&n&&l.isInsidePlot(u,h?n.x+1:n.y+n.height-1,{inverted:h,paneCoordinates:!0,series:s})),h=t.pos(),u&&h){p&&e.attr({align:g}),g=e.getBBox(!0);var y=[0,0],b=l.renderer.fontMetrics(l.styledMode?void 0:i.style.fontSize,e).b;n=o({x:h[0],y:Math.round(h[1]),width:0,height:0},n),o(i,{width:g.width,height:g.height}),p?(v=!1,y=l.renderer.rotCorr(b,p),b={x:n.x+(i.x||0)+n.width/2+y.x,y:n.y+(i.y||0)+{top:0,middle:.5,bottom:1}[i.verticalAlign]*n.height},y=[g.x-Number(e.attr("x")),g.y-Number(e.attr("y"))],d(b),e[r?"attr":"animate"](b)):(d(n),e.align(i,void 0,n),b=e.alignAttr),v&&0<=n.height?this.justifyDataLabel(e,i,b,g,n,r):f(i.crop,!0)&&(n=b.x,d=b.y,n+=y[0],d+=y[1],u=l.isInsidePlot(n,d,{paneCoordinates:!0,series:s})&&l.isInsidePlot(n+g.width,d+g.height,{paneCoordinates:!0,series:s})),i.shape&&!p&&e[r?"attr":"animate"]({anchorX:h[0],anchorY:h[1]})}r&&c&&(e.placed=!1),u||c&&!v?e.show():(e.hide(),e.placed=!1)}function i(t){void 0===t&&(t=this.points);var e=this,i=e.chart,n=e.options,o=e.hasRendered||0,u=i.renderer,m=i.options.chart,v=m.backgroundColor;m=m.plotBackgroundColor;var y=u.getContrast(c(m)&&m||c(v)&&v||"#000000"),b=n.dataLabels;if(v=b.animation,v=b.defer?r(i,v,e):{defer:0,duration:0},b=g(g(i.options.plotOptions&&i.options.plotOptions.series&&i.options.plotOptions.series.dataLabels,i.options.plotOptions&&i.options.plotOptions[e.type]&&i.options.plotOptions[e.type].dataLabels),b),l(this,"drawDataLabels"),h(b)||b.enabled||e._hasPointLabels){var _=e.plotGroup("dataLabelsGroup","data-labels",o?"inherit":"hidden",b.zIndex||6);_.attr({opacity:+o}),!o&&(o=e.dataLabelsGroup)&&(e.visible&&_.show(),o[n.animation?"animate":"attr"]({opacity:1},v)),t.forEach((function(t){p(g(b,t.dlOptions||t.options&&t.options.dataLabels)).forEach((function(r,o){var l=r.enabled&&(!t.isNull||t.dataLabelOnNull)&&function(t,e){var i=e.filter;return!i||(e=i.operator,t=t[i.property],i=i.value,">"===e&&t>i||"<"===e&&t<i||">="===e&&t>=i||"<="===e&&t<=i||"=="===e&&t==i||"==="===e&&t===i)}(t,r),h=t.connectors?t.connectors[o]:t.connector,c=t.dataLabels?t.dataLabels[o]:t.dataLabel,p=!c,g=f(r.distance,t.labelDistance);if(l){var m=t.getLabelConfig(),v=f(r[t.formatPrefix+"Format"],r.format);m=a(v)?s(v,m,i):(r[t.formatPrefix+"Formatter"]||r.formatter).call(m,r),v=r.style;var b=r.rotation;i.styledMode||(v.color=f(r.color,v.color,e.color,"#000000"),"contrast"===v.color?(t.contrastColor=u.getContrast(t.color||e.color),v.color=!a(g)&&r.inside||0>g||n.stacking?t.contrastColor:y):delete t.contrastColor,n.cursor&&(v.cursor=n.cursor));var x={r:r.borderRadius||0,rotation:b,padding:r.padding,zIndex:1};if(!i.styledMode){g=r.backgroundColor;var w=r.borderColor;x.fill="auto"===g?t.color:g,x.stroke="auto"===w?t.color:w,x["stroke-width"]=r.borderWidth}d(x,(function(t,e){void 0===t&&delete x[e]}))}!c||l&&a(m)&&!!c.div==!!r.useHTML&&(c.rotation&&r.rotation||c.rotation===r.rotation)||(p=!0,t.dataLabel=c=t.dataLabel&&t.dataLabel.destroy(),t.dataLabels&&(1===t.dataLabels.length?delete t.dataLabels:delete t.dataLabels[o]),o||delete t.dataLabel,h&&(t.connector=t.connector.destroy(),t.connectors&&(1===t.connectors.length?delete t.connectors:delete t.connectors[o]))),l&&a(m)?(c?x.text=m:(t.dataLabels=t.dataLabels||[],c=t.dataLabels[o]=b?u.text(m,0,0,r.useHTML).addClass("highcharts-data-label"):u.label(m,0,0,r.shape,null,null,r.useHTML,null,"data-label"),o||(t.dataLabel=c),c.addClass(" highcharts-data-label-color-"+t.colorIndex+" "+(r.className||"")+(r.useHTML?" highcharts-tracker":""))),c.options=r,c.attr(x),i.styledMode||c.css(v).shadow(r.shadow),(o=r[t.formatPrefix+"TextPath"]||r.textPath)&&!r.useHTML&&(c.setTextPath(t.getDataLabelPath&&t.getDataLabelPath(c)||t.graphic,o),t.dataLabelPath&&!o.enabled&&(t.dataLabelPath=t.dataLabelPath.destroy())),c.added||c.add(_),e.alignDataLabel(t,c,r,null,p)):c&&c.hide()}))}))}l(this,"afterDrawDataLabels")}function n(t,e,i,n,r,s){var a=this.chart,o=e.align,l=e.verticalAlign,h=t.box?0:t.padding||0,c=e.x;c=void 0===c?0:c;var u=e.y;u=void 0===u?0:u;var d=(i.x||0)+h;if(0>d){"right"===o&&0<=c?(e.align="left",e.inside=!0):c-=d;var f=!0}return(d=(i.x||0)+n.width-h)>a.plotWidth&&("left"===o&&0>=c?(e.align="right",e.inside=!0):c+=a.plotWidth-d,f=!0),0>(d=i.y+h)&&("bottom"===l&&0<=u?(e.verticalAlign="top",e.inside=!0):u-=d,f=!0),(d=(i.y||0)+n.height-h)>a.plotHeight&&("top"===l&&0>=u?(e.verticalAlign="bottom",e.inside=!0):u+=a.plotHeight-d,f=!0),f&&(e.x=c,e.y=u,t.placed=!s,t.align(e,void 0,r)),f}function g(t,e){var i,n=[];if(h(t)&&!h(e))n=t.map((function(t){return u(t,e)}));else if(h(e)&&!h(t))n=e.map((function(e){return u(t,e)}));else if(h(t)||h(e))for(i=Math.max(t.length,e.length);i--;)n[i]=u(t[i],e[i]);else n=u(t,e);return n}function m(t,e,i,n,r){var s=this.chart,a=s.inverted,o=this.xAxis,l=o.reversed,h=a?e.height/2:e.width/2;t=(t=t.pointWidth)?t/2:0,e.startXPos=a?r.x:l?-h-t:o.width-h+t,e.startYPos=a?l?this.yAxis.height-h+t:-h-t:r.y,n?"hidden"===e.visibility&&(e.show(),e.attr({opacity:0}).animate({opacity:1})):e.attr({opacity:1}).animate({opacity:0},void 0,e.hide),s.hasRendered&&(i&&e.attr({x:e.startXPos,y:e.startYPos}),e.placed=!0)}var v=[];t.compose=function(t){if(-1===v.indexOf(t)){var r=t.prototype;v.push(t),r.alignDataLabel=e,r.drawDataLabels=i,r.justifyDataLabel=n,r.setDataLabelStartPos=m}}}(n||(n={})),n})),e(i,"Series/Column/ColumnDataLabel.js",[i["Core/Series/DataLabel.js"],i["Core/Series/SeriesRegistry.js"],i["Core/Utilities.js"]],(function(t,e,i){var n,r=e.series,s=i.merge,a=i.pick;return function(e){function i(t,e,i,n,o){var l=this.chart.inverted,h=t.series,c=(h.xAxis?h.xAxis.len:this.chart.plotSizeX)||0;h=(h.yAxis?h.yAxis.len:this.chart.plotSizeY)||0;var u=t.dlBox||t.shapeArgs,d=a(t.below,t.plotY>a(this.translatedThreshold,h)),f=a(i.inside,!!this.options.stacking);u&&(0>(n=s(u)).y&&(n.height+=n.y,n.y=0),0<(u=n.y+n.height-h)&&u<n.height&&(n.height-=u),l&&(n={x:h-n.y-n.height,y:c-n.x-n.width,width:n.height,height:n.width}),f||(l?(n.x+=d?0:n.width,n.width=0):(n.y+=d?n.height:0,n.height=0))),i.align=a(i.align,!l||f?"center":d?"right":"left"),i.verticalAlign=a(i.verticalAlign,l||f?"middle":d?"top":"bottom"),r.prototype.alignDataLabel.call(this,t,e,i,n,o),i.inside&&t.contrastColor&&e.css({color:t.contrastColor})}var n=[];e.compose=function(e){t.compose(r),-1===n.indexOf(e)&&(n.push(e),e.prototype.alignDataLabel=i)}}(n||(n={})),n})),e(i,"Series/Bar/BarSeries.js",[i["Series/Column/ColumnSeries.js"],i["Core/Series/SeriesRegistry.js"],i["Core/Utilities.js"]],(function(t,e,i){var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=i.extend,s=i.merge;return i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=void 0,t.options=void 0,t.points=void 0,t}return n(i,e),i.defaultOptions=s(t.defaultOptions,{}),i}(t),r(i.prototype,{inverted:!0}),e.registerSeriesType("bar",i),i})),e(i,"Series/Scatter/ScatterSeriesDefaults.js",[],(function(){return{lineWidth:0,findNearestPointBy:"xy",jitter:{x:0,y:0},marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">●</span> <span style="font-size: 10px"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}}})),e(i,"Series/Scatter/ScatterSeries.js",[i["Series/Scatter/ScatterSeriesDefaults.js"],i["Core/Series/SeriesRegistry.js"],i["Core/Utilities.js"]],(function(t,e,i){var n=this&&this.__extends||function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=e.seriesTypes,s=r.column,a=r.line;r=i.addEvent;var o=i.extend,l=i.merge;return i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=void 0,t.options=void 0,t.points=void 0,t}return n(i,e),i.prototype.applyJitter=function(){var t=this,e=this.options.jitter,i=this.points.length;e&&this.points.forEach((function(n,r){["x","y"].forEach((function(s,a){var o="plot"+s.toUpperCase();if(e[s]&&!n.isNull){var l=t[s+"Axis"],h=e[s]*l.transA;if(l&&!l.isLog){var c=Math.max(0,n[o]-h);l=Math.min(l.len,n[o]+h),a=1e4*Math.sin(r+a*i),n[o]=c+(l-c)*(a-Math.floor(a)),"x"===s&&(n.clientX=n.plotX)}}}))}))},i.prototype.drawGraph=function(){this.options.lineWidth?e.prototype.drawGraph.call(this):this.graph&&(this.graph=this.graph.destroy())},i.defaultOptions=l(a.defaultOptions,t),i}(a),o(i.prototype,{drawTracker:s.prototype.drawTracker,sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1}),r(i,"afterTranslate",(function(){this.applyJitter()})),e.registerSeriesType("scatter",i),i})),e(i,"Series/CenteredUtilities.js",[i["Core/Globals.js"],i["Core/Series/Series.js"],i["Core/Utilities.js"]],(function(t,e,i){var n,r=t.deg2rad,s=i.fireEvent,a=i.isNumber,o=i.pick,l=i.relativeLength;return function(t){t.getCenter=function(){var t=this.options,i=this.chart,n=2*(t.slicedOffset||0),r=i.plotWidth-2*n,h=i.plotHeight-2*n,c=t.center,u=Math.min(r,h),d=t.thickness,f=t.size,p=t.innerSize||0;for("string"==typeof f&&(f=parseFloat(f)),"string"==typeof p&&(p=parseFloat(p)),t=[o(c[0],"50%"),o(c[1],"50%"),o(f&&0>f?void 0:t.size,"100%"),o(p&&0>p?void 0:t.innerSize||0,"0%")],!i.angular||this instanceof e||(t[3]=0),c=0;4>c;++c)f=t[c],i=2>c||2===c&&/%$/.test(f),t[c]=l(f,[r,h,u,t[2]][c])+(i?n:0);return t[3]>t[2]&&(t[3]=t[2]),a(d)&&2*d<t[2]&&0<d&&(t[3]=t[2]-2*d),s(this,"afterGetCenter",{positions:t}),t},t.getStartAndEndRadians=function(t,e){return t=a(t)?t:0,e=a(e)&&e>t&&360>e-t?e:t+360,{start:r*(t+-90),end:r*(e+-90)}}}(n||(n={})),n})),e(i,"Series/Pie/PiePoint.js",[i["Core/Animation/AnimationUtilities.js"],i["Core/Series/Point.js"],i["Core/Utilities.js"]],(function(t,e,i){var n=this&&this.__extends||function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),r=t.setAnimation,s=i.addEvent,a=i.defined;t=i.extend;var o=i.isNumber,l=i.pick,h=i.relativeLength;return e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelDistance=void 0,e.options=void 0,e.series=void 0,e}return n(e,t),e.prototype.getConnectorPath=function(){var t=this.labelPosition,e=this.series.options.dataLabels,i=this.connectorShapes,n=e.connectorShape;return i[n]&&(n=i[n]),n.call(this,{x:t.final.x,y:t.final.y,alignment:t.alignment},t.connectorPosition,e)},e.prototype.getTranslate=function(){return this.sliced?this.slicedTranslation:{translateX:0,translateY:0}},e.prototype.haloPath=function(t){var e=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(e.x,e.y,e.r+t,e.r+t,{innerR:e.r-1,start:e.start,end:e.end})},e.prototype.init=function(){var e=this;t.prototype.init.apply(this,arguments),this.name=l(this.name,"Slice");var i=function(t){e.slice("select"===t.type)};return s(this,"select",i),s(this,"unselect",i),this},e.prototype.isValid=function(){return o(this.y)&&0<=this.y},e.prototype.setVisible=function(t,e){var i=this,n=this.series,r=n.chart,s=n.options.ignoreHiddenPoint;e=l(e,s),t!==this.visible&&(this.visible=this.options.visible=t=void 0===t?!this.visible:t,n.options.data[n.data.indexOf(this)]=this.options,["graphic","dataLabel","connector","shadowGroup"].forEach((function(e){i[e]&&i[e][t?"show":"hide"](t)})),this.legendItem&&r.legend.colorizeItem(this,t),t||"hover"!==this.state||this.setState(""),s&&(n.isDirty=!0),e&&r.redraw())},e.prototype.slice=function(t,e,i){var n=this.series;r(i,n.chart),l(e,!0),this.sliced=this.options.sliced=a(t)?t:!this.sliced,n.options.data[n.data.indexOf(this)]=this.options,this.graphic&&this.graphic.animate(this.getTranslate()),this.shadowGroup&&this.shadowGroup.animate(this.getTranslate())},e}(e),t(e.prototype,{connectorShapes:{fixedOffset:function(t,e,i){var n=e.breakAt;return e=e.touchingSliceAt,[["M",t.x,t.y],i.softConnector?["C",t.x+("left"===t.alignment?-5:5),t.y,2*n.x-e.x,2*n.y-e.y,n.x,n.y]:["L",n.x,n.y],["L",e.x,e.y]]},straight:function(t,e){return e=e.touchingSliceAt,[["M",t.x,t.y],["L",e.x,e.y]]},crookedLine:function(t,e,i){e=e.touchingSliceAt;var n=this.series,r=n.center[0],s=n.chart.plotWidth,a=n.chart.plotLeft;n=t.alignment;var o=this.shapeArgs.r;return i=h(i.crookDistance,1),i=["L",s="left"===n?r+o+(s+a-r-o)*(1-i):a+(r-o)*i,t.y],r=!0,("left"===n?s>t.x||s<e.x:s<t.x||s>e.x)&&(r=!1),t=[["M",t.x,t.y]],r&&t.push(i),t.push(["L",e.x,e.y]),t}}}),e})),e(i,"Series/Pie/PieSeriesDefaults.js",[],(function(){return{center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{allowOverlap:!0,connectorPadding:5,connectorShape:"fixedOffset",crookDistance:"70%",distance:30,enabled:!0,formatter:function(){return this.point.isNull?void 0:this.point.name},softConnector:!0,x:0},fillColor:void 0,ignoreHiddenPoint:!0,inactiveOtherPoints:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,lineWidth:void 0,states:{hover:{brightness:.1}}}})),e(i,"Series/Pie/PieSeries.js",[i["Series/CenteredUtilities.js"],i["Series/Column/ColumnSeries.js"],i["Core/Globals.js"],i["Core/Legend/LegendSymbol.js"],i["Series/Pie/PiePoint.js"],i["Series/Pie/PieSeriesDefaults.js"],i["Core/Series/Series.js"],i["Core/Series/SeriesRegistry.js"],i["Core/Renderer/SVG/Symbols.js"],i["Core/Utilities.js"]],(function(t,e,i,n,r,s,a,o,l,h){var c=this&&this.__extends||function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),u=t.getStartAndEndRadians;i=i.noop;var d=h.clamp,f=h.extend,p=h.fireEvent,g=h.merge,m=h.pick,v=h.relativeLength;return h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.center=void 0,e.data=void 0,e.maxLabelDistance=void 0,e.options=void 0,e.points=void 0,e}return c(e,t),e.prototype.animate=function(t){var e=this,i=e.points,n=e.startAngleRad;t||i.forEach((function(t){var i=t.graphic,r=t.shapeArgs;i&&r&&(i.attr({r:m(t.startR,e.center&&e.center[3]/2),start:n,end:n}),i.animate({r:r.r,start:r.start,end:r.end},e.options.animation))}))},e.prototype.drawEmpty=function(){var t=this.startAngleRad,e=this.endAngleRad,i=this.options;if(0===this.total&&this.center){var n=this.center[0],r=this.center[1];this.graph||(this.graph=this.chart.renderer.arc(n,r,this.center[1]/2,0,t,e).addClass("highcharts-empty-series").add(this.group)),this.graph.attr({d:l.arc(n,r,this.center[2]/2,0,{start:t,end:e,innerR:this.center[3]/2})}),this.chart.styledMode||this.graph.attr({"stroke-width":i.borderWidth,fill:i.fillColor||"none",stroke:i.color||"#cccccc"})}else this.graph&&(this.graph=this.graph.destroy())},e.prototype.drawPoints=function(){var t=this.chart.renderer;this.points.forEach((function(e){e.graphic&&e.hasNewShapeType()&&(e.graphic=e.graphic.destroy()),e.graphic||(e.graphic=t[e.shapeType](e.shapeArgs).add(e.series.group),e.delayedRendering=!0)}))},e.prototype.generatePoints=function(){t.prototype.generatePoints.call(this),this.updateTotals()},e.prototype.getX=function(t,e,i){var n=this.center,r=this.radii?this.radii[i.index]||0:n[2]/2;return t=Math.asin(d((t-n[1])/(r+i.labelDistance),-1,1)),n[0]+(e?-1:1)*Math.cos(t)*(r+i.labelDistance)+(0<i.labelDistance?(e?-1:1)*this.options.dataLabels.padding:0)},e.prototype.hasData=function(){return!!this.processedXData.length},e.prototype.redrawPoints=function(){var t,e,i,n,r=this,s=r.chart,a=s.renderer,o=r.options.shadow;this.drawEmpty(),!o||r.shadowGroup||s.styledMode||(r.shadowGroup=a.g("shadow").attr({zIndex:-1}).add(r.group)),r.points.forEach((function(l){var h={};if(e=l.graphic,!l.isNull&&e){var c=void 0;n=l.shapeArgs,t=l.getTranslate(),s.styledMode||(c=l.shadowGroup,o&&!c&&(c=l.shadowGroup=a.g("shadow").add(r.shadowGroup)),c&&c.attr(t),i=r.pointAttribs(l,l.selected&&"select")),l.delayedRendering?(e.setRadialReference(r.center).attr(n).attr(t),s.styledMode||e.attr(i).attr({"stroke-linejoin":"round"}).shadow(o,c),l.delayedRendering=!1):(e.setRadialReference(r.center),s.styledMode||g(!0,h,i),g(!0,h,n,t),e.animate(h)),e.attr({visibility:l.visible?"inherit":"hidden"}),e.addClass(l.getClassName(),!0)}else e&&(l.graphic=e.destroy())}))},e.prototype.sortByAngle=function(t,e){t.sort((function(t,i){return void 0!==t.angle&&(i.angle-t.angle)*e}))},e.prototype.translate=function(t){p(this,"translate"),this.generatePoints();var e=this.options,i=e.slicedOffset,n=i+(e.borderWidth||0),r=u(e.startAngle,e.endAngle),s=this.startAngleRad=r.start;r=(this.endAngleRad=r.end)-s;var a=this.points,o=e.dataLabels.distance;e=e.ignoreHiddenPoint;var l,h=a.length,c=0;for(t||(this.center=t=this.getCenter()),l=0;l<h;l++){var d=a[l],f=s+c*r;!d.isValid()||e&&!d.visible||(c+=d.percentage/100);var g=s+c*r,y={x:t[0],y:t[1],r:t[2]/2,innerR:t[3]/2,start:Math.round(1e3*f)/1e3,end:Math.round(1e3*g)/1e3};d.shapeType="arc",d.shapeArgs=y,d.labelDistance=m(d.options.dataLabels&&d.options.dataLabels.distance,o),d.labelDistance=v(d.labelDistance,y.r),this.maxLabelDistance=Math.max(this.maxLabelDistance||0,d.labelDistance),(g=(g+f)/2)>1.5*Math.PI?g-=2*Math.PI:g<-Math.PI/2&&(g+=2*Math.PI),d.slicedTranslation={translateX:Math.round(Math.cos(g)*i),translateY:Math.round(Math.sin(g)*i)},y=Math.cos(g)*t[2]/2;var b=Math.sin(g)*t[2]/2;d.tooltipPos=[t[0]+.7*y,t[1]+.7*b],d.half=g<-Math.PI/2||g>Math.PI/2?1:0,d.angle=g,f=Math.min(n,d.labelDistance/5),d.labelPosition={natural:{x:t[0]+y+Math.cos(g)*d.labelDistance,y:t[1]+b+Math.sin(g)*d.labelDistance},final:{},alignment:0>d.labelDistance?"center":d.half?"right":"left",connectorPosition:{breakAt:{x:t[0]+y+Math.cos(g)*f,y:t[1]+b+Math.sin(g)*f},touchingSliceAt:{x:t[0]+y,y:t[1]+b}}}}p(this,"afterTranslate")},e.prototype.updateTotals=function(){var t,e=this.points,i=e.length,n=this.options.ignoreHiddenPoint,r=0;for(t=0;t<i;t++){var s=e[t];!s.isValid()||n&&!s.visible||(r+=s.y)}for(this.total=r,t=0;t<i;t++)(s=e[t]).percentage=0<r&&(s.visible||!n)?s.y/r*100:0,s.total=r},e.defaultOptions=g(a.defaultOptions,s),e}(a),f(h.prototype,{axisTypes:[],directTouch:!0,drawGraph:void 0,drawLegendSymbol:n.drawRectangle,drawTracker:e.prototype.drawTracker,getCenter:t.getCenter,getSymbol:i,isCartesian:!1,noSharedTooltip:!0,pointAttribs:e.prototype.pointAttribs,pointClass:r,requireSorting:!1,searchPoint:i,trackerGroups:["group","dataLabelsGroup"]}),o.registerSeriesType("pie",h),h})),e(i,"Series/Pie/PieDataLabel.js",[i["Core/Series/DataLabel.js"],i["Core/Globals.js"],i["Core/Renderer/RendererUtilities.js"],i["Core/Series/SeriesRegistry.js"],i["Core/Utilities.js"]],(function(t,e,i,n,r){var s,a=e.noop,o=i.distribute,l=n.series,h=r.arrayMax,c=r.clamp,u=r.defined,d=r.merge,f=r.pick,p=r.relativeLength;return function(e){function i(){var t,e,i,n,r,s,a,c,p,g,m,v,y=this,b=y.data,_=y.chart,x=y.options.dataLabels||{},w=x.connectorPadding,S=_.plotWidth,T=_.plotHeight,E=_.plotLeft,k=Math.round(_.chartWidth/3),C=y.center,M=C[2]/2,A=C[1],O=[[],[]],P=[0,0,0,0],R=y.dataLabelPositioners;y.visible&&(x.enabled||y._hasPointLabels)&&(b.forEach((function(t){t.dataLabel&&t.visible&&t.dataLabel.shortened&&(t.dataLabel.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),t.dataLabel.shortened=!1)})),l.prototype.drawDataLabels.apply(y),b.forEach((function(t){t.dataLabel&&(t.visible?(O[t.half].push(t),t.dataLabel._pos=null,!u(x.style.width)&&!u(t.options.dataLabels&&t.options.dataLabels.style&&t.options.dataLabels.style.width)&&t.dataLabel.getBBox().width>k&&(t.dataLabel.css({width:Math.round(.7*k)+"px"}),t.dataLabel.shortened=!0)):(t.dataLabel=t.dataLabel.destroy(),t.dataLabels&&1===t.dataLabels.length&&delete t.dataLabels))})),O.forEach((function(e,i){var l,h=e.length,d=[];if(h){if(y.sortByAngle(e,i-.5),0<y.maxLabelDistance){var b=Math.max(0,A-M-y.maxLabelDistance),k=Math.min(A+M+y.maxLabelDistance,_.plotHeight);e.forEach((function(t){0<t.labelDistance&&t.dataLabel&&(t.top=Math.max(0,A-M-t.labelDistance),t.bottom=Math.min(A+M+t.labelDistance,_.plotHeight),l=t.dataLabel.getBBox().height||21,t.distributeBox={target:t.labelPosition.natural.y-t.top+l/2,size:l,rank:t.y},d.push(t.distributeBox))})),o(d,b=k+l-b,b/5)}for(m=0;m<h;m++){if(t=e[m],s=t.labelPosition,n=t.dataLabel,g=!1===t.visible?"hidden":"inherit",p=b=s.natural.y,d&&u(t.distributeBox)&&(void 0===t.distributeBox.pos?g="hidden":(a=t.distributeBox.size,p=R.radialDistributionY(t))),delete t.positionIndex,x.justify)c=R.justify(t,M,C);else switch(x.alignTo){case"connectors":c=R.alignToConnectors(e,i,S,E);break;case"plotEdges":c=R.alignToPlotEdges(n,i,S,E);break;default:c=R.radialDistributionX(y,t,p,b)}n._attr={visibility:g,align:s.alignment},v=t.options.dataLabels||{},n._pos={x:c+f(v.x,x.x)+({left:w,right:-w}[s.alignment]||0),y:p+f(v.y,x.y)-10},s.final.x=c,s.final.y=p,f(x.crop,!0)&&(r=n.getBBox().width,b=null,c-r<w&&1===i?(b=Math.round(r-c+w),P[3]=Math.max(b,P[3])):c+r>S-w&&0===i&&(b=Math.round(c+r-S+w),P[1]=Math.max(b,P[1])),0>p-a/2?P[0]=Math.max(Math.round(a/2-p),P[0]):p+a/2>T&&(P[2]=Math.max(Math.round(p+a/2-T),P[2])),n.sideOverflow=b)}}})),0===h(P)||this.verifyDataLabelOverflow(P))&&(this.placeDataLabels(),this.points.forEach((function(t){var r;v=d(x,t.options.dataLabels),(e=f(v.connectorWidth,1))&&(i=t.connector,(n=t.dataLabel)&&n._pos&&t.visible&&0<t.labelDistance?(g=n._attr.visibility,(r=!i)&&(t.connector=i=_.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+t.colorIndex+(t.className?" "+t.className:"")).add(y.dataLabelsGroup),_.styledMode||i.attr({"stroke-width":e,stroke:v.connectorColor||t.color||"#666666"})),i[r?"attr":"animate"]({d:t.getConnectorPath()}),i.attr("visibility",g)):i&&(t.connector=i.destroy()))})))}function n(){this.points.forEach((function(t){var e,i=t.dataLabel;i&&t.visible&&((e=i._pos)?(i.sideOverflow&&(i._attr.width=Math.max(i.getBBox().width-i.sideOverflow,0),i.css({width:i._attr.width+"px",textOverflow:(this.options.dataLabels.style||{}).textOverflow||"ellipsis"}),i.shortened=!0),i.attr(i._attr),i[i.moved?"animate":"attr"](e),i.moved=!0):i&&i.attr({y:-9999})),delete t.distributeBox}),this)}function r(t){var e=this.center,i=this.options,n=i.center,r=i.minSize||80,s=null!==i.size;if(!s){if(null!==n[0])var a=Math.max(e[2]-Math.max(t[1],t[3]),r);else a=Math.max(e[2]-t[1]-t[3],r),e[0]+=(t[3]-t[1])/2;null!==n[1]?a=c(a,r,e[2]-Math.max(t[0],t[2])):(a=c(a,r,e[2]-t[0]-t[2]),e[1]+=(t[0]-t[2])/2),a<e[2]?(e[2]=a,e[3]=Math.min(i.thickness?Math.max(0,a-2*i.thickness):Math.max(0,p(i.innerSize||0,a)),a),this.translate(e),this.drawDataLabels&&this.drawDataLabels()):s=!0}return s}var s=[],g={radialDistributionY:function(t){return t.top+t.distributeBox.pos},radialDistributionX:function(t,e,i,n){return t.getX(i<e.top+2||i>e.bottom-2?n:i,e.half,e)},justify:function(t,e,i){return i[0]+(t.half?-1:1)*(e+t.labelDistance)},alignToPlotEdges:function(t,e,i,n){return t=t.getBBox().width,e?t+n:i-t-n},alignToConnectors:function(t,e,i,n){var r,s=0;return t.forEach((function(t){(r=t.dataLabel.getBBox().width)>s&&(s=r)})),e?s+n:i-s-n}};e.compose=function(e){t.compose(l),-1===s.indexOf(e)&&(s.push(e),(e=e.prototype).dataLabelPositioners=g,e.alignDataLabel=a,e.drawDataLabels=i,e.placeDataLabels=n,e.verifyDataLabelOverflow=r)}}(s||(s={})),s})),e(i,"Extensions/OverlappingDataLabels.js",[i["Core/Chart/Chart.js"],i["Core/Utilities.js"]],(function(t,e){function i(t,e){var i=!1;if(t){var n=t.newOpacity;t.oldOpacity!==n&&(t.alignAttr&&t.placed?(t[n?"removeClass":"addClass"]("highcharts-data-label-hidden"),i=!0,t.alignAttr.opacity=n,t[t.isOld?"animate":"attr"](t.alignAttr,null,(function(){e.styledMode||t.css({pointerEvents:n?"auto":"none"})})),r(e,"afterHideOverlappingLabel")):t.attr({opacity:n})),t.isOld=!0}return i}var n=e.addEvent,r=e.fireEvent,s=e.isArray,a=e.isNumber,o=e.objectEach,l=e.pick;n(t,"render",(function(){var t=this,e=[];(this.labelCollectors||[]).forEach((function(t){e=e.concat(t())})),(this.yAxis||[]).forEach((function(t){t.stacking&&t.options.stackLabels&&!t.options.stackLabels.allowOverlap&&o(t.stacking.stacks,(function(t){o(t,(function(t){t.label&&e.push(t.label)}))}))})),(this.series||[]).forEach((function(n){var r=n.options.dataLabels;n.visible&&(!1!==r.enabled||n._hasPointLabels)&&(r=function(n){return n.forEach((function(n){n.visible&&(s(n.dataLabels)?n.dataLabels:n.dataLabel?[n.dataLabel]:[]).forEach((function(r){var s=r.options;r.labelrank=l(s.labelrank,n.labelrank,n.shapeArgs&&n.shapeArgs.height),s.allowOverlap?(r.oldOpacity=r.opacity,r.newOpacity=1,i(r,t)):e.push(r)}))}))},r(n.nodes||[]),r(n.points))})),this.hideOverlappingLabels(e)})),t.prototype.hideOverlappingLabels=function(t){var e,n,s,o=this,l=t.length,h=o.renderer,c=!1,u=function(t){var e,i,n=t.box?0:t.padding||0,r=e=0;if(t&&(!t.alignAttr||t.placed)){var s=t.alignAttr||{x:t.attr("x"),y:t.attr("y")},o=t.parentGroup;t.width||(e=t.getBBox(),t.width=e.width,t.height=e.height,e=h.fontMetrics(null,t.element).h);var l=t.width-2*n;return(i={left:"0",center:"0.5",right:"1"}[t.alignValue])?r=+i*l:a(t.x)&&Math.round(t.x)!==t.translateX&&(r=t.x-t.translateX),{x:s.x+(o.translateX||0)+n-(r||0),y:s.y+(o.translateY||0)+n-e,width:t.width-2*n,height:t.height-2*n}}};for(n=0;n<l;n++)(e=t[n])&&(e.oldOpacity=e.opacity,e.newOpacity=1,e.absoluteBox=u(e));for(t.sort((function(t,e){return(e.labelrank||0)-(t.labelrank||0)})),n=0;n<l;n++){var d=(u=t[n])&&u.absoluteBox;for(e=n+1;e<l;++e){var f=(s=t[e])&&s.absoluteBox;!d||!f||u===s||0===u.newOpacity||0===s.newOpacity||"hidden"===u.visibility||"hidden"===s.visibility||f.x>=d.x+d.width||f.x+f.width<=d.x||f.y>=d.y+d.height||f.y+f.height<=d.y||((u.labelrank<s.labelrank?u:s).newOpacity=0)}}t.forEach((function(t){i(t,o)&&(c=!0)})),c&&r(o,"afterHideAllOverlappingLabels")}})),e(i,"Core/Responsive.js",[i["Core/Utilities.js"]],(function(t){var e,i=t.extend,n=t.find,r=t.isArray,s=t.isObject,a=t.merge,o=t.objectEach,l=t.pick,h=t.splat,c=t.uniqueKey;return function(t){var e=[];t.compose=function(t){return-1===e.indexOf(t)&&(e.push(t),i(t.prototype,u.prototype)),t};var u=function(){function t(){}return t.prototype.currentOptions=function(t){var e=this,i={};return function t(i,n,a,l){var c;o(i,(function(i,o){if(!l&&-1<e.collectionsWithUpdate.indexOf(o)&&n[o])for(i=h(i),a[o]=[],c=0;c<Math.max(i.length,n[o].length);c++)n[o][c]&&(void 0===i[c]?a[o][c]=n[o][c]:(a[o][c]={},t(i[c],n[o][c],a[o][c],l+1)));else s(i)?(a[o]=r(i)?[]:{},t(i,n[o]||{},a[o],l+1)):a[o]=void 0===n[o]?null:n[o]}))}(t,this.options,i,0),i},t.prototype.matchResponsiveRule=function(t,e){var i=t.condition;(i.callback||function(){return this.chartWidth<=l(i.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=l(i.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=l(i.minWidth,0)&&this.chartHeight>=l(i.minHeight,0)}).call(this)&&e.push(t._id)},t.prototype.setResponsive=function(t,e){var i=this,r=this.options.responsive,s=this.currentResponsive,o=[];!e&&r&&r.rules&&r.rules.forEach((function(t){void 0===t._id&&(t._id=c()),i.matchResponsiveRule(t,o)}),this),e=a.apply(void 0,o.map((function(t){return n((r||{}).rules||[],(function(e){return e._id===t}))})).map((function(t){return t&&t.chartOptions}))),e.isResponsiveOptions=!0,(o=o.toString()||void 0)!==(s&&s.ruleIds)&&(s&&this.update(s.undoOptions,t,!0),o?((s=this.currentOptions(e)).isResponsiveOptions=!0,this.currentResponsive={ruleIds:o,mergedOptions:e,undoOptions:s},this.update(e,t,!0)):this.currentResponsive=void 0)},t}()}(e||(e={})),e})),e(i,"masters/highcharts.src.js",[i["Core/Globals.js"],i["Core/Utilities.js"],i["Core/Defaults.js"],i["Core/Animation/Fx.js"],i["Core/Animation/AnimationUtilities.js"],i["Core/Renderer/HTML/AST.js"],i["Core/FormatUtilities.js"],i["Core/Renderer/RendererUtilities.js"],i["Core/Renderer/SVG/SVGElement.js"],i["Core/Renderer/SVG/SVGRenderer.js"],i["Core/Renderer/HTML/HTMLElement.js"],i["Core/Renderer/HTML/HTMLRenderer.js"],i["Core/Axis/Axis.js"],i["Core/Axis/DateTimeAxis.js"],i["Core/Axis/LogarithmicAxis.js"],i["Core/Axis/PlotLineOrBand/PlotLineOrBand.js"],i["Core/Axis/Tick.js"],i["Core/Tooltip.js"],i["Core/Series/Point.js"],i["Core/Pointer.js"],i["Core/MSPointer.js"],i["Core/Legend/Legend.js"],i["Core/Chart/Chart.js"],i["Core/Axis/Stacking/StackingAxis.js"],i["Core/Axis/Stacking/StackItem.js"],i["Core/Series/Series.js"],i["Core/Series/SeriesRegistry.js"],i["Series/Column/ColumnSeries.js"],i["Series/Column/ColumnDataLabel.js"],i["Series/Pie/PieSeries.js"],i["Series/Pie/PieDataLabel.js"],i["Core/Series/DataLabel.js"],i["Core/Responsive.js"],i["Core/Color/Color.js"],i["Core/Time.js"]],(function(t,e,i,n,r,s,a,o,l,h,c,u,d,f,p,g,m,v,y,b,_,x,w,S,T,E,k,C,M,A,O,P,R,I,L){return t.animate=r.animate,t.animObject=r.animObject,t.getDeferredAnimation=r.getDeferredAnimation,t.setAnimation=r.setAnimation,t.stop=r.stop,t.timers=n.timers,t.AST=s,t.Axis=d,t.Chart=w,t.chart=w.chart,t.Fx=n,t.Legend=x,t.PlotLineOrBand=g,t.Point=y,t.Pointer=_.isRequired()?_:b,t.Series=E,t.StackItem=T,t.SVGElement=l,t.SVGRenderer=h,t.Tick=m,t.Time=L,t.Tooltip=v,t.Color=I,t.color=I.parse,u.compose(h),c.compose(l),t.defaultOptions=i.defaultOptions,t.getOptions=i.getOptions,t.time=i.defaultTime,t.setOptions=i.setOptions,t.dateFormat=a.dateFormat,t.format=a.format,t.numberFormat=a.numberFormat,t.addEvent=e.addEvent,t.arrayMax=e.arrayMax,t.arrayMin=e.arrayMin,t.attr=e.attr,t.clearTimeout=e.clearTimeout,t.correctFloat=e.correctFloat,t.createElement=e.createElement,t.css=e.css,t.defined=e.defined,t.destroyObjectProperties=e.destroyObjectProperties,t.discardElement=e.discardElement,t.distribute=o.distribute,t.erase=e.erase,t.error=e.error,t.extend=e.extend,t.extendClass=e.extendClass,t.find=e.find,t.fireEvent=e.fireEvent,t.getMagnitude=e.getMagnitude,t.getStyle=e.getStyle,t.inArray=e.inArray,t.isArray=e.isArray,t.isClass=e.isClass,t.isDOMElement=e.isDOMElement,t.isFunction=e.isFunction,t.isNumber=e.isNumber,t.isObject=e.isObject,t.isString=e.isString,t.keys=e.keys,t.merge=e.merge,t.normalizeTickInterval=e.normalizeTickInterval,t.objectEach=e.objectEach,t.offset=e.offset,t.pad=e.pad,t.pick=e.pick,t.pInt=e.pInt,t.relativeLength=e.relativeLength,t.removeEvent=e.removeEvent,t.seriesType=k.seriesType,t.splat=e.splat,t.stableSort=e.stableSort,t.syncTimeout=e.syncTimeout,t.timeUnits=e.timeUnits,t.uniqueKey=e.uniqueKey,t.useSerialIds=e.useSerialIds,t.wrap=e.wrap,M.compose(C),P.compose(E),f.compose(d),p.compose(d),O.compose(A),g.compose(d),R.compose(w),S.compose(d,w,E),t})),i["masters/highcharts.src.js"]._modules=i,i["masters/highcharts.src.js"]},t.exports?(s.default=s,t.exports=r.document?s(r):s):void 0===(n=function(){return s(r)}.call(e,i,e,t))||(t.exports=n)},8393:(t,e,i)=>{var n,r,s;s=function(t){function e(t,e,i,n){t.hasOwnProperty(e)||(t[e]=n.apply(null,i),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t=t?t._modules:{},"Core/Chart/ChartNavigationComposition.js",[],(function(){var t;return function(t){t.compose=function(t){return t.navigation||(t.navigation=new e(t)),t};var e=function(){function t(t){this.updates=[],this.chart=t}return t.prototype.addUpdate=function(t){this.chart.navigation.updates.push(t)},t.prototype.update=function(t,e){var i=this;this.updates.forEach((function(n){n.call(i.chart,t,e)}))},t}();t.Additions=e}(t||(t={})),t})),e(t,"Extensions/Exporting/ExportingDefaults.js",[t["Core/Globals.js"]],(function(t){return t=t.isTouchDevice,{exporting:{allowTableSorting:!0,type:"image/png",url:"https://export.highcharts.com/",pdfFont:{normal:void 0,bold:void 0,bolditalic:void 0,italic:void 0},printMaxWidth:780,scale:2,buttons:{contextButton:{className:"highcharts-contextbutton",menuClassName:"highcharts-contextmenu",symbol:"menu",titleKey:"contextButtonTitle",menuItems:"viewFullscreen printChart separator downloadPNG downloadJPEG downloadPDF downloadSVG".split(" ")}},menuItemDefinitions:{viewFullscreen:{textKey:"viewFullscreen",onclick:function(){this.fullscreen&&this.fullscreen.toggle()}},printChart:{textKey:"printChart",onclick:function(){this.print()}},separator:{separator:!0},downloadPNG:{textKey:"downloadPNG",onclick:function(){this.exportChart()}},downloadJPEG:{textKey:"downloadJPEG",onclick:function(){this.exportChart({type:"image/jpeg"})}},downloadPDF:{textKey:"downloadPDF",onclick:function(){this.exportChart({type:"application/pdf"})}},downloadSVG:{textKey:"downloadSVG",onclick:function(){this.exportChart({type:"image/svg+xml"})}}}},lang:{viewFullscreen:"View in full screen",exitFullscreen:"Exit from full screen",printChart:"Print chart",downloadPNG:"Download PNG image",downloadJPEG:"Download JPEG image",downloadPDF:"Download PDF document",downloadSVG:"Download SVG vector image",contextButtonTitle:"Chart context menu"},navigation:{buttonOptions:{symbolSize:14,symbolX:12.5,symbolY:10.5,align:"right",buttonSpacing:3,height:22,verticalAlign:"top",width:24,symbolFill:"#666666",symbolStroke:"#666666",symbolStrokeWidth:3,theme:{padding:5}},menuStyle:{border:"1px solid ".concat("#999999"),background:"#ffffff",padding:"5px 0"},menuItemStyle:{padding:"0.5em 1em",color:"#333333",background:"none",fontSize:t?"14px":"11px",transition:"background 250ms, color 250ms"},menuItemHoverStyle:{background:"#335cad",color:"#ffffff"}}}})),e(t,"Extensions/Exporting/ExportingSymbols.js",[],(function(){var t;return function(t){function e(t,e,i,n){return[["M",t,e+2.5],["L",t+i,e+2.5],["M",t,e+n/2+.5],["L",t+i,e+n/2+.5],["M",t,e+n-1.5],["L",t+i,e+n-1.5]]}function i(t,e,i,n){return t=n/3-2,(n=[]).concat(this.circle(i-t,e,t,t),this.circle(i-t,e+t+4,t,t),this.circle(i-t,e+2*(t+4),t,t))}var n=[];t.compose=function(t){-1===n.indexOf(t)&&(n.push(t),(t=t.prototype.symbols).menu=e,t.menuball=i.bind(t))}}(t||(t={})),t})),e(t,"Extensions/Exporting/Fullscreen.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Utilities.js"]],(function(t,e){function i(){this.fullscreen=new a(this)}var n=e.addEvent,r=e.fireEvent,s=[],a=function(){function e(t){this.chart=t,this.isOpen=!1,t=t.renderTo,this.browserProps||("function"==typeof t.requestFullscreen?this.browserProps={fullscreenChange:"fullscreenchange",requestFullscreen:"requestFullscreen",exitFullscreen:"exitFullscreen"}:t.mozRequestFullScreen?this.browserProps={fullscreenChange:"mozfullscreenchange",requestFullscreen:"mozRequestFullScreen",exitFullscreen:"mozCancelFullScreen"}:t.webkitRequestFullScreen?this.browserProps={fullscreenChange:"webkitfullscreenchange",requestFullscreen:"webkitRequestFullScreen",exitFullscreen:"webkitExitFullscreen"}:t.msRequestFullscreen&&(this.browserProps={fullscreenChange:"MSFullscreenChange",requestFullscreen:"msRequestFullscreen",exitFullscreen:"msExitFullscreen"}))}return e.compose=function(t){-1===s.indexOf(t)&&(s.push(t),n(t,"beforeRender",i))},e.prototype.close=function(){var t=this,e=t.chart,i=e.options.chart;r(e,"fullscreenClose",null,(function(){t.isOpen&&t.browserProps&&e.container.ownerDocument instanceof Document&&e.container.ownerDocument[t.browserProps.exitFullscreen](),t.unbindFullscreenEvent&&(t.unbindFullscreenEvent=t.unbindFullscreenEvent()),e.setSize(t.origWidth,t.origHeight,!1),t.origWidth=void 0,t.origHeight=void 0,i.width=t.origWidthOption,i.height=t.origHeightOption,t.origWidthOption=void 0,t.origHeightOption=void 0,t.isOpen=!1,t.setButtonText()}))},e.prototype.open=function(){var t=this,e=t.chart,i=e.options.chart;r(e,"fullscreenOpen",null,(function(){if(i&&(t.origWidthOption=i.width,t.origHeightOption=i.height),t.origWidth=e.chartWidth,t.origHeight=e.chartHeight,t.browserProps){var r=n(e.container.ownerDocument,t.browserProps.fullscreenChange,(function(){t.isOpen?(t.isOpen=!1,t.close()):(e.setSize(null,null,!1),t.isOpen=!0,t.setButtonText())})),s=n(e,"destroy",r);t.unbindFullscreenEvent=function(){r(),s()};var a=e.renderTo[t.browserProps.requestFullscreen]();a&&a.catch((function(){alert("Full screen is not supported inside a frame.")}))}}))},e.prototype.setButtonText=function(){var e=this.chart,i=e.exportDivElements,n=e.options.exporting,r=n&&n.buttons&&n.buttons.contextButton.menuItems;e=e.options.lang,n&&n.menuItemDefinitions&&e&&e.exitFullscreen&&e.viewFullscreen&&r&&i&&(i=i[r.indexOf("viewFullscreen")])&&t.setElementHTML(i,this.isOpen?e.exitFullscreen:n.menuItemDefinitions.viewFullscreen.text||e.viewFullscreen)},e.prototype.toggle=function(){this.isOpen?this.close():this.open()},e}();return a})),e(t,"Core/HttpUtilities.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],(function(t,e){var i=t.doc,n=e.createElement,r=e.discardElement,s=e.merge,a=e.objectEach,o={ajax:function(t){var e={json:"application/json",xml:"application/xml",text:"text/plain",octet:"application/octet-stream"},i=new XMLHttpRequest;if(!t.url)return!1;i.open((t.type||"get").toUpperCase(),t.url,!0),t.headers&&t.headers["Content-Type"]||i.setRequestHeader("Content-Type",e[t.dataType||"json"]||e.text),a(t.headers,(function(t,e){i.setRequestHeader(e,t)})),t.responseType&&(i.responseType=t.responseType),i.onreadystatechange=function(){if(4===i.readyState){if(200===i.status){if("blob"!==t.responseType){var e=i.responseText;if("json"===t.dataType)try{e=JSON.parse(e)}catch(e){if(e instanceof Error)return void(t.error&&t.error(i,e))}}return t.success&&t.success(e,i)}t.error&&t.error(i,i.responseText)}},t.data&&"string"!=typeof t.data&&(t.data=JSON.stringify(t.data)),i.send(t.data)},getJSON:function(t,e){o.ajax({url:t,success:e,dataType:"json",headers:{"Content-Type":"text/plain"}})},post:function(t,e,o){var l=n("form",s({method:"post",action:t,enctype:"multipart/form-data"},o),{display:"none"},i.body);a(e,(function(t,e){n("input",{type:"hidden",name:e,value:t},void 0,l)})),l.submit(),r(l)}};return o})),e(t,"Extensions/Exporting/Exporting.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Chart/Chart.js"],t["Core/Chart/ChartNavigationComposition.js"],t["Core/Defaults.js"],t["Extensions/Exporting/ExportingDefaults.js"],t["Extensions/Exporting/ExportingSymbols.js"],t["Extensions/Exporting/Fullscreen.js"],t["Core/Globals.js"],t["Core/HttpUtilities.js"],t["Core/Utilities.js"]],(function(t,e,i,n,r,s,a,o,l,h){var c,u=n.defaultOptions,d=n.setOptions,f=o.doc,p=o.SVG_NS,g=o.win,m=h.addEvent,v=h.css,y=h.createElement,b=h.discardElement,_=h.extend,x=h.find,w=h.fireEvent,S=h.isObject,T=h.merge,E=h.objectEach,k=h.pick,C=h.removeEvent,M=h.uniqueKey;return function(e){function n(t){var e=this,i=e.renderer,n=T(e.options.navigation.buttonOptions,t),r=n.onclick,s=n.menuItems,a=n.symbolSize||12;if(e.btnCount||(e.btnCount=0),e.exportDivElements||(e.exportDivElements=[],e.exportSVGElements=[]),!1!==n.enabled&&n.theme){var o,l=n.theme;e.styledMode||(l.fill=k(l.fill,"#ffffff"),l.stroke=k(l.stroke,"none")),r?o=function(t){t&&t.stopPropagation(),r.call(e,t)}:s&&(o=function(t){t&&t.stopPropagation(),e.contextMenu(h.menuClassName,s,h.translateX,h.translateY,h.width,h.height,h),h.setState(2)}),n.text&&n.symbol?l.paddingLeft=k(l.paddingLeft,30):n.text||_(l,{width:n.width,height:n.height,padding:0}),e.styledMode||(l["stroke-linecap"]="round",l.fill=k(l.fill,"#ffffff"),l.stroke=k(l.stroke,"none"));var h=i.button(n.text,0,0,o,l,void 0,void 0,void 0,void 0,n.useHTML).addClass(t.className).attr({title:k(e.options.lang[n._titleKey||n.titleKey],"")});if(h.menuClassName=t.menuClassName||"highcharts-menu-"+e.btnCount++,n.symbol){var c=i.symbol(n.symbol,n.symbolX-a/2,n.symbolY-a/2,a,a,{width:a,height:a}).addClass("highcharts-button-symbol").attr({zIndex:1}).add(h);e.styledMode||c.attr({stroke:n.symbolStroke,fill:n.symbolFill,"stroke-width":n.symbolStrokeWidth||1})}h.add(e.exportingGroup).align(_(n,{width:h.width,x:k(n.x,e.buttonOffset)}),!0,"spacingBox"),e.buttonOffset+=(h.width+n.buttonSpacing)*("right"===n.align?-1:1),e.exportSVGElements.push(h,c)}}function c(){if(this.printReverseInfo){var t=this.printReverseInfo,e=t.childNodes,i=t.origDisplay;t=t.resetParams,this.moveContainers(this.renderTo),[].forEach.call(e,(function(t,e){1===t.nodeType&&(t.style.display=i[e]||"")})),this.isPrinting=!1,t&&this.setSize.apply(this,t),delete this.printReverseInfo,K=void 0,w(this,"afterPrint")}}function A(){var t=f.body,e=this.options.exporting.printMaxWidth,i={childNodes:t.childNodes,origDisplay:[],resetParams:void 0};this.isPrinting=!0,this.pointer.reset(null,0),w(this,"beforePrint"),e&&this.chartWidth>e&&(i.resetParams=[this.options.chart.width,void 0,!1],this.setSize(e,void 0,!1)),[].forEach.call(i.childNodes,(function(t,e){1===t.nodeType&&(i.origDisplay[e]=t.style.display,t.style.display="none")})),this.moveContainers(t),this.printReverseInfo=i}function O(t){t.renderExporting(),m(t,"redraw",t.renderExporting),m(t,"destroy",t.destroyExport)}function P(e,i,n,r,s,a,o){var l=this,c=l.options.navigation,u=l.chartWidth,d=l.chartHeight,p="cache-"+e,b=Math.max(s,a),x=l[p];if(!x){l.exportContextMenu=l[p]=x=y("div",{className:e},{position:"absolute",zIndex:1e3,padding:b+"px",pointerEvents:"auto"},l.fixedDiv||l.container);var T=y("ul",{className:"highcharts-menu"},{listStyle:"none",margin:0,padding:0},x);l.styledMode||v(T,_({MozBoxShadow:"3px 3px 10px #888",WebkitBoxShadow:"3px 3px 10px #888",boxShadow:"3px 3px 10px #888"},c.menuStyle)),x.hideMenu=function(){v(x,{display:"none"}),o&&o.setState(0),l.openMenu=!1,v(l.renderTo,{overflow:"hidden"}),v(l.container,{overflow:"hidden"}),h.clearTimeout(x.hideTimer),w(l,"exportMenuHidden")},l.exportEvents.push(m(x,"mouseleave",(function(){x.hideTimer=g.setTimeout(x.hideMenu,500)})),m(x,"mouseenter",(function(){h.clearTimeout(x.hideTimer)})),m(f,"mouseup",(function(t){l.pointer.inClass(t.target,e)||x.hideMenu()})),m(x,"click",(function(){l.openMenu&&x.hideMenu()}))),i.forEach((function(e){if("string"==typeof e&&(e=l.options.exporting.menuItemDefinitions[e]),S(e,!0)){var i=void 0;e.separator?i=y("hr",void 0,void 0,T):("viewData"===e.textKey&&l.isDataTableVisible&&(e.textKey="hideData"),i=y("li",{className:"highcharts-menu-item",onclick:function(t){t&&t.stopPropagation(),x.hideMenu(),e.onclick&&e.onclick.apply(l,arguments)}},void 0,T),t.setElementHTML(i,e.text||l.options.lang[e.textKey]),l.styledMode||(i.onmouseover=function(){v(this,c.menuItemHoverStyle)},i.onmouseout=function(){v(this,c.menuItemStyle)},v(i,_({cursor:"pointer"},c.menuItemStyle||{})))),l.exportDivElements.push(i)}})),l.exportDivElements.push(T,x),l.exportMenuWidth=x.offsetWidth,l.exportMenuHeight=x.offsetHeight}i={display:"block"},n+l.exportMenuWidth>u?i.right=u-n-s-b+"px":i.left=n-b+"px",r+a+l.exportMenuHeight>d&&"top"!==o.alignOptions.verticalAlign?i.bottom=d-r-b+"px":i.top=r+a-b+"px",v(x,i),v(l.renderTo,{overflow:""}),v(l.container,{overflow:""}),l.openMenu=!0,w(l,"exportMenuShown")}function R(t){var e,i=t?t.target:this,n=i.exportSVGElements,r=i.exportDivElements;t=i.exportEvents,n&&(n.forEach((function(t,r){t&&(t.onclick=t.ontouchstart=null,e="cache-"+t.menuClassName,i[e]&&delete i[e],n[r]=t.destroy())})),n.length=0),i.exportingGroup&&(i.exportingGroup.destroy(),delete i.exportingGroup),r&&(r.forEach((function(t,e){t&&(h.clearTimeout(t.hideTimer),C(t,"mouseleave"),r[e]=t.onmouseout=t.onmouseover=t.ontouchstart=t.onclick=null,b(t))})),r.length=0),t&&(t.forEach((function(t){t()})),t.length=0)}function I(t,e){e=this.getSVGForExport(t,e),t=T(this.options.exporting,t),l.post(t.url,{filename:t.filename?t.filename.replace(/\//g,"-"):this.getFilename(),type:t.type,width:t.width||0,scale:t.scale,svg:e},t.formAttributes)}function L(){return this.styledMode&&this.inlineStyles(),this.container.innerHTML}function D(){var t=this.userOptions.title&&this.userOptions.title.text,e=this.options.exporting.filename;return e?e.replace(/\//g,"-"):("string"==typeof t&&(e=t.toLowerCase().replace(/<\/?[^>]+(>|$)/g,"").replace(/[\s_]+/g,"-").replace(/[^a-z0-9\-]/g,"").replace(/^[\-]+/g,"").replace(/[\-]+/g,"-").substr(0,24).replace(/[\-]+$/g,"")),(!e||5>e.length)&&(e="chart"),e)}function N(t){var e,i=T(this.options,t);i.plotOptions=T(this.userOptions.plotOptions,t&&t.plotOptions),i.time=T(this.userOptions.time,t&&t.time);var n=y("div",null,{position:"absolute",top:"-9999em",width:this.chartWidth+"px",height:this.chartHeight+"px"},f.body),r=this.renderTo.style.width,s=this.renderTo.style.height;r=i.exporting.sourceWidth||i.chart.width||/px$/.test(r)&&parseInt(r,10)||(i.isGantt?800:600),s=i.exporting.sourceHeight||i.chart.height||/px$/.test(s)&&parseInt(s,10)||400,_(i.chart,{animation:!1,renderTo:n,forExport:!0,renderer:"SVGRenderer",width:r,height:s}),i.exporting.enabled=!1,delete i.data,i.series=[],this.series.forEach((function(t){(e=T(t.userOptions,{animation:!1,enableMouseTracking:!1,showCheckbox:!1,visible:t.visible})).isInternal||i.series.push(e)}));var a={};this.axes.forEach((function(t){t.userOptions.internalKey||(t.userOptions.internalKey=M()),t.options.isInternal||(a[t.coll]||(a[t.coll]=!0,i[t.coll]=[]),i[t.coll].push(T(t.userOptions,{visible:t.visible})))}));var o=new this.constructor(i,this.callback);return t&&["xAxis","yAxis","series"].forEach((function(e){var i={};t[e]&&(i[e]=t[e],o.update(i))})),this.axes.forEach((function(t){var e=x(o.axes,(function(e){return e.options.internalKey===t.userOptions.internalKey})),i=t.getExtremes(),n=i.userMin;i=i.userMax,e&&(void 0!==n&&n!==e.min||void 0!==i&&i!==e.max)&&e.setExtremes(n,i,!0,!1)})),s=o.getChartHTML(),w(this,"getSVG",{chartCopy:o}),s=this.sanitizeSVG(s,i),i=null,o.destroy(),b(n),s}function F(t,e){var i=this.options.exporting;return this.getSVG(T({chart:{borderRadius:0}},i.chartOptions,e,{exporting:{sourceWidth:t&&t.sourceWidth||i.sourceWidth,sourceHeight:t&&t.sourceHeight||i.sourceHeight}}))}function j(t){return t.replace(/([A-Z])/g,(function(t,e){return"-"+e.toLowerCase()}))}function B(){var t,i=V,n=e.inlineAllowlist,r={},s=f.createElement("iframe");v(s,{width:"1px",height:"1px",visibility:"hidden"}),f.body.appendChild(s);var a=s.contentWindow&&s.contentWindow.document;a&&a.body.appendChild(a.createElementNS(p,"svg")),function e(s){var l={};if(a&&1===s.nodeType&&-1===q.indexOf(s.nodeName)){var h=g.getComputedStyle(s,null),c="svg"===s.nodeName?{}:g.getComputedStyle(s.parentNode,null);if(!r[s.nodeName]){t=a.getElementsByTagName("svg")[0];var u=a.createElementNS(s.namespaceURI,s.nodeName);t.appendChild(u);var d=g.getComputedStyle(u,null),f={};for(var p in d)"string"!=typeof d[p]||/^[0-9]+$/.test(p)||(f[p]=d[p]);r[s.nodeName]=f,"text"===s.nodeName&&delete r.text.fill,t.removeChild(u)}for(var m in h)if(o.isFirefox||o.isMS||o.isSafari||Object.hasOwnProperty.call(h,m)){p=h[m];var y=m;if(u=d=!1,n.length){for(f=n.length;f--&&!d;)d=n[f].test(y);u=!d}for("transform"===y&&"none"===p&&(u=!0),f=i.length;f--&&!u;)u=i[f].test(y)||"function"==typeof p;u||c[y]===p&&"svg"!==s.nodeName||r[s.nodeName][y]===p||(Y&&-1===Y.indexOf(y)?l[y]=p:p&&s.setAttribute(j(y),p))}v(s,l),"svg"===s.nodeName&&s.setAttribute("stroke-width","1px"),"text"!==s.nodeName&&[].forEach.call(s.children||s.childNodes,e)}}(this.container.querySelector("svg")),t.parentNode.removeChild(t),s.parentNode.removeChild(s)}function z(t){(this.fixedDiv?[this.fixedDiv,this.scrollingContainer]:[this.container]).forEach((function(e){t.appendChild(e)}))}function W(){var t=this;t.exporting={update:function(e,i){t.isDirtyExporting=!0,T(!0,t.options.exporting,e),k(i,!0)&&t.redraw()}},i.compose(t).navigation.addUpdate((function(e,i){t.isDirtyExporting=!0,T(!0,t.options.navigation,e),k(i,!0)&&t.redraw()}))}function G(){var t=this;t.isPrinting||(K=t,o.isSafari||t.beforePrint(),setTimeout((function(){g.focus(),g.print(),o.isSafari||setTimeout((function(){t.afterPrint()}),1e3)}),1))}function U(){var t=this,e=t.options.exporting,i=e.buttons,n=t.isDirtyExporting||!t.exportSVGElements;t.buttonOffset=0,t.isDirtyExporting&&t.destroyExport(),n&&!1!==e.enabled&&(t.exportEvents=[],t.exportingGroup=t.exportingGroup||t.renderer.g("exporting-group").attr({zIndex:3}).add(),E(i,(function(e){t.addButton(e)})),t.isDirtyExporting=!1)}function H(t,e){var i=t.indexOf("</svg>")+6,n=t.substr(i);return t=t.substr(0,i),e&&e.exporting&&e.exporting.allowHTML&&n&&(n='<foreignObject x="0" y="0" width="'+e.chart.width+'" height="'+e.chart.height+'"><body xmlns="http://www.w3.org/1999/xhtml">'+n.replace(/(<(?:img|br).*?(?=>))>/g,"$1 />")+"</body></foreignObject>",t=t.replace("</svg>",n+"</svg>")),t=t.replace(/zIndex="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery[0-9]+="[^"]+"/g,"").replace(/url\(("|&quot;)(.*?)("|&quot;);?\)/g,"url($2)").replace(/url\([^#]+#/g,"url(#").replace(/<svg /,'<svg xmlns:xlink="http://www.w3.org/1999/xlink" ').replace(/ (|NS[0-9]+:)href=/g," xlink:href=").replace(/\n/," ").replace(/(fill|stroke)="rgba\(([ 0-9]+,[ 0-9]+,[ 0-9]+),([ 0-9\.]+)\)"/g,'$1="rgb($2)" $1-opacity="$3"').replace(/&nbsp;/g," ").replace(/&shy;/g,"­"),this.ieSanitizeSVG&&(t=this.ieSanitizeSVG(t)),t}var X=[],V=[/-/,/^(clipPath|cssText|d|height|width)$/,/^font$/,/[lL]ogical(Width|Height)$/,/^parentRule$/,/perspective/,/TapHighlightColor/,/^transition/,/^length$/,/^[0-9]+$/],Y="fill stroke strokeLinecap strokeLinejoin strokeWidth textAnchor x y".split(" ");e.inlineAllowlist=[];var K,q=["clipPath","defs","desc"];e.compose=function(t,e){s.compose(e),a.compose(t),-1===X.indexOf(t)&&(X.push(t),(e=t.prototype).afterPrint=c,e.exportChart=I,e.inlineStyles=B,e.print=G,e.sanitizeSVG=H,e.getChartHTML=L,e.getSVG=N,e.getSVGForExport=F,e.getFilename=D,e.moveContainers=z,e.beforePrint=A,e.contextMenu=P,e.addButton=n,e.destroyExport=R,e.renderExporting=U,e.callbacks.push(O),m(t,"init",W),o.isSafari&&o.win.matchMedia("print").addListener((function(t){K&&(t.matches?K.beforePrint():K.afterPrint())}))),-1===X.indexOf(d)&&(X.push(d),u.exporting=T(r.exporting,u.exporting),u.lang=T(r.lang,u.lang),u.navigation=T(r.navigation,u.navigation))}}(c||(c={})),c})),e(t,"masters/modules/exporting.src.js",[t["Core/Globals.js"],t["Extensions/Exporting/Exporting.js"],t["Core/HttpUtilities.js"]],(function(t,e,i){t.HttpUtilities=i,t.ajax=i.ajax,t.getJSON=i.getJSON,t.post=i.post,e.compose(t.Chart,t.Renderer)}))},t.exports?(s.default=s,t.exports=s):(n=[i(8840)],void 0===(r=function(t){return s(t),s.Highcharts=t,s}.apply(e,n))||(t.exports=r))},7732:(t,e,i)=>{var n,r,s;s=function(t){function e(t,e,i,n){t.hasOwnProperty(e)||(t[e]=n.apply(null,i),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t=t?t._modules:{},"Extensions/Exporting/Fullscreen.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Utilities.js"]],(function(t,e){function i(){this.fullscreen=new a(this)}var n=e.addEvent,r=e.fireEvent,s=[],a=function(){function e(t){this.chart=t,this.isOpen=!1,t=t.renderTo,this.browserProps||("function"==typeof t.requestFullscreen?this.browserProps={fullscreenChange:"fullscreenchange",requestFullscreen:"requestFullscreen",exitFullscreen:"exitFullscreen"}:t.mozRequestFullScreen?this.browserProps={fullscreenChange:"mozfullscreenchange",requestFullscreen:"mozRequestFullScreen",exitFullscreen:"mozCancelFullScreen"}:t.webkitRequestFullScreen?this.browserProps={fullscreenChange:"webkitfullscreenchange",requestFullscreen:"webkitRequestFullScreen",exitFullscreen:"webkitExitFullscreen"}:t.msRequestFullscreen&&(this.browserProps={fullscreenChange:"MSFullscreenChange",requestFullscreen:"msRequestFullscreen",exitFullscreen:"msExitFullscreen"}))}return e.compose=function(t){-1===s.indexOf(t)&&(s.push(t),n(t,"beforeRender",i))},e.prototype.close=function(){var t=this,e=t.chart,i=e.options.chart;r(e,"fullscreenClose",null,(function(){t.isOpen&&t.browserProps&&e.container.ownerDocument instanceof Document&&e.container.ownerDocument[t.browserProps.exitFullscreen](),t.unbindFullscreenEvent&&(t.unbindFullscreenEvent=t.unbindFullscreenEvent()),e.setSize(t.origWidth,t.origHeight,!1),t.origWidth=void 0,t.origHeight=void 0,i.width=t.origWidthOption,i.height=t.origHeightOption,t.origWidthOption=void 0,t.origHeightOption=void 0,t.isOpen=!1,t.setButtonText()}))},e.prototype.open=function(){var t=this,e=t.chart,i=e.options.chart;r(e,"fullscreenOpen",null,(function(){if(i&&(t.origWidthOption=i.width,t.origHeightOption=i.height),t.origWidth=e.chartWidth,t.origHeight=e.chartHeight,t.browserProps){var r=n(e.container.ownerDocument,t.browserProps.fullscreenChange,(function(){t.isOpen?(t.isOpen=!1,t.close()):(e.setSize(null,null,!1),t.isOpen=!0,t.setButtonText())})),s=n(e,"destroy",r);t.unbindFullscreenEvent=function(){r(),s()};var a=e.renderTo[t.browserProps.requestFullscreen]();a&&a.catch((function(){alert("Full screen is not supported inside a frame.")}))}}))},e.prototype.setButtonText=function(){var e=this.chart,i=e.exportDivElements,n=e.options.exporting,r=n&&n.buttons&&n.buttons.contextButton.menuItems;e=e.options.lang,n&&n.menuItemDefinitions&&e&&e.exitFullscreen&&e.viewFullscreen&&r&&i&&(i=i[r.indexOf("viewFullscreen")])&&t.setElementHTML(i,this.isOpen?e.exitFullscreen:n.menuItemDefinitions.viewFullscreen.text||e.viewFullscreen)},e.prototype.toggle=function(){this.isOpen?this.close():this.open()},e}();return a})),e(t,"masters/modules/full-screen.src.js",[t["Core/Globals.js"],t["Extensions/Exporting/Fullscreen.js"]],(function(t,e){t.Fullscreen=e,e.compose(t.Chart)}))},t.exports?(s.default=s,t.exports=s):(n=[i(8840)],void 0===(r=function(t){return s(t),s.Highcharts=t,s}.apply(e,n))||(t.exports=r))},4625:(t,e,i)=>{var n,r,s;s=function(t){function e(t,e,i,n){t.hasOwnProperty(e)||(t[e]=n.apply(null,i),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t=t?t._modules:{},"Extensions/DownloadURL.js",[t["Core/Globals.js"]],(function(t){var e=t.isSafari,i=t.win,n=i.document,r=i.URL||i.webkitURL||i,s=t.dataURLtoBlob=function(t){if((t=t.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<t.length&&i.atob&&i.ArrayBuffer&&i.Uint8Array&&i.Blob&&r.createObjectURL){var e=i.atob(t[3]),n=new i.ArrayBuffer(e.length);n=new i.Uint8Array(n);for(var s=0;s<n.length;++s)n[s]=e.charCodeAt(s);return t=new i.Blob([n],{type:t[1]}),r.createObjectURL(t)}};return t=t.downloadURL=function(t,r){var a=i.navigator,o=n.createElement("a");if("string"==typeof t||t instanceof String||!a.msSaveOrOpenBlob){if(t="".concat(t),a=/Edge\/\d+/.test(a.userAgent),(e&&"string"==typeof t&&0===t.indexOf("data:application/pdf")||a||2e6<t.length)&&!(t=s(t)||""))throw Error("Failed to convert to blob");if(void 0!==o.download)o.href=t,o.download=r,n.body.appendChild(o),o.click(),n.body.removeChild(o);else try{var l=i.open(t,"chart");if(null==l)throw Error("Failed to open window")}catch(e){i.location.href=t}}else a.msSaveOrOpenBlob(t,r)},{dataURLtoBlob:s,downloadURL:t}})),e(t,"Extensions/OfflineExporting/OfflineExportingDefaults.js",[],(function(){return{libURL:"https://code.highcharts.com/10.3.3/lib/",menuItemDefinitions:{downloadPNG:{textKey:"downloadPNG",onclick:function(){this.exportChartLocal()}},downloadJPEG:{textKey:"downloadJPEG",onclick:function(){this.exportChartLocal({type:"image/jpeg"})}},downloadSVG:{textKey:"downloadSVG",onclick:function(){this.exportChartLocal({type:"image/svg+xml"})}},downloadPDF:{textKey:"downloadPDF",onclick:function(){this.exportChartLocal({type:"application/pdf"})}}}}})),e(t,"Extensions/OfflineExporting/OfflineExporting.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Chart/Chart.js"],t["Core/Defaults.js"],t["Extensions/DownloadURL.js"],t["Extensions/Exporting/Exporting.js"],t["Core/Globals.js"],t["Core/HttpUtilities.js"],t["Extensions/OfflineExporting/OfflineExportingDefaults.js"],t["Core/Utilities.js"]],(function(t,e,i,n,r,s,a,o,l){var h=i.defaultOptions,c=n.downloadURL,u=s.win,d=s.doc,f=a.ajax,p=l.addEvent,g=l.error,m=l.extend,v=l.fireEvent,y=l.merge;t.allowedAttributes.push("data-z-index","fill-opacity","rx","ry","stroke-dasharray","stroke-linejoin","text-anchor","transform","version","viewBox","visibility","xmlns","xmlns:xlink"),t.allowedTags.push("desc","clippath","g");var b,_=[];return function(e){function i(t,i){var n=this,a=y(n.options.exporting,t),o=function(t){!1===a.fallbackToExportServer?a.error?a.error(a,t):g(28,!0):n.exportChart(a)};t=function(){return[].some.call(n.container.getElementsByTagName("image"),(function(t){return""!==(t=t.getAttribute("href"))&&"string"==typeof t&&0!==t.indexOf("data:")}))},s.isMS&&n.styledMode&&!r.inlineAllowlist.length&&r.inlineAllowlist.push(/^blockSize/,/^border/,/^caretColor/,/^color/,/^columnRule/,/^columnRuleColor/,/^cssFloat/,/^cursor/,/^fill$/,/^fillOpacity/,/^font/,/^inlineSize/,/^length/,/^lineHeight/,/^opacity/,/^outline/,/^parentRule/,/^rx$/,/^ry$/,/^stroke/,/^textAlign/,/^textAnchor/,/^textDecoration/,/^transform/,/^vectorEffect/,/^visibility/,/^x$/,/^y$/),s.isMS&&("application/pdf"===a.type||n.container.getElementsByTagName("image").length&&"image/svg+xml"!==a.type)||"application/pdf"===a.type&&t()?o(Error("Image type not supported for this chart/browser.")):n.getSVGForLocalExport(a,i||{},o,(function(t){-1<t.indexOf("<foreignObject")&&"image/svg+xml"!==a.type&&(s.isMS||"application/pdf"===a.type)?o(Error("Image type not supported for charts with embedded HTML")):e.downloadSVGLocal(t,m({filename:n.getFilename()},a),o,(function(){return v(n,"exportChartLocalSuccess")}))}))}function n(t,e){var i=d.getElementsByTagName("head")[0],n=d.createElement("script");n.type="text/javascript",n.src=t,n.onload=e,n.onerror=function(){g("Error loading script "+t)},i.appendChild(n)}function a(t,i,n,r){var s,a,o,l=this,h=function(){o&&f===d&&r(l.sanitizeSVG(s.innerHTML,a))},c=function(t,e,i){++f,i.imageElement.setAttributeNS("http://www.w3.org/1999/xlink","href",t),h()},u=null,d=0,f=0;l.unbindGetSVG=p(l,"getSVG",(function(t){a=t.chartCopy.options,o=(s=t.chartCopy.container.cloneNode(!0))&&s.getElementsByTagName("image")||[],d=o.length})),l.getSVGForExport(t,i);try{if(!o||!o.length)return void r(l.sanitizeSVG(s.innerHTML,a));for(i=0;i<o.length;i++){var g=o[i];(u=g.getAttributeNS("http://www.w3.org/1999/xlink","href"))?e.imageToDataUrl(u,"image/png",{imageElement:g},t.scale,c,n,n,n):(f++,g.parentNode.removeChild(g),i--,h())}}catch(t){n(t)}l.unbindGetSVG()}function l(t,i,n,r,s,a,o,l,h){var c=new u.Image,f=function(){setTimeout((function(){var e=d.createElement("canvas"),a=e.getContext&&e.getContext("2d");try{if(a){e.height=c.height*r,e.width=c.width*r,a.drawImage(c,0,0,e.width,e.height);try{var l=e.toDataURL(i);s(l,i,n,r)}catch(e){g(t,i,n,r)}}else o(t,i,n,r)}finally{h&&h(t,i,n,r)}}),e.loadEventDeferDelay)},p=function(){l(t,i,n,r),h&&h(t,i,n,r)},g=function(){c=new u.Image,g=a,c.crossOrigin="Anonymous",c.onload=f,c.onerror=p,c.src=t};c.onload=f,c.onerror=p,c.src=t}function b(t){var i=u.navigator.userAgent;i=-1<i.indexOf("WebKit")&&0>i.indexOf("Chrome");try{if(!i&&-1===t.indexOf("<foreignObject"))return e.domurl.createObjectURL(new u.Blob([t],{type:"image/svg+xml;charset-utf-16"}))}catch(t){}return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(t)}function x(t,e,i){var n=Number(t.getAttribute("width"))+2*e;e=Number(t.getAttribute("height"))+2*e;var r=new u.jspdf.jsPDF(e>n?"p":"l","pt",[n,e]);[].forEach.call(t.querySelectorAll('*[visibility="hidden"]'),(function(t){t.parentNode.removeChild(t)}));for(var s=t.querySelectorAll("linearGradient"),a=0;a<s.length;a++)for(var o=s[a].querySelectorAll("stop"),l=0;l<o.length&&"0"===o[l].getAttribute("offset")&&"0"===o[l+1].getAttribute("offset");)o[l].remove(),l++;[].forEach.call(t.querySelectorAll("tspan"),(function(t){"​"===t.textContent&&(t.textContent=" ",t.setAttribute("dx",-5))})),r.svg(t,{x:0,y:0,width:n,height:e,removeInvalid:!0}).then((function(){return i(r.output("datauristring"))}))}e.CanVGRenderer={},e.domurl=u.URL||u.webkitURL||u,e.loadEventDeferDelay=s.isMS?150:0,e.compose=function(t){if(-1===_.indexOf(t)){_.push(t);var e=t.prototype;e.getSVGForLocalExport=a,e.exportChartLocal=i,y(!0,h.exporting,o)}return t},e.downloadSVGLocal=function(i,r,s,a){var o=d.createElement("div"),p=r.type||"image/png",g=(r.filename||"chart")+"."+("image/svg+xml"===p?"svg":p.split("/")[1]),m=r.scale||1,v=r.libURL||h.exporting.libURL,y=!0,_=r.pdfFont;v="/"!==v.slice(-1)?v+"/":v;var w=function(){t.setElementHTML(o,i);var e,n=o.getElementsByTagName("text");[].forEach.call(n,(function(t){["font-family","font-size"].forEach((function(e){for(var i=t;i&&i!==o;){if(i.style[e]){t.style[e]=i.style[e];break}i=i.parentNode}})),t.style.fontFamily=_&&_.normal?"HighchartsFont":String(t.style.fontFamily&&t.style.fontFamily.split(" ").splice(-1)),e=t.getElementsByTagName("title"),[].forEach.call(e,(function(e){t.removeChild(e)}))}));var r=o.querySelector("svg");r&&function(t,e){var i=function(t,e){u.jspdf.jsPDF.API.events.push(["initialized",function(){this.addFileToVFS(t,e),this.addFont(t,"HighchartsFont",t),this.getFontList().HighchartsFont||this.setFont("HighchartsFont")}])};_&&!/[^\u0000-\u007F\u200B]+/.test(t.textContent||"")&&(_=void 0);var n,r=["normal","italic","bold","bolditalic"],s=function(){var t=r.shift();if(!t)return e();var a=_&&_[t];a?f({url:a,responseType:"blob",success:function(e,r){(e=new FileReader).onloadend=function(){if("string"==typeof this.result){var e=this.result.split(",")[1];i(t,e),"normal"===t&&(n=e)}s()},e.readAsDataURL(r.response)},error:s}):(n&&i(t,n),s())};s()}(r,(function(){x(r,0,(function(t){try{c(t,g),a&&a()}catch(t){s(t)}}))}))};if("image/svg+xml"===p)try{if(void 0!==u.navigator.msSaveOrOpenBlob){var S=new MSBlobBuilder;S.append(i);var T=S.getBlob("image/svg+xml")}else T=b(i);c(T,g),a&&a()}catch(t){s(t)}else if("application/pdf"===p)u.jspdf&&u.jspdf.jsPDF?w():(y=!0,n(v+"jspdf.js",(function(){n(v+"svg2pdf.js",w)})));else{T=b(i);var E=function(){try{e.domurl.revokeObjectURL(T)}catch(t){}};l(T,p,{},m,(function(t){try{c(t,g),a&&a()}catch(t){s(t)}}),(function(){var t=d.createElement("canvas"),e=t.getContext("2d"),r=i.match(/^<svg[^>]*width\s*=\s*"?(\d+)"?[^>]*>/)[1]*m,o=i.match(/^<svg[^>]*height\s*=\s*"?(\d+)"?[^>]*>/)[1]*m,l=function(){u.canvg.Canvg.fromString(e,i).start();try{c(u.navigator.msSaveOrOpenBlob?t.msToBlob():t.toDataURL(p),g),a&&a()}catch(t){s(t)}finally{E()}};t.width=r,t.height=o,u.canvg?l():(y=!0,n(v+"canvg.js",(function(){l()})))}),s,s,(function(){y&&E()}))}},e.getScript=n,e.imageToDataUrl=l,e.svgToDataUrl=b,e.svgToPdf=x}(b||(b={})),b})),e(t,"masters/modules/offline-exporting.src.js",[t["Core/Globals.js"],t["Extensions/OfflineExporting/OfflineExporting.js"]],(function(t,e){t.downloadSVGLocal=e.downloadSVGLocal,e.compose(t.Chart)}))},t.exports?(s.default=s,t.exports=s):(n=[i(8840),i(8393)],void 0===(r=function(t){return s(t),s.Highcharts=t,s}.apply(e,n))||(t.exports=r))},9483:(t,e,i)=>{
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
t.exports=function t(e,i,n){function r(a,o){if(!i[a]){if(!e[a]){if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[a]={exports:{}};e[a][0].call(h.exports,(function(t){var i=e[a][1][t];return r(i||t)}),h,h.exports,t,e,i,n)}return i[a].exports}for(var s=void 0,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(t,e,n){(function(t){"use strict";var i,n,r=t.MutationObserver||t.WebKitMutationObserver;if(r){var s=0,a=new r(c),o=t.document.createTextNode("");a.observe(o,{characterData:!0}),i=function(){o.data=s=++s%2}}else if(t.setImmediate||void 0===t.MessageChannel)i="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){c(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(c,0)};else{var l=new t.MessageChannel;l.port1.onmessage=c,i=function(){l.port2.postMessage(0)}}var h=[];function c(){var t,e;n=!0;for(var i=h.length;i;){for(e=h,h=[],t=-1;++t<i;)e[t]();i=h.length}n=!1}function u(t){1!==h.push(t)||n||i()}e.exports=u}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,i){"use strict";var n=t(1);function r(){}var s={},a=["REJECTED"],o=["FULFILLED"],l=["PENDING"];function h(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,t!==r&&f(this,t)}function c(t,e,i){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function u(t,e,i){n((function(){var n;try{n=e(i)}catch(e){return s.reject(t,e)}n===t?s.reject(t,new TypeError("Cannot resolve promise with itself")):s.resolve(t,n)}))}function d(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function f(t,e){var i=!1;function n(e){i||(i=!0,s.reject(t,e))}function r(e){i||(i=!0,s.resolve(t,e))}function a(){e(r,n)}var o=p(a);"error"===o.status&&n(o.value)}function p(t,e){var i={};try{i.value=t(e),i.status="success"}catch(t){i.status="error",i.value=t}return i}function g(t){return t instanceof this?t:s.resolve(new this(r),t)}function m(t){var e=new this(r);return s.reject(e,t)}function v(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var i=t.length,n=!1;if(!i)return this.resolve([]);for(var a=new Array(i),o=0,l=-1,h=new this(r);++l<i;)c(t[l],l);return h;function c(t,r){function l(t){a[r]=t,++o!==i||n||(n=!0,s.resolve(h,a))}e.resolve(t).then(l,(function(t){n||(n=!0,s.reject(h,t))}))}}function y(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var i=t.length,n=!1;if(!i)return this.resolve([]);for(var a=-1,o=new this(r);++a<i;)l(t[a]);return o;function l(t){e.resolve(t).then((function(t){n||(n=!0,s.resolve(o,t))}),(function(t){n||(n=!0,s.reject(o,t))}))}}e.exports=h,h.prototype.catch=function(t){return this.then(null,t)},h.prototype.then=function(t,e){if("function"!=typeof t&&this.state===o||"function"!=typeof e&&this.state===a)return this;var i=new this.constructor(r);return this.state!==l?u(i,this.state===o?t:e,this.outcome):this.queue.push(new c(i,t,e)),i},c.prototype.callFulfilled=function(t){s.resolve(this.promise,t)},c.prototype.otherCallFulfilled=function(t){u(this.promise,this.onFulfilled,t)},c.prototype.callRejected=function(t){s.reject(this.promise,t)},c.prototype.otherCallRejected=function(t){u(this.promise,this.onRejected,t)},s.resolve=function(t,e){var i=p(d,e);if("error"===i.status)return s.reject(t,i.value);var n=i.value;if(n)f(t,n);else{t.state=o,t.outcome=e;for(var r=-1,a=t.queue.length;++r<a;)t.queue[r].callFulfilled(e)}return t},s.reject=function(t,e){t.state=a,t.outcome=e;for(var i=-1,n=t.queue.length;++i<n;)t.queue[i].callRejected(e);return t},h.resolve=g,h.reject=m,h.all=v,h.race=y},{1:1}],3:[function(t,e,n){(function(e){"use strict";"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}var a=s();function o(){try{if(!a||!a.open)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}function l(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(r){if("TypeError"!==r.name)throw r;for(var i=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<t.length;n+=1)i.append(t[n]);return i.getBlob(e.type)}}"undefined"==typeof Promise&&t(3);var h=Promise;function c(t,e){e&&t.then((function(t){e(null,t)}),(function(t){e(t)}))}function u(t,e,i){"function"==typeof e&&t.then(e),"function"==typeof i&&t.catch(i)}function d(t){return"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function f(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var p="local-forage-detect-blob-support",g=void 0,m={},v=Object.prototype.toString,y="readonly",b="readwrite";function _(t){for(var e=t.length,i=new ArrayBuffer(e),n=new Uint8Array(i),r=0;r<e;r++)n[r]=t.charCodeAt(r);return i}function x(t){return new h((function(e){var i=t.transaction(p,b),n=l([""]);i.objectStore(p).put(n,"key"),i.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},i.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),i=navigator.userAgent.match(/Edge\//);e(i||!t||parseInt(t[1],10)>=43)}})).catch((function(){return!1}))}function w(t){return"boolean"==typeof g?h.resolve(g):x(t).then((function(t){return g=t}))}function S(t){var e=m[t.name],i={};i.promise=new h((function(t,e){i.resolve=t,i.reject=e})),e.deferredOperations.push(i),e.dbReady?e.dbReady=e.dbReady.then((function(){return i.promise})):e.dbReady=i.promise}function T(t){var e=m[t.name].deferredOperations.pop();if(e)return e.resolve(),e.promise}function E(t,e){var i=m[t.name].deferredOperations.pop();if(i)return i.reject(e),i.promise}function k(t,e){return new h((function(i,n){if(m[t.name]=m[t.name]||N(),t.db){if(!e)return i(t.db);S(t),t.db.close()}var r=[t.name];e&&r.push(t.version);var s=a.open.apply(a,r);e&&(s.onupgradeneeded=function(e){var i=s.result;try{i.createObjectStore(t.storeName),e.oldVersion<=1&&i.createObjectStore(p)}catch(i){if("ConstraintError"!==i.name)throw i;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),s.onerror=function(t){t.preventDefault(),n(s.error)},s.onsuccess=function(){var e=s.result;e.onversionchange=function(t){t.target.close()},i(e),T(t)}}))}function C(t){return k(t,!1)}function M(t){return k(t,!0)}function A(t,e){if(!t.db)return!0;var i=!t.db.objectStoreNames.contains(t.storeName),n=t.version<t.db.version,r=t.version>t.db.version;if(n&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),r||i){if(i){var s=t.db.version+1;s>t.version&&(t.version=s)}return!0}return!1}function O(t){return new h((function(e,i){var n=new FileReader;n.onerror=i,n.onloadend=function(i){var n=btoa(i.target.result||"");e({__local_forage_encoded_blob:!0,data:n,type:t.type})},n.readAsBinaryString(t)}))}function P(t){return l([_(atob(t.data))],{type:t.type})}function R(t){return t&&t.__local_forage_encoded_blob}function I(t){var e=this,i=e._initReady().then((function(){var t=m[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady}));return u(i,t,t),i}function L(t){S(t);for(var e=m[t.name],i=e.forages,n=0;n<i.length;n++){var r=i[n];r._dbInfo.db&&(r._dbInfo.db.close(),r._dbInfo.db=null)}return t.db=null,C(t).then((function(e){return t.db=e,A(t)?M(t):e})).then((function(n){t.db=e.db=n;for(var r=0;r<i.length;r++)i[r]._dbInfo.db=n})).catch((function(e){throw E(t,e),e}))}function D(t,e,i,n){void 0===n&&(n=1);try{var r=t.db.transaction(t.storeName,e);i(null,r)}catch(r){if(n>0&&(!t.db||"InvalidStateError"===r.name||"NotFoundError"===r.name))return h.resolve().then((function(){if(!t.db||"NotFoundError"===r.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),M(t)})).then((function(){return L(t).then((function(){D(t,e,i,n-1)}))})).catch(i);i(r)}}function N(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function F(t){var e=this,i={db:null};if(t)for(var n in t)i[n]=t[n];var r=m[i.name];r||(r=N(),m[i.name]=r),r.forages.push(e),e._initReady||(e._initReady=e.ready,e.ready=I);var s=[];function a(){return h.resolve()}for(var o=0;o<r.forages.length;o++){var l=r.forages[o];l!==e&&s.push(l._initReady().catch(a))}var c=r.forages.slice(0);return h.all(s).then((function(){return i.db=r.db,C(i)})).then((function(t){return i.db=t,A(i,e._defaultConfig.version)?M(i):t})).then((function(t){i.db=r.db=t,e._dbInfo=i;for(var n=0;n<c.length;n++){var s=c[n];s!==e&&(s._dbInfo.db=i.db,s._dbInfo.version=i.version)}}))}function j(t,e){var i=this;t=d(t);var n=new h((function(e,n){i.ready().then((function(){D(i._dbInfo,y,(function(r,s){if(r)return n(r);try{var a=s.objectStore(i._dbInfo.storeName).get(t);a.onsuccess=function(){var t=a.result;void 0===t&&(t=null),R(t)&&(t=P(t)),e(t)},a.onerror=function(){n(a.error)}}catch(t){n(t)}}))})).catch(n)}));return c(n,e),n}function B(t,e){var i=this,n=new h((function(e,n){i.ready().then((function(){D(i._dbInfo,y,(function(r,s){if(r)return n(r);try{var a=s.objectStore(i._dbInfo.storeName).openCursor(),o=1;a.onsuccess=function(){var i=a.result;if(i){var n=i.value;R(n)&&(n=P(n));var r=t(n,i.key,o++);void 0!==r?e(r):i.continue()}else e()},a.onerror=function(){n(a.error)}}catch(t){n(t)}}))})).catch(n)}));return c(n,e),n}function z(t,e,i){var n=this;t=d(t);var r=new h((function(i,r){var s;n.ready().then((function(){return s=n._dbInfo,"[object Blob]"===v.call(e)?w(s.db).then((function(t){return t?e:O(e)})):e})).then((function(e){D(n._dbInfo,b,(function(s,a){if(s)return r(s);try{var o=a.objectStore(n._dbInfo.storeName);null===e&&(e=void 0);var l=o.put(e,t);a.oncomplete=function(){void 0===e&&(e=null),i(e)},a.onabort=a.onerror=function(){var t=l.error?l.error:l.transaction.error;r(t)}}catch(t){r(t)}}))})).catch(r)}));return c(r,i),r}function W(t,e){var i=this;t=d(t);var n=new h((function(e,n){i.ready().then((function(){D(i._dbInfo,b,(function(r,s){if(r)return n(r);try{var a=s.objectStore(i._dbInfo.storeName).delete(t);s.oncomplete=function(){e()},s.onerror=function(){n(a.error)},s.onabort=function(){var t=a.error?a.error:a.transaction.error;n(t)}}catch(t){n(t)}}))})).catch(n)}));return c(n,e),n}function G(t){var e=this,i=new h((function(t,i){e.ready().then((function(){D(e._dbInfo,b,(function(n,r){if(n)return i(n);try{var s=r.objectStore(e._dbInfo.storeName).clear();r.oncomplete=function(){t()},r.onabort=r.onerror=function(){var t=s.error?s.error:s.transaction.error;i(t)}}catch(t){i(t)}}))})).catch(i)}));return c(i,t),i}function U(t){var e=this,i=new h((function(t,i){e.ready().then((function(){D(e._dbInfo,y,(function(n,r){if(n)return i(n);try{var s=r.objectStore(e._dbInfo.storeName).count();s.onsuccess=function(){t(s.result)},s.onerror=function(){i(s.error)}}catch(t){i(t)}}))})).catch(i)}));return c(i,t),i}function H(t,e){var i=this,n=new h((function(e,n){t<0?e(null):i.ready().then((function(){D(i._dbInfo,y,(function(r,s){if(r)return n(r);try{var a=s.objectStore(i._dbInfo.storeName),o=!1,l=a.openKeyCursor();l.onsuccess=function(){var i=l.result;i?0===t||o?e(i.key):(o=!0,i.advance(t)):e(null)},l.onerror=function(){n(l.error)}}catch(t){n(t)}}))})).catch(n)}));return c(n,e),n}function X(t){var e=this,i=new h((function(t,i){e.ready().then((function(){D(e._dbInfo,y,(function(n,r){if(n)return i(n);try{var s=r.objectStore(e._dbInfo.storeName).openKeyCursor(),a=[];s.onsuccess=function(){var e=s.result;e?(a.push(e.key),e.continue()):t(a)},s.onerror=function(){i(s.error)}}catch(t){i(t)}}))})).catch(i)}));return c(i,t),i}function V(t,e){e=f.apply(this,arguments);var i=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||i.name,t.storeName=t.storeName||i.storeName);var n,r=this;if(t.name){var s=t.name===i.name&&r._dbInfo.db?h.resolve(r._dbInfo.db):C(t).then((function(e){var i=m[t.name],n=i.forages;i.db=e;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=e;return e}));n=t.storeName?s.then((function(e){if(e.objectStoreNames.contains(t.storeName)){var i=e.version+1;S(t);var n=m[t.name],r=n.forages;e.close();for(var s=0;s<r.length;s++){var o=r[s];o._dbInfo.db=null,o._dbInfo.version=i}var l=new h((function(e,n){var r=a.open(t.name,i);r.onerror=function(t){r.result.close(),n(t)},r.onupgradeneeded=function(){r.result.deleteObjectStore(t.storeName)},r.onsuccess=function(){var t=r.result;t.close(),e(t)}}));return l.then((function(t){n.db=t;for(var e=0;e<r.length;e++){var i=r[e];i._dbInfo.db=t,T(i._dbInfo)}})).catch((function(e){throw(E(t,e)||h.resolve()).catch((function(){})),e}))}})):s.then((function(e){S(t);var i=m[t.name],n=i.forages;e.close();for(var r=0;r<n.length;r++)n[r]._dbInfo.db=null;var s=new h((function(e,i){var n=a.deleteDatabase(t.name);n.onerror=function(){var t=n.result;t&&t.close(),i(n.error)},n.onblocked=function(){console.warn('dropInstance blocked for database "'+t.name+'" until all open connections are closed')},n.onsuccess=function(){var t=n.result;t&&t.close(),e(t)}}));return s.then((function(t){i.db=t;for(var e=0;e<n.length;e++)T(n[e]._dbInfo)})).catch((function(e){throw(E(t,e)||h.resolve()).catch((function(){})),e}))}))}else n=h.reject("Invalid arguments");return c(n,e),n}var Y={_driver:"asyncStorage",_initStorage:F,_support:o(),iterate:B,getItem:j,setItem:z,removeItem:W,clear:G,length:U,key:H,keys:X,dropInstance:V};function K(){return"function"==typeof openDatabase}var q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Z="~~local_forage_type~",J=/^~~local_forage_type~([^~]+)~/,$="__lfsc__:",Q=$.length,tt="arbf",et="blob",it="si08",nt="ui08",rt="uic8",st="si16",at="si32",ot="ur16",lt="ui32",ht="fl32",ct="fl64",ut=Q+tt.length,dt=Object.prototype.toString;function ft(t){var e,i,n,r,s,a=.75*t.length,o=t.length,l=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var h=new ArrayBuffer(a),c=new Uint8Array(h);for(e=0;e<o;e+=4)i=q.indexOf(t[e]),n=q.indexOf(t[e+1]),r=q.indexOf(t[e+2]),s=q.indexOf(t[e+3]),c[l++]=i<<2|n>>4,c[l++]=(15&n)<<4|r>>2,c[l++]=(3&r)<<6|63&s;return h}function pt(t){var e,i=new Uint8Array(t),n="";for(e=0;e<i.length;e+=3)n+=q[i[e]>>2],n+=q[(3&i[e])<<4|i[e+1]>>4],n+=q[(15&i[e+1])<<2|i[e+2]>>6],n+=q[63&i[e+2]];return i.length%3==2?n=n.substring(0,n.length-1)+"=":i.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}function gt(t,e){var i="";if(t&&(i=dt.call(t)),t&&("[object ArrayBuffer]"===i||t.buffer&&"[object ArrayBuffer]"===dt.call(t.buffer))){var n,r=$;t instanceof ArrayBuffer?(n=t,r+=tt):(n=t.buffer,"[object Int8Array]"===i?r+=it:"[object Uint8Array]"===i?r+=nt:"[object Uint8ClampedArray]"===i?r+=rt:"[object Int16Array]"===i?r+=st:"[object Uint16Array]"===i?r+=ot:"[object Int32Array]"===i?r+=at:"[object Uint32Array]"===i?r+=lt:"[object Float32Array]"===i?r+=ht:"[object Float64Array]"===i?r+=ct:e(new Error("Failed to get type for BinaryArray"))),e(r+pt(n))}else if("[object Blob]"===i){var s=new FileReader;s.onload=function(){var i=Z+t.type+"~"+pt(this.result);e($+et+i)},s.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(i){console.error("Couldn't convert value into a JSON string: ",t),e(null,i)}}function mt(t){if(t.substring(0,Q)!==$)return JSON.parse(t);var e,i=t.substring(ut),n=t.substring(Q,ut);if(n===et&&J.test(i)){var r=i.match(J);e=r[1],i=i.substring(r[0].length)}var s=ft(i);switch(n){case tt:return s;case et:return l([s],{type:e});case it:return new Int8Array(s);case nt:return new Uint8Array(s);case rt:return new Uint8ClampedArray(s);case st:return new Int16Array(s);case ot:return new Uint16Array(s);case at:return new Int32Array(s);case lt:return new Uint32Array(s);case ht:return new Float32Array(s);case ct:return new Float64Array(s);default:throw new Error("Unkown type: "+n)}}var vt={serialize:gt,deserialize:mt,stringToBuffer:ft,bufferToString:pt};function yt(t,e,i,n){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],i,n)}function bt(t){var e=this,i={db:null};if(t)for(var n in t)i[n]="string"!=typeof t[n]?t[n].toString():t[n];var r=new h((function(t,n){try{i.db=openDatabase(i.name,String(i.version),i.description,i.size)}catch(t){return n(t)}i.db.transaction((function(r){yt(r,i,(function(){e._dbInfo=i,t()}),(function(t,e){n(e)}))}),n)}));return i.serializer=vt,r}function _t(t,e,i,n,r,s){t.executeSql(i,n,r,(function(t,a){a.code===a.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],(function(t,o){o.rows.length?s(t,a):yt(t,e,(function(){t.executeSql(i,n,r,s)}),s)}),s):s(t,a)}),s)}function xt(t,e){var i=this;t=d(t);var n=new h((function(e,n){i.ready().then((function(){var r=i._dbInfo;r.db.transaction((function(i){_t(i,r,"SELECT * FROM "+r.storeName+" WHERE key = ? LIMIT 1",[t],(function(t,i){var n=i.rows.length?i.rows.item(0).value:null;n&&(n=r.serializer.deserialize(n)),e(n)}),(function(t,e){n(e)}))}))})).catch(n)}));return c(n,e),n}function wt(t,e){var i=this,n=new h((function(e,n){i.ready().then((function(){var r=i._dbInfo;r.db.transaction((function(i){_t(i,r,"SELECT * FROM "+r.storeName,[],(function(i,n){for(var s=n.rows,a=s.length,o=0;o<a;o++){var l=s.item(o),h=l.value;if(h&&(h=r.serializer.deserialize(h)),void 0!==(h=t(h,l.key,o+1)))return void e(h)}e()}),(function(t,e){n(e)}))}))})).catch(n)}));return c(n,e),n}function St(t,e,i,n){var r=this;t=d(t);var s=new h((function(s,a){r.ready().then((function(){void 0===e&&(e=null);var o=e,l=r._dbInfo;l.serializer.serialize(e,(function(e,h){h?a(h):l.db.transaction((function(i){_t(i,l,"INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",[t,e],(function(){s(o)}),(function(t,e){a(e)}))}),(function(e){if(e.code===e.QUOTA_ERR){if(n>0)return void s(St.apply(r,[t,o,i,n-1]));a(e)}}))}))})).catch(a)}));return c(s,i),s}function Tt(t,e,i){return St.apply(this,[t,e,i,1])}function Et(t,e){var i=this;t=d(t);var n=new h((function(e,n){i.ready().then((function(){var r=i._dbInfo;r.db.transaction((function(i){_t(i,r,"DELETE FROM "+r.storeName+" WHERE key = ?",[t],(function(){e()}),(function(t,e){n(e)}))}))})).catch(n)}));return c(n,e),n}function kt(t){var e=this,i=new h((function(t,i){e.ready().then((function(){var n=e._dbInfo;n.db.transaction((function(e){_t(e,n,"DELETE FROM "+n.storeName,[],(function(){t()}),(function(t,e){i(e)}))}))})).catch(i)}));return c(i,t),i}function Ct(t){var e=this,i=new h((function(t,i){e.ready().then((function(){var n=e._dbInfo;n.db.transaction((function(e){_t(e,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],(function(e,i){var n=i.rows.item(0).c;t(n)}),(function(t,e){i(e)}))}))})).catch(i)}));return c(i,t),i}function Mt(t,e){var i=this,n=new h((function(e,n){i.ready().then((function(){var r=i._dbInfo;r.db.transaction((function(i){_t(i,r,"SELECT key FROM "+r.storeName+" WHERE id = ? LIMIT 1",[t+1],(function(t,i){var n=i.rows.length?i.rows.item(0).key:null;e(n)}),(function(t,e){n(e)}))}))})).catch(n)}));return c(n,e),n}function At(t){var e=this,i=new h((function(t,i){e.ready().then((function(){var n=e._dbInfo;n.db.transaction((function(e){_t(e,n,"SELECT key FROM "+n.storeName,[],(function(e,i){for(var n=[],r=0;r<i.rows.length;r++)n.push(i.rows.item(r).key);t(n)}),(function(t,e){i(e)}))}))})).catch(i)}));return c(i,t),i}function Ot(t){return new h((function(e,i){t.transaction((function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(i,n){for(var r=[],s=0;s<n.rows.length;s++)r.push(n.rows.item(s).name);e({db:t,storeNames:r})}),(function(t,e){i(e)}))}),(function(t){i(t)}))}))}function Pt(t,e){e=f.apply(this,arguments);var i=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||i.name,t.storeName=t.storeName||i.storeName);var n,r=this;return c(n=t.name?new h((function(e){var n;n=t.name===i.name?r._dbInfo.db:openDatabase(t.name,"","",0),t.storeName?e({db:n,storeNames:[t.storeName]}):e(Ot(n))})).then((function(t){return new h((function(e,i){t.db.transaction((function(n){function r(t){return new h((function(e,i){n.executeSql("DROP TABLE IF EXISTS "+t,[],(function(){e()}),(function(t,e){i(e)}))}))}for(var s=[],a=0,o=t.storeNames.length;a<o;a++)s.push(r(t.storeNames[a]));h.all(s).then((function(){e()})).catch((function(t){i(t)}))}),(function(t){i(t)}))}))})):h.reject("Invalid arguments"),e),n}var Rt={_driver:"webSQLStorage",_initStorage:bt,_support:K(),iterate:wt,getItem:xt,setItem:Tt,removeItem:Et,clear:kt,length:Ct,key:Mt,keys:At,dropInstance:Pt};function It(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}function Lt(t,e){var i=t.name+"/";return t.storeName!==e.storeName&&(i+=t.storeName+"/"),i}function Dt(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),!1}catch(t){return!0}}function Nt(){return!Dt()||localStorage.length>0}function Ft(t){var e=this,i={};if(t)for(var n in t)i[n]=t[n];return i.keyPrefix=Lt(t,e._defaultConfig),Nt()?(e._dbInfo=i,i.serializer=vt,h.resolve()):h.reject()}function jt(t){var e=this,i=e.ready().then((function(){for(var t=e._dbInfo.keyPrefix,i=localStorage.length-1;i>=0;i--){var n=localStorage.key(i);0===n.indexOf(t)&&localStorage.removeItem(n)}}));return c(i,t),i}function Bt(t,e){var i=this;t=d(t);var n=i.ready().then((function(){var e=i._dbInfo,n=localStorage.getItem(e.keyPrefix+t);return n&&(n=e.serializer.deserialize(n)),n}));return c(n,e),n}function zt(t,e){var i=this,n=i.ready().then((function(){for(var e=i._dbInfo,n=e.keyPrefix,r=n.length,s=localStorage.length,a=1,o=0;o<s;o++){var l=localStorage.key(o);if(0===l.indexOf(n)){var h=localStorage.getItem(l);if(h&&(h=e.serializer.deserialize(h)),void 0!==(h=t(h,l.substring(r),a++)))return h}}}));return c(n,e),n}function Wt(t,e){var i=this,n=i.ready().then((function(){var e,n=i._dbInfo;try{e=localStorage.key(t)}catch(t){e=null}return e&&(e=e.substring(n.keyPrefix.length)),e}));return c(n,e),n}function Gt(t){var e=this,i=e.ready().then((function(){for(var t=e._dbInfo,i=localStorage.length,n=[],r=0;r<i;r++){var s=localStorage.key(r);0===s.indexOf(t.keyPrefix)&&n.push(s.substring(t.keyPrefix.length))}return n}));return c(i,t),i}function Ut(t){var e=this.keys().then((function(t){return t.length}));return c(e,t),e}function Ht(t,e){var i=this;t=d(t);var n=i.ready().then((function(){var e=i._dbInfo;localStorage.removeItem(e.keyPrefix+t)}));return c(n,e),n}function Xt(t,e,i){var n=this;t=d(t);var r=n.ready().then((function(){void 0===e&&(e=null);var i=e;return new h((function(r,s){var a=n._dbInfo;a.serializer.serialize(e,(function(e,n){if(n)s(n);else try{localStorage.setItem(a.keyPrefix+t,e),r(i)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||s(t),s(t)}}))}))}));return c(r,i),r}function Vt(t,e){if(e=f.apply(this,arguments),!(t="function"!=typeof t&&t||{}).name){var i=this.config();t.name=t.name||i.name,t.storeName=t.storeName||i.storeName}var n,r=this;return n=t.name?new h((function(e){t.storeName?e(Lt(t,r._defaultConfig)):e(t.name+"/")})).then((function(t){for(var e=localStorage.length-1;e>=0;e--){var i=localStorage.key(e);0===i.indexOf(t)&&localStorage.removeItem(i)}})):h.reject("Invalid arguments"),c(n,e),n}var Yt={_driver:"localStorageWrapper",_initStorage:Ft,_support:It(),iterate:zt,getItem:Bt,setItem:Xt,removeItem:Ht,clear:jt,length:Ut,key:Wt,keys:Gt,dropInstance:Vt},Kt=function(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)},qt=function(t,e){for(var i=t.length,n=0;n<i;){if(Kt(t[n],e))return!0;n++}return!1},Zt=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Jt={},$t={},Qt={INDEXEDDB:Y,WEBSQL:Rt,LOCALSTORAGE:Yt},te=[Qt.INDEXEDDB._driver,Qt.WEBSQL._driver,Qt.LOCALSTORAGE._driver],ee=["dropInstance"],ie=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ee),ne={description:"",driver:te.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function re(t,e){t[e]=function(){var i=arguments;return t.ready().then((function(){return t[e].apply(t,i)}))}}function se(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var i in e)e.hasOwnProperty(i)&&(Zt(e[i])?arguments[0][i]=e[i].slice():arguments[0][i]=e[i])}return arguments[0]}var ae=function(){function t(e){for(var i in r(this,t),Qt)if(Qt.hasOwnProperty(i)){var n=Qt[i],s=n._driver;this[i]=s,Jt[s]||this.defineDriver(n)}this._defaultConfig=se({},ne),this._config=se({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return t.prototype.config=function(t){if("object"===(void 0===t?"undefined":n(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t)||!t.driver||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,i){var n=new h((function(e,i){try{var n=t._driver,r=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void i(r);for(var s=ie.concat("_initStorage"),a=0,o=s.length;a<o;a++){var l=s[a];if((!qt(ee,l)||t[l])&&"function"!=typeof t[l])return void i(r)}var u=function(){for(var e=function(t){return function(){var e=new Error("Method "+t+" is not implemented by the current driver"),i=h.reject(e);return c(i,arguments[arguments.length-1]),i}},i=0,n=ee.length;i<n;i++){var r=ee[i];t[r]||(t[r]=e(r))}};u();var d=function(i){Jt[n]&&console.info("Redefining LocalForage driver: "+n),Jt[n]=t,$t[n]=i,e()};"_support"in t?t._support&&"function"==typeof t._support?t._support().then(d,i):d(!!t._support):d(!0)}catch(t){i(t)}}));return u(n,e,i),n},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,i){var n=Jt[t]?h.resolve(Jt[t]):h.reject(new Error("Driver not found."));return u(n,e,i),n},t.prototype.getSerializer=function(t){var e=h.resolve(vt);return u(e,t),e},t.prototype.ready=function(t){var e=this,i=e._driverSet.then((function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready}));return u(i,t,t),i},t.prototype.setDriver=function(t,e,i){var n=this;Zt(t)||(t=[t]);var r=this._getSupportedDrivers(t);function s(){n._config.driver=n.driver()}function a(t){return n._extend(t),s(),n._ready=n._initStorage(n._config),n._ready}function o(t){return function(){var e=0;function i(){for(;e<t.length;){var r=t[e];return e++,n._dbInfo=null,n._ready=null,n.getDriver(r).then(a).catch(i)}s();var o=new Error("No available storage method found.");return n._driverSet=h.reject(o),n._driverSet}return i()}}var l=null!==this._driverSet?this._driverSet.catch((function(){return h.resolve()})):h.resolve();return this._driverSet=l.then((function(){var t=r[0];return n._dbInfo=null,n._ready=null,n.getDriver(t).then((function(t){n._driver=t._driver,s(),n._wrapLibraryMethodsWithReady(),n._initDriver=o(r)}))})).catch((function(){s();var t=new Error("No available storage method found.");return n._driverSet=h.reject(t),n._driverSet})),u(this._driverSet,e,i),this._driverSet},t.prototype.supports=function(t){return!!$t[t]},t.prototype._extend=function(t){se(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i];this.supports(r)&&e.push(r)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=ie.length;t<e;t++)re(this,ie[t])},t.prototype.createInstance=function(e){return new t(e)},t}(),oe=new ae;e.exports=oe},{3:3}]},{},[4])(4)},8018:(t,e,i)=>{"use strict";var n=i(8178);t.exports=function(t,e,i){var r=[],s=!1,a=-1;function o(){for(a=0;a<r.length;a+=2)try{t(r[a],n(r[a+1]),l)}catch(t){i.error(t)}a=-1}function l(){s||(s=!0,e((function(){s=!1,o()})))}return l.sync=o,{mount:function(e,i){if(null!=i&&null==i.view&&"function"!=typeof i)throw new TypeError("m.mount expects a component, not a vnode.");var s=r.indexOf(e);s>=0&&(r.splice(s,2),s<=a&&(a-=2),t(e,[])),null!=i&&(r.push(e,i),t(e,n(i),l))},redraw:l}}},3223:(t,e,i)=>{"use strict";var n=i(8178),r=i(373),s=i(5164),a=i(249),o=i(8561),l=i(7562),h=i(5641),c=i(6542),u={};function d(t){try{return decodeURIComponent(t)}catch(e){return t}}t.exports=function(t,e){var i,f,p,g,m,v,y=null==t?null:"function"==typeof t.setImmediate?t.setImmediate:t.setTimeout,b=s.resolve(),_=!1,x=!1,w=0,S=u,T={onbeforeupdate:function(){return!(!(w=w?2:1)||u===S)},onremove:function(){t.removeEventListener("popstate",C,!1),t.removeEventListener("hashchange",k,!1)},view:function(){if(w&&u!==S){var t=[n(p,g.key,g)];return S&&(t=S.render(t[0])),t}}},E=A.SKIP={};function k(){_=!1;var n=t.location.hash;"#"!==A.prefix[0]&&(n=t.location.search+n,"?"!==A.prefix[0]&&"/"!==(n=t.location.pathname+n)[0]&&(n="/"+n));var r=n.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,d).slice(A.prefix.length),s=o(r);function a(t){console.error(t),M(f,null,{replace:!0})}h(s.params,t.history.state),function t(n){for(;n<i.length;n++)if(i[n].check(s)){var o=i[n].component,l=i[n].route,h=o,c=v=function(i){if(c===v){if(i===E)return t(n+1);p=null==i||"function"!=typeof i.view&&"function"!=typeof i?"div":i,g=s.params,m=r,v=null,S=o.render?o:null,2===w?e.redraw():(w=2,e.redraw.sync())}};return void(o.view||"function"==typeof o?(o={},c(h)):o.onmatch?b.then((function(){return o.onmatch(s.params,r,l)})).then(c,r===f?null:a):c("div"))}if(r===f)throw new Error("Could not resolve default route "+f+".");M(f,null,{replace:!0})}(0)}function C(){_||(_=!0,y(k))}function M(e,i,n){if(e=a(e,i),x){C();var r=n?n.state:null,s=n?n.title:null;n&&n.replace?t.history.replaceState(r,s,A.prefix+e):t.history.pushState(r,s,A.prefix+e)}else t.location.href=A.prefix+e}function A(n,r,s){if(!n)throw new TypeError("DOM element being rendered to does not exist.");if(i=Object.keys(s).map((function(t){if("/"!==t[0])throw new SyntaxError("Routes must start with a '/'.");if(/:([^\/\.-]+)(\.{3})?:/.test(t))throw new SyntaxError("Route parameter names must be separated with either '/', '.', or '-'.");return{route:t,component:s[t],check:l(t)}})),f=r,null!=r){var a=o(r);if(!i.some((function(t){return t.check(a)})))throw new ReferenceError("Default route doesn't match any known routes.")}"function"==typeof t.history.pushState?t.addEventListener("popstate",C,!1):"#"===A.prefix[0]&&t.addEventListener("hashchange",k,!1),x=!0,e.mount(n,T),k()}return A.set=function(t,e,i){null!=v&&((i=i||{}).replace=!0),v=null,M(t,e,i)},A.get=function(){return m},A.prefix="#!",A.Link={view:function(t){var e,i,n,s=r(t.attrs.selector||"a",c(t.attrs,["options","params","selector","onclick"]),t.children);return(s.attrs.disabled=Boolean(s.attrs.disabled))?(s.attrs.href=null,s.attrs["aria-disabled"]="true"):(e=t.attrs.options,i=t.attrs.onclick,n=a(s.attrs.href,t.attrs.params),s.attrs.href=A.prefix+n,s.attrs.onclick=function(t){var r;"function"==typeof i?r=i.call(t.currentTarget,t):null==i||"object"!=typeof i||"function"==typeof i.handleEvent&&i.handleEvent(t),!1===r||t.defaultPrevented||0!==t.button&&0!==t.which&&1!==t.which||t.currentTarget.target&&"_self"!==t.currentTarget.target||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey||(t.preventDefault(),t.redraw=!1,A.set(n,null,e))}),s}},A.param=function(t){return g&&null!=t?g[t]:g},A}},1262:(t,e,i)=>{"use strict";var n=i(373);n.trust=i(4742),n.fragment=i(9621),t.exports=n},865:(t,e,i)=>{"use strict";var n=i(1262),r=i(9074),s=i(9165),a=function(){return n.apply(this,arguments)};a.m=n,a.trust=n.trust,a.fragment=n.fragment,a.Fragment="[",a.mount=s.mount,a.route=i(843),a.render=i(5358),a.redraw=s.redraw,a.request=r.request,a.jsonp=r.jsonp,a.parseQueryString=i(9874),a.buildQueryString=i(478),a.parsePathname=i(8561),a.buildPathname=i(249),a.vnode=i(8178),a.PromisePolyfill=i(2803),a.censor=i(6542),t.exports=a},9165:(t,e,i)=>{"use strict";var n=i(5358);t.exports=i(8018)(n,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:null,"undefined"!=typeof console?console:null)},249:(t,e,i)=>{"use strict";var n=i(478),r=i(5641);t.exports=function(t,e){if(/:([^\/\.-]+)(\.{3})?:/.test(t))throw new SyntaxError("Template parameter names must be separated by either a '/', '-', or '.'.");if(null==e)return t;var i=t.indexOf("?"),s=t.indexOf("#"),a=s<0?t.length:s,o=i<0?a:i,l=t.slice(0,o),h={};r(h,e);var c=l.replace(/:([^\/\.-]+)(\.{3})?/g,(function(t,i,n){return delete h[i],null==e[i]?t:n?e[i]:encodeURIComponent(String(e[i]))})),u=c.indexOf("?"),d=c.indexOf("#"),f=d<0?c.length:d,p=u<0?f:u,g=c.slice(0,p);i>=0&&(g+=t.slice(i,a)),u>=0&&(g+=(i<0?"?":"&")+c.slice(u,f));var m=n(h);return m&&(g+=(i<0&&u<0?"?":"&")+m),s>=0&&(g+=t.slice(s)),d>=0&&(g+=(s<0?"":"&")+c.slice(d)),g}},7562:(t,e,i)=>{"use strict";var n=i(8561);t.exports=function(t){var e=n(t),i=Object.keys(e.params),r=[],s=new RegExp("^"+e.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,(function(t,e,i){return null==e?"\\"+t:(r.push({k:e,r:"..."===i}),"..."===i?"(.*)":"."===i?"([^/]+)\\.":"([^/]+)"+(i||""))}))+"$");return function(t){for(var n=0;n<i.length;n++)if(e.params[i[n]]!==t.params[i[n]])return!1;if(!r.length)return s.test(t.path);var a=s.exec(t.path);if(null==a)return!1;for(n=0;n<r.length;n++)t.params[r[n].k]=r[n].r?a[n+1]:decodeURIComponent(a[n+1]);return!0}}},8561:(t,e,i)=>{"use strict";var n=i(9874);t.exports=function(t){var e=t.indexOf("?"),i=t.indexOf("#"),r=i<0?t.length:i,s=e<0?r:e,a=t.slice(0,s).replace(/\/{2,}/g,"/");return a?("/"!==a[0]&&(a="/"+a),a.length>1&&"/"===a[a.length-1]&&(a=a.slice(0,-1))):a="/",{path:a,params:e<0?{}:n(t.slice(e+1,r))}}},2803:t=>{"use strict";var e=function(t){if(!(this instanceof e))throw new Error("Promise must be called with 'new'.");if("function"!=typeof t)throw new TypeError("executor must be a function.");var i=this,n=[],r=[],s=h(n,!0),a=h(r,!1),o=i._instance={resolvers:n,rejectors:r},l="function"==typeof setImmediate?setImmediate:setTimeout;function h(t,e){return function s(h){var u;try{if(!e||null==h||"object"!=typeof h&&"function"!=typeof h||"function"!=typeof(u=h.then))l((function(){e||0!==t.length||console.error("Possible unhandled promise rejection:",h);for(var i=0;i<t.length;i++)t[i](h);n.length=0,r.length=0,o.state=e,o.retry=function(){s(h)}}));else{if(h===i)throw new TypeError("Promise can't be resolved with itself.");c(u.bind(h))}}catch(t){a(t)}}}function c(t){var e=0;function i(t){return function(i){e++>0||t(i)}}var n=i(a);try{t(i(s),n)}catch(t){n(t)}}c(t)};e.prototype.then=function(t,i){var n,r,s=this._instance;function a(t,e,i,a){e.push((function(e){if("function"!=typeof t)i(e);else try{n(t(e))}catch(t){r&&r(t)}})),"function"==typeof s.retry&&a===s.state&&s.retry()}var o=new e((function(t,e){n=t,r=e}));return a(t,s.resolvers,n,!0),a(i,s.rejectors,r,!1),o},e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(t){return this.then((function(i){return e.resolve(t()).then((function(){return i}))}),(function(i){return e.resolve(t()).then((function(){return e.reject(i)}))}))},e.resolve=function(t){return t instanceof e?t:new e((function(e){e(t)}))},e.reject=function(t){return new e((function(e,i){i(t)}))},e.all=function(t){return new e((function(e,i){var n=t.length,r=0,s=[];if(0===t.length)e([]);else for(var a=0;a<t.length;a++)!function(a){function o(t){r++,s[a]=t,r===n&&e(s)}null==t[a]||"object"!=typeof t[a]&&"function"!=typeof t[a]||"function"!=typeof t[a].then?o(t[a]):t[a].then(o,i)}(a)}))},e.race=function(t){return new e((function(e,i){for(var n=0;n<t.length;n++)t[n].then(e,i)}))},t.exports=e},5164:(t,e,i)=>{"use strict";var n=i(2803);"undefined"!=typeof window?(void 0===window.Promise?window.Promise=n:window.Promise.prototype.finally||(window.Promise.prototype.finally=n.prototype.finally),t.exports=window.Promise):void 0!==i.g?(void 0===i.g.Promise?i.g.Promise=n:i.g.Promise.prototype.finally||(i.g.Promise.prototype.finally=n.prototype.finally),t.exports=i.g.Promise):t.exports=n},478:t=>{"use strict";t.exports=function(t){if("[object Object]"!==Object.prototype.toString.call(t))return"";var e=[];for(var i in t)n(i,t[i]);return e.join("&");function n(t,i){if(Array.isArray(i))for(var r=0;r<i.length;r++)n(t+"["+r+"]",i[r]);else if("[object Object]"===Object.prototype.toString.call(i))for(var r in i)n(t+"["+r+"]",i[r]);else e.push(encodeURIComponent(t)+(null!=i&&""!==i?"="+encodeURIComponent(i):""))}}},9874:t=>{"use strict";function e(t){try{return decodeURIComponent(t)}catch(e){return t}}t.exports=function(t){if(""===t||null==t)return{};"?"===t.charAt(0)&&(t=t.slice(1));for(var i=t.split("&"),n={},r={},s=0;s<i.length;s++){var a=i[s].split("="),o=e(a[0]),l=2===a.length?e(a[1]):"";"true"===l?l=!0:"false"===l&&(l=!1);var h=o.split(/\]\[?|\[/),c=r;o.indexOf("[")>-1&&h.pop();for(var u=0;u<h.length;u++){var d=h[u],f=h[u+1],p=""==f||!isNaN(parseInt(f,10));if(""===d)null==n[o=h.slice(0,u).join()]&&(n[o]=Array.isArray(c)?c.length:0),d=n[o]++;else if("__proto__"===d)break;if(u===h.length-1)c[d]=l;else{var g=Object.getOwnPropertyDescriptor(c,d);null!=g&&(g=g.value),null==g&&(c[d]=g=p?[]:{}),c=g}}}return r}},5358:(t,e,i)=>{"use strict";t.exports=i(5452)("undefined"!=typeof window?window:null)},9621:(t,e,i)=>{"use strict";var n=i(8178),r=i(1359);t.exports=function(){var t=r.apply(0,arguments);return t.tag="[",t.children=n.normalizeChildren(t.children),t}},373:(t,e,i)=>{"use strict";var n=i(8178),r=i(1359),s=i(6188),a=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,o={};function l(t){for(var e in t)if(s.call(t,e))return!1;return!0}t.exports=function(t){if(null==t||"string"!=typeof t&&"function"!=typeof t&&"function"!=typeof t.view)throw Error("The selector must be either a string or a component.");var e=r.apply(1,arguments);return"string"==typeof t&&(e.children=n.normalizeChildren(e.children),"["!==t)?function(t,e){var i=e.attrs,n=s.call(i,"class"),r=n?i.class:i.className;if(e.tag=t.tag,e.attrs={},!l(t.attrs)&&!l(i)){var a={};for(var o in i)s.call(i,o)&&(a[o]=i[o]);i=a}for(var o in t.attrs)s.call(t.attrs,o)&&"className"!==o&&!s.call(i,o)&&(i[o]=t.attrs[o]);for(var o in null==r&&null==t.attrs.className||(i.className=null!=r?null!=t.attrs.className?String(t.attrs.className)+" "+String(r):r:null!=t.attrs.className?t.attrs.className:null),n&&(i.class=null),i)if(s.call(i,o)&&"key"!==o){e.attrs=i;break}return e}(o[t]||function(t){for(var e,i="div",n=[],r={};e=a.exec(t);){var s=e[1],l=e[2];if(""===s&&""!==l)i=l;else if("#"===s)r.id=l;else if("."===s)n.push(l);else if("["===e[3][0]){var h=e[6];h&&(h=h.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===e[4]?n.push(h):r[e[4]]=""===h?h:h||!0}}return n.length>0&&(r.className=n.join(" ")),o[t]={tag:i,attrs:r}}(t),e):(e.tag=t,e)}},1359:(t,e,i)=>{"use strict";var n=i(8178);t.exports=function(){var t,e=arguments[this],i=this+1;if(null==e?e={}:("object"!=typeof e||null!=e.tag||Array.isArray(e))&&(e={},i=this),arguments.length===i+1)t=arguments[i],Array.isArray(t)||(t=[t]);else for(t=[];i<arguments.length;)t.push(arguments[i++]);return n("",e.key,e,t)}},5452:(t,e,i)=>{"use strict";var n=i(8178);t.exports=function(t){var e,i=t&&t.document,r={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function s(t){return t.attrs&&t.attrs.xmlns||r[t.tag]}function a(t,e){if(t.state!==e)throw new Error("'vnode.state' must not be modified.")}function o(t){var e=t.state;try{return this.apply(e,arguments)}finally{a(t,e)}}function l(){try{return i.activeElement}catch(t){return null}}function h(t,e,i,n,r,s,a){for(var o=i;o<n;o++){var l=e[o];null!=l&&c(t,l,r,a,s)}}function c(t,e,r,a,l){var u=e.tag;if("string"==typeof u)switch(e.state={},null!=e.attrs&&j(e.attrs,e,r),u){case"#":!function(t,e,n){e.dom=i.createTextNode(e.children),_(t,e.dom,n)}(t,e,l);break;case"<":d(t,e,a,l);break;case"[":!function(t,e,n,r,s){var a=i.createDocumentFragment();if(null!=e.children){var o=e.children;h(a,o,0,o.length,n,null,r)}e.dom=a.firstChild,e.domSize=a.childNodes.length,_(t,a,s)}(t,e,r,a,l);break;default:!function(t,e,n,r,a){var o=e.tag,l=e.attrs,c=l&&l.is;r=s(e)||r;var u=r?c?i.createElementNS(r,o,{is:c}):i.createElementNS(r,o):c?i.createElement(o,{is:c}):i.createElement(o);e.dom=u,null!=l&&function(t,e,i){"input"===t.tag&&null!=e.type&&t.dom.setAttribute("type",e.type);var n=null!=e&&"input"===t.tag&&"file"===e.type;for(var r in e)C(t,r,null,e[r],i,n)}(e,l,r);if(_(t,u,a),!x(e)&&null!=e.children){var d=e.children;h(u,d,0,d.length,n,null,r),"select"===e.tag&&null!=l&&function(t,e){if("value"in e)if(null===e.value)-1!==t.dom.selectedIndex&&(t.dom.value=null);else{var i=""+e.value;t.dom.value===i&&-1!==t.dom.selectedIndex||(t.dom.value=i)}"selectedIndex"in e&&C(t,"selectedIndex",null,e.selectedIndex,void 0)}(e,l)}}(t,e,r,a,l)}else!function(t,e,i,r,s){(function(t,e){var i;if("function"==typeof t.tag.view){if(t.state=Object.create(t.tag),null!=(i=t.state.view).$$reentrantLock$$)return;i.$$reentrantLock$$=!0}else{if(t.state=void 0,null!=(i=t.tag).$$reentrantLock$$)return;i.$$reentrantLock$$=!0,t.state=null!=t.tag.prototype&&"function"==typeof t.tag.prototype.view?new t.tag(t):t.tag(t)}j(t.state,t,e),null!=t.attrs&&j(t.attrs,t,e);if(t.instance=n.normalize(o.call(t.state.view,t)),t.instance===t)throw Error("A view cannot return the vnode it received as argument");i.$$reentrantLock$$=null})(e,i),null!=e.instance?(c(t,e.instance,i,r,s),e.dom=e.instance.dom,e.domSize=null!=e.dom?e.instance.domSize:0):e.domSize=0}(t,e,r,a,l)}var u={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function d(t,e,n,r){var s=e.children.match(/^\s*?<(\w+)/im)||[],a=i.createElement(u[s[1]]||"div");"http://www.w3.org/2000/svg"===n?(a.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+e.children+"</svg>",a=a.firstChild):a.innerHTML=e.children,e.dom=a.firstChild,e.domSize=a.childNodes.length,e.instance=[];for(var o,l=i.createDocumentFragment();o=a.firstChild;)e.instance.push(o),l.appendChild(o);_(t,l,r)}function f(t,e,i,n,r,s){if(e!==i&&(null!=e||null!=i))if(null==e||0===e.length)h(t,i,0,i.length,n,r,s);else if(null==i||0===i.length)w(t,e,0,e.length);else{var a=null!=e[0]&&null!=e[0].key,o=null!=i[0]&&null!=i[0].key,l=0,u=0;if(!a)for(;u<e.length&&null==e[u];)u++;if(!o)for(;l<i.length&&null==i[l];)l++;if(a!==o)w(t,e,u,e.length),h(t,i,l,i.length,n,r,s);else if(o){for(var d,f,b,_,x,T=e.length-1,E=i.length-1;T>=u&&E>=l&&(b=e[T],_=i[E],b.key===_.key);)b!==_&&p(t,b,_,n,r,s),null!=_.dom&&(r=_.dom),T--,E--;for(;T>=u&&E>=l&&(d=e[u],f=i[l],d.key===f.key);)u++,l++,d!==f&&p(t,d,f,n,v(e,u,r),s);for(;T>=u&&E>=l&&l!==E&&d.key===_.key&&b.key===f.key;)y(t,b,x=v(e,u,r)),b!==f&&p(t,b,f,n,x,s),++l<=--E&&y(t,d,r),d!==_&&p(t,d,_,n,r,s),null!=_.dom&&(r=_.dom),u++,b=e[--T],_=i[E],d=e[u],f=i[l];for(;T>=u&&E>=l&&b.key===_.key;)b!==_&&p(t,b,_,n,r,s),null!=_.dom&&(r=_.dom),E--,b=e[--T],_=i[E];if(l>E)w(t,e,u,T+1);else if(u>T)h(t,i,l,E+1,n,r,s);else{var k,C,M=r,A=E-l+1,O=new Array(A),P=0,R=0,I=2147483647,L=0;for(R=0;R<A;R++)O[R]=-1;for(R=E;R>=l;R--){null==k&&(k=g(e,u,T+1));var D=k[(_=i[R]).key];null!=D&&(I=D<I?D:-1,O[R-l]=D,b=e[D],e[D]=null,b!==_&&p(t,b,_,n,r,s),null!=_.dom&&(r=_.dom),L++)}if(r=M,L!==T-u+1&&w(t,e,u,T+1),0===L)h(t,i,l,E+1,n,r,s);else if(-1===I)for(C=function(t){var e=[0],i=0,n=0,r=0,s=m.length=t.length;for(r=0;r<s;r++)m[r]=t[r];for(r=0;r<s;++r)if(-1!==t[r]){var a=e[e.length-1];if(t[a]<t[r])m[r]=a,e.push(r);else{for(i=0,n=e.length-1;i<n;){var o=(i>>>1)+(n>>>1)+(i&n&1);t[e[o]]<t[r]?i=o+1:n=o}t[r]<t[e[i]]&&(i>0&&(m[r]=e[i-1]),e[i]=r)}}i=e.length,n=e[i-1];for(;i-- >0;)e[i]=n,n=m[n];return m.length=0,e}(O),P=C.length-1,R=E;R>=l;R--)f=i[R],-1===O[R-l]?c(t,f,n,s,r):C[P]===R-l?P--:y(t,f,r),null!=f.dom&&(r=i[R].dom);else for(R=E;R>=l;R--)f=i[R],-1===O[R-l]&&c(t,f,n,s,r),null!=f.dom&&(r=i[R].dom)}}else{var N=e.length<i.length?e.length:i.length;for(l=l<u?l:u;l<N;l++)(d=e[l])===(f=i[l])||null==d&&null==f||(null==d?c(t,f,n,s,v(e,l+1,r)):null==f?S(t,d):p(t,d,f,n,v(e,l+1,r),s));e.length>N&&w(t,e,l,e.length),i.length>N&&h(t,i,l,i.length,n,r,s)}}}function p(t,e,i,r,a,l){var h=e.tag;if(h===i.tag){if(i.state=e.state,i.events=e.events,function(t,e){do{var i;if(null!=t.attrs&&"function"==typeof t.attrs.onbeforeupdate)if(void 0!==(i=o.call(t.attrs.onbeforeupdate,t,e))&&!i)break;if("string"!=typeof t.tag&&"function"==typeof t.state.onbeforeupdate)if(void 0!==(i=o.call(t.state.onbeforeupdate,t,e))&&!i)break;return!1}while(0);return t.dom=e.dom,t.domSize=e.domSize,t.instance=e.instance,t.attrs=e.attrs,t.children=e.children,t.text=e.text,!0}(i,e))return;if("string"==typeof h)switch(null!=i.attrs&&B(i.attrs,i,r),h){case"#":!function(t,e){t.children.toString()!==e.children.toString()&&(t.dom.nodeValue=e.children);e.dom=t.dom}(e,i);break;case"<":!function(t,e,i,n,r){e.children!==i.children?(T(t,e),d(t,i,n,r)):(i.dom=e.dom,i.domSize=e.domSize,i.instance=e.instance)}(t,e,i,l,a);break;case"[":!function(t,e,i,n,r,s){f(t,e.children,i.children,n,r,s);var a=0,o=i.children;if(i.dom=null,null!=o){for(var l=0;l<o.length;l++){var h=o[l];null!=h&&null!=h.dom&&(null==i.dom&&(i.dom=h.dom),a+=h.domSize||1)}1!==a&&(i.domSize=a)}}(t,e,i,r,a,l);break;default:!function(t,e,i,n){var r=e.dom=t.dom;n=s(e)||n,"textarea"===e.tag&&null==e.attrs&&(e.attrs={});(function(t,e,i,n){e&&e===i&&console.warn("Don't reuse attrs object, use new object for every redraw, this will throw in next major");if(null!=i){"input"===t.tag&&null!=i.type&&t.dom.setAttribute("type",i.type);var r="input"===t.tag&&"file"===i.type;for(var s in i)C(t,s,e&&e[s],i[s],n,r)}var a;if(null!=e)for(var s in e)null==(a=e[s])||null!=i&&null!=i[s]||M(t,s,a,n)})(e,t.attrs,e.attrs,n),x(e)||f(r,t.children,e.children,i,null,n)}(e,i,r,l)}else!function(t,e,i,r,s,a){if(i.instance=n.normalize(o.call(i.state.view,i)),i.instance===i)throw Error("A view cannot return the vnode it received as argument");B(i.state,i,r),null!=i.attrs&&B(i.attrs,i,r);null!=i.instance?(null==e.instance?c(t,i.instance,r,a,s):p(t,e.instance,i.instance,r,s,a),i.dom=i.instance.dom,i.domSize=i.instance.domSize):null!=e.instance?(S(t,e.instance),i.dom=void 0,i.domSize=0):(i.dom=e.dom,i.domSize=e.domSize)}(t,e,i,r,a,l)}else S(t,e),c(t,i,r,l,a)}function g(t,e,i){for(var n=Object.create(null);e<i;e++){var r=t[e];if(null!=r){var s=r.key;null!=s&&(n[s]=e)}}return n}var m=[];function v(t,e,i){for(;e<t.length;e++)if(null!=t[e]&&null!=t[e].dom)return t[e].dom;return i}function y(t,e,n){var r=i.createDocumentFragment();b(t,r,e),_(t,r,n)}function b(t,e,i){for(;null!=i.dom&&i.dom.parentNode===t;){if("string"!=typeof i.tag){if(null!=(i=i.instance))continue}else if("<"===i.tag)for(var n=0;n<i.instance.length;n++)e.appendChild(i.instance[n]);else if("["!==i.tag)e.appendChild(i.dom);else if(1===i.children.length){if(null!=(i=i.children[0]))continue}else for(n=0;n<i.children.length;n++){var r=i.children[n];null!=r&&b(t,e,r)}break}}function _(t,e,i){null!=i?t.insertBefore(e,i):t.appendChild(e)}function x(t){if(null==t.attrs||null==t.attrs.contenteditable&&null==t.attrs.contentEditable)return!1;var e=t.children;if(null!=e&&1===e.length&&"<"===e[0].tag){var i=e[0].children;t.dom.innerHTML!==i&&(t.dom.innerHTML=i)}else if(null!=e&&0!==e.length)throw new Error("Child node of a contenteditable must be trusted.");return!0}function w(t,e,i,n){for(var r=i;r<n;r++){var s=e[r];null!=s&&S(t,s)}}function S(t,e){var i,n,r,s=0,l=e.state;"string"!=typeof e.tag&&"function"==typeof e.state.onbeforeremove&&(null!=(r=o.call(e.state.onbeforeremove,e))&&"function"==typeof r.then&&(s=1,i=r));e.attrs&&"function"==typeof e.attrs.onbeforeremove&&(null!=(r=o.call(e.attrs.onbeforeremove,e))&&"function"==typeof r.then&&(s|=2,n=r));if(a(e,l),s){if(null!=i){var h=function(){1&s&&((s&=2)||c())};i.then(h,h)}if(null!=n){h=function(){2&s&&((s&=1)||c())};n.then(h,h)}}else k(e),E(t,e);function c(){a(e,l),k(e),E(t,e)}}function T(t,e){for(var i=0;i<e.instance.length;i++)t.removeChild(e.instance[i])}function E(t,e){for(;null!=e.dom&&e.dom.parentNode===t;){if("string"!=typeof e.tag){if(null!=(e=e.instance))continue}else if("<"===e.tag)T(t,e);else{if("["!==e.tag&&(t.removeChild(e.dom),!Array.isArray(e.children)))break;if(1===e.children.length){if(null!=(e=e.children[0]))continue}else for(var i=0;i<e.children.length;i++){var n=e.children[i];null!=n&&E(t,n)}}break}}function k(t){if("string"!=typeof t.tag&&"function"==typeof t.state.onremove&&o.call(t.state.onremove,t),t.attrs&&"function"==typeof t.attrs.onremove&&o.call(t.attrs.onremove,t),"string"!=typeof t.tag)null!=t.instance&&k(t.instance);else{var e=t.children;if(Array.isArray(e))for(var i=0;i<e.length;i++){var n=e[i];null!=n&&k(n)}}}function C(t,e,n,r,s,a){if(!("key"===e||"is"===e||null==r||A(e)||n===r&&!function(t,e){return"value"===e||"checked"===e||"selectedIndex"===e||"selected"===e&&t.dom===l()||"option"===t.tag&&t.dom.parentNode===i.activeElement}(t,e)&&"object"!=typeof r||"type"===e&&"input"===t.tag)){if("o"===e[0]&&"n"===e[1])return F(t,e,r);if("xlink:"===e.slice(0,6))t.dom.setAttributeNS("http://www.w3.org/1999/xlink",e.slice(6),r);else if("style"===e)D(t.dom,n,r);else if(O(t,e,s)){if("value"===e){if(("input"===t.tag||"textarea"===t.tag)&&t.dom.value===""+r&&(a||t.dom===l()))return;if("select"===t.tag&&null!==n&&t.dom.value===""+r)return;if("option"===t.tag&&null!==n&&t.dom.value===""+r)return;if(a&&""+r!="")return void console.error("`value` is read-only on file inputs!")}t.dom[e]=r}else"boolean"==typeof r?r?t.dom.setAttribute(e,""):t.dom.removeAttribute(e):t.dom.setAttribute("className"===e?"class":e,r)}}function M(t,e,i,n){if("key"!==e&&"is"!==e&&null!=i&&!A(e))if("o"===e[0]&&"n"===e[1])F(t,e,void 0);else if("style"===e)D(t.dom,i,null);else if(!O(t,e,n)||"className"===e||"title"===e||"value"===e&&("option"===t.tag||"select"===t.tag&&-1===t.dom.selectedIndex&&t.dom===l())||"input"===t.tag&&"type"===e){var r=e.indexOf(":");-1!==r&&(e=e.slice(r+1)),!1!==i&&t.dom.removeAttribute("className"===e?"class":e)}else t.dom[e]=null}function A(t){return"oninit"===t||"oncreate"===t||"onupdate"===t||"onremove"===t||"onbeforeremove"===t||"onbeforeupdate"===t}function O(t,e,i){return void 0===i&&(t.tag.indexOf("-")>-1||null!=t.attrs&&t.attrs.is||"href"!==e&&"list"!==e&&"form"!==e&&"width"!==e&&"height"!==e)&&e in t.dom}var P,R=/[A-Z]/g;function I(t){return"-"+t.toLowerCase()}function L(t){return"-"===t[0]&&"-"===t[1]?t:"cssFloat"===t?"float":t.replace(R,I)}function D(t,e,i){if(e===i);else if(null==i)t.style.cssText="";else if("object"!=typeof i)t.style.cssText=i;else if(null==e||"object"!=typeof e)for(var n in t.style.cssText="",i){null!=(r=i[n])&&t.style.setProperty(L(n),String(r))}else{for(var n in i){var r;null!=(r=i[n])&&(r=String(r))!==String(e[n])&&t.style.setProperty(L(n),r)}for(var n in e)null!=e[n]&&null==i[n]&&t.style.removeProperty(L(n))}}function N(){this._=e}function F(t,i,n){if(null!=t.events){if(t.events._=e,t.events[i]===n)return;null==n||"function"!=typeof n&&"object"!=typeof n?(null!=t.events[i]&&t.dom.removeEventListener(i.slice(2),t.events,!1),t.events[i]=void 0):(null==t.events[i]&&t.dom.addEventListener(i.slice(2),t.events,!1),t.events[i]=n)}else null==n||"function"!=typeof n&&"object"!=typeof n||(t.events=new N,t.dom.addEventListener(i.slice(2),t.events,!1),t.events[i]=n)}function j(t,e,i){"function"==typeof t.oninit&&o.call(t.oninit,e),"function"==typeof t.oncreate&&i.push(o.bind(t.oncreate,e))}function B(t,e,i){"function"==typeof t.onupdate&&i.push(o.bind(t.onupdate,e))}return N.prototype=Object.create(null),N.prototype.handleEvent=function(t){var e,i=this["on"+t.type];"function"==typeof i?e=i.call(t.currentTarget,t):"function"==typeof i.handleEvent&&i.handleEvent(t),this._&&!1!==t.redraw&&(0,this._)(),!1===e&&(t.preventDefault(),t.stopPropagation())},function(t,i,r){if(!t)throw new TypeError("DOM element being rendered to does not exist.");if(null!=P&&t.contains(P))throw new TypeError("Node is currently being rendered to and thus is locked.");var s=e,a=P,o=[],h=l(),c=t.namespaceURI;P=t,e="function"==typeof r?r:void 0;try{null==t.vnodes&&(t.textContent=""),i=n.normalizeChildren(Array.isArray(i)?i:[i]),f(t,t.vnodes,i,o,null,"http://www.w3.org/1999/xhtml"===c?void 0:c),t.vnodes=i,null!=h&&l()!==h&&"function"==typeof h.focus&&h.focus();for(var u=0;u<o.length;u++)o[u]()}finally{e=s,P=a}}}},4742:(t,e,i)=>{"use strict";var n=i(8178);t.exports=function(t){return null==t&&(t=""),n("<",void 0,void 0,t,void 0,void 0)}},8178:t=>{"use strict";function e(t,e,i,n,r,s){return{tag:t,key:e,attrs:i,children:n,text:r,dom:s,domSize:void 0,state:void 0,events:void 0,instance:void 0}}e.normalize=function(t){return Array.isArray(t)?e("[",void 0,void 0,e.normalizeChildren(t),void 0,void 0):null==t||"boolean"==typeof t?null:"object"==typeof t?t:e("#",void 0,void 0,String(t),void 0,void 0)},e.normalizeChildren=function(t){var i=[];if(t.length){for(var n=null!=t[0]&&null!=t[0].key,r=1;r<t.length;r++)if((null!=t[r]&&null!=t[r].key)!==n)throw new TypeError(!n||null==t[r]&&"boolean"!=typeof t[r]?"In fragments, vnodes must either all have keys or none have keys.":"In fragments, vnodes must either all have keys or none have keys. You may wish to consider using an explicit keyed empty fragment, m.fragment({key: ...}), instead of a hole.");for(r=0;r<t.length;r++)i[r]=e.normalize(t[r])}return i},t.exports=e},9074:(t,e,i)=>{"use strict";var n=i(5164),r=i(9165);t.exports=i(2775)("undefined"!=typeof window?window:null,n,r.redraw)},2775:(t,e,i)=>{"use strict";var n=i(249),r=i(6188);t.exports=function(t,e,i){var s=0;function a(t){return new e(t)}function o(t){return function(r,s){"string"!=typeof r?(s=r,r=r.url):null==s&&(s={});var o=new e((function(e,i){t(n(r,s.params),s,(function(t){if("function"==typeof s.type)if(Array.isArray(t))for(var i=0;i<t.length;i++)t[i]=new s.type(t[i]);else t=new s.type(t);e(t)}),i)}));if(!0===s.background)return o;var l=0;function h(){0==--l&&"function"==typeof i&&i()}return function t(e){var i=e.then;return e.constructor=a,e.then=function(){l++;var n=i.apply(e,arguments);return n.then(h,(function(t){if(h(),0===l)throw t})),t(n)},e}(o)}}function l(t,e){for(var i in t.headers)if(r.call(t.headers,i)&&i.toLowerCase()===e)return!0;return!1}return a.prototype=e.prototype,a.__proto__=e,{request:o((function(e,i,n,s){var a,o=null!=i.method?i.method.toUpperCase():"GET",h=i.body,c=(null==i.serialize||i.serialize===JSON.serialize)&&!(h instanceof t.FormData||h instanceof t.URLSearchParams),u=i.responseType||("function"==typeof i.extract?"":"json"),d=new t.XMLHttpRequest,f=!1,p=!1,g=d,m=d.abort;for(var v in d.abort=function(){f=!0,m.call(this)},d.open(o,e,!1!==i.async,"string"==typeof i.user?i.user:void 0,"string"==typeof i.password?i.password:void 0),c&&null!=h&&!l(i,"content-type")&&d.setRequestHeader("Content-Type","application/json; charset=utf-8"),"function"==typeof i.deserialize||l(i,"accept")||d.setRequestHeader("Accept","application/json, text/*"),i.withCredentials&&(d.withCredentials=i.withCredentials),i.timeout&&(d.timeout=i.timeout),d.responseType=u,i.headers)r.call(i.headers,v)&&d.setRequestHeader(v,i.headers[v]);d.onreadystatechange=function(t){if(!f&&4===t.target.readyState)try{var r,a=t.target.status>=200&&t.target.status<300||304===t.target.status||/^file:\/\//i.test(e),o=t.target.response;if("json"===u){if(!t.target.responseType&&"function"!=typeof i.extract)try{o=JSON.parse(t.target.responseText)}catch(t){o=null}}else u&&"text"!==u||null==o&&(o=t.target.responseText);if("function"==typeof i.extract?(o=i.extract(t.target,i),a=!0):"function"==typeof i.deserialize&&(o=i.deserialize(o)),a)n(o);else{var l=function(){try{r=t.target.responseText}catch(t){r=o}var e=new Error(r);e.code=t.target.status,e.response=o,s(e)};0===d.status?setTimeout((function(){p||l()})):l()}}catch(t){s(t)}},d.ontimeout=function(t){p=!0;var e=new Error("Request timed out");e.code=t.target.status,s(e)},"function"==typeof i.config&&(d=i.config(d,i,e)||d)!==g&&(a=d.abort,d.abort=function(){f=!0,a.call(this)}),null==h?d.send():"function"==typeof i.serialize?d.send(i.serialize(h)):h instanceof t.FormData||h instanceof t.URLSearchParams?d.send(h):d.send(JSON.stringify(h))})),jsonp:o((function(e,i,n,r){var a=i.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+s++,o=t.document.createElement("script");t[a]=function(e){delete t[a],o.parentNode.removeChild(o),n(e)},o.onerror=function(){delete t[a],o.parentNode.removeChild(o),r(new Error("JSONP request failed"))},o.src=e+(e.indexOf("?")<0?"?":"&")+encodeURIComponent(i.callbackKey||"callback")+"="+encodeURIComponent(a),t.document.documentElement.appendChild(o)}))}}},843:(t,e,i)=>{"use strict";var n=i(9165);t.exports=i(3223)("undefined"!=typeof window?window:null,n)},5641:(t,e,i)=>{"use strict";var n=i(6188);t.exports=Object.assign||function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i])}},6542:(t,e,i)=>{"use strict";var n=i(6188),r=new RegExp("^(?:key|oninit|oncreate|onbeforeupdate|onupdate|onbeforeremove|onremove)$");t.exports=function(t,e){var i={};if(null!=e)for(var s in t)n.call(t,s)&&!r.test(s)&&e.indexOf(s)<0&&(i[s]=t[s]);else for(var s in t)n.call(t,s)&&!r.test(s)&&(i[s]=t[s]);return i}},6188:t=>{"use strict";t.exports={}.hasOwnProperty},2582:function(t){t.exports=function(){"use strict";function t(t,n,r,s,a){!function t(i,n,r,s,a){for(;s>r;){if(s-r>600){var o=s-r+1,l=n-r+1,h=Math.log(o),c=.5*Math.exp(2*h/3),u=.5*Math.sqrt(h*c*(o-c)/o)*(l-o/2<0?-1:1);t(i,n,Math.max(r,Math.floor(n-l*c/o+u)),Math.min(s,Math.floor(n+(o-l)*c/o+u)),a)}var d=i[n],f=r,p=s;for(e(i,r,n),a(i[s],d)>0&&e(i,r,s);f<p;){for(e(i,f,p),f++,p--;a(i[f],d)<0;)f++;for(;a(i[p],d)>0;)p--}0===a(i[r],d)?e(i,r,p):e(i,++p,s),p<=n&&(r=p+1),n<=p&&(s=p-1)}}(t,n,r||0,s||t.length-1,a||i)}function e(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function i(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,i,n,r){r||(r=p(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s=e;s<i;s++){var a=t.children[s];o(r,t.leaf?n(a):a)}return r}function o(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function f(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,i,n,r,s){for(var a=[i,n];a.length;)if(!((n=a.pop())-(i=a.pop())<=r)){var o=i+Math.ceil((n-i)/r/2)*r;t(e,o,i,n,s),a.push(i,o,o,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,i=[];if(!f(t,e))return i;for(var n=this.toBBox,r=[];e;){for(var s=0;s<e.children.length;s++){var a=e.children[s],o=e.leaf?n(a):a;f(t,o)&&(e.leaf?i.push(a):d(t,o)?this._all(a,i):r.push(a))}e=r.pop()}return i},n.prototype.collides=function(t){var e=this.data;if(!f(t,e))return!1;for(var i=[];e;){for(var n=0;n<e.children.length;n++){var r=e.children[n],s=e.leaf?this.toBBox(r):r;if(f(t,s)){if(e.leaf||d(t,s))return!0;i.push(r)}}e=i.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=p([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var i,n,s,a=this.data,o=this.toBBox(t),l=[],h=[];a||l.length;){if(a||(a=l.pop(),n=l[l.length-1],i=h.pop(),s=!0),a.leaf){var c=r(t,a.children,e);if(-1!==c)return a.children.splice(c,1),l.push(a),this._condense(l),this}s||a.leaf||!d(a,o)?n?(i++,a=n.children[i],s=!1):a=null:(l.push(a),h.push(i),i=0,n=a,a=a.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},n.prototype._build=function(t,e,i,n){var r,a=i-e+1,o=this._maxEntries;if(a<=o)return s(r=p(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(a)/Math.log(o)),o=Math.ceil(a/Math.pow(o,n-1))),(r=p([])).leaf=!1,r.height=n;var l=Math.ceil(a/o),h=l*Math.ceil(Math.sqrt(o));g(t,e,i,h,this.compareMinX);for(var c=e;c<=i;c+=h){var u=Math.min(c+h-1,i);g(t,c,u,l,this.compareMinY);for(var d=c;d<=u;d+=l){var f=Math.min(d+l-1,u);r.children.push(this._build(t,d,f,n-1))}}return s(r,this.toBBox),r},n.prototype._chooseSubtree=function(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){for(var r=1/0,s=1/0,a=void 0,o=0;o<e.children.length;o++){var l=e.children[o],h=c(l),u=(d=t,f=l,(Math.max(f.maxX,d.maxX)-Math.min(f.minX,d.minX))*(Math.max(f.maxY,d.maxY)-Math.min(f.minY,d.minY))-h);u<s?(s=u,r=h<r?h:r,a=l):u===s&&h<r&&(r=h,a=l)}e=a||e.children[0]}var d,f;return e},n.prototype._insert=function(t,e,i){var n=i?t:this.toBBox(t),r=[],s=this._chooseSubtree(n,this.data,e,r);for(s.children.push(t),o(s,n);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(n,r,e)},n.prototype._split=function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var a=this._chooseSplitIndex(i,r,n),o=p(i.children.splice(a,i.children.length-a));o.height=i.height,o.leaf=i.leaf,s(i,this.toBBox),s(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(i,o)},n.prototype._splitRoot=function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,i){for(var n,r,s,o,l,h,u,d=1/0,f=1/0,p=e;p<=i-e;p++){var g=a(t,0,p,this.toBBox),m=a(t,p,i,this.toBBox),v=(r=g,s=m,o=void 0,l=void 0,h=void 0,u=void 0,o=Math.max(r.minX,s.minX),l=Math.max(r.minY,s.minY),h=Math.min(r.maxX,s.maxX),u=Math.min(r.maxY,s.maxY),Math.max(0,h-o)*Math.max(0,u-l)),y=c(g)+c(m);v<d?(d=v,n=p,f=y<f?y:f):v===d&&y<f&&(f=y,n=p)}return n||i-e},n.prototype._chooseSplitAxis=function(t,e,i){var n=t.leaf?this.compareMinX:l,r=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,i,n){t.children.sort(n);for(var r=this.toBBox,s=a(t,0,e,r),l=a(t,i-e,i,r),h=u(s)+u(l),c=e;c<i-e;c++){var d=t.children[c];o(s,t.leaf?r(d):d),h+=u(s)}for(var f=i-e-1;f>=e;f--){var p=t.children[f];o(l,t.leaf?r(p):p),h+=u(l)}return h},n.prototype._adjustParentBBoxes=function(t,e,i){for(var n=i;n>=0;n--)o(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():s(t[e],this.toBBox)},n}()},9829:function(t,e){var i,n,r;!function(s,a){"use strict";n=[],void 0===(r="function"==typeof(i=function(){function t(t){return!isNaN(parseFloat(t))&&isFinite(t)}function e(t){return t.charAt(0).toUpperCase()+t.substring(1)}function i(t){return function(){return this[t]}}var n=["isConstructor","isEval","isNative","isToplevel"],r=["columnNumber","lineNumber"],s=["fileName","functionName","source"],a=["args"],o=["evalOrigin"],l=n.concat(r,s,a,o);function h(t){if(t)for(var i=0;i<l.length;i++)void 0!==t[l[i]]&&this["set"+e(l[i])](t[l[i]])}h.prototype={getArgs:function(){return this.args},setArgs:function(t){if("[object Array]"!==Object.prototype.toString.call(t))throw new TypeError("Args must be an Array");this.args=t},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(t){if(t instanceof h)this.evalOrigin=t;else{if(!(t instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new h(t)}},toString:function(){var t=this.getFileName()||"",e=this.getLineNumber()||"",i=this.getColumnNumber()||"",n=this.getFunctionName()||"";return this.getIsEval()?t?"[eval] ("+t+":"+e+":"+i+")":"[eval]:"+e+":"+i:n?n+" ("+t+":"+e+":"+i+")":t+":"+e+":"+i}},h.fromString=function(t){var e=t.indexOf("("),i=t.lastIndexOf(")"),n=t.substring(0,e),r=t.substring(e+1,i).split(","),s=t.substring(i+1);if(0===s.indexOf("@"))var a=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(s,""),o=a[1],l=a[2],c=a[3];return new h({functionName:n,args:r||void 0,fileName:o,lineNumber:l||void 0,columnNumber:c||void 0})};for(var c=0;c<n.length;c++)h.prototype["get"+e(n[c])]=i(n[c]),h.prototype["set"+e(n[c])]=function(t){return function(e){this[t]=Boolean(e)}}(n[c]);for(var u=0;u<r.length;u++)h.prototype["get"+e(r[u])]=i(r[u]),h.prototype["set"+e(r[u])]=function(e){return function(i){if(!t(i))throw new TypeError(e+" must be a Number");this[e]=Number(i)}}(r[u]);for(var d=0;d<s.length;d++)h.prototype["get"+e(s[d])]=i(s[d]),h.prototype["set"+e(s[d])]=function(t){return function(e){this[t]=String(e)}}(s[d]);return h})?i.apply(e,n):i)||(t.exports=r)}()},3379:(t,e,i)=>{"use strict";var n,r=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},s=function(){var t={};return function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[e]=i}return t[e]}}(),a=[];function o(t){for(var e=-1,i=0;i<a.length;i++)if(a[i].identifier===t){e=i;break}return e}function l(t,e){for(var i={},n=[],r=0;r<t.length;r++){var s=t[r],l=e.base?s[0]+e.base:s[0],h=i[l]||0,c="".concat(l," ").concat(h);i[l]=h+1;var u=o(c),d={css:s[1],media:s[2],sourceMap:s[3]};-1!==u?(a[u].references++,a[u].updater(d)):a.push({identifier:c,updater:m(d,e),references:1}),n.push(c)}return n}function h(t){var e=document.createElement("style"),n=t.attributes||{};if(void 0===n.nonce){var r=i.nc;r&&(n.nonce=r)}if(Object.keys(n).forEach((function(t){e.setAttribute(t,n[t])})),"function"==typeof t.insert)t.insert(e);else{var a=s(t.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(e)}return e}var c,u=(c=[],function(t,e){return c[t]=e,c.filter(Boolean).join("\n")});function d(t,e,i,n){var r=i?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(t.styleSheet)t.styleSheet.cssText=u(e,r);else{var s=document.createTextNode(r),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(s,a[e]):t.appendChild(s)}}function f(t,e,i){var n=i.css,r=i.media,s=i.sourceMap;if(r?t.setAttribute("media",r):t.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var p=null,g=0;function m(t,e){var i,n,r;if(e.singleton){var s=g++;i=p||(p=h(e)),n=d.bind(null,i,s,!1),r=d.bind(null,i,s,!0)}else i=h(e),n=f.bind(null,i,e),r=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else r()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=r());var i=l(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var n=0;n<i.length;n++){var r=o(i[n]);a[r].references--}for(var s=l(t,e),h=0;h<i.length;h++){var c=o(i[h]);0===a[c].references&&(a[c].updater(),a.splice(c,1))}i=s}}}},4378:(t,e,i)=>{var n=i(7424).RBTree;function r(t,e,i){this.discrete=!1===t,this.delta=t||.01,this.K=void 0===e?25:e,this.CX=void 0===i?1.1:i,this.centroids=new n(s),this.nreset=0,this.reset()}function s(t,e){return t.mean>e.mean?1:t.mean<e.mean?-1:0}function a(t,e){return t.mean_cumn-e.mean_cumn}function o(t){this.config=t||{},this.mode=this.config.mode||"auto",r.call(this,"cont"===this.mode&&t.delta),this.digest_ratio=this.config.ratio||.9,this.digest_thresh=this.config.thresh||1e3,this.n_unique=0}r.prototype.reset=function(){this.centroids.clear(),this.n=0,this.nreset+=1,this.last_cumulate=0},r.prototype.size=function(){return this.centroids.size},r.prototype.toArray=function(t){var e=[];return t?(this._cumulate(!0),this.centroids.each((function(t){e.push(t)}))):this.centroids.each((function(t){e.push({mean:t.mean,n:t.n})})),e},r.prototype.summary=function(){return[(this.discrete?"exact ":"approximating ")+this.n+" samples using "+this.size()+" centroids","min = "+this.percentile(0),"Q1  = "+this.percentile(.25),"Q2  = "+this.percentile(.5),"Q3  = "+this.percentile(.75),"max = "+this.percentile(1)].join("\n")},r.prototype.push=function(t,e){e=e||1,t=Array.isArray(t)?t:[t];for(var i=0;i<t.length;i++)this._digest(t[i],e)},r.prototype.push_centroid=function(t){t=Array.isArray(t)?t:[t];for(var e=0;e<t.length;e++)this._digest(t[e].mean,t[e].n)},r.prototype._cumulate=function(t){if(!(this.n===this.last_cumulate||!t&&this.CX&&this.CX>this.n/this.last_cumulate)){var e=0;this.centroids.each((function(t){t.mean_cumn=e+t.n/2,e=t.cumn=e+t.n})),this.n=this.last_cumulate=e}},r.prototype.find_nearest=function(t){if(0===this.size())return null;var e=this.centroids.lowerBound({mean:t}),i=null===e.data()?e.prev():e.data();if(i.mean===t||this.discrete)return i;var n=e.prev();return n&&Math.abs(n.mean-t)<Math.abs(i.mean-t)?n:i},r.prototype._new_centroid=function(t,e,i){var n={mean:t,n:e,cumn:i};return this.centroids.insert(n),this.n+=e,n},r.prototype._addweight=function(t,e,i){e!==t.mean&&(t.mean+=i*(e-t.mean)/(t.n+i)),t.cumn+=i,t.mean_cumn+=i/2,t.n+=i,this.n+=i},r.prototype._digest=function(t,e){var i=this.centroids.min(),n=this.centroids.max(),r=this.find_nearest(t);if(r&&r.mean===t)this._addweight(r,t,e);else if(r===i)this._new_centroid(t,e,0);else if(r===n)this._new_centroid(t,e,this.n);else if(this.discrete)this._new_centroid(t,e,r.cumn);else{var s=r.mean_cumn/this.n;Math.floor(4*this.n*this.delta*s*(1-s))-r.n>=e?this._addweight(r,t,e):this._new_centroid(t,e,r.cumn)}this._cumulate(!1),!this.discrete&&this.K&&this.size()>this.K/this.delta&&this.compress()},r.prototype.bound_mean=function(t){var e=this.centroids.upperBound({mean:t}),i=e.prev();return[i,i.mean===t?i:e.next()]},r.prototype.p_rank=function(t){var e=(Array.isArray(t)?t:[t]).map(this._p_rank,this);return Array.isArray(t)?e:e[0]},r.prototype._p_rank=function(t){if(0!==this.size()){if(t<this.centroids.min().mean)return 0;if(t>this.centroids.max().mean)return 1;this._cumulate(!0);var e=this.bound_mean(t),i=e[0],n=e[1];if(this.discrete)return i.cumn/this.n;var r=i.mean_cumn;return i!==n&&(r+=(t-i.mean)*(n.mean_cumn-i.mean_cumn)/(n.mean-i.mean)),r/this.n}},r.prototype.bound_mean_cumn=function(t){this.centroids._comparator=a;var e=this.centroids.upperBound({mean_cumn:t});this.centroids._comparator=s;var i=e.prev();return[i,i&&i.mean_cumn===t?i:e.next()]},r.prototype.percentile=function(t){var e=(Array.isArray(t)?t:[t]).map(this._percentile,this);return Array.isArray(t)?e:e[0]},r.prototype._percentile=function(t){if(0!==this.size()){this._cumulate(!0);var e=this.n*t,i=this.bound_mean_cumn(e),n=i[0],r=i[1];return r===n||null===n||null===r?(n||r).mean:this.discrete?e<=n.cumn?n.mean:r.mean:n.mean+(e-n.mean_cumn)*(r.mean-n.mean)/(r.mean_cumn-n.mean_cumn)}},r.prototype.compress=function(){if(!this.compressing){var t,e,i=this.toArray();for(this.reset(),this.compressing=!0;i.length>0;)this.push_centroid((t=i,e=void 0,e=Math.floor(Math.random()*t.length),t.splice(e,1)[0]));this._cumulate(!0),this.compressing=!1}},o.prototype=Object.create(r.prototype),o.prototype.constructor=o,o.prototype.push=function(t){r.prototype.push.call(this,t),this.check_continuous()},o.prototype._new_centroid=function(t,e,i){this.n_unique+=1,r.prototype._new_centroid.call(this,t,e,i)},o.prototype._addweight=function(t,e,i){1===t.n&&(this.n_unique-=1),r.prototype._addweight.call(this,t,e,i)},o.prototype.check_continuous=function(){return!("auto"!==this.mode||this.size()<this.digest_thresh)&&(this.n_unique/this.size()>this.digest_ratio&&(this.mode="cont",this.discrete=!1,this.delta=this.config.delta||.01,this.compress(),!0))},t.exports={TDigest:r,Digest:o}}},t=>{var e;e=3268,t(t.s=e)}]);